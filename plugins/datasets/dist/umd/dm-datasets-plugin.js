"use strict";(this.webpackChunkdefra_DefraMap=this.webpackChunkdefra_DefraMap||[]).push([[676],{621:(e,t,r)=>{function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,i)}return r}function n(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach(function(t){a(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function a(e,t,r){return(t=function(e){var t=function(e){if("object"!=i(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==i(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}r.r(t),r.d(t,{manifest:()=>k});var s={SET_DATASETS:function(e,t){return n(n({},e),{},{datasets:t.datasets})},SET_DATASET_VISIBILITY:function(e,t){var r,i=t.id,o=t.visibility;return n(n({},e),{},{datasets:null===(r=e.datasets)||void 0===r?void 0:r.map(function(e){return e.id===i?n(n({},e),{},{visibility:o}):e})})}},l=r(738),c={stroke:"#d4351c",strokeWidth:2,fill:"rgba(212 53 28, 0.5)",symbolDescription:"red outline",minZoom:6,maxZoom:24,showInKey:!1,showInLayers:!1,visibility:"visible"};function u(e){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u(e)}var d=function(e,t){if(!e)return null;if("string"==typeof e)return e.trim();if("object"===u(e)){if(t&&e[t])return e[t];var r=Object.values(e)[0];return null!=r?r:null}return null};function y(e){return y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},y(e)}function f(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,i)}return r}function p(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?f(Object(r),!0).forEach(function(t){m(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):f(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function m(e,t,r){return(t=function(e){var t=function(e){if("object"!=y(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=y(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==y(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var b=function(e,t,r){var i="".concat(r.id,"-source");e.getSource(i)||e.addSource(i,{type:"vector",tiles:r.tiles,minzoom:r.minZoom||0,maxzoom:r.maxZoom||22});var o=!!r.fill,n=!!r.stroke,a=o?r.id:null,s=n?o?"".concat(r.id,"-stroke"):r.id:null,l="hidden"===r.visibility?"none":"visible";if(o&&!e.getLayer(a)){var c=d(r.fill,t);e.addLayer(p({id:a,type:"fill",source:i,"source-layer":r.sourceLayer,layout:{visibility:l},paint:{"fill-color":c,"fill-opacity":r.opacity||1}},r.filter?{filter:r.filter}:{}))}if(n&&!e.getLayer(s)){var u=d(r.stroke,t);e.addLayer(p({id:s,type:"line",source:i,"source-layer":r.sourceLayer,layout:{visibility:l},paint:p({"line-color":u,"line-width":r.strokeWidth||1,"line-opacity":r.opacity||1},r.strokeDashArray?{"line-dasharray":r.strokeDashArray}:{})},r.filter?{filter:r.filter}:{}))}},v=function(e,t){var r=e.mapProvider,i=e.pluginState,o=r.map;o.getLayer(t)&&o.setLayoutProperty(t,"visibility","visible"),o.getLayer("".concat(t,"-stroke"))&&o.setLayoutProperty("".concat(t,"-stroke"),"visibility","visible"),i.dispatch({type:"SET_DATASET_VISIBILITY",payload:{id:t,visibility:"visible"}})},h=function(e,t){var r=e.mapProvider,i=e.pluginState,o=r.map;o.getLayer(t)&&o.setLayoutProperty(t,"visibility","none"),o.getLayer("".concat(t,"-stroke"))&&o.setLayoutProperty("".concat(t,"-stroke"),"visibility","none"),i.dispatch({type:"SET_DATASET_VISIBILITY",payload:{id:t,visibility:"hidden"}})},g=r(287),k={InitComponent:function(e){var t,r=e.pluginConfig,i=e.pluginState,o=e.appState,n=e.mapState,a=e.mapProvider,s=e.services,u=i.dispatch,d=s.events,y=s.eventBus,f=!(null===(t=a.map)||void 0===t||!t.getStyle()),p=(0,l.useRef)(i);p.current=i;var m=(0,l.useRef)(null);return(0,l.useEffect)(function(){var e,t,s,l,v=null===(e=null===(t=r.includeModes)||void 0===t?void 0:t.includes(o.mode))||void 0===e||e,h=null!==(s=null===(l=r.excludeModes)||void 0===l?void 0:l.includes(o.mode))&&void 0!==s&&s;f&&v&&!h&&(m.current||(i.datasets||u({type:"SET_DATASETS",payload:{datasets:r.datasets,datasetDefaults:c}}),m.current=function(e){var t=e.pluginConfig,r=e.pluginStateRef,i=e.mapStyleId,o=e.mapProvider,n=e.events,a=e.eventBus,s=o.map,l=t.datasets,c=function(){return r.current.datasets||l};l.forEach(function(e){b(s,i,e)});var u=function(e){var t=e.map,r=e.events,i=e.getDatasets,o=function(e){t.once("idle",function(){var r=e.id;i().forEach(function(e){b(t,r,e)})})};return e.eventBus.on(r.MAP_SET_STYLE,o),o}({map:s,events:n,eventBus:a,getDatasets:c});return{remove:function(){a.off(n.MAP_SET_STYLE,u),c().forEach(function(e){var t="".concat(e.id,"-source"),r=e.fill?e.id:null,i=e.stroke?e.fill?"".concat(e.id,"-stroke"):e.id:null;i&&s.getLayer(i)&&s.removeLayer(i),r&&s.getLayer(r)&&s.removeLayer(r),s.getSource(t)&&s.removeSource(t)})}}}({mapStyleId:n.mapStyle.id,pluginConfig:r,pluginStateRef:p,mapProvider:a,events:d,eventBus:y})))},[f,o.mode]),(0,l.useEffect)(function(){return function(){m.current&&(m.current.remove(),m.current=null)}},[]),null},reducer:{initialState:{datasets:null},actions:s},panels:[{id:"datasetsLayers",label:"Layers",mobile:{slot:"bottom",modal:!0,dismissable:!0},tablet:{slot:"inset",dismissable:!0,exclusive:!0,width:"300px"},desktop:{slot:"inset",modal:!1,dismissable:!0,exclusive:!0,width:"320px"},render:function(e){var t=e.pluginState,r=e.mapProvider,i=function(e){var i=e.target,o=i.value;i.checked?v({mapProvider:r,pluginState:t},o):h({mapProvider:r,pluginState:t},o)};return(0,g.jsx)("div",{className:"dm-c-datasets-layers",children:(0,g.jsx)("div",{className:"govuk-form-group",children:(0,g.jsxs)("fieldset",{className:"govuk-fieldset",children:[(0,g.jsx)("legend",{className:"govuk-visually-hidden",children:"Layers"}),(0,g.jsx)("div",{className:"govuk-checkboxes govuk-checkboxes--small","data-module":"govuk-checkboxes",children:t.datasets.filter(function(e){return e.showInLayers}).map(function(e){return(0,g.jsx)("div",{className:"dm-c-datasets-layers__item",children:(0,g.jsxs)("div",{className:"govuk-checkboxes__item",children:[(0,g.jsx)("input",{className:"govuk-checkboxes__input",id:e.id,name:"layers",type:"checkbox",value:e.id,checked:"hidden"!==e.visibility,onChange:i}),(0,g.jsx)("label",{className:"dm-c-datasets-layers__item-label govuk-label govuk-checkboxes__label",htmlFor:e.id,children:e.label})]})},e.id)})})]})})})}},{id:"datasetsKey",label:"Key",mobile:{slot:"bottom",modal:!0},tablet:{slot:"inset",width:"300px"},desktop:{slot:"inset",width:"320px"},render:function(e){var t=e.mapState,r=e.pluginState,i=t.mapStyle,o=function(e){return(0,g.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 20 20","aria-hidden":"true",focusable:"false",children:"line"===e.keySymbolShape?(0,g.jsx)("line",{x1:e.strokeWidth/2,y1:"10",x2:20-e.strokeWidth/2,y2:"10",stroke:d(e.stroke,i.id),strokeWidth:e.strokeWidth,strokeLinecap:"round"}):(0,g.jsx)("rect",{x:e.strokeWidth/2,y:e.strokeWidth/2,width:20-e.strokeWidth,height:20-e.strokeWidth,rx:e.strokeWidth,ry:e.strokeWidth,fill:d(e.fill,i.id),stroke:d(e.stroke,i.id),strokeWidth:e.strokeWidth,strokeLinejoin:"round"})})};return(0,g.jsx)("div",{className:"dm-c-datasets-key",children:r.datasets.filter(function(e){return e.showInKey&&"hidden"!==e.visibility}).map(function(e){return(0,g.jsx)("div",{className:"dm-c-datasets-key__item",children:(0,g.jsxs)("div",{className:"dm-c-datasets-key__item-label",children:[o(e),e.label,e.symbolDescription&&(0,g.jsxs)("span",{className:"govuk-visually-hidden",children:["(",d(e.symbolDescription,i.id),")"]})]})},e.id)})})}}],buttons:[{id:"datasetsLayers",label:"Layers",panelId:"datasetsLayers",iconId:"layers",excludeWhen:function(e){return!e.pluginConfig.datasets.find(function(e){return e.showInLayers})},mobile:{slot:"top-left",showLabel:!0},tablet:{slot:"top-left",showLabel:!0},desktop:{slot:"top-left",showLabel:!0}},{id:"datasetsKey",label:"Key",panelId:"datasetsKey",iconId:"key",excludeWhen:function(e){return!e.pluginConfig.datasets.find(function(e){return e.showInKey})},mobile:{slot:"top-left",showLabel:!0},tablet:{slot:"top-left",showLabel:!0},desktop:{slot:"top-left",showLabel:!0}}],icons:[{id:"layers",svgContent:'<path d="M13 13.74a2 2 0 0 1-2 0L2.5 8.87a1 1 0 0 1 0-1.74L11 2.26a2 2 0 0 1 2 0l8.5 4.87a1 1 0 0 1 0 1.74z"></path><path d="m20 14.285 1.5.845a1 1 0 0 1 0 1.74L13 21.74a2 2 0 0 1-2 0l-8.5-4.87a1 1 0 0 1 0-1.74l1.5-.845"></path>'},{id:"key",svgContent:'<path d="M3 5h.01"/><path d="M3 12h.01"/><path d="M3 19h.01"/><path d="M8 5h13"/><path d="M8 12h13"/><path d="M8 19h13"/>'}],api:{showLayer:v,hideLayer:h}}}}]);