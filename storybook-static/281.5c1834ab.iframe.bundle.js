"use strict";(self.webpackChunk_defra_flood_map=self.webpackChunk_defra_flood_map||[]).push([[281],{"./node_modules/@arcgis/core/views/2d/layers/CatalogDynamicGroupLayerView2D.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>c});var tslib_es6=__webpack_require__("./node_modules/@arcgis/core/chunks/tslib.es6.js"),Collection=__webpack_require__("./node_modules/@arcgis/core/core/Collection.js"),Logger=__webpack_require__("./node_modules/@arcgis/core/core/Logger.js"),subclass=(__webpack_require__("./node_modules/@arcgis/core/core/has.js"),__webpack_require__("./node_modules/@arcgis/core/core/RandomLCG.js"),__webpack_require__("./node_modules/@arcgis/core/core/Error.js"),__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/decorators/subclass.js")),LayerView2D=__webpack_require__("./node_modules/@arcgis/core/views/2d/layers/LayerView2D.js"),handleUtils=__webpack_require__("./node_modules/@arcgis/core/core/handleUtils.js"),promiseUtils=__webpack_require__("./node_modules/@arcgis/core/core/promiseUtils.js"),sql=__webpack_require__("./node_modules/@arcgis/core/core/sql.js"),property=__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/decorators/property.js");const l=Symbol(),u=u=>{let y=class extends u{constructor(){super(...arguments),this.layerViews=new Collection.A,this._debouncedUpdate=(0,promiseUtils.sg)((async()=>{const{layer:e,parent:r}=this,t=r?.footprintLayerView;let s=[];const i=this._createQuery();if(i&&t){const{features:r}=await t.queryFeatures(i);this.suspended||(s=r.map((r=>e.acquireLayer(r))))}this.removeHandles(l),this.addHandles(s,l)}))}get creatingLayerViews(){return this.view?.layerViewManager.isCreatingLayerViewsForLayer(this.layer)??!1}isUpdating(){return this.creatingLayerViews||this.layer.updating||this.layerViews.some((e=>e.updating))}enableLayerUpdates(){return(0,handleUtils.vE)([this._updatingHandles.addWhen((()=>!1===this.parent?.footprintLayerView?.dataUpdating),(()=>this.updateLayers())),this._updatingHandles.add((()=>[this.layer.maximumVisibleSublayers,this.layer.parent?.orderBy,this.parent?.footprintLayerView?.filter,this.parent?.footprintLayerView?.timeExtent,this.suspended]),(()=>this.updateLayers())),(0,handleUtils.hA)((()=>this.removeHandles(l)))])}updateLayers(){this.suspended?this.removeHandles(l):this._updatingHandles.addPromise((0,promiseUtils.QZ)(this._debouncedUpdate()).catch((e=>{Logger.A.getLogger(this).error(e)})))}_createQuery(){const e=this.parent?.footprintLayerView,r=this.layer?.parent;if(!e||!r||r.destroyed)return null;const{layer:{maximumVisibleSublayers:t},view:{scale:s}}=this;if(!t)return null;const{itemTypeField:i,itemSourceField:a,itemNameField:o,minScaleField:d,maxScaleField:p,objectIdField:l,orderBy:u}=r,y=(0,sql.mA)(`${d} IS NULL OR ${s} <= ${d} OR ${d} = 0`,`${p} IS NULL OR ${s} >= ${p}`),c=u?.find((e=>e.field&&!e.valueExpression)),m=e.createQuery();if(m.returnGeometry=!1,m.num=t,m.outFields=[l,a,o],m.where=(0,sql.mA)(m.where,y),null!=this.unsupportedItemTypes){const e=`${i} NOT IN (${this.unsupportedItemTypes.map((e=>`'${e}'`))})`;m.where=(0,sql.mA)(m.where,e)}return c?.field&&(m.orderByFields=[`${c.field} ${"descending"===c.order?"DESC":"ASC"}`],m.outFields.push(c.field)),m}};return(0,tslib_es6._)([(0,property.MZ)({readOnly:!0})],y.prototype,"creatingLayerViews",null),(0,tslib_es6._)([(0,property.MZ)()],y.prototype,"layer",void 0),(0,tslib_es6._)([(0,property.MZ)()],y.prototype,"layerViews",void 0),(0,tslib_es6._)([(0,property.MZ)({readOnly:!0})],y.prototype,"unsupportedItemTypes",void 0),(0,tslib_es6._)([(0,property.MZ)()],y.prototype,"parent",void 0),(0,tslib_es6._)([(0,property.MZ)({readOnly:!0})],y.prototype,"isUpdating",null),y=(0,tslib_es6._)([(0,subclass.$)("esri.views.layers.CatalogDynamicGroupLayerView")],y),y};var LayerView=__webpack_require__("./node_modules/@arcgis/core/views/layers/LayerView.js");let i=class extends(u((0,LayerView2D.e)(LayerView.A))){constructor(){super(...arguments),this.unsupportedItemTypes=["Scene Service"],this.layerViews=new Collection.A}attach(){this.addAttachHandles([this.layerViews.on("after-changes",(()=>this._updateStageChildren())),this.enableLayerUpdates()])}detach(){this.container.removeAllChildren()}update(e){this.updateLayers()}viewChange(){}moveEnd(){this.requestUpdate()}_updateStageChildren(){this.container.removeAllChildren(),this.layerViews.forEach(((e,r)=>this.container.addChildAt(e.container,r)))}};i=(0,tslib_es6._)([(0,subclass.$)("esri.views.2d.layers.CatalogDynamicGroupLayerView2D")],i);const c=i}}]);