"use strict";(self.webpackChunk_defra_flood_map=self.webpackChunk_defra_flood_map||[]).push([[1222],{"./node_modules/@arcgis/core/views/3d/interactive/editingTools/isSupportedObjectUtils.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{c:()=>E,d:()=>P});var P;__webpack_require__("./node_modules/@arcgis/core/core/has.js");function E(E){switch(E){case P.SUPPORTED:break;case P.GRAPHICS_LAYER_MISSING:return"not owned by a graphics layer";case P.GEOMETRY_MISSING:return"no geometry";case P.GEOMETRY_TYPE_UNSUPPORTED:return"the geometry type is not supported";case P.ELEVATION_MODE_UNSUPPORTED:return"the elevation mode is not supported";case P.SYMBOL_TYPE_UNSUPPORTED:return"the symbol type is not supported"}return""}!function(E){E[E.SUPPORTED=0]="SUPPORTED",E[E.GRAPHICS_LAYER_MISSING=1]="GRAPHICS_LAYER_MISSING",E[E.GEOMETRY_MISSING=2]="GEOMETRY_MISSING",E[E.GEOMETRY_TYPE_UNSUPPORTED=3]="GEOMETRY_TYPE_UNSUPPORTED",E[E.ELEVATION_MODE_UNSUPPORTED=4]="ELEVATION_MODE_UNSUPPORTED",E[E.SYMBOL_TYPE_UNSUPPORTED=5]="SYMBOL_TYPE_UNSUPPORTED"}(P||(P={}))},"./node_modules/@arcgis/core/views/3d/interactive/editingTools/move/isSupportedObject.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Y:()=>r});__webpack_require__("./node_modules/@arcgis/core/core/has.js");var _support_elevationInfoUtils_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@arcgis/core/support/elevationInfoUtils.js"),_isSupportedObjectUtils_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@arcgis/core/views/3d/interactive/editingTools/isSupportedObjectUtils.js");function r(r){if(r.graphic&&"graphics"!==r.graphic.layer?.type)return _isSupportedObjectUtils_js__WEBPACK_IMPORTED_MODULE_2__.d.GRAPHICS_LAYER_MISSING;const o=r.operations?.data.type;if(!o)return _isSupportedObjectUtils_js__WEBPACK_IMPORTED_MODULE_2__.d.GEOMETRY_TYPE_UNSUPPORTED;switch(o){case"polygon":case"point":case"polyline":case"mesh":break;default:return _isSupportedObjectUtils_js__WEBPACK_IMPORTED_MODULE_2__.d.GEOMETRY_TYPE_UNSUPPORTED}const i=r.elevationInfo;return(0,_support_elevationInfoUtils_js__WEBPACK_IMPORTED_MODULE_1__.wz)(i)?_isSupportedObjectUtils_js__WEBPACK_IMPORTED_MODULE_2__.d.ELEVATION_MODE_UNSUPPORTED:_isSupportedObjectUtils_js__WEBPACK_IMPORTED_MODULE_2__.d.SUPPORTED}},"./node_modules/@arcgis/core/views/3d/interactive/support/viewUtils.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{X:()=>i});var _core_screenUtils_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/@arcgis/core/core/screenUtils.js"),_chunks_vec32_js__WEBPACK_IMPORTED_MODULE_1__=(__webpack_require__("./node_modules/@arcgis/core/core/libs/gl-matrix-2/math/vec2.js"),__webpack_require__("./node_modules/@arcgis/core/chunks/vec32.js")),_core_libs_gl_matrix_2_factories_vec3f64_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@arcgis/core/core/libs/gl-matrix-2/factories/vec3f64.js"),_support_elevationInfoUtils_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@arcgis/core/support/elevationInfoUtils.js");function i(r,o,e,n,i=(0,_core_libs_gl_matrix_2_factories_vec3f64_js__WEBPACK_IMPORTED_MODULE_2__.vt)()){const p=(0,_chunks_vec32_js__WEBPACK_IMPORTED_MODULE_1__.c)(m,r);return p[2]=(0,_support_elevationInfoUtils_js__WEBPACK_IMPORTED_MODULE_3__.xS)(n,p,o,e)||0,n.renderCoordsHelper.toRenderCoords(p,o,i),i}const m=(0,_core_libs_gl_matrix_2_factories_vec3f64_js__WEBPACK_IMPORTED_MODULE_2__.vt)();(0,_core_screenUtils_js__WEBPACK_IMPORTED_MODULE_4__.QG)(),(0,_core_screenUtils_js__WEBPACK_IMPORTED_MODULE_4__.QG)()},"./node_modules/@arcgis/core/views/draw/support/layerUtils.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{function e(e,r,n){if(!r||!e?.map)return;const{map:s}=e,l=s.layers.find((e=>e===r));l||s.add(r,n),l&&null!=n&&s.layers.reorder(l,n)}function r(e,r){const n="subtype-sublayer"===r?.type?r.parent:r;return e.allLayerViews.find((e=>{const r=e.layer;return r===n||"sublayers"in r&&null!=r.sublayers&&r.sublayers.includes(n)}))}__webpack_require__.d(__webpack_exports__,{Y:()=>e,i:()=>r})},"./node_modules/@arcgis/core/views/interactive/snapping/candidates/DrapedEdgeSnappingCandidate.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{X:()=>r});var _sketch_constraints_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@arcgis/core/views/interactive/sketch/constraints.js"),_snappingUtils_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@arcgis/core/views/interactive/snapping/snappingUtils.js"),_FeatureSnappingCandidate_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@arcgis/core/views/interactive/snapping/candidates/FeatureSnappingCandidate.js"),_hints_LineSnappingHint_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@arcgis/core/views/interactive/snapping/hints/LineSnappingHint.js");class r extends _FeatureSnappingCandidate_js__WEBPACK_IMPORTED_MODULE_2__.w{constructor(n){super({...n,isDraped:!0,constraint:new _sketch_constraints_js__WEBPACK_IMPORTED_MODULE_0__.en(n.edgeStart,n.edgeEnd,n.getGroundElevation)})}get hints(){return[new _hints_LineSnappingHint_js__WEBPACK_IMPORTED_MODULE_3__.c(_snappingUtils_js__WEBPACK_IMPORTED_MODULE_1__.H3.REFERENCE,this.constraint.start,this.constraint.end,this.isDraped,this.domain)]}}},"./node_modules/@arcgis/core/views/interactive/snapping/candidates/EdgeSnappingCandidate.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{z:()=>r});var _sketch_constraints_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@arcgis/core/views/interactive/sketch/constraints.js"),_snappingUtils_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@arcgis/core/views/interactive/snapping/snappingUtils.js"),_FeatureSnappingCandidate_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@arcgis/core/views/interactive/snapping/candidates/FeatureSnappingCandidate.js"),_hints_LineSnappingHint_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@arcgis/core/views/interactive/snapping/hints/LineSnappingHint.js");class r extends _FeatureSnappingCandidate_js__WEBPACK_IMPORTED_MODULE_2__.w{constructor(n){super({...n,constraint:new _sketch_constraints_js__WEBPACK_IMPORTED_MODULE_0__.Mn(n.edgeStart,n.edgeEnd)})}get hints(){return[new _hints_LineSnappingHint_js__WEBPACK_IMPORTED_MODULE_3__.c(_snappingUtils_js__WEBPACK_IMPORTED_MODULE_1__.H3.REFERENCE,this.constraint.start,this.constraint.end,this.isDraped,this.domain)]}}},"./node_modules/@arcgis/core/views/interactive/snapping/candidates/FeatureSnappingCandidate.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{w:()=>n});var _SnappingDomain_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@arcgis/core/views/interactive/snapping/SnappingDomain.js"),_SnappingCandidate_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@arcgis/core/views/interactive/snapping/candidates/SnappingCandidate.js");class n extends _SnappingCandidate_js__WEBPACK_IMPORTED_MODULE_1__.C{constructor({targetPoint:o,objectId:n,constraint:r,isDraped:i}){super(o,r,i,_SnappingDomain_js__WEBPACK_IMPORTED_MODULE_0__.n.FEATURE),this.objectId=n}}},"./node_modules/@arcgis/core/views/interactive/snapping/candidates/IntersectionSnappingCandidate.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{N:()=>r});var _sketch_constraints_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@arcgis/core/views/interactive/sketch/constraints.js"),_SnappingDomain_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@arcgis/core/views/interactive/snapping/SnappingDomain.js"),_SnappingCandidate_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@arcgis/core/views/interactive/snapping/candidates/SnappingCandidate.js"),_hints_IntersectionSnappingHint_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@arcgis/core/views/interactive/snapping/hints/IntersectionSnappingHint.js");class r extends _SnappingCandidate_js__WEBPACK_IMPORTED_MODULE_3__.C{constructor(s,n,r,o){super(s,new _sketch_constraints_js__WEBPACK_IMPORTED_MODULE_0__.i7(s),o,_SnappingDomain_js__WEBPACK_IMPORTED_MODULE_1__.n.ALL),this.first=n,this.second=r}get hints(){return this.first.targetPoint=this.targetPoint,this.second.targetPoint=this.targetPoint,[...this.first.hints,...this.second.hints,new _hints_IntersectionSnappingHint_js__WEBPACK_IMPORTED_MODULE_2__.v(this.targetPoint,this.isDraped,this.domain)]}}},"./node_modules/@arcgis/core/views/interactive/snapping/candidates/LineSnappingCandidate.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{o:()=>r});var _sketch_constraints_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@arcgis/core/views/interactive/sketch/constraints.js"),_SnappingDomain_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@arcgis/core/views/interactive/snapping/SnappingDomain.js"),_snappingUtils_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@arcgis/core/views/interactive/snapping/snappingUtils.js"),_SnappingCandidate_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/@arcgis/core/views/interactive/snapping/candidates/SnappingCandidate.js"),_hints_LineSnappingHint_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@arcgis/core/views/interactive/snapping/hints/LineSnappingHint.js");class r extends _SnappingCandidate_js__WEBPACK_IMPORTED_MODULE_4__.C{constructor({lineStart:e,lineEnd:r,targetPoint:o,isDraped:a}){super(o,new _sketch_constraints_js__WEBPACK_IMPORTED_MODULE_0__.WG(e,r),a,_SnappingDomain_js__WEBPACK_IMPORTED_MODULE_1__.n.SELF),this._referenceLineHint=new _hints_LineSnappingHint_js__WEBPACK_IMPORTED_MODULE_3__.c(_snappingUtils_js__WEBPACK_IMPORTED_MODULE_2__.H3.REFERENCE_EXTENSION,e,r,a,this.domain)}get hints(){return[this._referenceLineHint,new _hints_LineSnappingHint_js__WEBPACK_IMPORTED_MODULE_3__.c(_snappingUtils_js__WEBPACK_IMPORTED_MODULE_2__.H3.TARGET,this._lineEndClosestToTarget(),this.targetPoint,this.isDraped,this.domain)]}_lineEndClosestToTarget(){return this.constraint.closestEndTo(this.targetPoint)}}},"./node_modules/@arcgis/core/views/interactive/snapping/candidates/ParallelLineSnappingCandidate.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{B:()=>g});var _chunks_vec32_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@arcgis/core/chunks/vec32.js"),_core_libs_gl_matrix_2_factories_vec3f64_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@arcgis/core/core/libs/gl-matrix-2/factories/vec3f64.js"),_sketch_constraints_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@arcgis/core/views/interactive/sketch/constraints.js"),_sketch_normalizedPoint_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@arcgis/core/views/interactive/sketch/normalizedPoint.js"),_SnappingDomain_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/@arcgis/core/views/interactive/snapping/SnappingDomain.js"),_snappingUtils_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/@arcgis/core/views/interactive/snapping/snappingUtils.js"),_SnappingCandidate_js__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./node_modules/@arcgis/core/views/interactive/snapping/candidates/SnappingCandidate.js"),_hints_LineSnappingHint_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./node_modules/@arcgis/core/views/interactive/snapping/hints/LineSnappingHint.js"),_hints_ParallelSnappingHint_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./node_modules/@arcgis/core/views/interactive/snapping/hints/ParallelSnappingHint.js");class g extends _SnappingCandidate_js__WEBPACK_IMPORTED_MODULE_8__.C{constructor({referenceLine:i,lineStart:f,targetPoint:o,isDraped:d}){const h=(0,_core_libs_gl_matrix_2_factories_vec3f64_js__WEBPACK_IMPORTED_MODULE_1__.o8)(f),{left:g,right:p}=i;(0,_chunks_vec32_js__WEBPACK_IMPORTED_MODULE_0__.d)(h,(0,_chunks_vec32_js__WEBPACK_IMPORTED_MODULE_0__.g)(h,h,p),g),super(o,new _sketch_constraints_js__WEBPACK_IMPORTED_MODULE_2__.WG(f,(0,_sketch_normalizedPoint_js__WEBPACK_IMPORTED_MODULE_3__._7)(h)),d,_SnappingDomain_js__WEBPACK_IMPORTED_MODULE_4__.n.SELF),this._referenceLines=[{edge:i,fadeLeft:!0,fadeRight:!0}]}get hints(){return[new _hints_LineSnappingHint_js__WEBPACK_IMPORTED_MODULE_6__.c(_snappingUtils_js__WEBPACK_IMPORTED_MODULE_5__.H3.TARGET,this.constraint.start,this.targetPoint,this.isDraped,this.domain),new _hints_ParallelSnappingHint_js__WEBPACK_IMPORTED_MODULE_7__.r(this.constraint.start,this.targetPoint,this.isDraped,this.domain),...this._referenceLines.map((e=>new _hints_LineSnappingHint_js__WEBPACK_IMPORTED_MODULE_6__.c(_snappingUtils_js__WEBPACK_IMPORTED_MODULE_5__.H3.REFERENCE,e.edge.left,e.edge.right,this.isDraped,this.domain,e.fadeLeft,e.fadeRight)))]}addReferenceLine(e){const t={edge:e,fadeLeft:!0,fadeRight:!0};this._referenceLines.forEach((r=>{(0,_chunks_vec32_js__WEBPACK_IMPORTED_MODULE_0__.p)(e.right,r.edge.left)&&(r.fadeLeft=!1,t.fadeRight=!1),(0,_chunks_vec32_js__WEBPACK_IMPORTED_MODULE_0__.p)(e.right,r.edge.right)&&(r.fadeRight=!1,t.fadeRight=!1),(0,_chunks_vec32_js__WEBPACK_IMPORTED_MODULE_0__.p)(e.left,r.edge.right)&&(r.fadeRight=!1,t.fadeLeft=!1),(0,_chunks_vec32_js__WEBPACK_IMPORTED_MODULE_0__.p)(e.left,r.edge.left)&&(r.fadeLeft=!1,t.fadeLeft=!1)})),this._referenceLines.push(t)}}},"./node_modules/@arcgis/core/views/interactive/snapping/candidates/RightAngleSnappingCandidate.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{HJ:()=>n,_b:()=>p,pn:()=>o});var o,p,t,_SnappingDomain_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@arcgis/core/views/interactive/snapping/SnappingDomain.js"),_snappingUtils_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@arcgis/core/views/interactive/snapping/snappingUtils.js"),_SnappingCandidate_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/@arcgis/core/views/interactive/snapping/candidates/SnappingCandidate.js"),_hints_LineSnappingHint_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@arcgis/core/views/interactive/snapping/hints/LineSnappingHint.js"),_hints_RightAngleSnappingHint_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@arcgis/core/views/interactive/snapping/hints/RightAngleSnappingHint.js");class n extends _SnappingCandidate_js__WEBPACK_IMPORTED_MODULE_4__.C{constructor({targetPoint:e,constraint:i,previousVertex:r,otherVertex:s,otherVertexType:n,isDraped:o,selfSnappingType:h,objectId:a,domain:x}){super(e,i,o,x??_SnappingDomain_js__WEBPACK_IMPORTED_MODULE_0__.n.SELF),this.previousVertex=r,this.otherVertex=s,this.otherVertexType=n,this.selfSnappingType=h??p.None,this.objectId=a??null}get hints(){const t=this.previousVertex,i=this.otherVertexType===o.CENTER?this.otherVertex:this.targetPoint,n=this.otherVertexType===o.CENTER?this.targetPoint:this.otherVertex;return[new _hints_LineSnappingHint_js__WEBPACK_IMPORTED_MODULE_2__.c(_snappingUtils_js__WEBPACK_IMPORTED_MODULE_1__.H3.TARGET,i,n,this.isDraped,this.domain),new _hints_LineSnappingHint_js__WEBPACK_IMPORTED_MODULE_2__.c(_snappingUtils_js__WEBPACK_IMPORTED_MODULE_1__.H3.REFERENCE,t,i,this.isDraped,this.domain),new _hints_RightAngleSnappingHint_js__WEBPACK_IMPORTED_MODULE_3__.l(this.previousVertex,i,n,this.isDraped,this.domain)]}}(t=o||(o={}))[t.NEXT=0]="NEXT",t[t.CENTER=1]="CENTER",function(t){t[t.None=0]="None",t[t.LastVertex=1]="LastVertex",t[t.FirstVertex=2]="FirstVertex",t[t.ExistingEdge=3]="ExistingEdge"}(p||(p={}))},"./node_modules/@arcgis/core/views/interactive/snapping/candidates/RightAngleTriangleSnappingCandidate.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{R:()=>g});var _core_libs_gl_matrix_2_math_vec2_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@arcgis/core/core/libs/gl-matrix-2/math/vec2.js"),_chunks_vec32_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@arcgis/core/chunks/vec32.js"),_core_libs_gl_matrix_2_factories_vec3f64_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@arcgis/core/core/libs/gl-matrix-2/factories/vec3f64.js"),_sketch_constraints_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@arcgis/core/views/interactive/sketch/constraints.js"),_sketch_normalizedPoint_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/@arcgis/core/views/interactive/sketch/normalizedPoint.js"),_SnappingDomain_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/@arcgis/core/views/interactive/snapping/SnappingDomain.js"),_snappingUtils_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./node_modules/@arcgis/core/views/interactive/snapping/snappingUtils.js"),_SnappingCandidate_js__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./node_modules/@arcgis/core/views/interactive/snapping/candidates/SnappingCandidate.js"),_hints_LineSnappingHint_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./node_modules/@arcgis/core/views/interactive/snapping/hints/LineSnappingHint.js"),_hints_RightAngleSnappingHint_js__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./node_modules/@arcgis/core/views/interactive/snapping/hints/RightAngleSnappingHint.js");class g extends _SnappingCandidate_js__WEBPACK_IMPORTED_MODULE_9__.C{constructor({targetPoint:e,point1:m,point2:a,isDraped:h}){super(e,new _sketch_constraints_js__WEBPACK_IMPORTED_MODULE_3__.ej((0,_sketch_normalizedPoint_js__WEBPACK_IMPORTED_MODULE_4__._7)((0,_chunks_vec32_js__WEBPACK_IMPORTED_MODULE_1__.m)((0,_core_libs_gl_matrix_2_factories_vec3f64_js__WEBPACK_IMPORTED_MODULE_2__.vt)(),m,a,.5)),.5*(0,_core_libs_gl_matrix_2_math_vec2_js__WEBPACK_IMPORTED_MODULE_0__.Io)((0,_sketch_normalizedPoint_js__WEBPACK_IMPORTED_MODULE_4__.Xz)(m),(0,_sketch_normalizedPoint_js__WEBPACK_IMPORTED_MODULE_4__.Xz)(a))),h,_SnappingDomain_js__WEBPACK_IMPORTED_MODULE_5__.n.SELF),this._p1=m,this._p2=a}get hints(){return[new _hints_LineSnappingHint_js__WEBPACK_IMPORTED_MODULE_7__.c(_snappingUtils_js__WEBPACK_IMPORTED_MODULE_6__.H3.REFERENCE,this.targetPoint,this._p1,this.isDraped,this.domain),new _hints_LineSnappingHint_js__WEBPACK_IMPORTED_MODULE_7__.c(_snappingUtils_js__WEBPACK_IMPORTED_MODULE_6__.H3.REFERENCE,this.targetPoint,this._p2,this.isDraped,this.domain),new _hints_RightAngleSnappingHint_js__WEBPACK_IMPORTED_MODULE_8__.l(this._p1,this.targetPoint,this._p2,this.isDraped,this.domain)]}}},"./node_modules/@arcgis/core/views/interactive/snapping/candidates/SnappingCandidate.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{C:()=>t});class t{constructor(t,s,i,o){this.targetPoint=t,this.constraint=s,this.isDraped=i,this.domain=o}}},"./node_modules/@arcgis/core/views/interactive/support/viewUtils.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{j:()=>s});var _core_screenUtils_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@arcgis/core/core/screenUtils.js"),_core_libs_gl_matrix_2_factories_vec3f64_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@arcgis/core/core/libs/gl-matrix-2/factories/vec3f64.js"),_layers_graphics_dehydratedPoint_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@arcgis/core/layers/graphics/dehydratedPoint.js"),_3d_interactive_support_viewUtils_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@arcgis/core/views/3d/interactive/support/viewUtils.js");function s(r,t,o,s){return"2d"===s.type?(c.x=r[0],c.y=r[1],c.spatialReference=t,s.toScreen(c)):((0,_3d_interactive_support_viewUtils_js__WEBPACK_IMPORTED_MODULE_1__.X)(r,t,o,s,a),s.state.camera.projectToScreen(a,n),(0,_core_screenUtils_js__WEBPACK_IMPORTED_MODULE_2__.tc)(n[0],n[1]))}const c=(0,_layers_graphics_dehydratedPoint_js__WEBPACK_IMPORTED_MODULE_3__.T)(0,0,0,null),a=(0,_core_libs_gl_matrix_2_factories_vec3f64_js__WEBPACK_IMPORTED_MODULE_0__.vt)(),n=(0,_core_screenUtils_js__WEBPACK_IMPORTED_MODULE_2__.gs)()},"./node_modules/@arcgis/core/widgets/Sketch/SketchViewModel.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>ye});var tslib_es6=__webpack_require__("./node_modules/@arcgis/core/chunks/tslib.es6.js"),Collection=__webpack_require__("./node_modules/@arcgis/core/core/Collection.js"),Error=__webpack_require__("./node_modules/@arcgis/core/core/Error.js"),Evented=__webpack_require__("./node_modules/@arcgis/core/core/Evented.js"),handleUtils=__webpack_require__("./node_modules/@arcgis/core/core/handleUtils.js"),Logger=(__webpack_require__("./node_modules/@arcgis/core/core/has.js"),__webpack_require__("./node_modules/@arcgis/core/core/Logger.js")),maybe=__webpack_require__("./node_modules/@arcgis/core/core/maybe.js"),promiseUtils=__webpack_require__("./node_modules/@arcgis/core/core/promiseUtils.js"),reactiveUtils=__webpack_require__("./node_modules/@arcgis/core/core/reactiveUtils.js"),property=__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/decorators/property.js"),subclass=(__webpack_require__("./node_modules/@arcgis/core/core/RandomLCG.js"),__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/decorators/subclass.js")),UpdatingHandles=__webpack_require__("./node_modules/@arcgis/core/core/support/UpdatingHandles.js"),ellipsoidUtils=__webpack_require__("./node_modules/@arcgis/core/geometry/ellipsoidUtils.js"),projection=__webpack_require__("./node_modules/@arcgis/core/geometry/projection.js"),coordsUtils=__webpack_require__("./node_modules/@arcgis/core/geometry/support/coordsUtils.js"),spatialReferenceUtils=__webpack_require__("./node_modules/@arcgis/core/geometry/support/spatialReferenceUtils.js"),GraphicsLayer=__webpack_require__("./node_modules/@arcgis/core/layers/GraphicsLayer.js"),layerUtils=__webpack_require__("./node_modules/@arcgis/core/layers/support/layerUtils.js"),FillSymbol3DLayer=__webpack_require__("./node_modules/@arcgis/core/symbols/FillSymbol3DLayer.js"),MeshSymbol3D=__webpack_require__("./node_modules/@arcgis/core/symbols/MeshSymbol3D.js"),SimpleFillSymbol=__webpack_require__("./node_modules/@arcgis/core/symbols/SimpleFillSymbol.js"),SimpleLineSymbol=__webpack_require__("./node_modules/@arcgis/core/symbols/SimpleLineSymbol.js"),SimpleMarkerSymbol=__webpack_require__("./node_modules/@arcgis/core/symbols/SimpleMarkerSymbol.js"),typeUtils=__webpack_require__("./node_modules/@arcgis/core/symbols/support/typeUtils.js"),isSupportedObjectUtils=__webpack_require__("./node_modules/@arcgis/core/views/3d/interactive/editingTools/isSupportedObjectUtils.js"),isSupportedObject=__webpack_require__("./node_modules/@arcgis/core/views/3d/interactive/editingTools/move/isSupportedObject.js"),elevationInfoUtils=__webpack_require__("./node_modules/@arcgis/core/support/elevationInfoUtils.js");function isSupportedObject_e(t){return function o(e){if(e.graphic&&"graphics"!==e.graphic.layer?.type)return{result:isSupportedObjectUtils.d.GRAPHICS_LAYER_MISSING};if(!e.operations)return{result:isSupportedObjectUtils.d.GEOMETRY_MISSING};if((0,elevationInfoUtils.wz)(e.elevationInfo))return{result:isSupportedObjectUtils.d.ELEVATION_MODE_UNSUPPORTED};const o=e.operations.data.type,i=e.operations.data.geometry;return"point"===o||"mesh"===o||"polyline"===o||"polygon"===o?{result:isSupportedObjectUtils.d.SUPPORTED,geometry:i}:{result:isSupportedObjectUtils.d.GEOMETRY_TYPE_UNSUPPORTED}}(t).result}var support_layerUtils=__webpack_require__("./node_modules/@arcgis/core/views/draw/support/layerUtils.js"),InputManager=__webpack_require__("./node_modules/@arcgis/core/views/input/InputManager.js"),keybindings=__webpack_require__("./node_modules/@arcgis/core/views/interactive/keybindings.js"),SketchLabelOptions=__webpack_require__("./node_modules/@arcgis/core/views/interactive/sketch/SketchLabelOptions.js"),SketchOptions=__webpack_require__("./node_modules/@arcgis/core/views/interactive/sketch/SketchOptions.js"),SketchTooltipOptions=__webpack_require__("./node_modules/@arcgis/core/views/interactive/sketch/SketchTooltipOptions.js"),SketchValueOptions=__webpack_require__("./node_modules/@arcgis/core/views/interactive/sketch/SketchValueOptions.js"),Accessor=__webpack_require__("./node_modules/@arcgis/core/core/Accessor.js"),asyncUtils=__webpack_require__("./node_modules/@arcgis/core/core/asyncUtils.js"),normalizedPoint=__webpack_require__("./node_modules/@arcgis/core/views/interactive/sketch/normalizedPoint.js"),Settings=__webpack_require__("./node_modules/@arcgis/core/views/interactive/snapping/Settings.js"),SnappingDomain=__webpack_require__("./node_modules/@arcgis/core/views/interactive/snapping/SnappingDomain.js"),arrayUtils=__webpack_require__("./node_modules/@arcgis/core/core/arrayUtils.js");let i=class extends Accessor.A{constructor(o){super(o),this.layer=null,this.enabled=!0,this.updating=!1,this.availability=1,this.sublayerSources=new Collection.A}};(0,tslib_es6._)([(0,property.MZ)({constructOnly:!0})],i.prototype,"layer",void 0),(0,tslib_es6._)([(0,property.MZ)()],i.prototype,"enabled",void 0),(0,tslib_es6._)([(0,property.MZ)()],i.prototype,"updating",void 0),(0,tslib_es6._)([(0,property.MZ)()],i.prototype,"availability",void 0),(0,tslib_es6._)([(0,property.MZ)()],i.prototype,"sublayerSources",void 0),i=(0,tslib_es6._)([(0,subclass.$)("esri.views.interactive.snapping.FeatureSnappingLayerSource")],i);const p=i;let u=class extends Accessor.A{constructor(e){super(e),this.enabled=!1,this.enabledToggled=!1,this.forceDisabled=!1,this.selfEnabled=!0,this.featureEnabled=!0,this.gridEnabled=!1,this.attributeRulesEnabled=!1,this.featureSources=new Collection.A,this.distance=Settings.N.distance,this.touchSensitivityMultiplier=Settings.N.touchSensitivityMultiplier}get effectiveEnabled(){return!this.forceDisabled&&(this.enabledToggled?!this.enabled:this.enabled)}get effectiveGridEnabled(){return this.effectiveEnabled&&this.gridEnabled}get effectiveSelfEnabled(){return this.effectiveEnabled&&this.selfEnabled}get effectiveFeatureEnabled(){return this.effectiveEnabled&&this.featureEnabled}get _effectiveFeatureSources(){const e=this.featureSources;e.some(SnappingOptions_p)&&Logger.A.getLogger(this).warnOnce("Do not configure SubtypeGroupLayer sources in SnappingOptions.featureSources directly. Create a FeatureSnappingLayerSource for each SubtypeSublayer.");const t=e.filter(f),s=this._get("_effectiveFeatureSources")?.filter(SnappingOptions_p)??new Collection.A;for(const r of t){const e=s.find((e=>e.layer===r.layer.parent));if(e)e.sublayerSources.includes(r)||e.sublayerSources.add(r);else if(r.layer.parent){const e=new p({layer:r.layer.parent});e.sublayerSources.add(r),s.add(e)}}for(const r of s){const e=r.sublayerSources.filter((e=>!t.includes(e)));r.sublayerSources.removeMany(e)}s.removeMany(s.filter((e=>0===e.sublayerSources.length)));const a=e.filter(d),l=this._get("_effectiveFeatureSources")??new Collection.A,{added:u,removed:c}=(0,arrayUtils.iv)(l.toArray(),[...a,...s]);return l.removeMany(c),l.addMany(u),l}};(0,tslib_es6._)([(0,property.MZ)()],u.prototype,"enabled",void 0),(0,tslib_es6._)([(0,property.MZ)()],u.prototype,"enabledToggled",void 0),(0,tslib_es6._)([(0,property.MZ)()],u.prototype,"forceDisabled",void 0),(0,tslib_es6._)([(0,property.MZ)()],u.prototype,"selfEnabled",void 0),(0,tslib_es6._)([(0,property.MZ)()],u.prototype,"featureEnabled",void 0),(0,tslib_es6._)([(0,property.MZ)()],u.prototype,"gridEnabled",void 0),(0,tslib_es6._)([(0,property.MZ)()],u.prototype,"attributeRulesEnabled",void 0),(0,tslib_es6._)([(0,property.MZ)({type:Collection.A.ofType(p)})],u.prototype,"featureSources",void 0),(0,tslib_es6._)([(0,property.MZ)()],u.prototype,"distance",void 0),(0,tslib_es6._)([(0,property.MZ)()],u.prototype,"touchSensitivityMultiplier",void 0),(0,tslib_es6._)([(0,property.MZ)({readOnly:!0})],u.prototype,"effectiveEnabled",null),(0,tslib_es6._)([(0,property.MZ)({readOnly:!0})],u.prototype,"effectiveGridEnabled",null),(0,tslib_es6._)([(0,property.MZ)({readOnly:!0})],u.prototype,"effectiveSelfEnabled",null),(0,tslib_es6._)([(0,property.MZ)({readOnly:!0})],u.prototype,"effectiveFeatureEnabled",null),(0,tslib_es6._)([(0,property.MZ)({readOnly:!0})],u.prototype,"_effectiveFeatureSources",null),u=(0,tslib_es6._)([(0,subclass.$)("esri.views.interactive.snapping.SnappingOptions")],u);const c=u;function SnappingOptions_p(e){return"subtype-group"===e.layer.type}function d(e){return"subtype-group"!==e.layer.type}function f(e){return"subtype-sublayer"===e.layer.type}var snappingUtils=__webpack_require__("./node_modules/@arcgis/core/views/interactive/snapping/snappingUtils.js"),DrapedEdgeSnappingCandidate=__webpack_require__("./node_modules/@arcgis/core/views/interactive/snapping/candidates/DrapedEdgeSnappingCandidate.js"),EdgeSnappingCandidate=__webpack_require__("./node_modules/@arcgis/core/views/interactive/snapping/candidates/EdgeSnappingCandidate.js"),IntersectionSnappingCandidate=__webpack_require__("./node_modules/@arcgis/core/views/interactive/snapping/candidates/IntersectionSnappingCandidate.js"),LineSnappingCandidate=__webpack_require__("./node_modules/@arcgis/core/views/interactive/snapping/candidates/LineSnappingCandidate.js"),ParallelLineSnappingCandidate=__webpack_require__("./node_modules/@arcgis/core/views/interactive/snapping/candidates/ParallelLineSnappingCandidate.js"),RightAngleSnappingCandidate=__webpack_require__("./node_modules/@arcgis/core/views/interactive/snapping/candidates/RightAngleSnappingCandidate.js"),RightAngleTriangleSnappingCandidate=__webpack_require__("./node_modules/@arcgis/core/views/interactive/snapping/candidates/RightAngleTriangleSnappingCandidate.js"),viewUtils=__webpack_require__("./node_modules/@arcgis/core/views/interactive/support/viewUtils.js");let I=class extends(Evented.A.EventedMixin(Accessor.A)){constructor(e){super(e),this.options=new c,this._engineCache=new Map,this._loadTask=null,this._engines=[],this._currentMainCandidate=null,this._currentOtherActiveCandidates=[],this._currentSnappedType=x.MAIN}initialize(){this.addHandles([(0,reactiveUtils.watch)((()=>{const{distance:e,touchSensitivityMultiplier:t,effectiveSelfEnabled:n,effectiveFeatureEnabled:i,effectiveGridEnabled:s}=this.options;return{selfEnabled:n,featureEnabled:i,gridEnabled:"2d"===this.view.type&&s,viewReady:this.view.ready,viewSpatialReference:this.view.spatialReference,distance:e,touchSensitivityMultiplier:t}}),((e,t)=>{t&&(this.doneSnapping(),this.emit("changed")),this._loadTask?.abort(),this._loadTask=(0,asyncUtils.UT)((n=>this._updateEngines(e,t,n)))}),reactiveUtils.pc),(0,reactiveUtils.watch)((()=>this.options),(e=>{for(const t of this._engines)t.options=e}),reactiveUtils.OH)])}destroy(){this._loadTask?.abort(),this._destroyEngines()}get updating(){return this._engines.some((e=>e.updating))||!this._loadTask?.finished}_destroyEngines(){this._engineCache.forEach((e=>e.destroy())),this._engineCache.clear(),this._engines=[]}async _updateEngines(e,t,n){if(!e.viewReady)return void this._destroyEngines();t?.viewSpatialReference!==e.viewSpatialReference&&this._destroyEngines();const i=this._engineCache,s=await Promise.allSettled([e.featureEnabled&&!i.has("feature")?this._createFeatureSnappingEngine(n):void 0,e.selfEnabled&&!i.has("self")?this._createSelfSnappingEngine(n):void 0,e.gridEnabled&&!i.has("grid")?this._createGridSnappingEngine(n):void 0]);if(n.aborted)for(const a of s)"fulfilled"===a.status&&a.value?.engine.destroy();else{for(const e of s)"fulfilled"===e.status&&e.value&&i.set(e.value.type,e.value.engine);this._engines=Array.from(i.values())}}async _createSelfSnappingEngine(e){const{SelfSnappingEngine:t}=await Promise.all([__webpack_require__.e(3048),__webpack_require__.e(2962)]).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@arcgis/core/views/interactive/snapping/SelfSnappingEngine.js"));return(0,promiseUtils.Te)(e),{type:"self",engine:new t({view:this.view,options:this.options})}}async _createGridSnappingEngine(e){const{view:t}=this;if("2d"!==t.type)return;const{GridSnappingEngine:n}=await __webpack_require__.e(517).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@arcgis/core/views/interactive/snapping/GridSnappingEngine.js"));return(0,promiseUtils.Te)(e),{type:"grid",engine:new n({view:t,options:this.options})}}async _createFeatureSnappingEngine(e){const{FeatureSnappingEngine:t}=await __webpack_require__.e(1622).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@arcgis/core/views/interactive/snapping/FeatureSnappingEngine.js"));(0,promiseUtils.Te)(e);const{view:n,options:i}=this,{spatialReference:a}=n;return{type:"feature",engine:new t({view:n,options:i,spatialReference:a})}}get _squaredMouseProximityThreshold(){return this.options.distance*this.options.distance}get _squaredTouchProximityThreshold(){const{distance:e,touchSensitivityMultiplier:t}=this.options,n=e*t;return n*n}snap(e){return function H(e){return null!=e.scenePoint}(e)?this._snapMultiPoint(e):this._snapSinglePoint(e)}update(e){const{point:t,context:n}=e;this._removeVisualization();const i=this._currentMainCandidate;if(null==i)return t;const s=this._selectUpdateInput(e);if(null==s)return t;const{spatialReference:a}=n,r=(0,projection.project)(s,a);if(null==r)return t;const{view:o}=this,{elevationInfo:p,visualizer:d}=n,c=[],l=(0,normalizedPoint.vf)(r,o,p),u=i.constraint.closestTo(l);if(!this._arePointsWithinScreenThreshold(l,u,n)||!N(i,n.drawConstraints))return this._resetSnappingState(),t;i.targetPoint=(0,normalizedPoint.de)(u),c.push(...i.hints);for(const h of this._currentOtherActiveCandidates)N(h,n.drawConstraints)&&(h.targetPoint=(0,normalizedPoint.de)(u),c.push(...h.hints));return null!=d&&this.addHandles(d.draw(c,{spatialReference:a,elevationInfo:L(n),view:o,selfSnappingZ:n.selfSnappingZ}),b),(0,normalizedPoint.xF)(u,o,t,n)}doneSnapping(){this._removeVisualization(),this._resetSnappingState()}_selectUpdateInput({point:e,scenePoint:t}){switch(this._currentSnappedType){case x.MAIN:return e;case x.SCENE:return t}}_resetSnappingState(){this._currentMainCandidate=null,this._currentOtherActiveCandidates=[],this._currentSnappedType=x.MAIN}_removeVisualization(){this.removeHandles(b)}async _snapSinglePoint({point:e,context:t,signal:n}){const{view:i}=this,{elevationInfo:s}=t,a=(0,normalizedPoint.vf)(e,i,s),r=await this._fetchCandidates(a,SnappingDomain.n.ALL,t,n);return this._createSnapResult(a,x.MAIN,r,i,e,t,n)}async _snapMultiPoint({point:e,scenePoint:t,context:n,signal:i}){const{view:s}=this,{coordinateHelper:a,elevationInfo:r,spatialReference:o}=n;await(0,projection.initializeProjection)(t.spatialReference,o);const p=(0,projection.project)(t,o),d=(0,normalizedPoint.vf)(p,s,r),c=await this._fetchCandidates(d,SnappingDomain.n.FEATURE,n,i);if(c.length>0){const e=await this._fetchCandidates(d,SnappingDomain.n.SELF,n,i);return this._createSnapResult(d,x.SCENE,[...c,...e],s,p,n,i)}const u=(0,normalizedPoint.vf)(e,s,r),g=await this._fetchCandidates(u,SnappingDomain.n.SELF,n,i);return this._createSnapResult(u,x.MAIN,g,s,{z:a.hasZ()&&e.hasZ?e.z??0:void 0,m:a.hasM()&&e.hasM?e.m??0:void 0},n,i)}async _fetchCandidates(e,t,n,i){return(await Promise.all(this._engines.map((s=>s.fetchCandidates(e,t,n,i))))).flat()}_createSnapResult(e,t,n,i,s,r,o){return{get valid(){return!(0,promiseUtils.G4)(o)},apply:()=>{const{spatialReference:a}=r,{snappedPoint:o,hints:p}=this._processCandidates(e,t,n,r);return this._removeVisualization(),null!=r.visualizer&&this.addHandles(r.visualizer.draw(p,{spatialReference:a,elevationInfo:elevationInfoUtils.qt,view:i,selfSnappingZ:r.selfSnappingZ}),b),(0,normalizedPoint.xF)(o,i,s,r)}}}_processCandidates(e,t,n,i){if(n.length<1)return this.doneSnapping(),{snappedPoint:e,hints:[]};this._currentSnappedType!==t&&this._resetSnappingState(),(0,snappingUtils.xX)(e,n);const s=this._currentMainCandidate;if(null!=s){const a=function O(e,t){return e instanceof IntersectionSnappingCandidate.N?k(t,e.first)>=0&&k(t,e.second)>=0?0:-1:k(t,e)}(s,n);if(a>=0){if(!(n[a]instanceof IntersectionSnappingCandidate.N))return this._intersectWithOtherCandidates(a,n,e,t,i);if(this._arePointsWithinScreenThreshold(e,s.targetPoint,i))return this._updateSnappingCandidate(s,t,n,i)}}return this._intersectWithOtherCandidates(0,n,e,t,i)}_intersectWithOtherCandidates(e,t,n,i,s){const{coordinateHelper:a}=s,r=t[e],o=[];for(let p=0;p<t.length;++p){if(p===e)continue;const i=t[p],s=r.constraint.intersect(i.constraint);if(s)for(const e of s.closestPoints(r.targetPoint))o.push([new IntersectionSnappingCandidate.N((0,normalizedPoint.de)(e),r,i,i.isDraped),this._squaredScreenDistance(n,e,a)])}return o.length>0&&(o.sort(((e,t)=>e[1]-t[1])),o[0][1]<this._squaredPointProximityThreshold(s.pointer))?this._updateSnappingCandidate(o[0][0],i,t,s):N(r,s.drawConstraints)?this._updateSnappingCandidate(r,i,t,s):{snappedPoint:n,hints:[]}}_updateSnappingCandidate(e,t,n,i){this.doneSnapping(),this._currentMainCandidate=e,this._currentSnappedType=t;const s=this._currentMainCandidate.targetPoint,a=[];a.push(...e.hints);for(const r of n){if(e instanceof IntersectionSnappingCandidate.N){if(r.constraint.equals(e.first.constraint)||r.constraint.equals(e.second.constraint))continue}else if(r.constraint.equals(e.constraint))continue;const t=r.constraint.closestTo(s);this._squaredScreenDistance(t,s,i.coordinateHelper)<Settings.N.satisfiesConstraintScreenThreshold*Settings.N.satisfiesConstraintScreenThreshold&&(r.targetPoint=s,this._currentOtherActiveCandidates.push(r),a.push(...r.hints))}return{snappedPoint:s,hints:a}}_squaredPointProximityThreshold(e){return"touch"===e?this._squaredTouchProximityThreshold:this._squaredMouseProximityThreshold}_arePointsWithinScreenThreshold(e,t,n){return this._squaredScreenDistance(e,t,n.coordinateHelper)<this._squaredPointProximityThreshold(n.pointer)}_squaredScreenDistance(e,t,n){return(0,snappingUtils.pM)(this._toScreen(e,n),this._toScreen(t,n))}_toScreen(e,t){return(0,viewUtils.j)(e,t.spatialReference,elevationInfoUtils.qt,this.view)}get test(){}};var x;(0,tslib_es6._)([(0,property.MZ)({constructOnly:!0})],I.prototype,"view",void 0),(0,tslib_es6._)([(0,property.MZ)()],I.prototype,"options",void 0),(0,tslib_es6._)([(0,property.MZ)({readOnly:!0})],I.prototype,"updating",null),(0,tslib_es6._)([(0,property.MZ)()],I.prototype,"_loadTask",void 0),(0,tslib_es6._)([(0,property.MZ)()],I.prototype,"_engines",void 0),(0,tslib_es6._)([(0,property.MZ)()],I.prototype,"_squaredMouseProximityThreshold",null),(0,tslib_es6._)([(0,property.MZ)()],I.prototype,"_squaredTouchProximityThreshold",null),I=(0,tslib_es6._)([(0,subclass.$)("esri.views.interactive.snapping.SnappingManager")],I),function(e){e[e.MAIN=0]="MAIN",e[e.SCENE=1]="SCENE"}(x||(x={}));const b="visualization-handle";function N(e,t){return!t||null==t.direction&&null==t.distance||!(e instanceof DrapedEdgeSnappingCandidate.X||e instanceof EdgeSnappingCandidate.z||e instanceof LineSnappingCandidate.o||e instanceof ParallelLineSnappingCandidate.B||e instanceof RightAngleTriangleSnappingCandidate.R)&&(!(e instanceof RightAngleSnappingCandidate.HJ)||null==t.direction&&e.selfSnappingType===RightAngleSnappingCandidate._b.LastVertex)}function k(e,t){let n=-1;for(let i=0;i<e.length;++i)if(t.constraint.equals(e[i].constraint)){n=i;break}return n}function L({coordinateHelper:e,elevationInfo:t}){return e.hasZ()?elevationInfoUtils.qt:t}var hitTestSelectUtils=__webpack_require__("./node_modules/@arcgis/core/views/support/hitTestSelectUtils.js"),screenUtils=__webpack_require__("./node_modules/@arcgis/core/views/support/screenUtils.js"),compilerUtils=__webpack_require__("./node_modules/@arcgis/core/core/compilerUtils.js");let n=class extends Evented.A.EventedAccessor{constructor(e){super(e),this.cancelled=!1,this.history={undo:[],redo:[]},this.type=null}get tool(){if(!this.activeComponent)return null;switch(this.activeComponent.type){case"graphic-mover":case"move-3d":return"move";case"box":case"transform-3d":return"transform";case"reshape":case"reshape-3d":return"reshape";case"draw-2d":case"draw-3d":return this.activeComponent.geometryType;default:(0,compilerUtils.Xb)(this.activeComponent)}return null}addToHistory(e){this.history.redo=[],this.history.undo.push(e)}resetHistory(){this.history.redo=[],this.history.undo=[]}canUndo(){return this.history.undo.length>0}canRedo(){return this.history.redo.length>0}complete(){this._reset(),this.onEnd(),this.emit("complete")}cancel(){this.cancelled=!0,this.complete()}_reset(){this.activeComponent?.reset()}refreshComponent(){const e=this.activeComponent;e&&("box"!==e.type&&"reshape"!==e.type&&"graphic-mover"!==e.type||e.refresh())}set undo(e){this._set("undo",(()=>{this.canUndo()&&e()}))}set redo(e){this._set("redo",(()=>{this.canRedo()&&e()}))}};(0,tslib_es6._)([(0,property.MZ)()],n.prototype,"activeComponent",void 0),(0,tslib_es6._)([(0,property.MZ)()],n.prototype,"cancelled",void 0),(0,tslib_es6._)([(0,property.MZ)()],n.prototype,"history",void 0),(0,tslib_es6._)([(0,property.MZ)()],n.prototype,"tool",null),(0,tslib_es6._)([(0,property.MZ)()],n.prototype,"type",void 0),(0,tslib_es6._)([(0,property.MZ)()],n.prototype,"canUndo",null),(0,tslib_es6._)([(0,property.MZ)()],n.prototype,"canRedo",null),(0,tslib_es6._)([(0,property.MZ)()],n.prototype,"onEnd",void 0),(0,tslib_es6._)([(0,property.MZ)()],n.prototype,"undo",null),(0,tslib_es6._)([(0,property.MZ)()],n.prototype,"redo",null),(0,tslib_es6._)([(0,property.MZ)()],n.prototype,"toggleTool",void 0),(0,tslib_es6._)([(0,property.MZ)()],n.prototype,"addToSelection",void 0),(0,tslib_es6._)([(0,property.MZ)()],n.prototype,"removeFromSelection",void 0),n=(0,tslib_es6._)([(0,subclass.$)("esri.widgets.Sketch.support.OperationHandle")],n);let OperationHandle_p=class extends n{};(0,tslib_es6._)([(0,property.MZ)()],OperationHandle_p.prototype,"activeComponent",void 0),OperationHandle_p=(0,tslib_es6._)([(0,subclass.$)("esri.widgets.Sketch.support.OperationHandle.CreateOperationHandle")],OperationHandle_p);let OperationHandle_i=class extends n{};var sketchUtils_o;(0,tslib_es6._)([(0,property.MZ)()],OperationHandle_i.prototype,"activeComponent",void 0),OperationHandle_i=(0,tslib_es6._)([(0,subclass.$)("esri.widgets.Sketch.support.OperationHandle.UpdateOperationHandle")],OperationHandle_i),function(e){e[e.ForceCollapse=-1]="ForceCollapse",e[e.Low=0]="Low",e[e.Medium=10]="Medium",e[e.High=100]="High",e[e.Max=1e3]="Max"}(sketchUtils_o||(sketchUtils_o={}));const te={defaultZ:0},oe={reshapeOptions:{edgeOperation:"split",shapeOperation:"move",vertexOperation:"move"},enableMoveAllGraphics:!0,enableRotation:!0,enableScaling:!0,multipleSelectionEnabled:!0,preserveAspectRatio:!1,toggleToolOnClick:!0,enableZ:!0,highlightOptions:{enabled:!0},tool:"transform"};let ie=class extends Evented.A.EventedAccessor{constructor(e){super(e),this._defaultSnappingManager=null,this._updatingHandles=new UpdatingHandles.U,this._internalGraphicsLayer=new GraphicsLayer.default({listMode:"hide",internal:!0,title:"SVM Internal"}),this._operationHandle=null,this._viewHandlesKey="viewHandles",this.activeFillSymbol=null,this.activeLineSymbol=null,this.activeVertexSymbol=null,this.allowDeleteKey=!0,this.layer=null,this.pointSymbol=new SimpleMarkerSymbol.A({style:"circle",size:6,color:[255,255,255],outline:{color:[50,50,50],width:1}}),this.polygonSymbol=new SimpleFillSymbol.A({color:[150,150,150,.2],outline:{color:[50,50,50],width:2}}),this.polylineSymbol=new SimpleLineSymbol.A({color:[130,130,130,1],width:2}),this.meshSymbol=new MeshSymbol3D.A({symbolLayers:new Collection.A([new FillSymbol3DLayer.A])}),this.updateGraphics=new Collection.A,this.updateOnGraphicClick=!0,this.creationMode="single",this.vertexSymbol=new SimpleMarkerSymbol.A({style:"circle",size:6,color:[255,255,255],outline:{color:[50,50,50],width:1}}),this.sketchOptions=new SketchOptions.A,this._moduleLoaderAbortController=null,this._viewReadyAbortController=null,this._sketchContinuationFlag=!1,this._originalPopupEnabled=null,this.defaultCreateOptions=te,this.defaultUpdateOptions=oe,this.snappingOptions=e?.snappingManager?.options??e?.snappingOptions??new c}initialize(){this.addHandles([(0,reactiveUtils.on)((()=>this.view?.map?.layers),"change",(e=>{e.removed.includes(this.layer)&&this.cancel()})),(0,reactiveUtils.on)((()=>this.layer?.graphics),"change",(e=>{if(null!=this._operationHandle)for(const t of e.removed)this.updateGraphics.includes(t)&&(this.updateGraphics.length>1?this._operationHandle.removeFromSelection(t):this._operationHandle.cancel())})),(0,reactiveUtils.watch)((()=>this.layer?.elevationInfo??null),(e=>{e!==this._internalGraphicsLayer.elevationInfo&&(this.cancel(),this._internalGraphicsLayer.elevationInfo=e)}),reactiveUtils.pc),(0,reactiveUtils.watch)((()=>this.view),(e=>{this._defaultSnappingManager=(0,maybe.pR)(this._defaultSnappingManager),e&&(this.snappingManager||(this._defaultSnappingManager=new I({view:e,options:this.snappingOptions})),"2d"===e.type?Promise.all([__webpack_require__.e(5751),__webpack_require__.e(3048),__webpack_require__.e(4480),__webpack_require__.e(1860),__webpack_require__.e(8964),__webpack_require__.e(2109),__webpack_require__.e(3820),__webpack_require__.e(5386),__webpack_require__.e(9486)]).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@arcgis/core/views/2d/interactive/editingTools.js")):"3d"===e.type&&(Promise.all([__webpack_require__.e(5751),__webpack_require__.e(3048),__webpack_require__.e(666),__webpack_require__.e(1315),__webpack_require__.e(4480),__webpack_require__.e(1860),__webpack_require__.e(2248),__webpack_require__.e(2394),__webpack_require__.e(8964),__webpack_require__.e(2109),__webpack_require__.e(4916),__webpack_require__.e(9790),__webpack_require__.e(3820),__webpack_require__.e(8186),__webpack_require__.e(8297),__webpack_require__.e(4993)]).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@arcgis/core/views/3d/interactive/editingTools.js")),Promise.all([__webpack_require__.e(563),__webpack_require__.e(666),__webpack_require__.e(1315),__webpack_require__.e(2248),__webpack_require__.e(2394),__webpack_require__.e(2954),__webpack_require__.e(4916),__webpack_require__.e(8297),__webpack_require__.e(8865),__webpack_require__.e(1866),__webpack_require__.e(2480)]).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@arcgis/core/views/3d/layers/GraphicsLayerView3D.js"))))}),reactiveUtils.pc),(0,reactiveUtils.watch)((()=>this.view?.spatialReference),((e,t)=>{e&&t&&!e.equals(t)&&this.cancel()}))]),(0,snappingUtils.BY)(this)}destroy(){this.cancel(),this._removeDefaultLayer(),this._defaultSnappingManager=(0,maybe.pR)(this._defaultSnappingManager),this._set("snappingManager",null),this._set("view",null),this._updatingHandles.destroy(),this.emit("destroy")}get updating(){return this._updatingHandles.updating||null!=this.snappingManager&&this.snappingManager.updating}get activeTool(){return this._operationHandle?.tool??null}get activeCreateToolDrawMode(){return"create"===this._operationHandle?.type&&this._operationHandle.activeComponent&&"mode"in this._operationHandle.activeComponent?this._operationHandle.activeComponent.mode:null}get activeTooltip(){const{activeComponent:e,destroyed:t}=this,o=!t&&e&&"tooltip"in e?e.tooltip:null;return o?.visible?o:null}get activeComponent(){return this._operationHandle?.activeComponent??null}get createGraphic(){return null==this.activeComponent||"draw-3d"!==this.activeComponent.type&&"draw-2d"!==this.activeComponent.type?this._get("createGraphic"):this.activeComponent.graphic}get defaultCreateOptions(){return this._get("defaultCreateOptions")}set defaultCreateOptions(e){this._set("defaultCreateOptions",{...te,...e})}get defaultUpdateOptions(){return this._get("defaultUpdateOptions")}set defaultUpdateOptions(e){this._set("defaultUpdateOptions",{...oe,...e,reshapeOptions:{...oe.reshapeOptions,...e?.reshapeOptions},highlightOptions:{...oe.highlightOptions,...e?.highlightOptions}})}get labelOptions(){return this.sketchOptions.labels}set labelOptions(e){this.sketchOptions.labels=e}get snappingOptions(){return this.snappingManager?.options??this._get("snappingOptions")}set snappingOptions(e){null!=this._defaultSnappingManager&&(this._defaultSnappingManager.options=e),this._set("snappingOptions",e)}get snappingManager(){return this._isOverridden("snappingManager")&&this._get("snappingManager"),this._defaultSnappingManager}set snappingManager(e){if(e)this._isOverridden("snappingManager")||(this._defaultSnappingManager=(0,maybe.pR)(this._defaultSnappingManager)),this._override("snappingManager",e);else{const{view:e}=this;!this._defaultSnappingManager&&e&&(this._defaultSnappingManager=new I({options:this.snappingOptions,view:e})),this._clearOverride("snappingManager")}}get state(){const e=!(!this.view?.ready||!this.layer),t=this._operationHandle;return e&&t?"active":e?"ready":"disabled"}get tooltipOptions(){return this.sketchOptions.tooltips}set tooltipOptions(e){this.sketchOptions.tooltips=e}get valueOptions(){return this.sketchOptions.values}set valueOptions(e){this.sketchOptions.values=e}get view(){return this._get("view")}set view(e){const t=this._get("view");if(t){const{container:e,map:o}=t;e&&(t.cursor=null),o?.remove(this._internalGraphicsLayer),this.removeHandles(this._viewHandlesKey),this.cancel()}const o="view-ready";this.removeHandles(o),e&&this.addHandles((0,reactiveUtils.when)((()=>e.ready),(t=>{this.removeHandles(this._viewHandlesKey),t&&this.addHandles(this._generateViewHandles(e),this._viewHandlesKey)}),reactiveUtils.pc),o),this._set("view",e)}cancel(){this._moduleLoaderAbortController=(0,maybe.DC)(this._moduleLoaderAbortController),this._viewReadyAbortController=(0,maybe.DC)(this._viewReadyAbortController),this._sketchContinuationFlag=!0,this._operationHandle&&this._operationHandle.cancel()}complete(){this._operationHandle&&this._operationHandle.complete()}delete(){const{state:e,updateGraphics:t}=this;if("active"===e&&t.length){const{activeTool:e,layer:o}=this,i=t.toArray();o.removeMany(i),this.cancel(),this._emitDeleteEvent({graphics:i,tool:e})}}duplicate(){if("active"===this.state&&this.updateGraphics.length){const e=this.updateGraphics.map((e=>e.clone())).toArray();return this.layer.addMany(e),this.emit("duplicate",{graphics:e,type:"duplicate"}),e}return[]}async create(e,t){this.cancel(),await this._waitViewReady();const{view:o,layer:i}=this;if(!o||"disabled"===this.state)throw i||this._logMissingLayer(),(0,promiseUtils.NK)();if(null!=o.activeTool&&(o.activeTool=null),!e)return void this._logError("sketch:missing-parameter","Missing parameter 'tool'.");(0,support_layerUtils.Y)(o,this._internalGraphicsLayer);const a=await this._updatingHandles.addPromise(this._setupCreateOperation(e,t));if(null==a||this.destroyed)return void o.map.remove(this._internalGraphicsLayer);a.on("complete",(()=>{if(a===this._operationHandle){const o=this.createGraphic,s=this._operationHandle.cancelled;if(this._operationHandle.destroy(),this._operationHandle=null,this._set("createGraphic",null),this.view?.map&&this.view.map.remove(this._internalGraphicsLayer),a.cancelled||null==o||i.add(o),this._sketchContinuationFlag=!1,this.emit("create",{graphic:o,state:s?"cancel":"complete",tool:e,toolEventInfo:null,type:"create"}),s||this._sketchContinuationFlag)return;const{creationMode:r}=this;if("continuous"===r){if(t?.geometryToPlace)return;this._updatingHandles.addPromise((0,promiseUtils.QZ)(this.create(e,t)))}else"update"===r&&o&&this._updatingHandles.addPromise((0,promiseUtils.QZ)(this.update([o])))}})),this._operationHandle=a,o.ready&&o.focus()}async place(e,t){return this.create("mesh",{mode:"click",hasZ:e.hasZ,geometryToPlace:e,...t})}async update(e,t){this.cancel(),await this._waitViewReady();const{layer:o,view:i,state:a}=this;if(!i||"disabled"===a)throw o||this._logMissingLayer(),(0,promiseUtils.NK)();null!=i.activeTool&&(i.activeTool=null);const s=Array.isArray(e)?e:[e];if(null==e||!s?.length)return void this._logError("sketch:missing-parameter","Missing parameter 'graphics'.");if(s.some((e=>e.layer!==o?(this._logError("sketch:invalid-parameter","Parameter 'graphics' contains one or more graphics missing from the supplied GraphicsLayer."),!0):null==e.geometry&&(this._logError("sketch:invalid-parameter","Parameter 'graphics' contains one or more graphics with an unsupported geometry."),!0))))return;const r=await this._updatingHandles.addPromise(this._setupUpdateOperation(s,t));this.destroyed||null==r||ue(r)||((0,support_layerUtils.Y)(i,this._internalGraphicsLayer),this._setUpdateOperationHandle(r,t),this.emit("update",{graphics:s,state:"start",aborted:!1,tool:r.tool,toolEventInfo:null,type:"update"}))}async _updateSpatialReference(e){const t=this.view;if(t){e=Array.isArray(e)?e:[e];for(const o of e)null==o.geometry||"mesh"===o.geometry.type||(0,spatialReferenceUtils.aI)(o.geometry.spatialReference,t.spatialReference)||((0,projection.canProjectWithoutEngine)(o.geometry.spatialReference,t.spatialReference)||(0,projection.isLoaded)()||await(0,projection.load)(),o.geometry=(0,projection.project)(o.geometry,t.spatialReference))}else this._logMissingView()}undo(){this.canUndo()&&this._operationHandle?.undo()}redo(){this.canRedo()&&this._operationHandle?.redo()}canUndo(){return!!this._operationHandle?.canUndo()}canRedo(){return!!this._operationHandle?.canRedo()}toggleUpdateTool(){this._operationHandle?.toggleTool()}async _getFirstHit(e){const t=this.view;if(!t)return this._logMissingView(),null;if("2d"===t.type){const o=[];t.map.allLayers.forEach((e=>{"vector-tile"!==e.type&&"imagery"!==e.type||o.push(e)}));const i=await t.hitTest(e,{exclude:o});return(0,hitTestSelectUtils.zF)(i.results)}const o=[t.map.ground];t.map.allLayers.forEach((e=>{(0,layerUtils.Eq)(e.type)&&o.push(e)}));const i=await t.hitTest(e,{exclude:o});if(i.results.length>0){const e=i.results[0];if(null!=e&&"graphic"===e.type&&e.graphic&&(!i.ground.mapPoint||t.map.ground.opacity<1||i.ground.distance-(e.distance??0)>-Math.min(3*i.ground.distance,"global"===t.viewingMode?(0,ellipsoidUtils.tO)(t.renderCoordsHelper.spatialReference).radius/t.renderCoordsHelper.unitInMeters:Number.POSITIVE_INFINITY)))return e}return null}_generateViewHandles(e){return[e.on("immediate-click",(async e=>{const t="active"===this.state&&"create"===this._operationHandle?.type;"disabled"!==this.state&&!t&&this.updateOnGraphicClick&&await this._updatingHandles.addPromise(this._handleImmediateClick(e))}),InputManager.o.WIDGET)]}async _handleImmediateClick(e){const t=await e.async((()=>this._getFirstHit((0,screenUtils.ZV)(e))));let o=null;if(null!=t){const i=t.graphic;this.updateGraphics.includes(i)||i.layer===this.layer?(e.stopPropagation(),o=i):"2d"!==this.view?.type||this._isComponentGraphic(i)||"active"!==this.state||this.cancel()}else"active"===this.state&&this.cancel();null==o||this.updateGraphics.includes(o)||await this.update([o],{...this.defaultUpdateOptions,reshapeOptions:{...this.defaultUpdateOptions.reshapeOptions}})}async _setupCreateOperation(e,t){const o=this.view;if(!o)return this._logMissingView(),null;const i={hasZ:"3d"===o.type,...this.defaultCreateOptions,...t},a=await this._setupDrawGraphicTool(e,o,i);return null==a?null:(o.tools.add(a),o.activeTool=a,this._setupCreateOperationHandle(a))}async _setupDrawGraphicTool(e,t,o){if("multipoint"===e&&"3d"===t.type)return this._logError("sketch:create","Multipoint geometries are not supported in SceneView."),null;if(!t)return this._logMissingView(),null;const{cursor:i,defaultZ:a,hasZ:s,geometryToPlace:r,graphicProperties:n,mode:p,preserveAspectRatio:l}=o,h=function sketchUtils_e(e,n){return"freehandPolygon"===n||"freehandPolyline"===n?"freehand":e??("rectangle"===n||"circle"===n?"hybrid":"click")}(p,e),c=function sketchUtils_n(e){switch(e){case"freehandPolygon":return"polygon";case"freehandPolyline":return"polyline";default:return e}}(e),d=o?.optionsPerTool?.has(e)?o.optionsPerTool.get(e):{},u=d?.preserveAspectRatio??l??"rectangle"!==e,y={centered:"rectangle"!==e&&!("circle"===e&&!u),cursor:i,defaultZ:a,forceUniformSize:u,graphicProperties:{...n,attributes:{...n?.attributes}},geometryToPlace:r,geometryType:c,mode:h,graphicSymbol:this._getGraphicSymbolFromTool(e),hasZ:s,snappingManager:this.snappingManager,snapToScene:!1,view:t,...d};return"2d"===t.type?this._makeDrawGraphicTool2D(y):this._makeDrawGraphicTool3D(y)}async _makeDrawGraphicTool2D(e){const t=await this._requireModule(Promise.all([__webpack_require__.e(5751),__webpack_require__.e(3048),__webpack_require__.e(4480),__webpack_require__.e(1860),__webpack_require__.e(8964),__webpack_require__.e(2109),__webpack_require__.e(3820),__webpack_require__.e(5386),__webpack_require__.e(9486)]).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@arcgis/core/views/2d/interactive/editingTools.js")));return ue(t)||this.destroyed?null:new t.module.DrawGraphicTool2D({...e,activeVertexSymbol:this.activeVertexSymbol,regularVerticesSymbol:this.vertexSymbol,activeLineSymbol:this.activeLineSymbol,activeFillSymbol:re(e.geometryType)?this.activeFillSymbol:null,sketchOptions:this.sketchOptions})}async _makeDrawGraphicTool3D(e){const t=await this._requireModule(Promise.all([__webpack_require__.e(5751),__webpack_require__.e(3048),__webpack_require__.e(666),__webpack_require__.e(1315),__webpack_require__.e(4480),__webpack_require__.e(1860),__webpack_require__.e(2248),__webpack_require__.e(2394),__webpack_require__.e(8964),__webpack_require__.e(2109),__webpack_require__.e(4916),__webpack_require__.e(9790),__webpack_require__.e(3820),__webpack_require__.e(8186),__webpack_require__.e(8297),__webpack_require__.e(4993)]).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@arcgis/core/views/3d/interactive/editingTools.js")));if(ue(t)||this.destroyed)return null;const{elevationInfo:o}=this.layer;return new t.module.DrawGraphicTool3D({...e,elevationInfo:o,snapToScene:!0,sketchOptions:this.sketchOptions})}_setupCreateOperationHandle(e){const t=this.view;if(!t)return this._logMissingView(),null;let o=null;const i=e.forceUniformSize,s=e.centered,r=[t.on("key-down",(t=>{if(t.key===keybindings.NE.pan)t.stopPropagation(),t.repeat||(e.enabled=!1);else if(t.key===keybindings.NE.complete)t.stopPropagation(),e.completeCreateOperation();else if(t.key!==keybindings.NE.vertexAdd||t.repeat)t.key===keybindings.NE.undo?(t.stopPropagation(),n.undo()):t.key===keybindings.NE.redo?(t.stopPropagation(),n.redo()):t.key!==keybindings.NE.constraint||"rectangle"!==e.geometryType&&"circle"!==e.geometryType||t.repeat?t.key===keybindings.NE.center&&(t.repeat||(e.centered=!s,t.stopPropagation())):(e.forceUniformSize=!i,t.stopPropagation());else{const o=e.drawOperation.geometryType;"polyline"!==o&&"polygon"!==o&&"multipoint"!==o||(t.stopPropagation(),e.drawOperation.commitStagedVertex())}}),InputManager.o.WIDGET),t.on("key-up",(t=>{t.key===keybindings.NE.pan?e.enabled=!0:t.key!==keybindings.NE.constraint||"rectangle"!==e.geometryType&&"circle"!==e.geometryType?t.key===keybindings.NE.center&&(e.centered=s,t.stopPropagation()):(e.forceUniformSize=i,t.stopPropagation())}),InputManager.o.WIDGET),e.on("vertex-add",(t=>{switch(o=null==o?"start":"active",t.operation){case"apply":this.emit("create",{graphic:e.graphic,state:o,tool:this.activeTool,toolEventInfo:t,type:"create"});break;case"undo":this._emitUndoEvent({graphics:[e.graphic],tool:e.geometryType});break;case"redo":this._emitRedoEvent({graphics:[e.graphic],tool:e.geometryType})}})),e.on("cursor-update",(t=>{e.drawOperation.numCommittedVertices>0&&this.emit("create",{graphic:e.graphic,state:"active",tool:this.activeTool,toolEventInfo:{coordinates:t.vertices[0].coordinates,type:"cursor-update"},type:"create"})})),e.on("vertex-remove",(t=>{switch(t.operation){case"apply":this.emit("create",{graphic:e.graphic,state:"active",tool:this.activeTool,toolEventInfo:t,type:"create"});break;case"undo":this._emitUndoEvent({graphics:[e.graphic],tool:e.geometryType});break;case"redo":this._emitRedoEvent({graphics:[e.graphic],tool:e.geometryType})}})),e.on("complete",(e=>{this._set("createGraphic",e.graphic),o="complete",e.aborted?n&&n.cancel():n&&n.complete()})),(0,reactiveUtils.watch)((()=>this._getGraphicSymbolFromTool(e.geometryType)),(t=>{e.graphicSymbol=t}))],n=new OperationHandle_p({activeComponent:e,tool:e.geometryType,type:"create",onEnd:()=>{(0,handleUtils.ei)(r),t.tools?.remove(e)},undo:()=>{e.canUndo&&e.undo()},redo:()=>{e.canRedo&&e.redo()},canUndo:()=>e.canUndo,canRedo:()=>e.canRedo});return n}_getGraphicSymbolFromTool(e){switch(e){case"point":case"multipoint":return this.pointSymbol;case"polyline":case"freehandPolyline":return this.polylineSymbol;case"circle":case"rectangle":case"polygon":case"freehandPolygon":return this.polygonSymbol;case"mesh":return this.meshSymbol}}async _setupUpdateOperation(e,t){const{layer:o,view:i}=this;if(!i)return this._logMissingView(),null;const a={...this.defaultUpdateOptions,...t,reshapeOptions:{...this.defaultUpdateOptions.reshapeOptions,...t?.reshapeOptions},highlightOptions:{...this.defaultUpdateOptions.highlightOptions,...t?.highlightOptions}};let s=a.tool??oe.tool;for(const r of e)o.remove(r),o.add(r);if("3d"===i.type){if(0===e.length)return null;switch(s){case"move":return this._setupMove3DOperation(e,a,i,s);case"reshape":return e.length>1?(this._logError("sketch:reshape-multiple","Reshape operation does not support multiple graphics."),null):this._setupReshape3DOperation(e[0],a,i);case"transform":return this._setupGraphicTransform3DOperation(e,a,i)}}switch(s){case"move":return this._setupMove2DOperation(e,a,i);case"reshape":return e.length>1?(this._logError("sketch:reshape-multiple","Reshape operation does not support multiple graphics."),null):this._setupTransformOrReshape2DOperation(e,s,a,i);case"transform":if(1===e.length){const t=e[0].geometry?.type;"point"!==t&&"multipoint"!==t||(s="reshape")}return this._setupTransformOrReshape2DOperation(e,s,a,i)}}async _setupMove3DOperation(e,t,o,i,s=!1){const r=await this._requireModule(Promise.all([__webpack_require__.e(5751),__webpack_require__.e(3048),__webpack_require__.e(666),__webpack_require__.e(1315),__webpack_require__.e(4480),__webpack_require__.e(1860),__webpack_require__.e(2248),__webpack_require__.e(2394),__webpack_require__.e(8964),__webpack_require__.e(2109),__webpack_require__.e(4916),__webpack_require__.e(9790),__webpack_require__.e(3820),__webpack_require__.e(8186),__webpack_require__.e(8297),__webpack_require__.e(4993)]).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@arcgis/core/views/3d/interactive/editingTools.js")));if(ue(r))return r;const{ManipulatedObject3DGraphic:n,MoveTool3D:p}=r.module,l=new Map,h=()=>{l.forEach((e=>e.destroy())),l.clear()};for(const a of e){const e=new n({view:o,graphic:a}),t=(0,isSupportedObject.Y)(e);if(t!==isSupportedObjectUtils.d.SUPPORTED)return h(),this._logError("sketch:move",`Move operation not supported for provided graphic(s) (${(0,isSupportedObjectUtils.c)(t)}).`),null;l.set(a,e)}const c=new p({view:o,enableZ:t.enableZ,snappingManager:this.snappingManager,sketchOptions:this.sketchOptions});o.tools.add(c),c.objects.addMany(Array.from(l.values())),s||this.updateGraphics.addMany(e);const d=[],u=new OperationHandle_i({activeComponent:c,tool:i,type:"update",onEnd:()=>{(0,handleUtils.ei)(d),de(o,c),h()},undo:()=>{he(this.view,c),ne(u,this.updateGraphics.toArray()),this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:i})},redo:()=>{pe(u,this.updateGraphics.toArray()),this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:i})},addToSelection:e=>{this.updateGraphics.push(e);const t=new n({view:o,graphic:e});l.set(e,t),c.objects.push(t),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[e],removed:[],type:"selection-change"},type:"update"})},removeFromSelection:e=>{const t=this.updateGraphics.indexOf(e);if(u.history.undo.forEach((e=>e.updates.splice(t,1))),u.history.redo.forEach((e=>e.updates.splice(t,1))),this.updateGraphics.remove(e),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[e],type:"selection-change"},type:"update"}),0===this.updateGraphics.length)return void u.complete();const o=l.get(e);o&&(c.objects.remove(o),o.destroy(),l.delete(e))},toggleTool:async()=>{if(1!==this.updateGraphics.length||!1===t.toggleToolOnClick)return;if("transform"!==i)return;const e=this.updateGraphics.at(0),a=await this._setupReshape3DOperation(e,t,o,!0);a&&!ue(a)&&(u.onEnd(),u.destroy(),this._setUpdateOperationHandle(a,t))}});return d.push(...this._getHandlesForComponent(u,t),o.on("immediate-click",(e=>this._getCommonUpdateOperationClickHandlers(u,e,t)),InputManager.o.WIDGET),o.on("key-down",(e=>{this._getCommonUpdateOperationKeyDownHandlers(u,e)}),InputManager.o.WIDGET)),u}_setupGraphicTransform3DOperation(e,t,o,i=!1){if(1===e.length&&function r(r){if("graphics"!==r.layer?.type)return isSupportedObjectUtils.d.GRAPHICS_LAYER_MISSING;if(null==r.geometry)return isSupportedObjectUtils.d.GEOMETRY_MISSING;switch(r.geometry.type){case"point":break;case"polygon":case"polyline":case"multipoint":case"extent":case"mesh":return isSupportedObjectUtils.d.SUPPORTED;default:return isSupportedObjectUtils.d.GEOMETRY_TYPE_UNSUPPORTED}const s=null!=r.symbol&&"point-3d"===r.symbol.type&&r.symbol.symbolLayers;return s&&s.some((e=>"object"===e.type))?"on-the-ground"!==(0,elevationInfoUtils.ky)(r)&&(0,elevationInfoUtils.NN)(r)?isSupportedObjectUtils.d.ELEVATION_MODE_UNSUPPORTED:isSupportedObjectUtils.d.SUPPORTED:isSupportedObjectUtils.d.SYMBOL_TYPE_UNSUPPORTED}(e[0])===isSupportedObjectUtils.d.SUPPORTED){const a=e[0],s=a.geometry;if(null!=s&&("point"===s.type||"mesh"===s.type))return this._setupPointTransform3DOperation(a,t,o);if(null!=s&&("polygon"===s.type||"polyline"===s.type))return this._setupPolyTransform3DOperation(a,t,o,i)}return this._setupMove3DOperation(e,t,o,"transform",i)}async _setupPointTransform3DOperation(e,t,o){const i="transform",{enableRotation:s,enableScaling:r,enableZ:n}=t,p=await this._requireModule(Promise.all([__webpack_require__.e(5751),__webpack_require__.e(3048),__webpack_require__.e(666),__webpack_require__.e(1315),__webpack_require__.e(4480),__webpack_require__.e(1860),__webpack_require__.e(2248),__webpack_require__.e(2394),__webpack_require__.e(8964),__webpack_require__.e(2109),__webpack_require__.e(4916),__webpack_require__.e(9790),__webpack_require__.e(3820),__webpack_require__.e(8186),__webpack_require__.e(8297),__webpack_require__.e(4993)]).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@arcgis/core/views/3d/interactive/editingTools.js")));if(ue(p))return p;const{TransformTool3D:l,ManipulatedObject3DGraphic:h}=p.module,c=new h({graphic:e,view:o}),d=new l({object:c,view:o,enableRotation:s,enableScaling:r,enableZ:n,snappingManager:this.snappingManager,sketchOptions:this.sketchOptions});o.tools.add(d),this.updateGraphics.add(e);const u=[],y=new OperationHandle_i({activeComponent:d,tool:i,type:"update",onEnd:()=>{(0,handleUtils.ei)(u),de(o,d),c.destroy()},undo:()=>{he(this.view,d),ne(y,this.updateGraphics.toArray()),this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:i})},redo:()=>{pe(y,this.updateGraphics.toArray()),this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:i})},addToSelection:async e=>{this.updateGraphics.add(e),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[e],removed:[],type:"selection-change"},type:"update"}),y.onEnd(),y.destroy();const i=await this._setupMove3DOperation(this.updateGraphics.toArray(),t,o,"transform",!0);ue(i)||this._setUpdateOperationHandle(i,t)},removeFromSelection:e=>{this.updateGraphics.remove(e),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[e],type:"selection-change"},type:"update"}),y.complete()},toggleTool:()=>{}});return u.push(...this._getHandlesForComponent(y,t),o.on("immediate-click",(e=>this._getCommonUpdateOperationClickHandlers(y,e,t)),InputManager.o.WIDGET),o.on("key-down",(e=>{this._getCommonUpdateOperationKeyDownHandlers(y,e)}),InputManager.o.WIDGET)),y}async _setupPolyTransform3DOperation(e,t,o,i=!1){const s="transform",{enableRotation:r,enableScaling:n,enableZ:p,preserveAspectRatio:l}=t,h=await this._requireModule(Promise.all([__webpack_require__.e(5751),__webpack_require__.e(3048),__webpack_require__.e(666),__webpack_require__.e(1315),__webpack_require__.e(4480),__webpack_require__.e(1860),__webpack_require__.e(2248),__webpack_require__.e(2394),__webpack_require__.e(8964),__webpack_require__.e(2109),__webpack_require__.e(4916),__webpack_require__.e(9790),__webpack_require__.e(3820),__webpack_require__.e(8186),__webpack_require__.e(8297),__webpack_require__.e(4993)]).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@arcgis/core/views/3d/interactive/editingTools.js")));if(ue(h))return h;const{ManipulatedObject3DGraphic:c,ExtentTransformTool:d}=h.module,u=this.view?.inputManager?.isModifierKeyDown(keybindings.NE.constraint),y=new c({view:o,graphic:e}),m=new d({object:y,view:o,enableRotation:r,enableScaling:n,enableZ:p,preserveAspectRatio:!!l!=!!u,sketchOptions:this.sketchOptions});o.tools.add(m),i||this.updateGraphics.add(e);const g=[],v=new OperationHandle_i({activeComponent:m,tool:s,type:"update",onEnd:()=>{(0,handleUtils.ei)(g),de(o,m),y.destroy()},canUndo:()=>!m.destroyed&&m.canUndo,undo:()=>{m.destroyed||(m.undo(),this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:s}))},canRedo:()=>!m.destroyed&&m.canRedo,redo:()=>{m.destroyed||(m.redo(),this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:s}))},addToSelection:async e=>{this.updateGraphics.add(e),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[e],removed:[],type:"selection-change"},type:"update"}),v.onEnd(),v.destroy();const i=await this._setupMove3DOperation(this.updateGraphics.toArray(),t,o,"transform",!0);ue(i)||this._setUpdateOperationHandle(i,t)},removeFromSelection:e=>{this.updateGraphics.remove(e),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[e],type:"selection-change"},type:"update"}),v.complete()},toggleTool:async()=>{if(1!==this.updateGraphics.length||!1===t.toggleToolOnClick)return;const i=await this._setupReshape3DOperation(e,t,o,!0);i&&!ue(i)&&(v.onEnd(),v.destroy(),this._setUpdateOperationHandle(i,t))}});return g.push(...this._getHandlesForComponent(v,t),o.on("immediate-click",(e=>this._getCommonUpdateOperationClickHandlers(v,e,t)),InputManager.o.WIDGET),o.on("key-down",(e=>this._getCommonUpdateOperationKeyDownHandlers(v,e)),InputManager.o.WIDGET),o.on("key-down",(e=>{e.key!==keybindings.NE.constraint||e.repeat||(m.preserveAspectRatio=!m.preserveAspectRatio,e.stopPropagation())}),InputManager.o.WIDGET),o.on("key-up",(e=>{e.key===keybindings.NE.constraint&&(m.preserveAspectRatio=!m.preserveAspectRatio,e.stopPropagation())}),InputManager.o.WIDGET)),v}async _setupMove2DOperation(e,t,o){const i="move";this.updateGraphics.addMany(e),await this._updatingHandles.addPromise(this._updateSpatialReference(e));const s=await this._getGraphicMover(e,t,o);if(ue(s))return s;const r=new OperationHandle_i({activeComponent:s,tool:i,type:"update",onEnd:()=>{this._displayDefaultCursor(),(0,handleUtils.ei)(l),(0,handleUtils.ei)(p),s.destroy(),this._internalGraphicsLayer?.removeMany([...this.updateGraphics.toArray()])},undo:()=>{const e=this.updateGraphics.toArray();ne(r,e),r.refreshComponent(),this._emitUndoEvent({graphics:e,tool:i})},redo:()=>{const e=this.updateGraphics.toArray();pe(r,e),r.refreshComponent(),this._emitRedoEvent({graphics:e,tool:i})},addToSelection:async e=>{await this._updatingHandles.addPromise(this._updateSpatialReference(e)),this.updateGraphics.push(e),s.graphics=this.updateGraphics.toArray(),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[e],removed:[],type:"selection-change"},type:"update"})},removeFromSelection:e=>{const t=this.updateGraphics.indexOf(e);r.history.undo.forEach((e=>e.updates.splice(t,1))),r.history.redo.forEach((e=>e.updates.splice(t,1))),this.updateGraphics.remove(e);const o=this.updateGraphics.toArray();this.emit("update",{graphics:o,state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[e],type:"selection-change"},type:"update"}),0!==this.updateGraphics.length?s.graphics=o:r.complete()}});let n=!1;const p=[o.on("immediate-click",(e=>this._getCommonUpdateOperationClickHandlers(r,e,t)),InputManager.o.WIDGET),o.on("key-down",(e=>{this._getCommonUpdateOperationKeyDownHandlers(r,e),e.key!==keybindings.NE.constraint||e.repeat||(n=!0,s.enableMoveAllGraphics=!s.enableMoveAllGraphics)}),InputManager.o.WIDGET),o.on("key-up",(e=>{e.key===keybindings.NE.constraint&&n&&(n=!1,s.enableMoveAllGraphics=!s.enableMoveAllGraphics)}),InputManager.o.WIDGET)],l=this._getHandlesForComponent(r,t);return r}async _setupReshape3DOperation(e,t,o,i=!1){const s="reshape",r=await this._requireModule(Promise.all([__webpack_require__.e(5751),__webpack_require__.e(3048),__webpack_require__.e(666),__webpack_require__.e(1315),__webpack_require__.e(4480),__webpack_require__.e(1860),__webpack_require__.e(2248),__webpack_require__.e(2394),__webpack_require__.e(8964),__webpack_require__.e(2109),__webpack_require__.e(4916),__webpack_require__.e(9790),__webpack_require__.e(3820),__webpack_require__.e(8186),__webpack_require__.e(8297),__webpack_require__.e(4993)]).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@arcgis/core/views/3d/interactive/editingTools.js")));if(ue(r))return r;const{ManipulatedObject3DGraphic:n,ReshapeTool3D:p}=r.module,l=new n({view:o,graphic:e}),h=isSupportedObject_e(l);if(h!==isSupportedObjectUtils.d.SUPPORTED)return l.destroy(),this._logError("sketch:reshape",`Reshape operation not supported for provided graphic(s) (${(0,isSupportedObjectUtils.c)(h)}).`),null;const c=t.reshapeOptions,d=new p({view:o,object:l,enableZVertex:t.enableZ&&"move"===c?.vertexOperation,enableZShape:t.enableZ&&"move"===c?.shapeOperation,enableMoveObject:"move"===c?.shapeOperation||"move-xy"===c?.shapeOperation,enableMidpoints:"split"===c?.edgeOperation,enableEdgeOffset:"offset"===c?.edgeOperation,snappingManager:this.snappingManager,sketchOptions:this.sketchOptions});o.tools.add(d),i||this.updateGraphics.add(l.graphic);const u=[],y=new OperationHandle_i({activeComponent:d,tool:s,type:"update",onEnd:()=>{(0,handleUtils.ei)(u),de(o,d),l.destroy()},canUndo:()=>!d.destroyed&&d.canUndo,undo:()=>{d.destroyed||(d.undo(),this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:s}))},canRedo:()=>!d.destroyed&&d.canRedo,redo:()=>{d.destroyed||(d.redo(),this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:s}))},addToSelection:async e=>{this.updateGraphics.add(e),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[e],removed:[],type:"selection-change"},type:"update"}),y.onEnd(),y.destroy();const i=await this._setupMove3DOperation(this.updateGraphics.toArray(),t,o,"transform",!0);ue(i)||this._setUpdateOperationHandle(i,t)},removeFromSelection:e=>{this.updateGraphics.remove(e),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[e],type:"selection-change"},type:"update"}),y.complete()},toggleTool:async()=>{if(!1===t.toggleToolOnClick)return;y.onEnd(),y.destroy();const e=await this._setupGraphicTransform3DOperation(this.updateGraphics.toArray(),t,o,!0);ue(e)||this._setUpdateOperationHandle(e,t)}});return u.push(...this._getHandlesForComponent(y,t),o.on("immediate-click",(e=>this._getCommonUpdateOperationClickHandlers(y,e,t)),InputManager.o.WIDGET),o.on("key-down",(e=>{this._getCommonUpdateOperationKeyDownHandlers(y,e)}),InputManager.o.WIDGET)),y}async _setupTransformOrReshape2DOperation(e,t,o,i){this.updateGraphics.addMany(e),await this._updatingHandles.addPromise(this._updateSpatialReference(e));const s="transform"===t?await this._getBox(e,o,i):await this._getReshape(e,o,i);if(ue(s))return s;const r=new OperationHandle_i({activeComponent:s,type:"update",onEnd:()=>{(0,handleUtils.ei)(p),(0,handleUtils.ei)(n),r.activeComponent&&!r.activeComponent.destroyed&&r.activeComponent.destroy(),this._internalGraphicsLayer.removeMany(this.updateGraphics.toArray())},undo:()=>{ne(r,this.updateGraphics.toArray()),r.refreshComponent(),this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:r.tool})},redo:()=>{pe(r,this.updateGraphics.toArray()),r.refreshComponent(),this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:r.tool})},addToSelection:async e=>{let t=r.activeComponent;if("reshape"===t?.type){const t=[...this.updateGraphics,e];this.updateGraphics.removeAll(),r.onEnd(),r.destroy();const a=await this._setupTransformOrReshape2DOperation(t,"transform",o,i);if(ue(a))return;this._setUpdateOperationHandle(a,o)}else this.updateGraphics.add(e),t.graphics=this.updateGraphics.toArray(),t.refresh(),r.resetHistory();this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[e],removed:[],type:"selection-change"},type:"update"})},removeFromSelection:async e=>{const t=this.updateGraphics.indexOf(e);r.history.undo.forEach((e=>e.updates.splice(t,1))),r.history.redo.forEach((e=>e.updates.splice(t,1))),this.updateGraphics.remove(e);const o=this.updateGraphics.toArray();if(0===o.length)r.complete();else{const e=o[0].geometry;1!==o.length||null==e||"point"!==e.type&&"multipoint"!==e.type?r.activeComponent.graphics=o:r.toggleTool()}this.emit("update",{graphics:o,state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[e],type:"selection-change"},type:"update"})},toggleTool:async()=>{if(this.updateGraphics.length>1)return;const e=this.updateGraphics.at(0),t=e.geometry;if(null!=t&&("reshape"===r.tool&&("point"===t.type||"multipoint"===t.type)||"transform"===r.tool&&"extent"===t.type))return;let s=null;"transform"===r.tool?s=await this._getReshape([e],o,i):"reshape"===r.tool&&(s=await this._getBox([e],o,i)),ue(s)||(r.activeComponent?.destroy(),r.activeComponent=s,r.activeComponent&&((0,handleUtils.ei)(p),p=this._getHandlesForComponent(r,o)))}}),n=[i.on("immediate-click",(e=>this._getCommonUpdateOperationClickHandlers(r,e,o)),InputManager.o.WIDGET),i.on("key-down",(e=>{if(this._getCommonUpdateOperationKeyDownHandlers(r,e),e.key===keybindings.NE.constraint&&!e.repeat&&r){const e=r.activeComponent;e&&"box"===e.type&&(e.preserveAspectRatio=!e.preserveAspectRatio)}}),InputManager.o.WIDGET),i.on("key-up",(e=>{if(e.key===keybindings.NE.constraint&&r){const e=r.activeComponent;e&&"box"===e.type&&(e.preserveAspectRatio=!e.preserveAspectRatio)}}),InputManager.o.WIDGET)];let p=this._getHandlesForComponent(r,o);return r}async _getGraphicMover(e,t,o){const{enableMoveAllGraphics:i,highlightOptions:a}=t,s=await this._requireModule(Promise.all([__webpack_require__.e(9341),__webpack_require__.e(2124)]).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@arcgis/core/views/draw/support/GraphicMover.js")));return ue(s)?s:new s.module.default({enableMoveAllGraphics:i,highlightsEnabled:!!a?.enabled,indicatorsEnabled:!1,graphics:e,view:o,callbacks:{onGraphicMoveStart:({dx:e,dy:t,graphic:o})=>{this._displayGrabbingCursor(),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:e,dy:t,mover:o,type:"move-start"},type:"update"})},onGraphicMove:({dx:e,dy:t,graphic:o})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:e,dy:t,mover:o,type:"move"},type:"update"}),onGraphicMoveStop:({dx:e,dy:t,graphic:o})=>{this._displayPointerCursor(),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:e,dy:t,mover:o,type:"move-stop"},type:"update"})},onGraphicPointerOver:()=>this._displayPointerCursor(),onGraphicPointerOut:()=>this._displayDefaultCursor()}})}async _getBox(e,t,o){const{enableRotation:i,enableScaling:a,highlightOptions:s,preserveAspectRatio:r}=t,n=await this._requireModule(Promise.all([__webpack_require__.e(3048),__webpack_require__.e(4480),__webpack_require__.e(1860),__webpack_require__.e(9341),__webpack_require__.e(8260)]).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@arcgis/core/views/draw/support/Box.js")));if(ue(n))return n;const p=this.view?.inputManager?.isModifierKeyDown(keybindings.NE.constraint);return new n.module.default({graphics:e,enableRotation:i,enableScaling:a,highlightsEnabled:!!s?.enabled,preserveAspectRatio:!!r!=!!p,layer:this._internalGraphicsLayer,view:o,sketchOptions:this.sketchOptions,callbacks:{onMoveStart:e=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...e},type:"update"}),onMove:e=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...e},type:"update"}),onMoveStop:e=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...e},type:"update"}),onScaleStart:e=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...e},type:"update"}),onScale:e=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...e},type:"update"}),onScaleStop:e=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...e},type:"update"}),onRotateStart:e=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...e},type:"update"}),onRotate:e=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...e},type:"update"}),onRotateStop:e=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...e},type:"update"})}})}async _getReshape(e,t,o){const i="split"===t.reshapeOptions?.edgeOperation,a="move"===t.reshapeOptions?.shapeOperation,s=!!t.highlightOptions?.enabled,r=await this._requireModule(Promise.all([__webpack_require__.e(3048),__webpack_require__.e(4480),__webpack_require__.e(1860),__webpack_require__.e(8964),__webpack_require__.e(9341),__webpack_require__.e(6833)]).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@arcgis/core/views/draw/support/Reshape.js")));return ue(r)?r:new r.module.default({enableMidpoints:i,enableMovement:a,graphic:e[0],highlightsEnabled:s,layer:this._internalGraphicsLayer,snappingManager:this.snappingManager,sketchOptions:this.sketchOptions,view:o,callbacks:{onReshapeStart:e=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...e},type:"update"}),onReshape:e=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...e},type:"update"}),onReshapeStop:({mover:e,type:t})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:e,type:t},type:"update"}),onMoveStart:({dx:e,dy:t,mover:o,type:i})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:e,dy:t,mover:o,type:i},type:"update"}),onMove:({dx:e,dy:t,mover:o,type:i})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:e,dy:t,mover:o,type:i},type:"update"}),onMoveStop:({dx:e,dy:t,mover:o,type:i})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:e,dy:t,mover:o,type:i},type:"update"}),onVertexAdd:({added:e,type:t,vertices:o})=>{const i=e.map((e=>(0,coordsUtils.$K)(e.geometry)));this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:i,vertices:o,type:t},type:"update"})},onVertexRemove:({removed:e,type:t,vertices:o})=>{const i=e.map((e=>(0,coordsUtils.$K)(e.geometry)));this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{removed:i,vertices:o,type:t},type:"update"})}}})}_getHandlesForComponent(e,t){const o=e.activeComponent;if(!o)return[];switch(o.type){case"graphic-mover":return[o.on("graphic-click",(({graphic:t,viewEvent:o})=>{o.native?.shiftKey&&(o.stopPropagation(),e.removeFromSelection(t))})),o.on("graphic-move-start",(t=>e.addToHistory(ce(t.allGraphics))))];case"box":return[o.on("graphic-click",(o=>this._onTransformOrReshape2DGraphicClick(e,t,o))),o.on("move-start",(t=>e.addToHistory(ce(t.graphics)))),o.on("rotate-start",(t=>e.addToHistory(ce(t.graphics)))),o.on("scale-start",(t=>e.addToHistory(ce(t.graphics))))];case"reshape":return[o.on("graphic-click",(o=>this._onTransformOrReshape2DGraphicClick(e,t,o))),o.on("move-start",(t=>e.addToHistory(ce([t.mover])))),o.on("reshape-start",(t=>e.addToHistory(ce([t.graphic])))),o.on("vertex-add",(t=>e.addToHistory(ce([t.oldGraphic])))),o.on("vertex-remove",(t=>e.addToHistory(ce([t.oldGraphic]))))];case"move-3d":return[o.events.on("record-undo",(({updates:t})=>{e.addToHistory({updates:t})})),o.events.on("move-start",(e=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:0,dy:0,mover:e.objects.length>0?e.objects[0].graphic:null,type:"move-start"},type:"update"})})),o.events.on("move",(e=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:e.dx,dy:e.dy,mover:e.objects.length>0?e.objects[0].graphic:null,type:"move"},type:"update"})})),o.events.on("move-stop",(e=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:0,dy:0,mover:e.objects.length>0?e.objects[0].graphic:null,type:"move-stop"},type:"update"})})),o.events.on("immediate-click",(o=>{o.shiftKey?this._toggleSelection([o.object.graphic],e,t):e.toggleTool()}))];case"transform-3d":return[o.events.on("record-undo",(({updates:t})=>{e.addToHistory({updates:t})})),o.events.on("translate-start",(e=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:e.object.graphic,dx:e.dxScreen,dy:e.dyScreen,type:"move-start"},type:"update"})})),o.events.on("translate-stop",(e=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:e.object.graphic,dx:e.dxScreen,dy:e.dyScreen,type:"move-stop"},type:"update"})})),o.events.on("rotate-start",(e=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:e.object.graphic,angle:e.angle,type:"rotate-start"},type:"update"})})),o.events.on("rotate-stop",(e=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:e.object.graphic,angle:e.angle,type:"rotate-stop"},type:"update"})})),o.events.on("scale-start",(e=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:e.object.graphic,xScale:e.xScale,yScale:e.yScale,type:"scale-start"},type:"update"})})),o.events.on("scale-stop",(e=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:e.object.graphic,xScale:e.xScale,yScale:e.yScale,type:"scale-stop"},type:"update"})})),o.events.on("translate",(e=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:e.object.graphic,dx:e.dxScreen,dy:e.dyScreen,type:"move"},type:"update"})})),o.events.on("rotate",(e=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:e.object.graphic,angle:e.angle,type:"rotate"},type:"update"})})),o.events.on("scale",(e=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:e.object.graphic,xScale:e.xScale,yScale:e.yScale,type:"scale"},type:"update"})})),o.events.on("immediate-click",(o=>{o.shiftKey?this._toggleSelection([o.object.graphic],e,t):e.toggleTool()}))];case"reshape-3d":return[o.events.on("reshape",(e=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...e,mover:e.object.graphic},type:"update"})})),o.events.on("move",(e=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...e,mover:e.object.graphic},type:"update"})})),o.events.on("vertex-add",(e=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:e,type:"update"})})),o.events.on("vertex-remove",(e=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:e,type:"update"})})),o.events.on("immediate-click",(o=>{o.shiftKey?this._toggleSelection([o.object.graphic],e,t):e.toggleTool()}))]}}_onTransformOrReshape2DGraphicClick(e,t,o){const{graphic:i,viewEvent:a}=o;return a.native?.shiftKey&&i.layer===this.layer?(a.stopPropagation(),e.removeFromSelection(i)):t.toggleToolOnClick?(a.stopPropagation(),e.toggleTool()):void 0}_setUpdateOperationHandle(e,t){this._operationHandle=e;const o=this.view?.map;this._disablePopup(t);e.on("complete",(()=>{if(e===this._operationHandle){const i=this.updateGraphics.toArray(),a=this._operationHandle.tool;this._operationHandle.destroy(),this._operationHandle=null,this._internalGraphicsLayer.removeMany(this.updateGraphics.toArray()),this.updateGraphics.removeAll(),o&&o.remove(this._internalGraphicsLayer),this._restorePopup(t),this.emit("update",{graphics:i,state:"complete",aborted:e.cancelled,tool:a,toolEventInfo:null,type:"update"})}}))}async _getCommonUpdateOperationClickHandlers(e,t,o){const i=(0,screenUtils.ZV)(t),a=await t.async((()=>this._getFirstHit(i)));null!=a&&(t.native.shiftKey&&this._toggleSelection([a.graphic],e,o)||this.updateGraphics.includes(a.graphic))?t.stopPropagation():e.complete()}_toggleSelection(e,t,o){const i=!!o.multipleSelectionEnabled;return e.some((e=>!(null==e||!i||e.layer!==this.layer||(this.updateGraphics.includes(e)?t.removeFromSelection(e):t.addToSelection(e),0))))}_getCommonUpdateOperationKeyDownHandlers(e,t){if(!e)return;const o=t.key;o===keybindings.NE.undo&&e.canUndo()?(t.stopPropagation(),e.undo()):o===keybindings.NE.redo&&e.canRedo()?(t.stopPropagation(),e.redo()):o===keybindings.NE.cancel?(t.stopPropagation(),e.cancel()):this.allowDeleteKey&&keybindings.NE.delete.includes(o)&&this._onDeleteKey(t)}_onDeleteKey(e){if(!this._operationHandle||"update"!==this._operationHandle.type)return;const t=this.activeComponent,o=this.updateGraphics.toArray();null!=t&&("reshape"!==t.type||1===o.length&&"point"===o[0].geometry?.type)&&(e.stopPropagation(),this.delete())}_removeDefaultLayer(){this._internalGraphicsLayer&&(this.view?.map?.remove(this._internalGraphicsLayer),this._internalGraphicsLayer=(0,maybe.pR)(this._internalGraphicsLayer))}_isComponentGraphic(e){const{activeComponent:t}=this;return!(!e||null==t)&&(e.attributes?.esriSketchTool||"draw-2d"===t.type&&t.graphic===e||("box"===t.type||"reshape"===t.type)&&t.isUIGraphic(e))}_displayPointerCursor(){this.view?.container&&"pointer"!==this.view.cursor&&(this.view.cursor="pointer")}_displayGrabbingCursor(){this.view?.container&&"grabbing"!==this.view.cursor&&(this.view.cursor="grabbing")}_displayDefaultCursor(){this.view?.container&&null!==this.view.cursor&&(this.view.cursor=null)}_logError(e,t,i){Logger.A.getLogger(this).error(new Error.A(e,t,i))}async _requireModule(e){const t=new AbortController;this._moduleLoaderAbortController=t;const o=await e;return this._moduleLoaderAbortController!==t||t.signal.aborted?{requireError:"aborted"}:{module:o}}_emitUndoEvent(e){this.emit("undo",{...e,type:"undo"})}_emitRedoEvent(e){this.emit("redo",{...e,type:"redo"})}_emitDeleteEvent(e){this.emit("delete",{...e,type:"delete"})}get test(){}wait(){return(0,reactiveUtils.C_)((()=>!this.updating))}_disablePopupEnabled(e){return"3d"!==this.view?.type||this.updateOnGraphicClick||(e?.toggleToolOnClick??!1)}_disablePopup(e){this._disablePopupEnabled(e)&&this.view&&null==this._originalPopupEnabled&&(this._originalPopupEnabled=this.view.popupEnabled,this.view.popupEnabled=!1)}_restorePopup(e){this._disablePopupEnabled(e)&&this.view&&null!=this._originalPopupEnabled&&(this.view.popupEnabled=this._originalPopupEnabled,this._originalPopupEnabled=null)}async _waitViewReady(){const e=this.view;e?((0,maybe.DC)(this._viewReadyAbortController),this._viewReadyAbortController=new AbortController,await(0,promiseUtils.qr)((0,reactiveUtils.C_)((()=>e?.ready)),this._viewReadyAbortController.signal)):this._logMissingView()}_logMissingView(){this._logError("sketch:missing-property",se("view"))}_logMissingLayer(){this._logError(ae,se("layer"))}};(0,tslib_es6._)([(0,property.MZ)()],ie.prototype,"_defaultSnappingManager",void 0),(0,tslib_es6._)([(0,property.MZ)()],ie.prototype,"updating",null),(0,tslib_es6._)([(0,property.MZ)({readOnly:!0})],ie.prototype,"_updatingHandles",void 0),(0,tslib_es6._)([(0,property.MZ)()],ie.prototype,"_operationHandle",void 0),(0,tslib_es6._)([(0,property.MZ)({readOnly:!0})],ie.prototype,"activeTool",null),(0,tslib_es6._)([(0,property.MZ)({readOnly:!0})],ie.prototype,"activeCreateToolDrawMode",null),(0,tslib_es6._)([(0,property.MZ)()],ie.prototype,"activeTooltip",null),(0,tslib_es6._)([(0,property.MZ)({types:typeUtils.Es})],ie.prototype,"activeFillSymbol",void 0),(0,tslib_es6._)([(0,property.MZ)()],ie.prototype,"activeLineSymbol",void 0),(0,tslib_es6._)([(0,property.MZ)()],ie.prototype,"activeVertexSymbol",void 0),(0,tslib_es6._)([(0,property.MZ)()],ie.prototype,"allowDeleteKey",void 0),(0,tslib_es6._)([(0,property.MZ)({readOnly:!0})],ie.prototype,"createGraphic",null),(0,tslib_es6._)([(0,property.MZ)()],ie.prototype,"defaultCreateOptions",null),(0,tslib_es6._)([(0,property.MZ)()],ie.prototype,"defaultUpdateOptions",null),(0,tslib_es6._)([(0,property.MZ)({type:SketchLabelOptions.A,nonNullable:!0})],ie.prototype,"labelOptions",null),(0,tslib_es6._)([(0,property.MZ)()],ie.prototype,"layer",void 0),(0,tslib_es6._)([(0,property.MZ)({types:typeUtils.Es})],ie.prototype,"pointSymbol",void 0),(0,tslib_es6._)([(0,property.MZ)({types:typeUtils.Es})],ie.prototype,"polygonSymbol",void 0),(0,tslib_es6._)([(0,property.MZ)({types:typeUtils.Es})],ie.prototype,"polylineSymbol",void 0),(0,tslib_es6._)([(0,property.MZ)()],ie.prototype,"meshSymbol",void 0),(0,tslib_es6._)([(0,property.MZ)({type:c,nonNullable:!0})],ie.prototype,"snappingOptions",null),(0,tslib_es6._)([(0,property.MZ)()],ie.prototype,"snappingManager",null),(0,tslib_es6._)([(0,property.MZ)({readOnly:!0})],ie.prototype,"state",null),(0,tslib_es6._)([(0,property.MZ)({type:SketchTooltipOptions.A,nonNullable:!0})],ie.prototype,"tooltipOptions",null),(0,tslib_es6._)([(0,property.MZ)({readOnly:!0})],ie.prototype,"updateGraphics",void 0),(0,tslib_es6._)([(0,property.MZ)()],ie.prototype,"updateOnGraphicClick",void 0),(0,tslib_es6._)([(0,property.MZ)()],ie.prototype,"creationMode",void 0),(0,tslib_es6._)([(0,property.MZ)({type:SketchValueOptions.A,nonNullable:!0})],ie.prototype,"valueOptions",null),(0,tslib_es6._)([(0,property.MZ)({types:typeUtils.Es})],ie.prototype,"vertexSymbol",void 0),(0,tslib_es6._)([(0,property.MZ)({value:null})],ie.prototype,"view",null),(0,tslib_es6._)([(0,property.MZ)({constructOnly:!0,type:SketchOptions.A})],ie.prototype,"sketchOptions",void 0),ie=(0,tslib_es6._)([(0,subclass.$)("esri.widgets.Sketch.SketchViewModel")],ie);const ae="sketch:missing-property",se=e=>`Property '${e}' is missing on SketchViewModel.`;function re(e){return"polygon"===e||"rectangle"===e||"circle"===e}function ne(e,t){le("undo",e.history.undo,e.history.redo,t)}function pe(e,t){le("redo",e.history.redo,e.history.undo,t)}function le(e,t,o,i){const a=t.pop();if(!a)return;const s=a.updates,r=[];i.forEach(((t,o)=>{const i=s[o];null!=i&&("geometry"in i&&null!=i.geometry&&(r.push({geometry:t.geometry}),t.geometry=i.geometry),"symbol"in i&&null!=i.symbol&&(r.push({symbol:t.symbol}),t.symbol=i.symbol),"undo"in i&&(r.push(i),i[e](t)))})),o.push({updates:r})}function he(e,t){null!=e&&t.hasGrabbedManipulators&&(e.activeTool=null)}function ce(e){return{updates:e.map((({geometry:e})=>"mesh"===e?.type?{geometry:e.cloneShallow()}:{geometry:e}))}}function de(e,t){e.tools?.remove(t),t.destroyed||t.destroy()}function ue(e){return"requireError"in e&&"aborted"===e.requireError}const ye=ie}}]);