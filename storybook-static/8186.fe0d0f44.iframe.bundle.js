"use strict";(self.webpackChunk_defra_flood_map=self.webpackChunk_defra_flood_map||[]).push([[8186],{"./node_modules/@arcgis/core/chunks/ColorMaterial.glsl.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{C:()=>m,b:()=>c});var _views_3d_webgl_engine_core_shaderLibrary_Slice_glsl_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/Slice.glsl.js"),_views_3d_webgl_engine_core_shaderLibrary_Transform_glsl_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/Transform.glsl.js"),_views_3d_webgl_engine_core_shaderLibrary_attributes_ObjectAndLayerIdColor_glsl_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/attributes/ObjectAndLayerIdColor.glsl.js"),_views_3d_webgl_engine_core_shaderLibrary_attributes_VertexColor_glsl_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/attributes/VertexColor.glsl.js"),_views_3d_webgl_engine_core_shaderLibrary_shading_TerrainDepthTest_glsl_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/shading/TerrainDepthTest.glsl.js"),_views_3d_webgl_engine_core_shaderLibrary_shading_VisualVariables_glsl_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/shading/VisualVariables.glsl.js"),_views_3d_webgl_engine_core_shaderLibrary_util_ColorConversion_glsl_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/util/ColorConversion.glsl.js"),_views_3d_webgl_engine_core_shaderLibrary_util_View_glsl_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/util/View.glsl.js"),_views_3d_webgl_engine_core_shaderModules_Float4PassUniform_js__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderModules/Float4PassUniform.js"),_views_3d_webgl_engine_core_shaderModules_glsl_js__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderModules/glsl.js"),_views_3d_webgl_engine_lib_VertexAttribute_js__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/lib/VertexAttribute.js"),_views_3d_webgl_engine_shaders_OutputColorHighlightOID_glsl_js__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/shaders/OutputColorHighlightOID.glsl.js"),_views_webgl_ShaderBuilder_js__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__("./node_modules/@arcgis/core/views/webgl/ShaderBuilder.js");function c(c){const m=new _views_webgl_ShaderBuilder_js__WEBPACK_IMPORTED_MODULE_12__.N5,{vertex:u,fragment:w,attributes:p,varyings:f}=m,{vvColor:h,hasVertexColors:C}=c;return(0,_views_3d_webgl_engine_core_shaderLibrary_util_View_glsl_js__WEBPACK_IMPORTED_MODULE_7__.NB)(u,c),m.include(_views_3d_webgl_engine_core_shaderLibrary_Transform_glsl_js__WEBPACK_IMPORTED_MODULE_1__.d,c),m.include(_views_3d_webgl_engine_core_shaderLibrary_attributes_VertexColor_glsl_js__WEBPACK_IMPORTED_MODULE_3__.c,c),m.include(_views_3d_webgl_engine_core_shaderLibrary_shading_VisualVariables_glsl_js__WEBPACK_IMPORTED_MODULE_5__.A,c),m.include(_views_3d_webgl_engine_core_shaderLibrary_attributes_ObjectAndLayerIdColor_glsl_js__WEBPACK_IMPORTED_MODULE_2__.g,c),w.include(_views_3d_webgl_engine_core_shaderLibrary_Slice_glsl_js__WEBPACK_IMPORTED_MODULE_0__.HQ,c),m.include(_views_3d_webgl_engine_shaders_OutputColorHighlightOID_glsl_js__WEBPACK_IMPORTED_MODULE_11__.z,c),m.include(_views_3d_webgl_engine_core_shaderLibrary_shading_TerrainDepthTest_glsl_js__WEBPACK_IMPORTED_MODULE_4__.Z,c),p.add(_views_3d_webgl_engine_lib_VertexAttribute_js__WEBPACK_IMPORTED_MODULE_10__.r.POSITION,"vec3"),h&&p.add(_views_3d_webgl_engine_lib_VertexAttribute_js__WEBPACK_IMPORTED_MODULE_10__.r.COLORFEATUREATTRIBUTE,"float"),C||f.add("vColor","vec4"),f.add("vpos","vec3"),u.uniforms.add(new _views_3d_webgl_engine_core_shaderModules_Float4PassUniform_js__WEBPACK_IMPORTED_MODULE_8__.E("uColor",(e=>e.color))),u.main.add(_views_3d_webgl_engine_core_shaderModules_glsl_js__WEBPACK_IMPORTED_MODULE_9__.H`
      vpos = position;
      forwardNormalizedVertexColor();
      forwardObjectAndLayerIdColor();

      ${C?"vColor *= uColor;":h?"vColor = uColor * interpolateVVColor(colorFeatureAttribute);":"vColor = uColor;"}
      forwardViewPosDepth((view * vec4(vpos, 1.0)).xyz);
      gl_Position = transformPosition(proj, view, vpos);`),w.include(_views_3d_webgl_engine_core_shaderLibrary_util_ColorConversion_glsl_js__WEBPACK_IMPORTED_MODULE_6__.a),w.main.add(_views_3d_webgl_engine_core_shaderModules_glsl_js__WEBPACK_IMPORTED_MODULE_9__.H`discardBySlice(vpos);
discardByTerrainDepth();
outputColorHighlightOID(vColor, vpos);`),m}const m=Object.freeze(Object.defineProperty({__proto__:null,build:c},Symbol.toStringTag,{value:"Module"}))},"./node_modules/@arcgis/core/chunks/HighlightApply.glsl.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{H:()=>c,b:()=>a});var _views_3d_webgl_engine_core_shaderLibrary_HighlightCellGridScreenSpacePass_glsl_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/HighlightCellGridScreenSpacePass.glsl.js"),_views_3d_webgl_engine_core_shaderLibrary_HighlightReadBitmap_glsl_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/HighlightReadBitmap.glsl.js"),_views_3d_webgl_engine_core_shaderModules_FloatPassUniform_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderModules/FloatPassUniform.js"),_views_3d_webgl_engine_core_shaderModules_glsl_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderModules/glsl.js"),_views_3d_webgl_engine_core_shaderModules_IntegerBindUniform_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderModules/IntegerBindUniform.js"),_views_3d_webgl_engine_core_shaderModules_Texture2DPassUniform_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderModules/Texture2DPassUniform.js"),_views_webgl_ShaderBuilder_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./node_modules/@arcgis/core/views/webgl/ShaderBuilder.js");function a(){const a=new _views_webgl_ShaderBuilder_js__WEBPACK_IMPORTED_MODULE_6__.N5;a.include(_views_3d_webgl_engine_core_shaderLibrary_HighlightCellGridScreenSpacePass_glsl_js__WEBPACK_IMPORTED_MODULE_0__.Q);const{fragment:c}=a;return c.uniforms.add(new _views_3d_webgl_engine_core_shaderModules_Texture2DPassUniform_js__WEBPACK_IMPORTED_MODULE_5__.N("highlightTexture",(e=>e.highlightTexture)),new _views_3d_webgl_engine_core_shaderModules_Texture2DPassUniform_js__WEBPACK_IMPORTED_MODULE_5__.N("highlightOptionsTexture",(e=>e.highlightOptionsTexture)),new _views_3d_webgl_engine_core_shaderModules_FloatPassUniform_js__WEBPACK_IMPORTED_MODULE_2__.m("pixelRatio",(e=>e.pixelRatio)),new _views_3d_webgl_engine_core_shaderModules_FloatPassUniform_js__WEBPACK_IMPORTED_MODULE_2__.m("occludedIntensityFactor",(e=>e.occludedFactor)),new _views_3d_webgl_engine_core_shaderModules_IntegerBindUniform_js__WEBPACK_IMPORTED_MODULE_4__.W("maxHighlightLevel",(e=>e.highlights.length-1))),c.constants.add("pixelSampleScale","float",1),a.include(_views_3d_webgl_engine_core_shaderLibrary_HighlightReadBitmap_glsl_js__WEBPACK_IMPORTED_MODULE_1__.y),c.code.add(_views_3d_webgl_engine_core_shaderModules_glsl_js__WEBPACK_IMPORTED_MODULE_3__.H`const float pascal17[9] = float[9](12870.0, 11440.0, 8008.0, 4368.0, 1820.0, 560.0, 120.0, 16.0, 1.0);
const float denom17 =  65536.0;
float colorWeight[16] = float[16](0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0);
float colorOcclusion[16] = float[16](0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0);
float weights[16] = float[16](0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0);
void applyTexel(vec2 texel, float weight) {
if (texel != vec2(0.0)){
int maxChannel = (maxHighlightLevel >> 2) & 1;
for (int channelIndex = 0; channelIndex <= maxChannel; ++channelIndex){
uint channel = readChannel(texel, channelIndex << 2);
int firstIndex = channelIndex << 2;
int maxIndex  = min(firstIndex + 3, maxHighlightLevel);
for (int highlightIndex = firstIndex; highlightIndex <= maxIndex; ++highlightIndex ) {
uint v = readChannelBits(channel, highlightIndex);
if ((v & 1u) == 1u){
colorWeight[highlightIndex] += weight;
if ((v & 2u) == 2u){
colorOcclusion[highlightIndex] += weight;
}
}
}
}
}
}
vec2 readTexel(ivec2 iuv, int du, int dv) {
return texelFetch(highlightTexture, iuv + ivec2(du, dv), 0).rg;
}
void readAndApplyTexel(ivec2 iuv, int du, int dv, float weight) {
vec2 texel = readTexel(iuv, du, dv);
applyTexel(texel, weight);
}
void readAndApply2TexelsU(ivec2 iuv, int du, int dv, float weight) {
readAndApplyTexel(iuv, -du, dv, weight);
readAndApplyTexel(iuv, +du, dv, weight);
}
float getWeight(int pixelDistance) {
float scaledDistance = float(pixelDistance) * pixelSampleScale / pixelRatio;
float d0f = floor(scaledDistance);
int d0 = int(d0f);
if (d0 >= 8){
return 0.0;
}
float w0 = pascal17[d0];
float w1 = pascal17[d0+1];
float f =  scaledDistance - d0f;
return mix(w0, w1, f);
}`),c.main.add(_views_3d_webgl_engine_core_shaderModules_glsl_js__WEBPACK_IMPORTED_MODULE_3__.H`vec2 highlightTextureSize = vec2(textureSize(highlightTexture,0));
ivec2 iuv = ivec2(sUV * highlightTextureSize);
vec2 centerTexel = texelFetch(highlightTexture, iuv, 0).rg;
bool outlinePossible = false;
if (vOutlinePossible > 0.0){
for (int highlightLevel=0; highlightLevel<= maxHighlightLevel; ++highlightLevel) {
if ((readLevelBits(centerTexel,highlightLevel) & 1u) == 0u) {
outlinePossible = true;
break;
}
}
}
if (outlinePossible) {
int maxPixelDistance = clamp(int(8.0 * pixelRatio / pixelSampleScale), 2, 16);
float weightSum = 0.0;
for(int y = 0; y <= maxPixelDistance; ++y) {
float w = getWeight(y);
weights[y] = w;
weightSum += w * (y == 0 ? 1.0 : 2.0);
}
for(int y = 0; y <= maxPixelDistance; ++y) {
weights[y] = weights[y] / weightSum;
}
float weight0 = weights[0];
applyTexel(centerTexel, weight0 * weight0);
for(int y = 0; y <= maxPixelDistance; y += 1) {
float yFactor = weights[y];
if (y != 0) {
float xFactor = weight0;
float weight = xFactor * yFactor;
if (weight > 0.0) {
readAndApplyTexel(iuv, 0, +y, weight);
readAndApplyTexel(iuv, 0, -y, weight);
}
}
for(int x = 1; x <= maxPixelDistance; x += 1) {
float xFactor = weights[x];
float weight = xFactor * yFactor;
if (weight > 0.0) {
readAndApply2TexelsU(iuv, x, +y, weight);
if (y != 0){
readAndApply2TexelsU(iuv, x, -y, weight);
}
}
}
}
} else {
applyTexel(centerTexel, 1.0);
}
int frontColorIndex = 999;
int maxColorIndex = 0;
for (int i = 0; i <= maxHighlightLevel; ++i) {
if (colorWeight[i] > 0.0){
frontColorIndex = min(frontColorIndex, i);
maxColorIndex = max(maxColorIndex, i);
}
}
if (frontColorIndex == 999){
fragColor = vec4(0.0);
return;
}
vec4 accumulatedColor = vec4(0.0);
for (int curColorIndex = frontColorIndex; curColorIndex <= maxColorIndex; ++curColorIndex) {
float curColorWeight = colorWeight[curColorIndex];
if (curColorWeight <= 0.01){
continue;
}
uint vc = readLevelBits(centerTexel, curColorIndex);
bool centerFilled = (vc & 1u) == 1u;
bool centerOccluded = (vc & 3u) == 3u;
float curColorOcclusion = colorOcclusion[curColorIndex];
bool occluded = centerFilled ? centerOccluded : curColorOcclusion > 0.5 * curColorWeight;
int colorChannel = centerFilled ? 0 : 1;
vec4 colorBase = texelFetch(highlightOptionsTexture, ivec2(curColorIndex, colorChannel), 0);
float occlusionFactor = occluded ? occludedIntensityFactor : 1.0;
float outlineFactor = centerFilled ? 1.0 : smoothstep(0.0, 0.03, curColorWeight);
float intensity = colorBase.a * occlusionFactor * outlineFactor;
vec3 currentColor = colorBase.rgb;
float a0 = accumulatedColor.a;
float a1 = intensity;
float alpha = clamp(a0 + a1 - a0 * a1, 0.0, 1.0);
if (alpha > 0.001){
vec3 blendedColor = ((1.0 - a1) * a0 * accumulatedColor.rgb + a1 * currentColor) / alpha;
accumulatedColor = vec4(blendedColor, alpha);
}
}
fragColor = accumulatedColor;`),a}const c=Object.freeze(Object.defineProperty({__proto__:null,build:a},Symbol.toStringTag,{value:"Module"}))},"./node_modules/@arcgis/core/chunks/HighlightDownsample.glsl.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{H:()=>u,a:()=>s,b:()=>a,c:()=>o,g:()=>c,o:()=>n});var _views_3d_webgl_engine_core_shaderLibrary_ScreenSpacePass_glsl_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/ScreenSpacePass.glsl.js"),_views_3d_webgl_engine_core_shaderModules_glsl_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderModules/glsl.js"),_views_3d_webgl_engine_core_shaderModules_Texture2DDrawUniform_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderModules/Texture2DDrawUniform.js"),_views_webgl_NoParameters_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@arcgis/core/views/webgl/NoParameters.js"),_views_webgl_ShaderBuilder_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/@arcgis/core/views/webgl/ShaderBuilder.js");class u extends _views_webgl_NoParameters_js__WEBPACK_IMPORTED_MODULE_3__.Y{}function o(){const r=new _views_webgl_ShaderBuilder_js__WEBPACK_IMPORTED_MODULE_4__.N5,{outputs:u,fragment:o}=r;return r.include(_views_3d_webgl_engine_core_shaderLibrary_ScreenSpacePass_glsl_js__WEBPACK_IMPORTED_MODULE_0__.c),o.uniforms.add(new _views_3d_webgl_engine_core_shaderModules_Texture2DDrawUniform_js__WEBPACK_IMPORTED_MODULE_2__.o("textureInput",(e=>e.input))),o.constants.add("outlineWidth","int",Math.ceil(n)),o.constants.add("cellSize","int",c),u.add("fragGrid","vec2"),o.main.add(_views_3d_webgl_engine_core_shaderModules_glsl_js__WEBPACK_IMPORTED_MODULE_1__.H`ivec2 inputTextureSize = textureSize(textureInput, 0);
ivec2 cellBottomLeftCornerInput = ivec2(floor(gl_FragCoord.xy) * vec2(cellSize));
ivec2 coordMid =  cellBottomLeftCornerInput + ivec2(cellSize >> 1);
uvec2 centreTexel = uvec2( texelFetch(textureInput, coordMid, 0).rg * 255.0) & uvec2(0x55u);
float marginSquare = float(outlineWidth*outlineWidth);
uvec2 outputValue = centreTexel & uvec2(0x55u);
for(int y = -outlineWidth; y <= cellSize + outlineWidth; y+=2) {
int dy = y < 0 ? -y : y > cellSize ? y-cellSize : 0;
int xMargin = dy > 0 ? int(ceil(sqrt(marginSquare - float(dy*dy)))) : outlineWidth;
for(int x = -xMargin; x <= cellSize + xMargin; x+=2) {
ivec2 coord = cellBottomLeftCornerInput + ivec2(x, y);
uvec2[4] texels = uvec2[4] (
uvec2(texelFetch(textureInput,coord+ivec2(0,0),0).rg * 255.0) & uvec2(0x55u),
uvec2(texelFetch(textureInput,coord+ivec2(1,0),0).rg * 255.0) & uvec2(0x55u),
uvec2(texelFetch(textureInput,coord+ivec2(0,1),0).rg * 255.0) & uvec2(0x55u),
uvec2(texelFetch(textureInput,coord+ivec2(1,1),0).rg * 255.0) & uvec2(0x55u)
);
if (texels[0] == texels[1] && texels[1] == texels[2] && texels[2] == texels[3] && texels[3] ==  centreTexel) {
continue;
}
for (int i=0; i<4; ++i){
outputValue |= ((texels[i] ^ centreTexel) << 1);
outputValue |= texels[i];
}
}
}
fragGrid = vec2(outputValue) / 255.0;`),r}const c=32,n=9,a=.4,s=Object.freeze(Object.defineProperty({__proto__:null,HighlightDownsampleDrawParameters:u,blurSize:a,build:o,gridCellPixelSize:c,outlineSize:n},Symbol.toStringTag,{value:"Module"}))},"./node_modules/@arcgis/core/chunks/HighlightToSingle.glsl.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{H:()=>h,b:()=>s});var _views_3d_webgl_engine_core_shaderLibrary_HighlightCellGridScreenSpacePass_glsl_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/HighlightCellGridScreenSpacePass.glsl.js"),_views_3d_webgl_engine_core_shaderLibrary_HighlightReadBitmap_glsl_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/HighlightReadBitmap.glsl.js"),_views_3d_webgl_engine_core_shaderModules_glsl_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderModules/glsl.js"),_views_3d_webgl_engine_core_shaderModules_IntegerPassUniform_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderModules/IntegerPassUniform.js"),_views_3d_webgl_engine_core_shaderModules_Texture2DPassUniform_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderModules/Texture2DPassUniform.js"),_views_webgl_ShaderBuilder_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/@arcgis/core/views/webgl/ShaderBuilder.js");function s(){const s=new _views_webgl_ShaderBuilder_js__WEBPACK_IMPORTED_MODULE_5__.N5;s.include(_views_3d_webgl_engine_core_shaderLibrary_HighlightCellGridScreenSpacePass_glsl_js__WEBPACK_IMPORTED_MODULE_0__.Q),s.include(_views_3d_webgl_engine_core_shaderLibrary_HighlightReadBitmap_glsl_js__WEBPACK_IMPORTED_MODULE_1__.y);const{fragment:h}=s;return s.outputs.add("fragSingleHighlight","vec2",0),h.uniforms.add(new _views_3d_webgl_engine_core_shaderModules_Texture2DPassUniform_js__WEBPACK_IMPORTED_MODULE_4__.N("highlightTexture",(e=>e.highlightTexture)),new _views_3d_webgl_engine_core_shaderModules_IntegerPassUniform_js__WEBPACK_IMPORTED_MODULE_3__.c("highlightLevel",(e=>e.highlightLevel))),h.main.add(_views_3d_webgl_engine_core_shaderModules_glsl_js__WEBPACK_IMPORTED_MODULE_2__.H`ivec2 iuv = ivec2(gl_FragCoord.xy);
vec2 inputTexel = texelFetch(highlightTexture, iuv, 0).rg;
uint bits = readLevelBits(inputTexel, highlightLevel);
bool hasHighlight = (bits & 1u) == 1u;
bool hasOccluded  = (bits & 2u) == 2u;
fragSingleHighlight = vec2(hasHighlight ? 1.0 : 0.0, hasOccluded ? 1.0 : 0.0);`),s}const h=Object.freeze(Object.defineProperty({__proto__:null,build:s},Symbol.toStringTag,{value:"Module"}))},"./node_modules/@arcgis/core/chunks/OverlayCompositing.glsl.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{O:()=>d,a:()=>m,b:()=>l});var _views_3d_terrain_interfaces_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@arcgis/core/views/3d/terrain/interfaces.js"),_views_3d_webgl_engine_core_shaderLibrary_ScreenSpacePass_glsl_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/ScreenSpacePass.glsl.js"),_views_3d_webgl_engine_core_shaderModules_FloatPassUniform_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderModules/FloatPassUniform.js"),_views_3d_webgl_engine_core_shaderModules_glsl_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderModules/glsl.js"),_views_3d_webgl_engine_core_shaderModules_IntegerPassUniform_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderModules/IntegerPassUniform.js"),_views_3d_webgl_engine_core_shaderModules_Texture2DPassUniform_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderModules/Texture2DPassUniform.js"),_views_webgl_NoParameters_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./node_modules/@arcgis/core/views/webgl/NoParameters.js"),_views_webgl_ShaderBuilder_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./node_modules/@arcgis/core/views/webgl/ShaderBuilder.js");class d extends _views_webgl_NoParameters_js__WEBPACK_IMPORTED_MODULE_6__.Y{constructor(){super(...arguments),this.overlayIndex=_views_3d_terrain_interfaces_js__WEBPACK_IMPORTED_MODULE_0__.vr.INNER,this.opacity=1}}function l(){const e=new _views_webgl_ShaderBuilder_js__WEBPACK_IMPORTED_MODULE_7__.N5;return e.include(_views_3d_webgl_engine_core_shaderLibrary_ScreenSpacePass_glsl_js__WEBPACK_IMPORTED_MODULE_1__.c),e.fragment.uniforms.add(new _views_3d_webgl_engine_core_shaderModules_Texture2DPassUniform_js__WEBPACK_IMPORTED_MODULE_5__.N("tex",(e=>e.texture))),e.fragment.uniforms.add(new _views_3d_webgl_engine_core_shaderModules_IntegerPassUniform_js__WEBPACK_IMPORTED_MODULE_4__.c("overlayIdx",(e=>e.overlayIndex))),e.fragment.uniforms.add(new _views_3d_webgl_engine_core_shaderModules_FloatPassUniform_js__WEBPACK_IMPORTED_MODULE_2__.m("opacity",(e=>e.opacity))),e.fragment.main.add(_views_3d_webgl_engine_core_shaderModules_glsl_js__WEBPACK_IMPORTED_MODULE_3__.H`vec2 overlayUV = overlayIdx == 0 ? vec2(uv.x * 0.5, uv.y) : vec2(uv.x * 0.5 + 0.5, uv.y);
fragColor = texture(tex, overlayUV) * opacity;`),e}const m=Object.freeze(Object.defineProperty({__proto__:null,OverlayCompositingPassParameters:d,build:l},Symbol.toStringTag,{value:"Module"}))},"./node_modules/@arcgis/core/chunks/SingleHighlightApply.glsl.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{S:()=>c,b:()=>s});var _views_3d_webgl_engine_core_shaderLibrary_HighlightCellGridScreenSpacePass_glsl_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/HighlightCellGridScreenSpacePass.glsl.js"),_views_3d_webgl_engine_core_shaderLibrary_HighlightReadBitmap_glsl_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/HighlightReadBitmap.glsl.js"),_views_3d_webgl_engine_core_shaderModules_Float2DrawUniform_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderModules/Float2DrawUniform.js"),_views_3d_webgl_engine_core_shaderModules_FloatPassUniform_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderModules/FloatPassUniform.js"),_views_3d_webgl_engine_core_shaderModules_glsl_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderModules/glsl.js"),_views_3d_webgl_engine_core_shaderModules_IntegerPassUniform_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderModules/IntegerPassUniform.js"),_views_3d_webgl_engine_core_shaderModules_Texture2DPassUniform_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderModules/Texture2DPassUniform.js"),_HighlightDownsample_glsl_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./node_modules/@arcgis/core/chunks/HighlightDownsample.glsl.js"),_views_webgl_ShaderBuilder_js__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./node_modules/@arcgis/core/views/webgl/ShaderBuilder.js");function s(){const s=new _views_webgl_ShaderBuilder_js__WEBPACK_IMPORTED_MODULE_8__.N5;s.include(_views_3d_webgl_engine_core_shaderLibrary_HighlightCellGridScreenSpacePass_glsl_js__WEBPACK_IMPORTED_MODULE_0__.Q);const{fragment:c}=s;return c.uniforms.add(new _views_3d_webgl_engine_core_shaderModules_Texture2DPassUniform_js__WEBPACK_IMPORTED_MODULE_6__.N("blurInput",(e=>e.singleHighlightBlurTexture)),new _views_3d_webgl_engine_core_shaderModules_Float2DrawUniform_js__WEBPACK_IMPORTED_MODULE_2__.t("blurSize",(e=>e.blurSize)),new _views_3d_webgl_engine_core_shaderModules_Texture2DPassUniform_js__WEBPACK_IMPORTED_MODULE_6__.N("highlightTexture",(e=>e.highlightTexture)),new _views_3d_webgl_engine_core_shaderModules_Texture2DPassUniform_js__WEBPACK_IMPORTED_MODULE_6__.N("highlightOptionsTexture",(e=>e.highlightOptionsTexture)),new _views_3d_webgl_engine_core_shaderModules_IntegerPassUniform_js__WEBPACK_IMPORTED_MODULE_5__.c("highlightLevel",(e=>e.highlightLevel)),new _views_3d_webgl_engine_core_shaderModules_FloatPassUniform_js__WEBPACK_IMPORTED_MODULE_3__.m("occludedIntensityFactor",(e=>e.occludedFactor))),c.constants.add("inner","float",1-(_HighlightDownsample_glsl_js__WEBPACK_IMPORTED_MODULE_7__.o-_HighlightDownsample_glsl_js__WEBPACK_IMPORTED_MODULE_7__.b)/_HighlightDownsample_glsl_js__WEBPACK_IMPORTED_MODULE_7__.o),s.include(_views_3d_webgl_engine_core_shaderLibrary_HighlightReadBitmap_glsl_js__WEBPACK_IMPORTED_MODULE_1__.y),c.main.add(_views_3d_webgl_engine_core_shaderModules_glsl_js__WEBPACK_IMPORTED_MODULE_4__.H`vec2 highlightTextureSize = vec2(textureSize(highlightTexture,0));
vec2 uv = sUV;
vec2 center = texture(blurInput, uv).rg;
vec2 blurredHighlightValue = (vOutlinePossible == 0.0)
? center
: center * 0.204164
+ texture(blurInput, uv + blurSize * 1.407333).rg * 0.304005
+ texture(blurInput, uv - blurSize * 1.407333).rg * 0.304005
+ texture(blurInput, uv + blurSize * 3.294215).rg * 0.093913
+ texture(blurInput, uv - blurSize * 3.294215).rg * 0.093913;
float highlightIntensity = blurredHighlightValue.r;
float occlusionWeight = blurredHighlightValue.g;
if (highlightIntensity <= 0.01) {
discard;
}
vec4 fillColor    = texelFetch(highlightOptionsTexture, ivec2(highlightLevel, 0), 0);
vec4 outlineColor = texelFetch(highlightOptionsTexture, ivec2(highlightLevel, 1), 0);
vec2 centerTexel = texelFetch(highlightTexture, ivec2(uv * highlightTextureSize), 0).rg;
uint centerBits = readLevelBits(centerTexel, highlightLevel);
bool centerFilled = (centerBits & 1u) == 1u;
bool centerOccluded = (centerBits & 3u) == 3u;
bool occluded = centerOccluded || (0.5 * highlightIntensity < occlusionWeight);
float occlusionFactor = occluded ? occludedIntensityFactor : 1.0;
float outlineFactor = centerFilled ? 1.0 : smoothstep(0.0, inner, highlightIntensity);
float fillFactor = centerFilled ? 1.0 : 0.0;
vec4 baseColor = mix(outlineColor, fillColor, fillFactor);
float intensity = baseColor.a * occlusionFactor * outlineFactor;
fragColor = vec4(baseColor.rgb, intensity);`),s}const c=Object.freeze(Object.defineProperty({__proto__:null,build:s},Symbol.toStringTag,{value:"Module"}))},"./node_modules/@arcgis/core/chunks/SingleHighlightBlur.glsl.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{S:()=>n,a:()=>g,b:()=>o});var _core_libs_gl_matrix_2_factories_vec2f64_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@arcgis/core/core/libs/gl-matrix-2/factories/vec2f64.js"),_views_3d_webgl_engine_core_shaderLibrary_HighlightCellGridScreenSpacePass_glsl_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/HighlightCellGridScreenSpacePass.glsl.js"),_views_3d_webgl_engine_core_shaderModules_Float2DrawUniform_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderModules/Float2DrawUniform.js"),_views_3d_webgl_engine_core_shaderModules_glsl_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderModules/glsl.js"),_views_3d_webgl_engine_core_shaderModules_Texture2DDrawUniform_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderModules/Texture2DDrawUniform.js"),_views_webgl_NoParameters_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/@arcgis/core/views/webgl/NoParameters.js"),_views_webgl_ShaderBuilder_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./node_modules/@arcgis/core/views/webgl/ShaderBuilder.js");class n extends _views_webgl_NoParameters_js__WEBPACK_IMPORTED_MODULE_5__.Y{constructor(){super(...arguments),this.blurSize=(0,_core_libs_gl_matrix_2_factories_vec2f64_js__WEBPACK_IMPORTED_MODULE_0__.vt)()}}function o(){const e=new _views_webgl_ShaderBuilder_js__WEBPACK_IMPORTED_MODULE_6__.N5;return e.include(_views_3d_webgl_engine_core_shaderLibrary_HighlightCellGridScreenSpacePass_glsl_js__WEBPACK_IMPORTED_MODULE_1__.Q),e.outputs.add("fragSingleHighlight","vec2",0),e.fragment.uniforms.add(new _views_3d_webgl_engine_core_shaderModules_Float2DrawUniform_js__WEBPACK_IMPORTED_MODULE_2__.t("blurSize",(e=>e.blurSize)),new _views_3d_webgl_engine_core_shaderModules_Texture2DDrawUniform_js__WEBPACK_IMPORTED_MODULE_4__.o("blurInput",(e=>e.blurInput))).main.add(_views_3d_webgl_engine_core_shaderModules_glsl_js__WEBPACK_IMPORTED_MODULE_3__.H`vec2 highlightTextureSize = vec2(textureSize(blurInput,0));
vec2 center = texture(blurInput, sUV).rg;
if (vOutlinePossible == 0.0) {
fragSingleHighlight = center;
} else {
vec2 sum = center * 0.204164;
sum += texture(blurInput, sUV + blurSize * 1.407333).rg * 0.304005;
sum += texture(blurInput, sUV - blurSize * 1.407333).rg * 0.304005;
sum += texture(blurInput, sUV + blurSize * 3.294215).rg * 0.093913;
sum += texture(blurInput, sUV - blurSize * 3.294215).rg * 0.093913;
fragSingleHighlight = sum;
}`),e}const g=Object.freeze(Object.defineProperty({__proto__:null,SingleHighlightBlurDrawParameters:n,build:o},Symbol.toStringTag,{value:"Module"}))},"./node_modules/@arcgis/core/chunks/TextureOnly.glsl.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{T:()=>a,a:()=>m,b:()=>n});var _core_libs_gl_matrix_2_factories_vec3f64_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@arcgis/core/core/libs/gl-matrix-2/factories/vec3f64.js"),_views_3d_webgl_engine_core_shaderLibrary_ScreenSpacePass_glsl_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/ScreenSpacePass.glsl.js"),_views_3d_webgl_engine_core_shaderModules_Float3PassUniform_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderModules/Float3PassUniform.js"),_views_3d_webgl_engine_core_shaderModules_glsl_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderModules/glsl.js"),_views_3d_webgl_engine_core_shaderModules_Texture2DPassUniform_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderModules/Texture2DPassUniform.js"),_views_webgl_NoParameters_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/@arcgis/core/views/webgl/NoParameters.js"),_views_webgl_ShaderBuilder_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./node_modules/@arcgis/core/views/webgl/ShaderBuilder.js");class a extends _views_webgl_NoParameters_js__WEBPACK_IMPORTED_MODULE_5__.Y{constructor(){super(...arguments),this.color=(0,_core_libs_gl_matrix_2_factories_vec3f64_js__WEBPACK_IMPORTED_MODULE_0__.fA)(1,1,1)}}function n(){const e=new _views_webgl_ShaderBuilder_js__WEBPACK_IMPORTED_MODULE_6__.N5;return e.include(_views_3d_webgl_engine_core_shaderLibrary_ScreenSpacePass_glsl_js__WEBPACK_IMPORTED_MODULE_1__.c),e.fragment.uniforms.add(new _views_3d_webgl_engine_core_shaderModules_Texture2DPassUniform_js__WEBPACK_IMPORTED_MODULE_4__.N("tex",(e=>e.texture)),new _views_3d_webgl_engine_core_shaderModules_Float3PassUniform_js__WEBPACK_IMPORTED_MODULE_2__.t("uColor",(e=>e.color))),e.fragment.main.add(_views_3d_webgl_engine_core_shaderModules_glsl_js__WEBPACK_IMPORTED_MODULE_3__.H`vec4 texColor = texture(tex, uv);
fragColor = texColor * vec4(uColor, 1.0);`),e}const m=Object.freeze(Object.defineProperty({__proto__:null,TextureOnlyPassParameters:a,build:n},Symbol.toStringTag,{value:"Module"}))},"./node_modules/@arcgis/core/core/LRUCache.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{q:()=>e});var _MemCache_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@arcgis/core/core/MemCache.js");class e{constructor(e,s){this._storage=new _MemCache_js__WEBPACK_IMPORTED_MODULE_0__.F,this.id="",this.name="",this.size=0,this._storage.maxSize=e,this._storage.register(this),s&&this._storage.registerRemoveFunc("",s)}destroy(){this._storage.deregister(this),this._storage.destroy()}put(t,e,s=1){this._storage.put(this,t,e,s,1)}pop(t){return this._storage.pop(this,t)}get(t){return this._storage.get(this,t)}clear(){this._storage.clearAll()}get maxSize(){return this._storage.maxSize}set maxSize(t){this._storage.maxSize=t}resetHitRate(){}}},"./node_modules/@arcgis/core/core/NestedMap.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{O:()=>t});class t{constructor(){this._outer=new Map}clear(){this._outer.clear()}get empty(){return 0===this._outer.size}get(t,e){return this._outer.get(t)?.get(e)}getInner(t){return this._outer.get(t)}set(t,e,r){const o=this._outer.get(t);o?o.set(e,r):this._outer.set(t,new Map([[e,r]]))}delete(t,e){const r=this._outer.get(t);r&&(r.delete(e),0===r.size&&this._outer.delete(t))}forEach(t){this._outer.forEach(((e,r)=>t(e,r)))}forAll(t){for(const e of this._outer.values())for(const r of e.values())t(r)}}},"./node_modules/@arcgis/core/layers/graphics/sources/interfaces.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{var a;__webpack_require__.d(__webpack_exports__,{$:()=>a}),function(a){a[a.EnableFastUpdates=0]="EnableFastUpdates",a[a.DisableFastUpdates=1]="DisableFastUpdates",a[a.UpdateFastLocalOrigin=2]="UpdateFastLocalOrigin"}(a||(a={}))},"./node_modules/@arcgis/core/symbols/support/gfxUtils.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{$4:()=>y,O0:()=>g,O1:()=>w,Sw:()=>b,eH:()=>u,rc:()=>f});var _assets_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@arcgis/core/assets.js"),_Color_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@arcgis/core/Color.js"),_request_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@arcgis/core/request.js"),_core_LRUCache_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@arcgis/core/core/LRUCache.js"),_core_screenUtils_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/@arcgis/core/core/screenUtils.js"),_cimSymbolUtils_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/@arcgis/core/symbols/support/cimSymbolUtils.js");const i="picture-fill",a="simple-fill",l="simple-line",c="simple-marker",h="text",d="cim",m=new Map([["dash",[4,3]],["dashdot",[4,3,1,3]],["dot",[1,3]],["longdash",[8,3]],["longdashdot",[8,3,1,3]],["longdashdotdot",[8,3,1,3,1,3]],["shortdash",[4,1]],["shortdashdot",[4,1,1,1]],["shortdashdotdot",[4,1,1,1,1,1]],["shortdot",[1,1]],["solid",[]]]),p=new _core_LRUCache_js__WEBPACK_IMPORTED_MODULE_3__.q(1e3);function u(e){const o=e.style;let s=null;if(e)switch(e.type){case c:"cross"!==o&&"x"!==o&&(s=e.color);break;case a:o&&"solid"!==o?"none"!==o&&(s={type:"pattern",x:0,y:0,src:(0,_assets_js__WEBPACK_IMPORTED_MODULE_0__.s)(`esri/symbols/patterns/${o}.png`),width:5,height:5}):s=e.color;break;case i:s={type:"pattern",src:e.url,width:(0,_core_screenUtils_js__WEBPACK_IMPORTED_MODULE_5__.Lz)(e.width)*e.xscale,height:(0,_core_screenUtils_js__WEBPACK_IMPORTED_MODULE_5__.Lz)(e.height)*e.yscale,x:(0,_core_screenUtils_js__WEBPACK_IMPORTED_MODULE_5__.Lz)(e.xoffset),y:(0,_core_screenUtils_js__WEBPACK_IMPORTED_MODULE_5__.Lz)(e.yoffset)};break;case h:s=e.color;break;case d:s=(0,_cimSymbolUtils_js__WEBPACK_IMPORTED_MODULE_4__.Nk)(e)}return s}function f(t,e){const s=t+"-"+e;return void 0!==p.get(s)?Promise.resolve(p.get(s)):(0,_request_js__WEBPACK_IMPORTED_MODULE_2__.A)(t,{responseType:"image"}).then((t=>{const o=t.data,r=o.naturalWidth,n=o.naturalHeight,i=document.createElement("canvas");i.width=r,i.height=n;const a=i.getContext("2d");a.fillStyle=e,a.fillRect(0,0,r,n),a.globalCompositeOperation="destination-in",a.drawImage(o,0,0);const l=i.toDataURL();return p.put(s,l),l}))}function y(t){if(!t)return null;let e=null;switch(t.type){case a:case i:case c:e=y(t.outline);break;case l:{const o=(0,_core_screenUtils_js__WEBPACK_IMPORTED_MODULE_5__.Lz)(t.width);null!=t.style&&"none"!==t.style&&0!==o&&(e={color:t.color,style:w(t.style),width:o,cap:t.cap,join:"miter"===t.join?(0,_core_screenUtils_js__WEBPACK_IMPORTED_MODULE_5__.Lz)(t.miterLimit):t.join},e.dashArray=g(e).join(",")||"none");break}default:e=null}return e}function g(t){if(!t?.style)return[];const{dashArray:e,style:o,width:s}=t;if("string"==typeof e&&"none"!==e)return e.split(",").map((t=>Number(t)));const r=s??0,n=m.has(o)?m.get(o).map((t=>t*r)):[];if("butt"!==t.cap)for(const[i,a]of n.entries())n[i]=i%2==1?a+r:Math.max(a-r,1);return n}const w=(()=>{const t={};return e=>{if(t[e])return t[e];const o=e.replaceAll("-","");return t[e]=o,o}})(),b=new _Color_js__WEBPACK_IMPORTED_MODULE_1__.A([128,128,128])},"./node_modules/@arcgis/core/symbols/support/utils.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{$d:()=>y,GG:()=>J,N7:()=>p,Sx:()=>h,UQ:()=>D,di:()=>M,dt:()=>g,f3:()=>N,k_:()=>m});var _Color_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@arcgis/core/Color.js"),_core_asyncUtils_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@arcgis/core/core/asyncUtils.js"),_core_screenUtils_js__WEBPACK_IMPORTED_MODULE_9__=(__webpack_require__("./node_modules/@arcgis/core/core/has.js"),__webpack_require__("./node_modules/@arcgis/core/core/screenUtils.js")),_core_libs_gl_matrix_2_factories_vec3f64_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@arcgis/core/core/libs/gl-matrix-2/factories/vec3f64.js"),_layers_effects_jsonUtils_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/@arcgis/core/layers/effects/jsonUtils.js"),_cimSymbolUtils_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/@arcgis/core/symbols/support/cimSymbolUtils.js"),_gfxUtils_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./node_modules/@arcgis/core/symbols/support/gfxUtils.js"),_Symbol3DMaterial_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./node_modules/@arcgis/core/symbols/support/Symbol3DMaterial.js"),_typeUtils_js__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./node_modules/@arcgis/core/symbols/support/typeUtils.js");const a=new _Color_js__WEBPACK_IMPORTED_MODULE_0__.A("white");function m(e){if(!e)return 0;if((0,_typeUtils_js__WEBPACK_IMPORTED_MODULE_8__.wk)(e)){const t=function f(e){const t=e.symbolLayers?.at(-1);if(t&&"outline"in t)return t?.outline?.size}(e);return null!=t?t:0}return(0,_core_screenUtils_js__WEBPACK_IMPORTED_MODULE_9__.PN)((0,_gfxUtils_js__WEBPACK_IMPORTED_MODULE_6__.$4)(e)?.width)}function y(e){if(null==e||!("symbolLayers"in e)||null==e.symbolLayers)return!1;switch(e.type){case"point-3d":return e.symbolLayers.some((e=>"object"===e.type));case"line-3d":return e.symbolLayers.some((e=>"path"===e.type));case"polygon-3d":return e.symbolLayers.some((e=>"object"===e.type||"extrude"===e.type));default:return!1}}function p(e){return e.resource?.href??""}function h(t,o){if(!t)return null;let r=null;return(0,_typeUtils_js__WEBPACK_IMPORTED_MODULE_8__.wk)(t)?r=function b(t){const o=t.symbolLayers;if(!o)return null;let r=null;return o.forEach((e=>{"object"===e.type&&e.resource?.href||(r="water"===e.type?e.color:e.material?e.material.color:null)})),r?new _Color_js__WEBPACK_IMPORTED_MODULE_0__.A(r):null}(t):(0,_typeUtils_js__WEBPACK_IMPORTED_MODULE_8__.$y)(t)&&(r="cim"===t.type?(0,_cimSymbolUtils_js__WEBPACK_IMPORTED_MODULE_5__.Nk)(t):t.color?new _Color_js__WEBPACK_IMPORTED_MODULE_0__.A(t.color):null),r?w(r,o):null}function w(t,o){if(null==o||null==t)return t;const r=t.toRgba();return r[3]=r[3]*o,new _Color_js__WEBPACK_IMPORTED_MODULE_0__.A(r)}function g(t,o,r){t&&(o||null!=r)&&(o&&(o=new _Color_js__WEBPACK_IMPORTED_MODULE_0__.A(o)),(0,_typeUtils_js__WEBPACK_IMPORTED_MODULE_8__.wk)(t)?function d(e,t,o){const r=e.symbolLayers;if(!r)return;const n=e=>w(t=t??e??(null!=o?a:null),o);r.forEach((e=>{if("object"!==e.type||!e.resource?.href||t)if("water"===e.type)e.color=n(e.color);else{const t=null!=e.material?e.material.color:null,r=n(t);null==e.material?e.material=new _Symbol3DMaterial_js__WEBPACK_IMPORTED_MODULE_7__.N({color:r}):e.material.color=r,null!=o&&"outline"in e&&null!=e.outline?.color&&(e.outline.color=w(e.outline.color,o))}}))}(t,o,r):(0,_typeUtils_js__WEBPACK_IMPORTED_MODULE_8__.$y)(t)&&function j(e,t,o){(t=t??e.color)&&(e.color=w(t,o)),null!=o&&"outline"in e&&e.outline?.color&&(e.outline.color=w(e.outline.color,o))}(t,o,r))}async function k(e,o){const r=e.symbolLayers;r&&await(0,_core_asyncUtils_js__WEBPACK_IMPORTED_MODULE_1__.jJ)(r,(async e=>async function L(e,t){switch(e.type){case"extrude":!function S(e,t){e.size="number"==typeof t[2]?t[2]:0}(e,t);break;case"icon":case"line":case"text":!function z(e,t){const o=x(t);null!=o&&(e.size=o)}(e,t);break;case"path":!function v(e,t){const o=E(t,_core_libs_gl_matrix_2_factories_vec3f64_js__WEBPACK_IMPORTED_MODULE_3__.Un,[e.width,void 0,e.height]);e.width=R(t[0],e.width,1,o),e.height=R(t[2],e.height,1,o)}(e,t);break;case"object":await async function U(e,t){const{resourceSize:o,symbolSize:r}=await async function O(e){const{computeObjectLayerResourceSize:t}=await __webpack_require__.e(7242).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@arcgis/core/symbols/support/symbolLayerUtils.js")),o=await t(e,10),{width:r,height:n,depth:l}=e,i=[r,l,n];let c=1;for(let s=0;s<3;s++){const e=i[s];if(null!=e){c=e/o[s];break}}for(let s=0;s<3;s++)null==i[s]&&(i[s]=o[s]*c);return{resourceSize:o,symbolSize:i}}(e),n=E(t,o,r);e.width=R(t[0],r[0],o[0],n),e.depth=R(t[1],r[1],o[1],n),e.height=R(t[2],r[2],o[2],n)}(e,t)}}(e,o)))}function x(e){for(const t of e)if("number"==typeof t)return t;return null}function E(e,t,o){for(let r=0;r<3;r++){const n=e[r];switch(n){case"symbol-value":{const e=o[r];return null!=e?e/t[r]:1}case"proportional":break;default:if(n&&t[r])return n/t[r]}}return 1}function R(e,t,o,r){switch(e){case"proportional":return o*r;case"symbol-value":return null!=t?t:o;default:return e}}async function D(e,t){if(e&&t)return(0,_typeUtils_js__WEBPACK_IMPORTED_MODULE_8__.wk)(e)?k(e,t):void((0,_typeUtils_js__WEBPACK_IMPORTED_MODULE_8__.$y)(e)&&function C(e,t){const o=x(t);if(null!=o)switch(e.type){case"simple-marker":e.size=o;break;case"picture-marker":{const t=e.width/e.height;t>1?(e.width=o,e.height=o*t):(e.width=o*t,e.height=o);break}case"simple-line":e.width=o;break;case"text":e.font.size=o}}(e,t))}function J(e,t,o){if(e&&null!=t)if((0,_typeUtils_js__WEBPACK_IMPORTED_MODULE_8__.wk)(e)){const r=e.symbolLayers;r&&r.forEach((e=>{if("object"===e.type)switch(o){case"tilt":e.tilt=(e.tilt??0)+t;break;case"roll":e.roll=(e.roll??0)+t;break;default:e.heading=(e.heading??0)+t}"icon"===e.type&&(e.angle+=t)}))}else(0,_typeUtils_js__WEBPACK_IMPORTED_MODULE_8__.$y)(e)&&("simple-marker"!==e.type&&"picture-marker"!==e.type&&"text"!==e.type||(e.angle+=t))}function M(e){if(!e)return null;const t=e.effects.filter((e=>"bloom"!==e.type)).map((e=>e.toJSON()));return(0,_layers_effects_jsonUtils_js__WEBPACK_IMPORTED_MODULE_4__.zu)(t)}function N(e){return null!=e&&"polygon-3d"===e.type&&e.symbolLayers.some((e=>"extrude"===e.type))}},"./node_modules/@arcgis/core/views/3d/environment/Clouds.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{var n,e;function d(n){return null!=n&&!n.running}__webpack_require__.d(__webpack_exports__,{c:()=>e,pi:()=>d,tf:()=>n}),function(n){n[n.Idle=0]="Idle",n[n.Rendering=1]="Rendering",n[n.Ready=2]="Ready",n[n.Fading=3]="Fading"}(n||(n={})),function(n){n[n.RG=0]="RG",n[n.BA=1]="BA",n[n.COUNT=2]="COUNT"}(e||(e={}))},"./node_modules/@arcgis/core/views/3d/environment/CloudsParameters.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{c:()=>A,n:()=>x});var A,_core_compilerUtils_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@arcgis/core/core/compilerUtils.js"),_core_mathUtils_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@arcgis/core/core/mathUtils.js"),_core_signal_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@arcgis/core/core/signal.js"),_core_libs_gl_matrix_2_math_mat4_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@arcgis/core/core/libs/gl-matrix-2/math/mat4.js"),_core_libs_gl_matrix_2_factories_mat4f64_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/@arcgis/core/core/libs/gl-matrix-2/factories/mat4f64.js"),_chunks_vec32_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/@arcgis/core/chunks/vec32.js"),_core_libs_gl_matrix_2_factories_vec3f64_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./node_modules/@arcgis/core/core/libs/gl-matrix-2/factories/vec3f64.js"),_geometry_support_axisAngleDegrees_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./node_modules/@arcgis/core/geometry/support/axisAngleDegrees.js"),_geometry_support_Ellipsoid_js__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./node_modules/@arcgis/core/geometry/support/Ellipsoid.js"),_Clouds_js__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./node_modules/@arcgis/core/views/3d/environment/Clouds.js"),_weather_js__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("./node_modules/@arcgis/core/views/3d/environment/weather.js");class x{constructor(){this.startTime=0,this._data=(0,_core_signal_js__WEBPACK_IMPORTED_MODULE_2__.v)(null),this._readChannels=_Clouds_js__WEBPACK_IMPORTED_MODULE_9__.c.RG,this.parallax=new O,this.parallaxNew=new O,this._anchorPoint=(0,_core_libs_gl_matrix_2_factories_vec3f64_js__WEBPACK_IMPORTED_MODULE_6__.vt)(),this._fadeState=(0,_core_signal_js__WEBPACK_IMPORTED_MODULE_2__.v)(A.HIDE),this._fadeFactor=(0,_core_signal_js__WEBPACK_IMPORTED_MODULE_2__.v)(1)}get data(){return this._data.value}set data(a){this._data.value=a}get readChannels(){return this._readChannels}get fadeState(){return this._fadeState.value}get fadeFactor(){return this._fadeFactor.value}get opacity(){switch(this.fadeState){case A.HIDE:return 0;case A.FADE_OUT:return 1-this.fadeFactor;case A.FADE_IN:return this.fadeFactor;case A.SHOW:case A.CROSS_FADE:return 1}}fade(a,e,s){this.isFading&&this.fadeFactor<1&&(this._fadeFactor.value=s?(0,_core_mathUtils_js__WEBPACK_IMPORTED_MODULE_1__.qE)((e-this.startTime)/(H*s),0,1):1,1===this.fadeFactor&&this._endFade()),this._evaluateState(a,e),this._updateParallax(a)}_evaluateState(a,t){const e=a.relativeElevation,s=this._updateAnchorPoint(a);(e>1.7*_weather_js__WEBPACK_IMPORTED_MODULE_10__.zF||e<-1e4||s>I)&&this.opacity>0?this._startFade(A.HIDE,t):this.isFading||(e>_weather_js__WEBPACK_IMPORTED_MODULE_10__.zF||e<-.35*_weather_js__WEBPACK_IMPORTED_MODULE_10__.zF||s>w*I?this.opacity>0&&this._startFade(A.FADE_OUT,t):(0,_Clouds_js__WEBPACK_IMPORTED_MODULE_9__.pi)(this.data)&&(0===this.opacity?this._startFade(A.FADE_IN,t):this.data.state===_Clouds_js__WEBPACK_IMPORTED_MODULE_9__.tf.Ready&&(this.fadeState===A.SHOW?this._startFade(A.CROSS_FADE,t):this._startFade(A.SHOW,t))))}_updateParallax(a){const t=(0,_chunks_vec32_js__WEBPACK_IMPORTED_MODULE_5__.k)(a.eye);this.parallax.radiusCurvatureCorrection=.84*Math.sqrt(Math.max(t-_geometry_support_Ellipsoid_js__WEBPACK_IMPORTED_MODULE_8__.$O.radius*_geometry_support_Ellipsoid_js__WEBPACK_IMPORTED_MODULE_8__.$O.radius,0))/Math.sqrt(t),(0,_geometry_support_axisAngleDegrees_js__WEBPACK_IMPORTED_MODULE_7__.Cr)(C,this.parallax.anchorPoint,v),(0,_core_libs_gl_matrix_2_math_mat4_js__WEBPACK_IMPORTED_MODULE_3__.e$)(this.parallax.transform,_core_libs_gl_matrix_2_factories_mat4f64_js__WEBPACK_IMPORTED_MODULE_4__.zK,v[3],(0,_geometry_support_axisAngleDegrees_js__WEBPACK_IMPORTED_MODULE_7__.yo)(v)),(0,_geometry_support_axisAngleDegrees_js__WEBPACK_IMPORTED_MODULE_7__.Cr)(C,this.parallaxNew.anchorPoint,v),(0,_core_libs_gl_matrix_2_math_mat4_js__WEBPACK_IMPORTED_MODULE_3__.e$)(this.parallaxNew.transform,_core_libs_gl_matrix_2_factories_mat4f64_js__WEBPACK_IMPORTED_MODULE_4__.zK,v[3],(0,_geometry_support_axisAngleDegrees_js__WEBPACK_IMPORTED_MODULE_7__.yo)(v))}_updateAnchorPoint(a){return(0,_chunks_vec32_js__WEBPACK_IMPORTED_MODULE_5__.n)(this._anchorPoint,a.eye),(0,_chunks_vec32_js__WEBPACK_IMPORTED_MODULE_5__.h)(this._anchorPoint,this._anchorPoint,_geometry_support_Ellipsoid_js__WEBPACK_IMPORTED_MODULE_8__.$O.radius),this.fadeState===A.HIDE&&this.data?.state===_Clouds_js__WEBPACK_IMPORTED_MODULE_9__.tf.Ready?((0,_chunks_vec32_js__WEBPACK_IMPORTED_MODULE_5__.c)(this.parallax.anchorPoint,this._anchorPoint),0):(0,_chunks_vec32_js__WEBPACK_IMPORTED_MODULE_5__.l)((0,_chunks_vec32_js__WEBPACK_IMPORTED_MODULE_5__.d)(g,this.parallax.anchorPoint,this._anchorPoint))}requestFade(){this._fadeFactor.value=0}_startFade(a,t){switch(this._fadeState.value=a,this.startTime=t,a){case A.CROSS_FADE:this.requestFade(),this._switchReadChannels(),(0,_chunks_vec32_js__WEBPACK_IMPORTED_MODULE_5__.c)(this.parallaxNew.anchorPoint,this._anchorPoint);break;case A.FADE_IN:this.requestFade(),this._switchReadChannels(),(0,_chunks_vec32_js__WEBPACK_IMPORTED_MODULE_5__.c)(this.parallax.anchorPoint,this._anchorPoint),(0,_chunks_vec32_js__WEBPACK_IMPORTED_MODULE_5__.c)(this.parallaxNew.anchorPoint,this._anchorPoint);break;case A.FADE_OUT:this.requestFade();break;case A.SHOW:this._switchReadChannels(),(0,_chunks_vec32_js__WEBPACK_IMPORTED_MODULE_5__.c)(this.parallax.anchorPoint,this._anchorPoint),(0,_chunks_vec32_js__WEBPACK_IMPORTED_MODULE_5__.c)(this.parallaxNew.anchorPoint,this._anchorPoint),this._endFade();break;case A.HIDE:this._endFade()}}_endFade(){switch(this._fadeFactor.value=1,this.data&&this.data.state!==_Clouds_js__WEBPACK_IMPORTED_MODULE_9__.tf.Ready&&(this.data.state=_Clouds_js__WEBPACK_IMPORTED_MODULE_9__.tf.Idle),this.fadeState){case A.CROSS_FADE:(0,_chunks_vec32_js__WEBPACK_IMPORTED_MODULE_5__.c)(this.parallax.anchorPoint,this.parallaxNew.anchorPoint),this._fadeState.value=A.SHOW;break;case A.FADE_IN:this._fadeState.value=A.SHOW;break;case A.FADE_OUT:this._fadeState.value=A.HIDE;break;case A.SHOW:case A.HIDE:break;default:(0,_core_compilerUtils_js__WEBPACK_IMPORTED_MODULE_0__.Xb)(this.fadeState)}}_switchReadChannels(){this.data?.state===_Clouds_js__WEBPACK_IMPORTED_MODULE_9__.tf.Ready&&(this._readChannels=1-this._readChannels,this.data.state=_Clouds_js__WEBPACK_IMPORTED_MODULE_9__.tf.Fading)}get isFading(){return this.fadeState===A.FADE_OUT||this.fadeState===A.FADE_IN||this.fadeState===A.CROSS_FADE}}!function(a){a[a.HIDE=0]="HIDE",a[a.FADE_IN=1]="FADE_IN",a[a.SHOW=2]="SHOW",a[a.CROSS_FADE=3]="CROSS_FADE",a[a.FADE_OUT=4]="FADE_OUT"}(A||(A={}));class O{constructor(){this.anchorPoint=(0,_core_libs_gl_matrix_2_factories_vec3f64_js__WEBPACK_IMPORTED_MODULE_6__.vt)(),this.radiusCurvatureCorrection=0,this.transform=(0,_core_libs_gl_matrix_2_factories_mat4f64_js__WEBPACK_IMPORTED_MODULE_4__.vt)()}}const C=(0,_core_libs_gl_matrix_2_factories_vec3f64_js__WEBPACK_IMPORTED_MODULE_6__.fA)(0,0,1),v=(0,_geometry_support_axisAngleDegrees_js__WEBPACK_IMPORTED_MODULE_7__.vt)(),g=(0,_core_libs_gl_matrix_2_factories_vec3f64_js__WEBPACK_IMPORTED_MODULE_6__.vt)(),H=1.25,w=.5,I=2e5},"./node_modules/@arcgis/core/views/3d/environment/weather.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{k9:()=>weather_i,zF:()=>weather_p});var c,tslib_es6=__webpack_require__("./node_modules/@arcgis/core/chunks/tslib.es6.js"),JSONSupport=__webpack_require__("./node_modules/@arcgis/core/core/JSONSupport.js"),property=__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/decorators/property.js"),enumeration=(__webpack_require__("./node_modules/@arcgis/core/core/has.js"),__webpack_require__("./node_modules/@arcgis/core/core/Logger.js"),__webpack_require__("./node_modules/@arcgis/core/core/RandomLCG.js"),__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/decorators/enumeration.js")),subclass=__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/decorators/subclass.js");let p=c=class extends JSONSupport.A{constructor(o){super(o),this.type="cloudy",this.cloudCover=.5}clone(){return new c({cloudCover:this.cloudCover})}};(0,tslib_es6._)([(0,enumeration.e)({cloudy:"cloudy"}),(0,property.MZ)({json:{write:{isRequired:!0}}})],p.prototype,"type",void 0),(0,tslib_es6._)([(0,property.MZ)({type:Number,nonNullable:!0,range:{min:0,max:1},json:{write:!0}})],p.prototype,"cloudCover",void 0),p=c=(0,tslib_es6._)([(0,subclass.$)("esri.views.3d.environment.CloudyWeather")],p);const i=p;var FoggyWeather_p;let FoggyWeather_c=FoggyWeather_p=class extends JSONSupport.A{constructor(o){super(o),this.type="foggy",this.fogStrength=.5}clone(){return new FoggyWeather_p({fogStrength:this.fogStrength})}};(0,tslib_es6._)([(0,enumeration.e)({foggy:"foggy"}),(0,property.MZ)({json:{write:{isRequired:!0}}})],FoggyWeather_c.prototype,"type",void 0),(0,tslib_es6._)([(0,property.MZ)({type:Number,nonNullable:!0,range:{min:0,max:1},json:{write:!0}})],FoggyWeather_c.prototype,"fogStrength",void 0),FoggyWeather_c=FoggyWeather_p=(0,tslib_es6._)([(0,subclass.$)("esri.views.3d.environment.FoggyWeather")],FoggyWeather_c);const FoggyWeather_i=FoggyWeather_c;var s;let RainyWeather_p=s=class extends JSONSupport.A{constructor(o){super(o),this.type="rainy",this.cloudCover=.5,this.precipitation=.5}clone(){return new s({cloudCover:this.cloudCover,precipitation:this.precipitation})}};(0,tslib_es6._)([(0,enumeration.e)({rainy:"rainy"}),(0,property.MZ)({json:{write:{isRequired:!0}}})],RainyWeather_p.prototype,"type",void 0),(0,tslib_es6._)([(0,property.MZ)({type:Number,nonNullable:!0,range:{min:0,max:1},json:{write:!0}})],RainyWeather_p.prototype,"cloudCover",void 0),(0,tslib_es6._)([(0,property.MZ)({type:Number,nonNullable:!0,range:{min:0,max:1},json:{write:!0}})],RainyWeather_p.prototype,"precipitation",void 0),RainyWeather_p=s=(0,tslib_es6._)([(0,subclass.$)("esri.views.3d.environment.RainyWeather")],RainyWeather_p);const n=RainyWeather_p;var SnowyWeather_i;let SnowyWeather_p=SnowyWeather_i=class extends JSONSupport.A{constructor(o){super(o),this.type="snowy",this.cloudCover=.5,this.precipitation=.5,this.snowCover="disabled"}clone(){return new SnowyWeather_i({cloudCover:this.cloudCover,precipitation:this.precipitation,snowCover:this.snowCover})}};(0,tslib_es6._)([(0,enumeration.e)({snowy:"snowy"}),(0,property.MZ)({json:{write:{isRequired:!0}}})],SnowyWeather_p.prototype,"type",void 0),(0,tslib_es6._)([(0,property.MZ)({type:Number,nonNullable:!0,range:{min:0,max:1},json:{write:!0}})],SnowyWeather_p.prototype,"cloudCover",void 0),(0,tslib_es6._)([(0,property.MZ)({type:Number,nonNullable:!0,range:{min:0,max:1},json:{write:!0}})],SnowyWeather_p.prototype,"precipitation",void 0),(0,tslib_es6._)([(0,property.MZ)({type:["enabled","disabled"],nonNullable:!0,json:{write:!0}})],SnowyWeather_p.prototype,"snowCover",void 0),SnowyWeather_p=SnowyWeather_i=(0,tslib_es6._)([(0,subclass.$)("esri.views.3d.environment.SnowyWeather")],SnowyWeather_p);const SnowyWeather_n=SnowyWeather_p;var SunnyWeather_c;let SunnyWeather_n=SunnyWeather_c=class extends JSONSupport.A{constructor(o){super(o),this.type="sunny",this.cloudCover=.5}clone(){return new SunnyWeather_c({cloudCover:this.cloudCover})}};(0,tslib_es6._)([(0,enumeration.e)({sunny:"sunny"}),(0,property.MZ)({json:{write:{isRequired:!0}}})],SunnyWeather_n.prototype,"type",void 0),(0,tslib_es6._)([(0,property.MZ)({type:Number,nonNullable:!0,range:{min:0,max:1},json:{write:!0}})],SunnyWeather_n.prototype,"cloudCover",void 0),SunnyWeather_n=SunnyWeather_c=(0,tslib_es6._)([(0,subclass.$)("esri.views.3d.environment.SunnyWeather")],SunnyWeather_n);const weather_n={key:"type",base:SunnyWeather_n,typeMap:{sunny:SunnyWeather_n,cloudy:i,rainy:n,snowy:SnowyWeather_n,foggy:FoggyWeather_i}};Object.keys(weather_n.typeMap);const weather_p=1e4,weather_i=1e5},"./node_modules/@arcgis/core/views/3d/support/engineContent/line.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{t:()=>b,z:()=>R});var _core_libs_gl_matrix_2_math_vec2_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@arcgis/core/core/libs/gl-matrix-2/math/vec2.js"),_core_libs_gl_matrix_2_factories_vec2f64_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@arcgis/core/core/libs/gl-matrix-2/factories/vec2f64.js"),_core_libs_gl_matrix_2_factories_vec4f64_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@arcgis/core/core/libs/gl-matrix-2/factories/vec4f64.js"),_geometry_ellipsoidUtils_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@arcgis/core/geometry/ellipsoidUtils.js"),_geometry_projection_projectors_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/@arcgis/core/geometry/projection/projectors.js"),_geometry_support_DoubleArray_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/@arcgis/core/geometry/support/DoubleArray.js"),_geometry_support_FloatArray_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./node_modules/@arcgis/core/geometry/support/FloatArray.js"),_geometry_support_Indices_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./node_modules/@arcgis/core/geometry/support/Indices.js"),_ViewingMode_js__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./node_modules/@arcgis/core/views/ViewingMode.js"),_webgl_engine_lib_Attribute_js__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/lib/Attribute.js"),_webgl_engine_lib_ContentObjectType_js__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/lib/ContentObjectType.js"),_webgl_engine_lib_Geometry_js__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/lib/Geometry.js"),_webgl_engine_lib_VertexAttribute_js__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/lib/VertexAttribute.js");function b(t,e,r=null){const o=[],n=e.mapPositions;!function g(t,e){const{attributeData:{position:r},removeDuplicateStartEnd:o}=t,n=function A(t){const e=t.length;return t[0]===t[e-3]&&t[1]===t[e-2]&&t[2]===t[e-1]}(r)&&o,i=r.length/3-(n?1:0),a=new Array(2*(i-1)),l=n?r.slice(0,-3):r;let u=0;for(let s=0;s<i-1;s++)a[u++]=s,a[u++]=s+1;e.push([_webgl_engine_lib_VertexAttribute_js__WEBPACK_IMPORTED_MODULE_12__.r.POSITION,new _webgl_engine_lib_Attribute_js__WEBPACK_IMPORTED_MODULE_9__.n(l,a,3,n)])}(e,o);const i=o[0][1].data,a=o[0][1].indices.length,l=(0,_geometry_support_Indices_js__WEBPACK_IMPORTED_MODULE_7__.EH)(a);return function h(t,e,r){if(null!=t.attributeData.colorFeature)return;const n=t.attributeData.color;e.push([_webgl_engine_lib_VertexAttribute_js__WEBPACK_IMPORTED_MODULE_12__.r.COLOR,new _webgl_engine_lib_Attribute_js__WEBPACK_IMPORTED_MODULE_9__.n(n??_core_libs_gl_matrix_2_factories_vec4f64_js__WEBPACK_IMPORTED_MODULE_2__.Un,r,4)])}(e,o,l),function j(t,e,r){null==t.attributeData.sizeFeature&&e.push([_webgl_engine_lib_VertexAttribute_js__WEBPACK_IMPORTED_MODULE_12__.r.SIZE,new _webgl_engine_lib_Attribute_js__WEBPACK_IMPORTED_MODULE_9__.n([t.attributeData.size??1],r,1,!0)])}(e,o,l),function T(t,e,r){t.attributeData.normal&&e.push([_webgl_engine_lib_VertexAttribute_js__WEBPACK_IMPORTED_MODULE_12__.r.NORMAL,new _webgl_engine_lib_Attribute_js__WEBPACK_IMPORTED_MODULE_9__.n(t.attributeData.normal,r,3)])}(e,o,l),function D(t,e,r){null!=t.attributeData.colorFeature&&e.push([_webgl_engine_lib_VertexAttribute_js__WEBPACK_IMPORTED_MODULE_12__.r.COLORFEATUREATTRIBUTE,new _webgl_engine_lib_Attribute_js__WEBPACK_IMPORTED_MODULE_9__.n([t.attributeData.colorFeature],r,1,!0)])}(e,o,l),function w(t,e,r){null!=t.attributeData.sizeFeature&&e.push([_webgl_engine_lib_VertexAttribute_js__WEBPACK_IMPORTED_MODULE_12__.r.SIZEFEATUREATTRIBUTE,new _webgl_engine_lib_Attribute_js__WEBPACK_IMPORTED_MODULE_9__.n([t.attributeData.sizeFeature],r,1,!0)])}(e,o,l),function y(t,e,r){null!=t.attributeData.opacityFeature&&e.push([_webgl_engine_lib_VertexAttribute_js__WEBPACK_IMPORTED_MODULE_12__.r.OPACITYFEATUREATTRIBUTE,new _webgl_engine_lib_Attribute_js__WEBPACK_IMPORTED_MODULE_9__.n([t.attributeData.opacityFeature],r,1,!0)])}(e,o,l),function E(r,o,u){if(null==r.overlayInfo||r.overlayInfo.renderCoordsHelper.viewingMode!==_ViewingMode_js__WEBPACK_IMPORTED_MODULE_8__.RT.Global||!r.overlayInfo.spatialReference.isGeographic)return;const p=(0,_geometry_support_DoubleArray_js__WEBPACK_IMPORTED_MODULE_5__.jh)(u.length),f=(0,_geometry_ellipsoidUtils_js__WEBPACK_IMPORTED_MODULE_3__.tO)(r.overlayInfo.spatialReference);for(let t=0;t<p.length;t+=3)(0,_geometry_projection_projectors_js__WEBPACK_IMPORTED_MODULE_4__.RC)(u,t,p,t,f);const b=u.length/3,g=(0,_geometry_support_FloatArray_js__WEBPACK_IMPORTED_MODULE_6__.oe)(b+1);let h=I,T=F,D=0,j=0;(0,_core_libs_gl_matrix_2_math_vec2_js__WEBPACK_IMPORTED_MODULE_0__.hZ)(h,p[j++],p[j++]),j++,g[0]=0;for(let n=1;n<b+1;++n)n===b&&(j=0),(0,_core_libs_gl_matrix_2_math_vec2_js__WEBPACK_IMPORTED_MODULE_0__.hZ)(T,p[j++],p[j++]),j++,D+=(0,_core_libs_gl_matrix_2_math_vec2_js__WEBPACK_IMPORTED_MODULE_0__.xg)(h,T),g[n]=D,[h,T]=[T,h];o.push([_webgl_engine_lib_VertexAttribute_js__WEBPACK_IMPORTED_MODULE_12__.r.DISTANCETOSTART,new _webgl_engine_lib_Attribute_js__WEBPACK_IMPORTED_MODULE_9__.n(g,o[0][1].indices,1,!0)])}(e,o,i),new _webgl_engine_lib_Geometry_js__WEBPACK_IMPORTED_MODULE_11__.V(t,o,n,_webgl_engine_lib_ContentObjectType_js__WEBPACK_IMPORTED_MODULE_10__.X.Line,r)}const I=(0,_core_libs_gl_matrix_2_factories_vec2f64_js__WEBPACK_IMPORTED_MODULE_1__.vt)(),F=(0,_core_libs_gl_matrix_2_factories_vec2f64_js__WEBPACK_IMPORTED_MODULE_1__.vt)();function R(t,e){if(null==t||0===t.length)return[];const r=[];return t.forEach((t=>{const o=t.length,n=(0,_geometry_support_DoubleArray_js__WEBPACK_IMPORTED_MODULE_5__.jh)(3*o);t.forEach(((t,e)=>{n[3*e]=t[0],n[3*e+1]=t[1],n[3*e+2]=t[2]}));const i={attributeData:{position:n,normal:e},removeDuplicateStartEnd:!1};r.push(i)})),r}},"./node_modules/@arcgis/core/views/3d/support/renderInfoUtils/line.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>l,C:()=>p});var _geometry_projection_projectBuffer_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@arcgis/core/geometry/projection/projectBuffer.js"),_geometry_support_DoubleArray_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@arcgis/core/geometry/support/DoubleArray.js"),_geometry_support_triangulationUtils_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@arcgis/core/geometry/support/triangulationUtils.js"),_layers_graphics_elevationAlignmentUtils_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@arcgis/core/views/3d/layers/graphics/elevationAlignmentUtils.js"),_terrain_OverlayRenderer_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/@arcgis/core/views/3d/terrain/OverlayRenderer.js");function p(o,t,s,p){const l="polygon"===o.type?_geometry_support_triangulationUtils_js__WEBPACK_IMPORTED_MODULE_2__.Wq.CCW_IS_HOLE:_geometry_support_triangulationUtils_js__WEBPACK_IMPORTED_MODULE_2__.Wq.NONE,a="polygon"===o.type?o.rings:o.paths,{position:u,outlines:f}=(0,_geometry_support_triangulationUtils_js__WEBPACK_IMPORTED_MODULE_2__.oR)(a,!!o.hasZ,l,o.spatialReference),m=(0,_geometry_support_DoubleArray_js__WEBPACK_IMPORTED_MODULE_1__.jh)(u.length),g=(0,_layers_graphics_elevationAlignmentUtils_js__WEBPACK_IMPORTED_MODULE_3__.au)(u,o.spatialReference,0,m,0,u,0,u.length/3,t,s,p),y=null!=g;return{lines:y?c(f,u,m):[],projectionSuccess:y,sampledElevation:g}}function l(e,t){const i="polygon"===e.type?_geometry_support_triangulationUtils_js__WEBPACK_IMPORTED_MODULE_2__.Wq.CCW_IS_HOLE:_geometry_support_triangulationUtils_js__WEBPACK_IMPORTED_MODULE_2__.Wq.NONE,p="polygon"===e.type?e.rings:e.paths,{position:l,outlines:a}=(0,_geometry_support_triangulationUtils_js__WEBPACK_IMPORTED_MODULE_2__.oR)(p,!1,i),u=(0,_geometry_projection_projectBuffer_js__WEBPACK_IMPORTED_MODULE_0__.projectBuffer)(l,e.spatialReference,0,l,t,0);for(let o=2;o<l.length;o+=3)l[o]=_terrain_OverlayRenderer_js__WEBPACK_IMPORTED_MODULE_4__.bi;return{lines:u?c(a,l):[],projectionSuccess:u}}function c(o,e,n=null){const r=new Array;for(const{index:i,count:s}of o){if(s<=1)continue;const o=3*i,p=3*s;r.push({position:(0,_geometry_support_DoubleArray_js__WEBPACK_IMPORTED_MODULE_1__.l5)(e,3*i,3*s),mapPositions:null!=n?(0,_geometry_support_DoubleArray_js__WEBPACK_IMPORTED_MODULE_1__.l5)(n,o,p):void 0})}return r}},"./node_modules/@arcgis/core/views/3d/terrain/OverlayRenderer.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{bi:()=>te});var OverlayContent_o,tslib_es6=__webpack_require__("./node_modules/@arcgis/core/chunks/tslib.es6.js"),Evented=__webpack_require__("./node_modules/@arcgis/core/core/Evented.js"),has=__webpack_require__("./node_modules/@arcgis/core/core/has.js"),MapUtils=__webpack_require__("./node_modules/@arcgis/core/core/MapUtils.js"),maybe=__webpack_require__("./node_modules/@arcgis/core/core/maybe.js"),PooledArray=__webpack_require__("./node_modules/@arcgis/core/core/PooledArray.js"),reactiveUtils=__webpack_require__("./node_modules/@arcgis/core/core/reactiveUtils.js"),SetUtils=__webpack_require__("./node_modules/@arcgis/core/core/SetUtils.js"),property=__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/decorators/property.js"),Logger=__webpack_require__("./node_modules/@arcgis/core/core/Logger.js"),subclass=(__webpack_require__("./node_modules/@arcgis/core/core/RandomLCG.js"),__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/decorators/subclass.js")),mat4=__webpack_require__("./node_modules/@arcgis/core/core/libs/gl-matrix-2/math/mat4.js"),vec32=__webpack_require__("./node_modules/@arcgis/core/chunks/vec32.js"),vec3f64=__webpack_require__("./node_modules/@arcgis/core/core/libs/gl-matrix-2/factories/vec3f64.js"),interfaces=__webpack_require__("./node_modules/@arcgis/core/views/3d/layers/interfaces.js"),debugFlags=__webpack_require__("./node_modules/@arcgis/core/views/3d/support/debugFlags.js"),terrain_interfaces=__webpack_require__("./node_modules/@arcgis/core/views/3d/terrain/interfaces.js"),aaBoundingRect=__webpack_require__("./node_modules/@arcgis/core/geometry/support/aaBoundingRect.js"),LocalOriginFactory=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/lib/LocalOriginFactory.js");class Overlay_n{constructor(){this._extent=(0,aaBoundingRect.vt)(),this.resolution=0,this.renderLocalOrigin=(0,LocalOriginFactory.f)(0,0,0,"O"),this.pixelRatio=1,this.mapUnitsPerPixel=1,this.canvasGeometries=new Overlay_r}get extent(){return this._extent}setupGeometryViewsCyclical(e){this.setupGeometryView();const s=.001*e.range;if(this._extent[0]-s<=e.min){const s=this.canvasGeometries.extents[this.canvasGeometries.numViews++];(0,aaBoundingRect.cY)(this._extent,e.range,0,s)}if(this._extent[2]+s>=e.max){const s=this.canvasGeometries.extents[this.canvasGeometries.numViews++];(0,aaBoundingRect.cY)(this._extent,-e.range,0,s)}}setupGeometryView(){this.canvasGeometries.numViews=1,(0,aaBoundingRect.C)(this.canvasGeometries.extents[0],this._extent)}hasSomeSizedView(){for(let e=0;e<this.canvasGeometries.numViews;e++){const t=this.canvasGeometries.extents[e];if(t[0]!==t[2]&&t[1]!==t[3])return!0}return!1}}class Overlay_r{constructor(){this.extents=[(0,aaBoundingRect.vt)(),(0,aaBoundingRect.vt)(),(0,aaBoundingRect.vt)()],this.numViews=0}}!function(o){o[o.Color=0]="Color",o[o.ColorNoRasterImage=1]="ColorNoRasterImage",o[o.Highlight=2]="Highlight",o[o.WaterNormal=3]="WaterNormal",o[o.Occluded=4]="Occluded",o[o.ObjectAndLayerIdColor=5]="ObjectAndLayerIdColor"}(OverlayContent_o||(OverlayContent_o={}));class OverlayFramebufferObject_t{constructor(e,t,h){this._fbos=e,this._format=t,this._name=h}get valid(){return null!=this._handle?.getTexture()}dispose(){this._handle=(0,maybe.Gz)(this._handle)}get texture(){return this._handle?.getTexture()}bind(e,t,h){this._handle&&this._handle.fbo?.width===t&&this._handle.fbo?.height===h||(this._handle?.release(),this._handle=this._fbos.acquire(t,h,this._name,this._format)),e.bindFramebuffer(this._handle?.fbo)}generateMipMap(){this._handle?.getTexture()?.descriptor?.hasMipmap&&this._handle?.getTexture()?.generateMipmap()}}var formats=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl/formats.js"),ShaderOutput=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/ShaderOutput.js"),olidUtils=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/effects/geometry/olidUtils.js");class OverlayRenderTargets_s{constructor(e,t,l,s,i=formats.N.RGBA_MIPMAP){this.output=l,this.content=s,this.fbo=new OverlayFramebufferObject_t(e,i,t)}get valid(){return this.fbo.valid}}class OverlayRenderTargets_i{constructor(r){this.targets=[new OverlayRenderTargets_s(r,"overlay color",ShaderOutput.V.Color,OverlayContent_o.Color),new OverlayRenderTargets_s(r,"overlay IM color",ShaderOutput.V.Color,OverlayContent_o.ColorNoRasterImage),new OverlayRenderTargets_s(r,"overlay highlight",ShaderOutput.V.Highlight,OverlayContent_o.Highlight,formats.N.RG),new OverlayRenderTargets_s(r,"overlay water",ShaderOutput.V.Normal,OverlayContent_o.WaterNormal),new OverlayRenderTargets_s(r,"overlay occluded",ShaderOutput.V.Color,OverlayContent_o.Occluded)],(0,olidUtils.E)()&&this.targets.push(new OverlayRenderTargets_s(r,"overlay olid",ShaderOutput.V.ObjectAndLayerIdColor,OverlayContent_o.ObjectAndLayerIdColor,formats.N.RGBA))}getTexture(e){return this.targets[e]?.fbo.texture}dispose(){for(const e of this.targets)e.fbo.dispose()}computeValidity(){return this.targets.reduce(((e,r,o)=>r.valid?e|=1<<o:e),0)}}var RenderPassIdentifier_a,RenderCamera=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl/RenderCamera.js"),vec4f64=__webpack_require__("./node_modules/@arcgis/core/core/libs/gl-matrix-2/factories/vec4f64.js");!function(a){a[a.Material=0]="Material",a[a.ShadowMap=1]="ShadowMap",a[a.Highlight=2]="Highlight",a[a.ViewshedShadowMap=3]="ViewshedShadowMap"}(RenderPassIdentifier_a||(RenderPassIdentifier_a={}));__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/shading/MainLighting.glsl.js"),__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/shading/PhysicallyBasedRenderingParameters.glsl.js"),__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/shading/Water.glsl.js"),__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderModules/Float4DrawUniform.js"),__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderModules/FloatPassUniform.js"),__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderModules/glsl.js"),__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderModules/Texture2DPassUniform.js");var C,Uniform=__webpack_require__("./node_modules/@arcgis/core/views/webgl/Uniform.js");!function(e){e[e.Disabled=0]="Disabled",e[e.Enabled=1]="Enabled",e[e.EnabledWithWater=2]="EnabledWithWater",e[e.COUNT=3]="COUNT"}(C||(C={}));(0,vec4f64.vt)();Uniform.n;var TextureOnly_glsl=__webpack_require__("./node_modules/@arcgis/core/chunks/TextureOnly.glsl.js"),RenderPlugin=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/effects/RenderPlugin.js"),vec2=__webpack_require__("./node_modules/@arcgis/core/core/libs/gl-matrix-2/math/vec2.js"),webgl=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl.js"),RenderNode=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl/RenderNode.js"),ReloadableShaderModule=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderTechnique/ReloadableShaderModule.js"),ShaderTechnique=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderTechnique/ShaderTechnique.js"),HighlightApply_glsl=__webpack_require__("./node_modules/@arcgis/core/chunks/HighlightApply.glsl.js"),renderState=__webpack_require__("./node_modules/@arcgis/core/views/webgl/renderState.js");class HighlightApplyTechnique_t extends ShaderTechnique.w{constructor(r,o){super(r,o,new ReloadableShaderModule.$(HighlightApply_glsl.H,(()=>__webpack_require__.e(5379).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@arcgis/core/views/3d/webgl-engine/shaders/HighlightApply.glsl.js")))))}initializePipeline(){return(0,renderState.Ey)({blending:renderState.Ky,colorWrite:renderState.kn})}}var HighlightDownsample_glsl=__webpack_require__("./node_modules/@arcgis/core/chunks/HighlightDownsample.glsl.js");class HighlightDownsampleTechnique_l extends ShaderTechnique.w{constructor(r,s){super(r,s,new ReloadableShaderModule.$(HighlightDownsample_glsl.a,(()=>__webpack_require__.e(7965).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@arcgis/core/views/3d/webgl-engine/shaders/HighlightDownsample.glsl.js")))))}initializePipeline(){return(0,renderState.Ey)({colorWrite:renderState.kn})}}var HighlightDefaults=__webpack_require__("./node_modules/@arcgis/core/views/support/HighlightDefaults.js"),NoParameters=__webpack_require__("./node_modules/@arcgis/core/views/webgl/NoParameters.js");class e extends NoParameters.Y{constructor(){super(...arguments),this.occludedFactor=HighlightDefaults.cD,this.verticalCellCount=0,this.horizontalCellCount=0,this.highlightLevel=0,this.pixelRatio=1}}var HighlightToSingle_glsl=__webpack_require__("./node_modules/@arcgis/core/chunks/HighlightToSingle.glsl.js");class HighlightToSingleTechnique_l extends ShaderTechnique.w{constructor(r,o){super(r,o,new ReloadableShaderModule.$(HighlightToSingle_glsl.H,(()=>__webpack_require__.e(3360).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@arcgis/core/views/3d/webgl-engine/shaders/HighlightToSingle.glsl.js")))))}initializePipeline(){return(0,renderState.Ey)({colorWrite:renderState.kn})}}var SingleHighlightApply_glsl=__webpack_require__("./node_modules/@arcgis/core/chunks/SingleHighlightApply.glsl.js");class SingleHighlightApplyTechnique_t extends ShaderTechnique.w{constructor(r,l){super(r,l,new ReloadableShaderModule.$(SingleHighlightApply_glsl.S,(()=>__webpack_require__.e(7963).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@arcgis/core/views/3d/webgl-engine/shaders/SingleHighlightApply.glsl.js")))))}initializePipeline(){return(0,renderState.Ey)({blending:renderState.Ky,colorWrite:renderState.kn})}}var SingleHighlightBlur_glsl=__webpack_require__("./node_modules/@arcgis/core/chunks/SingleHighlightBlur.glsl.js");class SingleHighlightBlurTechnique_s extends ShaderTechnique.w{constructor(r,l){super(r,l,new ReloadableShaderModule.$(SingleHighlightBlur_glsl.a,(()=>__webpack_require__.e(8332).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@arcgis/core/views/3d/webgl-engine/shaders/SingleHighlightBlur.glsl.js")))))}initializePipeline(){return(0,renderState.Ey)({colorWrite:renderState.kn})}}var basicInterfaces=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/lib/basicInterfaces.js"),DefaultVertexAttributeLocations=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/lib/DefaultVertexAttributeLocations.js"),DefaultVertexBufferLayouts=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/lib/DefaultVertexBufferLayouts.js"),VertexArrayObject=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/lib/VertexArrayObject.js"),BufferObject=__webpack_require__("./node_modules/@arcgis/core/views/webgl/BufferObject.js"),enums=__webpack_require__("./node_modules/@arcgis/core/views/webgl/enums.js"),Texture=__webpack_require__("./node_modules/@arcgis/core/views/webgl/Texture.js"),TextureDescriptor=__webpack_require__("./node_modules/@arcgis/core/views/webgl/TextureDescriptor.js");let Highlight_I=class extends RenderNode.A{constructor(){super(...arguments),this.produces=webgl.OG.HIGHLIGHTS,this.consumes={required:[webgl.OG.HIGHLIGHTS,"highlights"]},this._useMultipleHighlights=!1,this._downsampleDrawParameters=new HighlightDownsample_glsl.H,this._passParameters=new e,this._singleHighlightBlurDrawParameters=new SingleHighlightBlur_glsl.S,this._grid=new M}initialize(){this.addHandles([(0,reactiveUtils.watch)((()=>this._updateOptionsTexture()),(()=>{}),reactiveUtils.Vh)])}destroy(){this._grid.coverage=(0,maybe.Gz)(this._grid.coverage),this._grid.vao=(0,maybe.WD)(this._grid.vao),this._passParameters.highlightOptionsTexture=(0,maybe.Gz)(this._passParameters.highlightOptionsTexture)}_updateOptionsTexture(){if(null==this._passParameters.highlightOptionsTexture){const e=new TextureDescriptor.R(16,2);e.internalFormat=enums.Ab.RGBA,e.samplingMode=enums.Cj.NEAREST,this._passParameters.highlightOptionsTexture=new Texture.g(this.renderingContext,e,null)}this._passParameters.highlightOptionsTexture.setData(function U(e){const t=new Uint8Array(128);let i=0;for(const r of e){const e=4*i,s=4*i+64;++i;const{color:o}=r,h=r.haloColor??o;t[e+0]=o.r,t[e+1]=o.g,t[e+2]=o.b,t[e+3]=r.fillOpacity*o.a*255,t[s+0]=h.r,t[s+1]=h.g,t[s+2]=h.b,t[s+3]=r.haloOpacity*h.a*255}return t}(this.view.state.highlights)),this.requestRender(basicInterfaces.C7.UPDATE)}precompile(){this.techniques.precompile(HighlightDownsampleTechnique_l),this._useMultipleHighlights?this.techniques.precompile(HighlightApplyTechnique_t):(this.techniques.precompile(HighlightToSingleTechnique_l),this.techniques.precompile(SingleHighlightBlurTechnique_s),this.techniques.precompile(SingleHighlightApplyTechnique_t))}render(e){const t=e.find((({name:e})=>e===webgl.OG.HIGHLIGHTS)),{techniques:i,bindParameters:r,_passParameters:s,renderingContext:o}=this;if(!r.decorations)return t;const h=i.get(HighlightDownsampleTechnique_l);if(!h.compiled)return this.requestRender(basicInterfaces.C7.UPDATE),t;const l=e.find((({name:e})=>"highlights"===e)).getTexture(),n=()=>{this._gridUpdateResources(l);const e=this._gridComputeCoverage(h,l,r),{horizontalCellCount:t,verticalCellCount:i}=e;return s.horizontalCellCount=t,s.verticalCellCount=i,s.coverageTexture=e.coverage?.getTexture(),e},g=e=>{const t=e.verticalCellCount*e.horizontalCellCount;o.bindVAO(e.vao),o.drawElementsInstanced(enums.WR.TRIANGLES,6,enums.pe.UNSIGNED_BYTE,0,t)},{camera:c}=r,u=()=>{o.bindFramebuffer(t.fbo),o.setViewport4fv(c.fullViewport)};return this._useMultipleHighlights?this._renderMultiple(l,n,g,u):this._renderSingle(l,n,g,u),s.highlightTexture=null,s.coverageTexture=null,t}_renderMultiple(e,t,i,r){const{techniques:s,bindParameters:o,_passParameters:h,renderingContext:l}=this,n=s.get(HighlightApplyTechnique_t);if(!n.compiled)return void this.requestRender(basicInterfaces.C7.UPDATE);const a=t();h.highlightTexture=e,h.pixelRatio=o.camera.pixelRatio,l.bindTechnique(n,o,h),r(),i(a)}_renderSingle(e,t,i,r){const{fboCache:s,techniques:o,bindParameters:h,_passParameters:n,renderingContext:a}=this,c=o.get(HighlightToSingleTechnique_l),u=o.get(SingleHighlightBlurTechnique_s),m=o.get(SingleHighlightApplyTechnique_t);if(!m.compiled||!u.compiled||!c.compiled)return void this.requestRender(basicInterfaces.C7.UPDATE);const p=t(),{width:w,height:x}=e.descriptor;n.highlightTexture=e;const{camera:_}=h,{fullWidth:C,fullHeight:v,pixelRatio:j}=_,H=Math.ceil(C/j),q=Math.ceil(v/j),{_singleHighlightBlurDrawParameters:P}=this,D=this.view._stage.renderView.renderer,{highlights:O}=h;for(let d=0;d<O.length;++d){const{name:e}=O[d];if(!D.hasHighlightOptions(e))continue;n.highlightLevel=d,a.setClearColor(0,0,0,0);const t=s.acquire(w,x,"single highlight",formats.N.RG);a.bindFramebuffer(t.fbo),a.setViewport(0,0,w,x),a.clear(enums.NV.COLOR),a.bindTechnique(c,h,n),i(p),P.blurInput=t.getTexture(),(0,vec2.hZ)(P.blurSize,1/H,0);const o=s.acquire(H,q,"single highlight blur h",formats.N.RG);a.unbindTexture(o.fbo?.colorTexture),a.bindFramebuffer(o.fbo),a.setViewport(0,0,H,q),a.clear(enums.NV.COLOR),a.bindTechnique(u,h,n,P),i(p),t.release(),(0,vec2.hZ)(P.blurSize,0,1/q),n.singleHighlightBlurTexture=o.getTexture(),r(),a.bindTechnique(m,h,n,P),i(p),o.release()}}_gridUpdateResources(e){const t=this._grid,{width:i,height:r}=e.descriptor;if(t.horizontalCellCount=Math.ceil(i/HighlightDownsample_glsl.g),t.verticalCellCount=Math.ceil(r/HighlightDownsample_glsl.g),t.vao)return;const s=this.renderingContext,o=BufferObject.g.createIndex(s,enums._U.STATIC_DRAW,F);t.vao=new VertexArrayObject.Z(s,DefaultVertexAttributeLocations.D,new Map([["geometry",DefaultVertexBufferLayouts.wR]]),new Map([["geometry",BufferObject.g.createVertex(s,enums._U.STATIC_DRAW)]]),o)}_gridComputeCoverage(e,t,i){const r=this.renderingContext,s=this._grid,o=t.descriptor,h=Math.ceil(o.width/HighlightDownsample_glsl.g),l=Math.ceil(o.height/HighlightDownsample_glsl.g);this._downsampleDrawParameters.input=t,s.coverage?.release();const n=this.fboCache.acquire(h,l,"highlight coverage",formats.N.RG);return s.coverage=n,r.bindFramebuffer(n.fbo),r.bindTechnique(e,i,this._passParameters,this._downsampleDrawParameters),r.setViewport(0,0,h,l),r.screen.draw(),s}get test(){}};(0,tslib_es6._)([(0,property.MZ)()],Highlight_I.prototype,"produces",void 0),(0,tslib_es6._)([(0,property.MZ)()],Highlight_I.prototype,"consumes",void 0),Highlight_I=(0,tslib_es6._)([(0,subclass.$)("esri.views.3d.webgl-engine.effects.highlight.Highlight")],Highlight_I);class M{constructor(){this.coverage=null,this.vao=null,this.verticalCellCount=0,this.horizontalCellCount=0,this.viewportWidth=0,this.viewportHeight=0}}let G=0;const F=new Uint8Array([0,1,2,2,1,3]);var NestedMap=__webpack_require__("./node_modules/@arcgis/core/core/NestedMap.js"),Util=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/lib/Util.js");class GLMaterialRepository_s{constructor(e,t,i,s){this._textures=e,this._techniques=t,this.materialChanged=i,this.requestRender=s,this._id2glMaterialRef=new NestedMap.O}dispose(){this._textures.destroy()}acquire(e,t,r){this._ownMaterial(e);const i=e.produces.get(t);if(!i?.(r))return null;let s=this._id2glMaterialRef.get(r,e.id);if(null==s){const t=e.createGLMaterial({material:e,techniques:this._techniques,textures:this._textures,output:r});s=new GLMaterialRepository_a(t),this._id2glMaterialRef.set(r,e.id,s)}return s.ref(),s.glMaterial}release(e,r){const i=this._id2glMaterialRef.get(r,e.id);null!=i&&(i.unref(),i.referenced||((0,maybe.WD)(i.glMaterial),this._id2glMaterialRef.delete(r,e.id)))}_ownMaterial(t){t.repository&&t.repository!==this&&Logger.A.getLogger("esri.views.3d.webgl-engine.lib.GLMaterialRepository").error("Material is already owned by a different material repository"),t.repository=this}}class GLMaterialRepository_a{constructor(e){this.glMaterial=e,this._refCnt=0}ref(){++this._refCnt}unref(){--this._refCnt,(0,Util.vA)(this._refCnt>=0)}get referenced(){return this._refCnt>0}}var Update_e,GridLocalOriginFactory=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/lib/GridLocalOriginFactory.js"),Material=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/lib/Material.js"),OITPass=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/lib/OITPass.js"),mat4f64=(__webpack_require__("./node_modules/@arcgis/core/core/time.js"),__webpack_require__("./node_modules/@arcgis/core/core/libs/gl-matrix-2/factories/mat4f64.js")),vec2f64=__webpack_require__("./node_modules/@arcgis/core/core/libs/gl-matrix-2/factories/vec2f64.js"),CloudsParameters=__webpack_require__("./node_modules/@arcgis/core/views/3d/environment/CloudsParameters.js"),HUDRenderStyle=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/hud/HUDRenderStyle.js"),RenderSlot=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/lib/RenderSlot.js");!function(e){e[e.Immediate=0]="Immediate",e[e.FadeWithWeather=1]="FadeWithWeather"}(Update_e||(Update_e={}));var SceneLighting=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/lighting/SceneLighting.js");class BindParameters_o{constructor(i){this.shadowMap=i,this.slot=RenderSlot.N.OPAQUE_MATERIAL,this.slicePlane=null,this.hasOccludees=!1,this.enableFillLights=!0,this.oitPass=OITPass.Y.NONE,this.alignPixelEnabled=!1,this.decorations=!0,this.overlayStretch=1,this.viewshedEnabled=!1,this._camera=new RenderCamera.A,this._inverseViewport=(0,vec2f64.vt)(),this._oldLighting=new SceneLighting.TA,this._newLighting=new SceneLighting.TA,this._fadedLighting=new SceneLighting.TA,this._lighting=this._newLighting,this.ssr=new BindParameters_c,this.terrainDepthTest=!1,this.cullAboveTerrain=!1,this.highlights=new Array,this.highlightOrderMap=new Map,this.highlightMixOrigin=(0,vec2f64.vt)(),this.highlightMixTexture=null,this.hudRenderStyle=HUDRenderStyle.D.Occluded,this.hudOccludedFragmentOpacity=1,this.clouds=new CloudsParameters.n,this.shadowHighlightsVisible=!1}get camera(){return this._camera}set camera(i){this._camera=i,this._inverseViewport[0]=1/i.fullViewport[2],this._inverseViewport[1]=1/i.fullViewport[3]}get inverseViewport(){return this._inverseViewport}get lighting(){return this._lighting}fadeLighting(){switch(this.clouds.fadeFactor){case 0:this._lighting=this._oldLighting;break;default:this._fadedLighting.lerpLighting(this._oldLighting,this._newLighting,this.clouds.fadeFactor),this._lighting=this._fadedLighting;break;case 1:this._lighting=this._newLighting,this._oldLighting.copyFrom(this._newLighting)}}updateLighting(i,t,h,e){this._oldLighting.copyFrom(this.lighting),this._newLighting.noonFactor=t,this._newLighting.globalFactor=h,this._newLighting.set(i),e===Update_e.FadeWithWeather&&this.clouds.requestFade(),this.fadeLighting()}get highlight(){return null==this.highlightLevel?null:this.highlights[this.highlightLevel]}}class BindParameters_c{constructor(){this.fadeFactor=1,this.reprojectionMatrix=(0,mat4f64.vt)()}}class RenderContext_a{constructor(r,i){this.rctx=r,this.lastFrameCamera=new RenderCamera.A,this.output=ShaderOutput.V.Color,this.renderOccludedMask=RenderContext_o,this.bind=new BindParameters_o(i),this.bind.alignPixelEnabled=!0}}const RenderContext_o=Material.m$.Occlude|Material.m$.OccludeAndTransparent|Material.m$.OccludeAndTransparentStencil;var mathUtils=__webpack_require__("./node_modules/@arcgis/core/core/mathUtils.js"),mat3f64=__webpack_require__("./node_modules/@arcgis/core/core/libs/gl-matrix-2/factories/mat3f64.js"),vec42=__webpack_require__("./node_modules/@arcgis/core/chunks/vec42.js"),ViewingMode=__webpack_require__("./node_modules/@arcgis/core/views/ViewingMode.js");let CascadeCamera_i=class extends RenderCamera.A{constructor(){super(...arguments),this._projectionMatrix=(0,mat4f64.vt)()}get projectionMatrix(){return this._projectionMatrix}};(0,tslib_es6._)([(0,property.MZ)()],CascadeCamera_i.prototype,"_projectionMatrix",void 0),(0,tslib_es6._)([(0,property.MZ)({readOnly:!0})],CascadeCamera_i.prototype,"projectionMatrix",null),CascadeCamera_i=(0,tslib_es6._)([(0,subclass.$)("esri.views.3d.webgl-engine.lib.CascadeCamera")],CascadeCamera_i);var P,textureUtils=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/lib/textureUtils.js");!function(t){t[t.Highlight=0]="Highlight",t[t.ExcludeHighlight=1]="ExcludeHighlight"}(P||(P={}));class q{constructor(){this.camera=new CascadeCamera_i,this.lightMat=(0,mat4f64.vt)()}}class ShadowMap_G{constructor(){this.maxNumCascadesHighQuality=4,this.maxNumCascadesLowQuality=4,this.textureSizeModHighQuality=1.3,this.textureSizeModLowQuality=.9,this.splitSchemeLambda=0}}class X{constructor(t,s){this._fbos=t,this._viewingMode=s,this._enabled=!1,this._snapshots=new Array,this._textureHeight=0,this._numCascades=1,this.settings=new ShadowMap_G,this._projectionView=(0,mat4f64.vt)(),this._projectionViewInverse=(0,mat4f64.vt)(),this._modelViewLight=(0,mat4f64.vt)(),this._cascadeDistances=[0,0,0,0,0],this._usedCascadeDistances=(0,vec4f64.vt)(),this._cascades=[new q,new q,new q,new q],this._lastOrigin=null,this._maxTextureWidth=Math.min((0,has.A)("esri-mobile")?4096:16384,t.rctx.parameters.maxTextureSize)}dispose(){this.enabled=!1,this.disposeOffscreenBuffers()}get depthTexture(){return this._handle?.getTexture()}get _textureWidth(){return this._textureHeight*this._numCascades}get numCascades(){return this._numCascades}get cascadeDistances(){return(0,vec42.s)(this._usedCascadeDistances,this._cascadeDistances[0],this._numCascades>1?this._cascadeDistances[1]:1/0,this._numCascades>2?this._cascadeDistances[2]:1/0,this._numCascades>3?this._cascadeDistances[3]:1/0)}disposeOffscreenBuffers(){this._handle=(0,maybe.Gz)(this._handle),this._discardSnapshots()}set maxCascades(s){this.settings.maxNumCascadesHighQuality=(0,mathUtils.qE)(Math.floor(s),1,4)}get maxCascades(){return this.settings.maxNumCascadesHighQuality}set enabled(t){this._enabled=t,t||this.disposeOffscreenBuffers()}get enabled(){return this._enabled}get ready(){return this._enabled&&null!=this.depthTexture}get cascades(){for(let t=0;t<this._numCascades;++t)it[t]=this._cascades[t];return it.length=this._numCascades,it}start(t,s,e,i,a){(0,Util.vA)(this.enabled);const{near:r,far:h}=function Tt(t){let{near:s,far:e}=t;return s<2&&(s=2),e<2&&(e=2),s>=e&&(s=2,e=4),{near:s,far:e}}(e);this._computeCascadeDistances(r,h,i),this._textureHeight=this._computeTextureHeight(t,a,i),this._setupMatrices(t,s);const{viewMatrix:o,projectionMatrix:n}=t;for(let c=0;c<this._numCascades;++c)this._constructCascade(c,n,o,s);this._lastOrigin=null,this.clear()}finish(){(0,Util.vA)(this.enabled),this._handle?.detachDepth()}getShadowMapMatrices(t){if(!this._lastOrigin||!(0,vec32.p)(t,this._lastOrigin)){this._lastOrigin=this._lastOrigin||(0,vec3f64.vt)(),(0,vec32.c)(this._lastOrigin,t);for(let s=0;s<this._numCascades;++s){(0,mat4.Tl)(at,this._cascades[s].lightMat,t);for(let t=0;t<16;++t)rt[16*s+t]=at[t]}}return rt}moveSnapshot(t){(0,Util.vA)(this.enabled),this._handle?.detachDepth(),this._snapshots[t]?.release(),this._snapshots[t]=this._handle,this._handle=null,this.clear()}copySnapshot(t){const s=this._handle?.getTexture()?.descriptor;if(!this.enabled||!s)return;this._snapshots[t]?.release();const{width:e,height:i}=s,a=t===P.Highlight?"shadow highlight snapshot":"shadow no highlight snapshot";this._snapshots[t]=this._fbos.acquire(e,i,a,formats.N.RGBA4);const r=this._fbos.rctx;this._bindFbo();const h=r.bindTexture(this._snapshots[t]?.getTexture(),Texture.g.TEXTURE_UNIT_FOR_UPDATES);r.gl.copyTexSubImage2D(enums.Ap.TEXTURE_2D,0,0,0,0,0,e,i),r.bindTexture(h,Texture.g.TEXTURE_UNIT_FOR_UPDATES)}getSnapshot(t){return this.enabled?this._snapshots[t]?.getTexture():null}clear(){const t=this._fbos.rctx;this._ensureFbo(),this._bindFbo(),t.setClearColor(1,1,1,1),t.clear(enums.NV.COLOR|enums.NV.DEPTH)}_computeTextureHeight(t,s,e){const i=Math.min(window.devicePixelRatio,s)/t.pixelRatio,a=e?this.settings.textureSizeModHighQuality:this.settings.textureSizeModLowQuality,r=(0,textureUtils.Mv)(Math.floor(Math.max(t.fullWidth,t.fullHeight)*i*a)),h=Math.min(this._maxTextureWidth,this._numCascades*r);return(0,textureUtils.uT)(h/this._numCascades)}_ensureFbo(){this._handle?.fbo?.width===this._textureWidth&&this._handle?.fbo.height===this._textureHeight||(this._handle?.release(),this._handle=this._fbos.acquire(this._textureWidth,this._textureHeight,"shadow map",formats.N.RGBA4)),this._handle?.acquireDepth(formats.z.DEPTH16_BUFFER)}_discardSnapshot(t){this._snapshots[t]=(0,maybe.Gz)(this._snapshots[t])}_discardSnapshots(){for(let t=0;t<this._snapshots.length;++t)this._discardSnapshot(t);this._snapshots.length=0}_bindFbo(){this._fbos.rctx.bindFramebuffer(this._handle?.fbo)}_constructCascade(t,s,e,i){const a=this._cascades[t],o=-this._cascadeDistances[t],n=-this._cascadeDistances[t+1],c=(s[10]*o+s[14])/Math.abs(s[11]*o+s[15]),l=(s[10]*n+s[14])/Math.abs(s[11]*n+s[15]);(0,Util.vA)(c<l);for(let r=0;r<8;++r){(0,vec42.s)(J,r%4==0||r%4==3?-1:1,r%4==0||r%4==1?-1:1,r<4?c:l,1);const t=K[r];(0,vec42.t)(t,J,this._projectionViewInverse),t[0]/=t[3],t[1]/=t[3],t[2]/=t[3]}(0,vec32.v)(et,K[0]),a.camera.viewMatrix=(0,mat4.Tl)(k,this._modelViewLight,et);for(let r=0;r<8;++r)(0,vec32.t)(K[r],K[r],a.camera.viewMatrix);let d=K[0][2],m=K[0][2];for(let r=1;r<8;++r)d=Math.min(d,K[r][2]),m=Math.max(m,K[r][2]);d-=200,m+=200,a.camera.near=-m,a.camera.far=-d,function jt(t,s,i,a,r){const h=1/K[0][3],o=1/K[4][3];(0,Util.vA)(h<o);let n=h+Math.sqrt(h*o);const c=Math.sin((0,mathUtils.XM)(t[2]*s[0]+t[6]*s[1]+t[10]*s[2]));n/=c,function gt(t,s,e,i,a,r,h,o){(0,vec2.hZ)(ht,0,0);for(let d=0;d<4;++d)(0,vec2.WQ)(ht,ht,t[d]);(0,vec2.hs)(ht,ht,.25),(0,vec2.hZ)(ot,0,0);for(let d=4;d<8;++d)(0,vec2.WQ)(ot,ot,t[d]);(0,vec2.hs)(ot,ot,.25),(0,vec2.Cc)(nt[0],t[4],t[5],.5),(0,vec2.Cc)(nt[1],t[5],t[6],.5),(0,vec2.Cc)(nt[2],t[6],t[7],.5),(0,vec2.Cc)(nt[3],t[7],t[4],.5);let n=0,c=(0,vec2.hG)(nt[0],ht);for(let d=1;d<4;++d){const t=(0,vec2.hG)(nt[d],ht);t<c&&(c=t,n=d)}(0,vec2.Re)(ct,nt[n],t[n+4]);const l=ct[0];let M,C;ct[0]=-ct[1],ct[1]=l,(0,vec2.Re)(lt,ot,ht),(0,vec2.Om)(lt,ct)<0&&(0,vec2.ze)(ct,ct),(0,vec2.Cc)(ct,ct,lt,e),(0,vec2.S8)(ct,ct),M=C=(0,vec2.Om)((0,vec2.Re)(dt,t[0],ht),ct);for(let d=1;d<8;++d){const s=(0,vec2.Om)((0,vec2.Re)(dt,t[d],ht),ct);s<M?M=s:s>C&&(C=s)}(0,vec2.C)(i,ht),(0,vec2.hs)(dt,ct,M-s),(0,vec2.WQ)(i,i,dt);let j=-1,T=1,y=0,D=0;for(let d=0;d<8;++d){(0,vec2.Re)(mt,t[d],i),(0,vec2.S8)(mt,mt);const s=ct[0]*mt[1]-ct[1]*mt[0];s>0?s>j&&(j=s,y=d):s<T&&(T=s,D=d)}(0,Util.MX)(j>0,"leftArea"),(0,Util.MX)(T<0,"rightArea"),(0,vec2.hs)(ut,ct,M),(0,vec2.WQ)(ut,ut,ht),(0,vec2.hs)(_t,ct,C),(0,vec2.WQ)(_t,_t,ht),ft[0]=-ct[1],ft[1]=ct[0];const H=(0,Util.L)(i,t[D],_t,(0,vec2.WQ)(dt,_t,ft),1,a),v=(0,Util.L)(i,t[y],_t,dt,1,r),S=(0,Util.L)(i,t[y],ut,(0,vec2.WQ)(dt,ut,ft),1,h),R=(0,Util.L)(i,t[D],ut,dt,1,o);(0,Util.MX)(H,"rayRay"),(0,Util.MX)(v,"rayRay"),(0,Util.MX)(S,"rayRay"),(0,Util.MX)(R,"rayRay")}(K,n,c,Y,Z,$,tt,st),function Ct(t,s,e,i,a){(0,vec2.Re)(wt,e,i),(0,vec2.hs)(wt,wt,.5),Mt[0]=wt[0],Mt[1]=wt[1],Mt[2]=0,Mt[3]=wt[1],Mt[4]=-wt[0],Mt[5]=0,Mt[6]=wt[0]*wt[0]+wt[1]*wt[1],Mt[7]=wt[0]*wt[1]-wt[1]*wt[0],Mt[8]=1,Mt[pt(0,2)]=-(0,vec2.Om)(bt(Mt,0),t),Mt[pt(1,2)]=-(0,vec2.Om)(bt(Mt,1),t);let r=(0,vec2.Om)(bt(Mt,0),e)+Mt[pt(0,2)],h=(0,vec2.Om)(bt(Mt,1),e)+Mt[pt(1,2)],o=(0,vec2.Om)(bt(Mt,0),i)+Mt[pt(0,2)],n=(0,vec2.Om)(bt(Mt,1),i)+Mt[pt(1,2)];r=-(r+o)/(h+n),Mt[pt(0,0)]+=Mt[pt(1,0)]*r,Mt[pt(0,1)]+=Mt[pt(1,1)]*r,Mt[pt(0,2)]+=Mt[pt(1,2)]*r,r=1/((0,vec2.Om)(bt(Mt,0),e)+Mt[pt(0,2)]),h=1/((0,vec2.Om)(bt(Mt,1),e)+Mt[pt(1,2)]),Mt[pt(0,0)]*=r,Mt[pt(0,1)]*=r,Mt[pt(0,2)]*=r,Mt[pt(1,0)]*=h,Mt[pt(1,1)]*=h,Mt[pt(1,2)]*=h,Mt[pt(2,0)]=Mt[pt(1,0)],Mt[pt(2,1)]=Mt[pt(1,1)],Mt[pt(2,2)]=Mt[pt(1,2)],Mt[pt(1,2)]+=1,r=(0,vec2.Om)(bt(Mt,1),s)+Mt[pt(1,2)],h=(0,vec2.Om)(bt(Mt,2),s)+Mt[pt(2,2)],o=(0,vec2.Om)(bt(Mt,1),e)+Mt[pt(1,2)],n=(0,vec2.Om)(bt(Mt,2),e)+Mt[pt(2,2)],r=-.5*(r/h+o/n),Mt[pt(1,0)]+=Mt[pt(2,0)]*r,Mt[pt(1,1)]+=Mt[pt(2,1)]*r,Mt[pt(1,2)]+=Mt[pt(2,2)]*r,r=(0,vec2.Om)(bt(Mt,1),s)+Mt[pt(1,2)],h=(0,vec2.Om)(bt(Mt,2),s)+Mt[pt(2,2)],o=-h/r,Mt[pt(1,0)]*=o,Mt[pt(1,1)]*=o,Mt[pt(1,2)]*=o,a[0]=Mt[0],a[1]=Mt[1],a[2]=0,a[3]=Mt[2],a[4]=Mt[3],a[5]=Mt[4],a[6]=0,a[7]=Mt[5],a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=Mt[6],a[13]=Mt[7],a[14]=0,a[15]=Mt[8]}(Y,Z,tt,st,r.projectionMatrix),r.projectionMatrix[10]=2/(i-a),r.projectionMatrix[14]=-(i+a)/(i-a)}(e,i,d,m,a.camera),(0,mat4.lw)(a.lightMat,a.camera.projectionMatrix,a.camera.viewMatrix);const u=this._textureHeight;a.camera.viewport=[t*u,0,u,u]}_setupMatrices(t,s){(0,mat4.lw)(this._projectionView,t.projectionMatrix,t.viewMatrix),(0,mat4.B8)(this._projectionViewInverse,this._projectionView);const e=this._viewingMode===ViewingMode.RT.Global?t.eye:(0,vec32.i)(et,0,0,1);(0,mat4.t5)(this._modelViewLight,[0,0,0],[-s[0],-s[1],-s[2]],e)}_computeCascadeDistances(t,e,i){const a=i?this.settings.maxNumCascadesHighQuality:this.settings.maxNumCascadesLowQuality;this._numCascades=Math.min(1+Math.floor((0,Util.kL)(e/t,4)),a);const r=(e-t)/this._numCascades,h=(e/t)**(1/this._numCascades);let o=t,n=t;for(let c=0;c<this._numCascades+1;++c)this._cascadeDistances[c]=(0,mathUtils.Cc)(o,n,this.settings.splitSchemeLambda),o*=h,n+=r}get test(){}}const k=(0,mat4f64.vt)(),J=(0,vec4f64.vt)(),K=[];for(let yt=0;yt<8;++yt)K.push((0,vec4f64.vt)());const Y=(0,vec2f64.vt)(),Z=(0,vec2f64.vt)(),$=(0,vec2f64.vt)(),tt=(0,vec2f64.vt)(),st=(0,vec2f64.vt)(),et=(0,vec3f64.vt)(),it=[],at=(0,mat4f64.vt)(),rt=mat4f64.zK.concat(mat4f64.zK,mat4f64.zK,mat4f64.zK,mat4f64.zK),ht=(0,vec2f64.vt)(),ot=(0,vec2f64.vt)(),nt=[(0,vec2f64.vt)(),(0,vec2f64.vt)(),(0,vec2f64.vt)(),(0,vec2f64.vt)()],ct=(0,vec2f64.vt)(),lt=(0,vec2f64.vt)(),dt=(0,vec2f64.vt)(),mt=(0,vec2f64.vt)(),ut=(0,vec2f64.vt)(),_t=(0,vec2f64.vt)(),ft=(0,vec2f64.vt)();function pt(t,s){return 3*s+t}const xt=(0,vec2f64.vt)();function bt(t,s){return(0,vec2.hZ)(xt,t[s],t[s+3]),xt}const wt=(0,vec2f64.vt)(),Mt=(0,mat3f64.vt)();class TextureTechnique_t extends ShaderTechnique.w{constructor(o,i){super(o,i,new ReloadableShaderModule.$(TextureOnly_glsl.a,(()=>__webpack_require__.e(1293).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/util/TextureOnly.glsl.js")))))}initializePipeline(e){return e.hasAlpha?(0,renderState.Ey)({blending:renderState.Ky,colorWrite:renderState.kn}):(0,renderState.Ey)({colorWrite:renderState.kn})}}var ShaderTechniqueConfiguration=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderTechnique/ShaderTechniqueConfiguration.js");class TextureTechniqueConfiguration_r extends ShaderTechniqueConfiguration.K{constructor(){super(...arguments),this.hasAlpha=!1}}(0,tslib_es6._)([(0,ShaderTechniqueConfiguration.W)()],TextureTechniqueConfiguration_r.prototype,"hasAlpha",void 0);var UpdatePolicy=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/lib/UpdatePolicy.js"),Lightsources=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/lighting/Lightsources.js"),OverlayCompositing_glsl=__webpack_require__("./node_modules/@arcgis/core/chunks/OverlayCompositing.glsl.js");class OverlayCompositingTechnique_s extends ShaderTechnique.w{constructor(r,s){super(r,s,new ReloadableShaderModule.$(OverlayCompositing_glsl.a,(()=>__webpack_require__.e(6188).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@arcgis/core/views/3d/webgl-engine/shaders/OverlayCompositing.glsl.js")))))}}var Scheduler=__webpack_require__("./node_modules/@arcgis/core/views/support/Scheduler.js");let OverlayRenderer_$=class extends RenderPlugin.RW{constructor(e){super(e),this._overlays=null,this._renderTargets=null,this._overlayParameters=new OverlayCompositing_glsl.O,this.hasHighlights=!1,this._hasWater=!1,this._renderers=new Map,this._sortedDrapeSourceRenderersDirty=!1,this._sortedRenderers=new PooledArray.A,this._passParameters=new TextureOnly_glsl.T,this._materials=null,this._screenToWorldRatio=1,this._localOriginFactory=null,this.unloadedMemory=0,this.ignoresMemoryFactor=!1,this._camera=new RenderCamera.A,this.events=new Evented.A,this.longitudeCyclical=null,this.produces=new Map([[RenderSlot.N.DRAPED_MATERIAL,e=>e!==ShaderOutput.V.Highlight||this.hasHighlights],[RenderSlot.N.DRAPED_WATER,()=>this._hasWater]]),this._hasTargetWithoutRasterImage=!1,this._hasDrapedFeatureSource=!1,this._hasDrapedRasterSource=!1}initialize(){const e=this._view,r=e._stage,t=r.renderer.fboCache,{waterTextures:s,textures:i}=r.renderView;this._renderContext=new RenderContext_a(this._rctx,new X(t,e.state.viewingMode)),this.addHandles([(0,reactiveUtils.watch)((()=>s.updating),(()=>this.events.emit("content-changed")),reactiveUtils.pc),(0,reactiveUtils.watch)((()=>this.spatialReference),(e=>this._localOriginFactory=new GridLocalOriginFactory.g(e)),reactiveUtils.pc),(0,reactiveUtils.on)((()=>e.allLayerViews),"after-changes",(()=>this._sortedDrapeSourceRenderersDirty=!0)),(0,reactiveUtils.watch)((()=>function L(e){let t=0;for(const r of e){const{name:e}=r;t+=e.length;const{color:i,fillOpacity:s,haloColor:o,haloOpacity:h}=r;t+=i.r+i.g+i.b+i.a+s,t+=o?o.r+o.g+o.b+o.a+h:0}const i=e.at(0);if(i){const{shadowOpacity:e,shadowDifference:r,shadowColor:s}=i;t+=e+r+s.r+s.g+s.b+s.a}return G+++(t>=0?0:1)}(e.state.highlights)),(()=>this._sortedDrapeSourceRenderersDirty=!0),reactiveUtils.Vh),(0,reactiveUtils.watch)((()=>e.state.highlights),(r=>{this._bindParameters.highlights=r,this._bindParameters.highlightOrderMap=e.state.highlightOrderMap,this._updateHighlights()}),reactiveUtils.Vh),e.resourceController.scheduler.registerTask(Scheduler.W6.STAGE,this)]),this._materials=new GLMaterialRepository_s(i,this._techniques,(()=>{this.notifyChange("rendersOccludedDraped"),this.events.emit("content-changed"),this.notifyChange("updating"),this.notifyChange("isEmpty")}),(()=>this.events.emit("content-changed")));const{_bindParameters:l,_camera:d}=this;d.near=1,d.far=1e4,d.relativeElevation=null,l.slot=RenderSlot.N.DRAPED_MATERIAL,l.mainDepth=null,l.camera=d,l.oitPass=OITPass.Y.NONE,l.updateLighting([new Lightsources.$p((0,vec3f64.S)())],0,0,Update_e.Immediate)}destroy(){this._renderers.forEach((e=>e.destroy())),this._renderers.clear(),this._passParameters.texture=(0,maybe.WD)(this._passParameters.texture),this.disposeOverlays()}get _bindParameters(){return this._renderContext.bind}get _rctx(){return this._stage.renderView.renderingContext}get _view(){return this.parent.view}get _stage(){return this.parent.view._stage}get spatialReference(){return this.parent.spatialReference}get _techniques(){return this._stage.renderView.techniques}get rctx(){return this._rctx}get materials(){return this._materials}get screenToWorldRatio(){return this._screenToWorldRatio}get localOriginFactory(){return this._localOriginFactory}get pluginContext(){return this._pluginContext}initializeRenderContext(e){this._pluginContext=e,this._techniques.precompile(OverlayCompositingTechnique_s)}uninitializeRenderContext(){}acquireTechniques(){return[]}render(){}get updating(){return this._sortedDrapeSourceRenderersDirty||(0,MapUtils.Bs)(this._renderers,(e=>e.updating))}get hasOverlays(){return null!=this._overlays&&null!=this._renderTargets}getMaterialRenderer(e){for(const r of this._renderers.values()){const t=r.getMaterialRenderer(e);if(t)return t}return null}get layers(){return this._sortedDrapeSourceRenderersDirty&&this._updateSortedDrapeSourceRenderers(),this._sortedRenderers.map((e=>e.drapeSource.layer)).filter((e=>!!e))}_updateHighlights(){const e=this._view.state;this._renderers.forEach((r=>r.updateHighlights(e.highlightOrderMap)))}createDrapeSourceRenderer(e,r,t){const s=this._renderers.get(e);null!=s&&s.destroy();const i=new r({...t,rendererContext:this,drapeSource:e});return this._renderers.set(e,i),this._sortedDrapeSourceRenderersDirty=!0,"fullOpacity"in e&&this.addHandles((0,reactiveUtils.watch)((()=>e.fullOpacity),(()=>this.events.emit("content-changed"))),e),i}removeDrapeSourceRenderer(e){if(null==e)return;const r=this._renderers.get(e);null!=r&&(this._sortedDrapeSourceRenderersDirty=!0,this._renderers.delete(e),this.removeHandles(e),r.destroy())}computeValidity(){return this._renderTargets?.computeValidity()??0}releaseRenderTargets(){this._renderTargets?.dispose()}get overlays(){return this._overlays??[]}ensureDrapeTargets(e){this._hasTargetWithoutRasterImage=!!this._overlays&&(0,SetUtils.bw)(e,(e=>e.drapeTargetType===interfaces.sv.WithoutRasterImage))}ensureDrapeSources(e){this._overlays?(this._hasDrapedFeatureSource=(0,SetUtils.bw)(e,(e=>e.drapeSourceType===interfaces.Om.Features)),this._hasDrapedRasterSource=(0,SetUtils.bw)(e,(e=>e.drapeSourceType===interfaces.Om.RasterImage))):this._hasDrapedFeatureSource=this._hasDrapedRasterSource=!1}get _needsColorWithoutRasterImage(){return this._hasDrapedRasterSource&&this._hasDrapedFeatureSource&&this._hasTargetWithoutRasterImage}ensureOverlays(e,r,t=this._bindParameters.overlayStretch){null==this._overlays&&(this._renderTargets=new OverlayRenderTargets_i(this._stage.renderer.fboCache),this._overlays=[new Overlay_n,new Overlay_n]),this.ensureDrapeTargets(e),this.ensureDrapeSources(r),this._bindParameters.overlayStretch=t}disposeOverlays(){this._overlays=null,this._renderTargets=(0,maybe.WD)(this._renderTargets),this.events.emit("textures-disposed")}getTexture(e){if(null!=e)return e===OverlayContent_o.ColorNoRasterImage&&!this._needsColorWithoutRasterImage&&this._hasDrapedFeatureSource?this._renderTargets?.getTexture(OverlayContent_o.Color):this._renderTargets?.getTexture(e)}get running(){return this.updating}runTask(e){this._processDrapeSources(e,(()=>!0))}_processDrapeSources(e,r){let s=!1;for(const[t,i]of this._renderers){if(e.done)break;(t.destroyed||r(t))&&i.commitChanges(this._view.state.highlightOrderMap)&&(s=!0,e.madeProgress())}this._sortedDrapeSourceRenderersDirty&&(this._sortedDrapeSourceRenderersDirty=!1,s=!0,this._updateSortedDrapeSourceRenderers()),s&&(null!=this._overlays&&0===this._renderers.size&&this.disposeOverlays(),this.notifyChange("updating"),this.notifyChange("isEmpty"),this.events.emit("content-changed"),this.hasHighlights=(0,MapUtils.Bs)(this._renderers,(e=>e.hasHighlights)),this.notifyChange("rendersOccludedDraped"))}hasHighlightOptions(e){return(0,MapUtils.Bs)(this._renderers,(r=>r.hasHighlightOptions(e)))}processSyncDrapeSources(){this._processDrapeSources(Scheduler.Bb,(e=>e.updatePolicy===UpdatePolicy.q.SYNC))}get isEmpty(){return!debugFlags.b.OVERLAY_DRAW_DEBUG_TEXTURE&&!(0,MapUtils.Bs)(this._renderers,(e=>!e.isEmpty))}get hasWater(){const e=(0,MapUtils.Bs)(this._renderers,(e=>e.hasWater));return e!==this._hasWater&&(this._hasWater=e,this.events.emit("has-water")),this._hasWater}get rendersOccludedDraped(){const e=this._renderContext.renderOccludedMask;this._renderContext.renderOccludedMask=se,++this._techniques.precompiling;const r=this._sortedRenderers.some((({renderer:e})=>e.precompile(this._renderContext)));return--this._techniques.precompiling,this._renderContext.renderOccludedMask=e,r}renders(e){if(debugFlags.b.OVERLAY_DRAW_DEBUG_TEXTURE&&e!==OverlayContent_o.Occluded&&e!==OverlayContent_o.Highlight)return!0;++this._techniques.precompiling;const r=this._sortedRenderers.some((({renderer:e})=>e.precompile(this._renderContext)));return--this._techniques.precompiling,r}get mode(){return this.isEmpty?C.Disabled:this.hasWater&&this.renders(OverlayContent_o.WaterNormal)?C.EnabledWithWater:this._renderTargets?.getTexture(OverlayContent_o.Color)?C.Enabled:C.Disabled}updateAnimation(e){let r=!1;return this._renderers.forEach((t=>r=t.updateAnimation(e)||r)),r&&this.parent.requestRender(basicInterfaces.C7.BACKGROUND),r}updateDrapeSourceOrder(){this._sortedDrapeSourceRenderersDirty=!0}precompileShaders(e){if(this._renderTargets){this._bindParameters.alignPixelEnabled=e.alignPixelEnabled,++this._techniques.precompiling;for(const e of this._renderTargets.targets){if(e.content===OverlayContent_o.ColorNoRasterImage&&!this._needsColorWithoutRasterImage)continue;const r=e.output;this._renderContext.output=r,this._bindParameters.slot=r===ShaderOutput.V.Normal?RenderSlot.N.DRAPED_WATER:RenderSlot.N.DRAPED_MATERIAL,e.content===OverlayContent_o.Occluded&&(this._renderContext.renderOccludedMask=se),this._sortedRenderers.forAll((({drapeSource:r,renderer:t})=>{e.content===OverlayContent_o.ColorNoRasterImage&&r.drapeSourceType===interfaces.Om.RasterImage||t.precompile(this._renderContext)})),this._renderContext.renderOccludedMask=RenderContext_o}--this._techniques.precompiling}}drawOverlays(e){if(this._overlays&&this._renderTargets){for(const e of this._overlays)this.longitudeCyclical?e.setupGeometryViewsCyclical(this.longitudeCyclical):e.setupGeometryView();this._bindParameters.alignPixelEnabled=e.alignPixelEnabled;for(const e of this._renderTargets.targets){if(e.content===OverlayContent_o.ColorNoRasterImage&&!this._needsColorWithoutRasterImage)continue;const r=this._drawTarget(terrain_interfaces.vr.INNER,e),t=this._drawTarget(terrain_interfaces.vr.OUTER,e);(r||t)&&e.fbo.generateMipMap()}}}_drawTarget(e,r){const t=this._overlays[e],s=t.canvasGeometries;if(0===s.numViews)return!1;const i=this._view.state.contentPixelRatio;this._screenToWorldRatio=i*t.mapUnitsPerPixel/this._bindParameters.overlayStretch;const n=r.output;if(this.isEmpty||n===ShaderOutput.V.Normal&&!this.hasWater||!t.hasSomeSizedView())return!1;const{_rctx:o,_camera:a,_renderContext:h,_bindParameters:l}=this;if(a.pixelRatio=t.pixelRatio*i,h.output=n,l.screenToWorldRatio=this._screenToWorldRatio,l.screenToPCSRatio=this._screenToWorldRatio*this.parent.worldToPCSRatio,l.slot=n===ShaderOutput.V.Normal?RenderSlot.N.DRAPED_WATER:RenderSlot.N.DRAPED_MATERIAL,r.content===OverlayContent_o.Occluded&&(h.renderOccludedMask=se),!this.renders(r.content))return h.renderOccludedMask=RenderContext_o,!1;const{resolution:d}=t,c=e===terrain_interfaces.vr.INNER?0:d;if(o.setViewport(c,0,d,d),this._bindTargetFBO(r),e===terrain_interfaces.vr.INNER&&(o.setClearColor(0,0,0,0),o.clear(enums.NV.COLOR)),debugFlags.b.OVERLAY_DRAW_DEBUG_TEXTURE&&r.content!==OverlayContent_o.Occluded&&r.content!==OverlayContent_o.Highlight){this._techniques.precompile(TextureTechnique_t,ie);const r=this._techniques.get(TextureTechnique_t,ie);for(let i=0;i<s.numViews;i++)this._setViewParameters(s.extents[i],t),this._ensureDebugPatternResources(t.resolution,re[e]),o.bindTechnique(r,l,this._passParameters),o.screen.draw()}if(r.output===ShaderOutput.V.Highlight){const{fboCache:t}=this._stage.renderer,s=this._resolution;this._bindTargetFBO(r),function Highlight_V(e,t,i,r,s,o=0){const h=r.highlights,a=h.length>1?t.acquire(i.width,i.height,"highlight mix",formats.N.RG):null;if(a){const t=e.getBoundFramebufferObject();e.bindFramebuffer(a.fbo),e.clearFramebuffer(vec4f64.uY),e.bindFramebuffer(t)}const c=a?.getTexture();r.highlightMixTexture=c,(0,vec2.hZ)(r.highlightMixOrigin,o,0),h.forEach(((t,h)=>{h>0&&(e.bindTexture(c,Texture.g.TEXTURE_UNIT_FOR_UPDATES),e.gl.copyTexSubImage2D(enums.Ap.TEXTURE_2D,0,0,0,o,0,i.width,i.height),e.bindTexture(null,Texture.g.TEXTURE_UNIT_FOR_UPDATES)),e.clear(enums.NV.DEPTH),r.highlightLevel=h,s()})),r.highlightLevel=null,r.highlightMixTexture=null,a?.release()}(o,t,{width:s,height:s},l,(()=>this._renderAllGeometry(e,r)),c)}else this._renderAllGeometry(e,r);return o.bindFramebuffer(null),h.renderOccludedMask=RenderContext_o,!0}_renderAllGeometry(e,r){const t=this._overlays[e],s=t.canvasGeometries;this._sortedRenderers.forAll((({drapeSource:i,renderer:n})=>{if(r.content===OverlayContent_o.ColorNoRasterImage&&i.drapeSourceType===interfaces.Om.RasterImage)return;const{fullOpacity:o}=i,a=null!=o&&o<1&&r.output===ShaderOutput.V.Color&&this._bindTemporaryFBO();for(let e=0;e<s.numViews;e++)this._setViewParameters(s.extents[e],t),n.render(this._renderContext);if(a){this._bindTargetFBO(r),this._overlayParameters.texture=a.getTexture(),this._overlayParameters.opacity=o,this._overlayParameters.overlayIndex=e;const t=this._techniques.get(OverlayCompositingTechnique_s);this._rctx.bindTechnique(t,this._bindParameters,this._overlayParameters),this._rctx.screen.draw(),a.release()}}))}_bindTargetFBO(e){const r=this._resolution,t=2*r;e.fbo.bind(this._rctx,t,r)}_bindTemporaryFBO(){const e=this._resolution,r=2*e,t=this._stage.renderer.fboCache,s=t.acquire(r,e,"overlay tmp");return t.rctx.bindFramebuffer(s.fbo),t.rctx.clear(enums.NV.COLOR),s}get _resolution(){return this._overlays?.[terrain_interfaces.vr.INNER].resolution??0}notifyContentChanged(){this.events.emit("content-changed")}intersect(e,r,t,s){this._sortedDrapeSourceRenderersDirty&&this._updateSortedDrapeSourceRenderers();let i=0;for(const{renderer:n}of this._sortedRenderers)i=n.intersect?.(e,r,t,s,i)??i}_updateSortedDrapeSourceRenderers(){if(this._sortedRenderers.clear(),0===this._renderers.size)return;const e=this._view.map.allLayers,r=e.length;this._renderers.forEach(((t,s)=>{const i=e.indexOf(s.layer),n=i>=0,o=s.renderGroup??(n?interfaces.O7.MapLayer:interfaces.O7.ViewLayer),a=r*o+(n?i:0);this._sortedRenderers.push(new ee(s,t,a))})),this._sortedRenderers.sort(((e,r)=>e.index-r.index))}_setViewParameters(e,r){const t=this._camera;t.viewport=[0,0,r.resolution,r.resolution],(0,mat4.v3)(t.projectionMatrix,0,e[2]-e[0],0,e[3]-e[1],t.near,t.far),(0,mat4.kN)(t.viewMatrix,[-e[0],-e[1],0])}_ensureDebugPatternResources(e,r){if((0,vec32.i)(this._passParameters.color,r[0],r[1],r[2]),this._passParameters.texture)return;const t=new Uint8Array(e*e*4);let s=0;for(let n=0;n<e;n++)for(let r=0;r<e;r++){const i=Math.floor(r/10),o=Math.floor(n/10);i<2||o<2||10*i>e-20||10*o>e-20?(t[s++]=255,t[s++]=255,t[s++]=255,t[s++]=255):(t[s++]=255,t[s++]=255,t[s++]=255,t[s++]=1&i&&1&o?1&r^1&n?0:255:1&i^1&o?0:128)}const i=new TextureDescriptor.R(e);i.samplingMode=enums.Cj.NEAREST,this._passParameters.texture=new Texture.g(this._rctx,i,t)}get test(){}};(0,tslib_es6._)([(0,property.MZ)()],OverlayRenderer_$.prototype,"hasHighlights",void 0),(0,tslib_es6._)([(0,property.MZ)()],OverlayRenderer_$.prototype,"_sortedDrapeSourceRenderersDirty",void 0),(0,tslib_es6._)([(0,property.MZ)({constructOnly:!0})],OverlayRenderer_$.prototype,"parent",void 0),(0,tslib_es6._)([(0,property.MZ)({readOnly:!0})],OverlayRenderer_$.prototype,"_techniques",null),(0,tslib_es6._)([(0,property.MZ)({type:Boolean,readOnly:!0})],OverlayRenderer_$.prototype,"updating",null),(0,tslib_es6._)([(0,property.MZ)()],OverlayRenderer_$.prototype,"isEmpty",null),(0,tslib_es6._)([(0,property.MZ)({readOnly:!0})],OverlayRenderer_$.prototype,"rendersOccludedDraped",null),OverlayRenderer_$=(0,tslib_es6._)([(0,subclass.$)("esri.views.3d.terrain.OverlayRenderer")],OverlayRenderer_$);class ee{constructor(e,r,t){this.drapeSource=e,this.renderer=r,this.index=t}}const re=[[1,.5,.5],[.5,.5,1]],te=-2,se=Material.m$.OccludeAndTransparent,ie=new TextureTechniqueConfiguration_r;ie.hasAlpha=!0},"./node_modules/@arcgis/core/views/3d/terrain/interfaces.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{var E,A,O;__webpack_require__.d(__webpack_exports__,{vr:()=>E}),function(E){E[E.INNER=0]="INNER",E[E.OUTER=1]="OUTER"}(E||(E={})),function(E){E[E.REGULAR=0]="REGULAR",E[E.HAS_NORTH_POLE=1]="HAS_NORTH_POLE",E[E.HAS_SOUTH_POLE=2]="HAS_SOUTH_POLE",E[E.HAS_BOTH_POLES=3]="HAS_BOTH_POLES"}(A||(A={})),function(E){E[E.FADING=0]="FADING",E[E.IMMEDIATE=1]="IMMEDIATE",E[E.UNFADED=2]="UNFADED"}(O||(O={}))},"./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/HighlightCellGridScreenSpacePass.glsl.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Q:()=>s});var vec2=__webpack_require__("./node_modules/@arcgis/core/core/libs/gl-matrix-2/math/vec2.js"),vec2f64=__webpack_require__("./node_modules/@arcgis/core/core/libs/gl-matrix-2/factories/vec2f64.js"),glsl=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderModules/glsl.js"),BindType=__webpack_require__("./node_modules/@arcgis/core/views/webgl/BindType.js"),Uniform=__webpack_require__("./node_modules/@arcgis/core/views/webgl/Uniform.js");class e extends Uniform.n{constructor(s,e){super(s,"ivec2",BindType.c.Pass,((r,o,i)=>r.setUniform2iv(s,e(o,i))))}}var IntegerPassUniform=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderModules/IntegerPassUniform.js"),Texture2DPassUniform=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderModules/Texture2DPassUniform.js"),HighlightDownsample_glsl=__webpack_require__("./node_modules/@arcgis/core/chunks/HighlightDownsample.glsl.js");function s(l){const{vertex:s}=l;s.uniforms.add(new Texture2DPassUniform.N("coverageTexture",(e=>e.coverageTexture)),new e("highlightRenderCellCount",(l=>(0,vec2.hZ)(r,l.horizontalCellCount,l.verticalCellCount))),new e("highlightTextureResolution",(({highlightTexture:l})=>(0,vec2.hZ)(r,l.descriptor.width,l.descriptor.height))),new IntegerPassUniform.c("highlightLevel",(e=>e.highlightLevel))).constants.add("cellSize","int",HighlightDownsample_glsl.g),l.varyings.add("sUV","vec2"),l.varyings.add("vOutlinePossible","float"),s.code.add(glsl.H`const ivec2 cellVertices[4] = ivec2[4](ivec2(0,0), ivec2(1,0), ivec2(0,1), ivec2(1,1));`).main.add(glsl.H`int cellIndex = gl_InstanceID;
int cellX = cellIndex % highlightRenderCellCount[0];
int cellY = (cellIndex - cellX) / highlightRenderCellCount[0];
ivec2 cellPos = ivec2(cellX, cellY);
uvec2 covTexel = uvec2(texelFetch(coverageTexture, cellPos, 0).rg * 255.0);
int channelIndex = (highlightLevel >> 2) & 3;
uint channelValue = covTexel[channelIndex];
int highlightIndex = (highlightLevel & 3) << 1;
bool covered = ((channelValue >> highlightIndex) & 1u) == 1u;
if (!covered) {
gl_Position = vec4(0.0);
return;
}
vOutlinePossible = (((channelValue >> highlightIndex) & 2u) == 2u) ? 1.0 : 0.0;
ivec2 iPosInCell = cellVertices[gl_VertexID];
vec2 sPos = vec2(cellPos * cellSize + iPosInCell * (cellSize));
vec2 vPos = sPos / vec2(highlightTextureResolution);
sUV = vPos;
gl_Position = vec4(2.0 * vPos - vec2(1.0), 0.0, 1.0);`)}const r=(0,vec2f64.vt)()},"./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/shading/FoamRendering.glsl.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{v:()=>n,z:()=>o});var _shaderModules_glsl_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderModules/glsl.js");function o(o){o.fragment.code.add(_shaderModules_glsl_js__WEBPACK_IMPORTED_MODULE_0__.H`float normals2FoamIntensity(vec3 n, float waveStrength){
float normalizationFactor =  max(0.015, waveStrength);
return max((n.x + n.y)*0.3303545/normalizationFactor + 0.3303545, 0.0);
}`)}function n(o){o.fragment.code.add(_shaderModules_glsl_js__WEBPACK_IMPORTED_MODULE_0__.H`vec3 foamIntensity2FoamColor(float foamIntensityExternal, float foamPixelIntensity, vec3 skyZenitColor, float dayMod){
return foamIntensityExternal * (0.075 * skyZenitColor * pow(foamPixelIntensity, 4.) +  50.* pow(foamPixelIntensity, 23.0)) * dayMod;
}`)}},"./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/shading/Water.glsl.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{E:()=>m});var FoamRendering_glsl=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/shading/FoamRendering.glsl.js"),colorUtils=__webpack_require__("./node_modules/@arcgis/core/colorUtils.js"),glsl=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderModules/glsl.js");function e(e){e.fragment.code.add(glsl.H`
    const float GAMMA = ${glsl.H.float(colorUtils.Tf)};
    const float INV_GAMMA = ${glsl.H.float(1/colorUtils.Tf)};

    vec4 delinearizeGamma(vec4 color) {
      return vec4(pow(color.rgb, vec3(INV_GAMMA)), color.a);
    }

    vec3 linearizeGamma(vec3 color) {
      return pow(color, vec3(GAMMA));
    }
  `)}var PhysicallyBasedRendering_glsl=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/shading/PhysicallyBasedRendering.glsl.js"),ScreenSpaceConstants=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/shading/ScreenSpaceConstants.js"),ReadDepth_glsl=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/output/ReadDepth.glsl.js"),Float2BindUniform=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderModules/Float2BindUniform.js"),FloatBindUniform=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderModules/FloatBindUniform.js"),Matrix4BindUniform=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderModules/Matrix4BindUniform.js"),Texture2DBindUniform=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderModules/Texture2DBindUniform.js");function d(d,n){if(!n.screenSpaceReflections)return;const c=d.fragment;c.include(ReadDepth_glsl.E),c.uniforms.add(new Float2BindUniform.E("nearFar",(e=>e.camera.nearFar)),new Texture2DBindUniform.x("depthMap",(e=>e.depth?.attachment)),new Matrix4BindUniform.F("proj",(e=>e.camera.projectionMatrix)),new FloatBindUniform.U("invResolutionHeight",(e=>1/e.camera.height)),new Matrix4BindUniform.F("reprojectionMatrix",(e=>e.ssr.reprojectionMatrix))).code.add(glsl.H`
  vec2 reprojectionCoordinate(vec3 projectionCoordinate)
  {
    vec4 zw = proj * vec4(0.0, 0.0, -projectionCoordinate.z, 1.0);
    vec4 reprojectedCoord = reprojectionMatrix * vec4(zw.w * (projectionCoordinate.xy * 2.0 - 1.0), zw.z, zw.w);
    reprojectedCoord.xy /= reprojectedCoord.w;
    return reprojectedCoord.xy * 0.5 + 0.5;
  }

  const int maxSteps = ${n.highStepCount?"150":"75"};

  vec4 applyProjectionMat(mat4 projectionMat, vec3 x)
  {
    vec4 projectedCoord =  projectionMat * vec4(x, 1.0);
    projectedCoord.xy /= projectedCoord.w;
    projectedCoord.xy = projectedCoord.xy*0.5 + 0.5;
    return projectedCoord;
  }

  vec3 screenSpaceIntersection(vec3 dir, vec3 startPosition, vec3 viewDir, vec3 normal)
  {
    vec3 viewPos = startPosition;
    vec3 viewPosEnd = startPosition;

    // Project the start position to the screen
    vec4 projectedCoordStart = applyProjectionMat(proj, viewPos);
    vec3  Q0 = viewPos / projectedCoordStart.w; // homogeneous camera space
    float k0 = 1.0/ projectedCoordStart.w;

    // advance the position in the direction of the reflection
    viewPos += dir;

    vec4 projectedCoordVanishingPoint = applyProjectionMat(proj, dir);

    // Project the advanced position to the screen
    vec4 projectedCoordEnd = applyProjectionMat(proj, viewPos);
    vec3  Q1 = viewPos / projectedCoordEnd.w; // homogeneous camera space
    float k1 = 1.0/ projectedCoordEnd.w;

    // calculate the reflection direction in the screen space
    vec2 projectedCoordDir = (projectedCoordEnd.xy - projectedCoordStart.xy);
    vec2 projectedCoordDistVanishingPoint = (projectedCoordVanishingPoint.xy - projectedCoordStart.xy);

    float yMod = min(abs(projectedCoordDistVanishingPoint.y), 1.0);

    float projectedCoordDirLength = length(projectedCoordDir);
    float maxSt = float(maxSteps);

    // normalize the projection direction depending on maximum steps
    // this determines how blocky the reflection looks
    vec2 dP = yMod * (projectedCoordDir)/(maxSt * projectedCoordDirLength);

    // Normalize the homogeneous camera space coordinates
    vec3  dQ = yMod * (Q1 - Q0)/(maxSt * projectedCoordDirLength);
    float dk = yMod * (k1 - k0)/(maxSt * projectedCoordDirLength);

    // initialize the variables for ray marching
    vec2 P = projectedCoordStart.xy;
    vec3 Q = Q0;
    float k = k0;
    float rayStartZ = -startPosition.z; // estimated ray start depth value
    float rayEndZ = -startPosition.z;   // estimated ray end depth value
    float prevEstimateZ = -startPosition.z;
    float rayDiffZ = 0.0;
    float dDepth;
    float depth;
    float rayDiffZOld = 0.0;

    // early outs
    if (dot(normal, dir) < 0.0 || dot(-viewDir, normal) < 0.0)
      return vec3(P, 0.0);
    float dDepthBefore = 0.0;

    for(int i = 0; i < maxSteps-1; i++)
    {
      depth = -linearDepthFromTexture(depthMap, P); // get linear depth from the depth buffer

      // estimate depth of the marching ray
      rayStartZ = prevEstimateZ;
      dDepth = -rayStartZ - depth;
      rayEndZ = (dQ.z * 0.5 + Q.z)/ ((dk * 0.5 + k));
      rayDiffZ = rayEndZ- rayStartZ;
      prevEstimateZ = rayEndZ;

      if(-rayEndZ > nearFar[1] || -rayEndZ < nearFar[0] || P.y < 0.0  || P.y > 1.0 )
      {
        return vec3(P, 0.);
      }

      // If we detect a hit - return the intersection point, two conditions:
      //  - dDepth > 0.0 - sampled point depth is in front of estimated depth
      //  - if difference between dDepth and rayDiffZOld is not too large
      //  - if difference between dDepth and 0.025/abs(k) is not too large
      //  - if the sampled depth is not behind far plane or in front of near plane

      if((dDepth) < 0.025/abs(k) + abs(rayDiffZ) && dDepth > 0.0 && depth > nearFar[0] && depth < nearFar[1] && abs(P.y - projectedCoordStart.y) > invResolutionHeight)
      {
        float weight = dDepth / (dDepth - dDepthBefore);
        vec2 Pf = mix(P - dP, P, 1.0 - weight);
        if (abs(Pf.y - projectedCoordStart.y) > invResolutionHeight) {
          return vec3(Pf, depth);
        }
        else {
          return vec3(P, depth);
        }
      }

      // continue with ray marching
      P = clamp(P + dP, vec2(0.0), vec2(0.999));
      Q.z += dQ.z;
      k += dk;
      rayDiffZOld = rayDiffZ;
      dDepthBefore = dDepth;
    }
    return vec3(P, 0.0);
  }
  `)}var vec3f64=__webpack_require__("./node_modules/@arcgis/core/core/libs/gl-matrix-2/factories/vec3f64.js"),Ellipsoid=__webpack_require__("./node_modules/@arcgis/core/geometry/support/Ellipsoid.js"),Clouds=__webpack_require__("./node_modules/@arcgis/core/views/3d/environment/Clouds.js"),CloudsParameters=__webpack_require__("./node_modules/@arcgis/core/views/3d/environment/CloudsParameters.js"),weather=__webpack_require__("./node_modules/@arcgis/core/views/3d/environment/weather.js"),MainLighting_glsl=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/shading/MainLighting.glsl.js"),BooleanBindUniform=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderModules/BooleanBindUniform.js"),Float3BindUniform=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderModules/Float3BindUniform.js"),BindType=__webpack_require__("./node_modules/@arcgis/core/views/webgl/BindType.js"),Uniform=__webpack_require__("./node_modules/@arcgis/core/views/webgl/Uniform.js");class o extends Uniform.n{constructor(r,o){super(r,"samplerCube",BindType.c.Bind,((e,s)=>e.bindTexture(r,o(s))))}}function h(t){const r=t.fragment;r.constants.add("radiusCloudsSquared","float",C).code.add(glsl.H`vec3 intersectWithCloudLayer(vec3 dir, vec3 cameraPosition, vec3 spherePos) {
float B = 2.0 * dot(cameraPosition, dir);
float C = dot(cameraPosition, cameraPosition) - radiusCloudsSquared;
float det = B * B - 4.0 * C;
float pointIntDist = max(0.0, 0.5 *(-B + sqrt(det)));
return (cameraPosition + dir * pointIntDist) - spherePos;
}`),r.uniforms.add(new FloatBindUniform.U("radiusCurvatureCorrection",(({clouds:o})=>o.parallax.radiusCurvatureCorrection))).code.add(glsl.H`vec3 correctForPlanetCurvature(vec3 dir) {
dir.z = dir.z * (1.0 - radiusCurvatureCorrection) + radiusCurvatureCorrection;
return dir;
}`),r.code.add(glsl.H`vec3 rotateDirectionToAnchorPoint(mat4 rotMat, vec3 inVec) {
return (rotMat * vec4(inVec, 0.0)).xyz;
}`),(0,MainLighting_glsl.Gc)(r),(0,MainLighting_glsl.O4)(r);const h=(0,vec3f64.fA)(.28,.175,.035);r.constants.add("RIM_COLOR","vec3",h);r.code.add(glsl.H`
    vec3 calculateCloudColor(vec3 cameraPosition, vec3 worldSpaceRay, vec4 clouds) {
      float upDotLight = dot(cameraPosition, mainLightDirection);
      float dirDotLight = max(dot(worldSpaceRay, mainLightDirection), 0.0);
      float sunsetTransition = clamp(pow(max(upDotLight, 0.0), ${glsl.H.float(.3)}), 0.0, 1.0);

      // Base color of the clouds that depends on lighting of the sun and sky
      vec3 ambientLight = calculateAmbientIrradiance(cameraPosition,  0.0);
      vec3 combinedLight = clamp((mainLightIntensity + ambientLight )/PI, vec3(0.0), vec3(1.0));
      vec3 baseCloudColor = pow(combinedLight * pow(clouds.xyz, vec3(GAMMA)), vec3(INV_GAMMA));

      // Rim light around the edge of the clouds simulating scattering of the direct lun light
      float scatteringMod = max(clouds.a < 0.5 ? clouds.a / 0.5 : - clouds.a / 0.5 + 2.0, 0.0);
      float rimLightIntensity = 0.5 + 0.5 * pow(max(upDotLight, 0.0), 0.35);
      vec3 directSunScattering = RIM_COLOR * rimLightIntensity * (pow(dirDotLight, ${glsl.H.float(140)})) * scatteringMod;

      // Brighten the clouds around the sun at the sunsets
      float additionalLight = ${glsl.H.float(.2)} * pow(dirDotLight, ${glsl.H.float(10)}) * (1. - pow(sunsetTransition, ${glsl.H.float(.3)})) ;

      return vec3(baseCloudColor * (1.0 + additionalLight) + directSunScattering);
    }
  `),r.uniforms.add(new BooleanBindUniform.o("readChannelsRG",(o=>o.clouds.readChannels===Clouds.c.RG)),new o("cubeMap",(o=>o.clouds.data?.cubeMap?.colorTexture??null))).code.add(glsl.H`vec4 sampleCloud(vec3 rayDir, bool readOtherChannel) {
vec4 s = texture(cubeMap, rayDir);
bool readRG = readChannelsRG ^^ readOtherChannel;
s = readRG ? vec4(vec3(s.r), s.g) : vec4(vec3(s.b), s.a);
return length(s) == 0.0 ? vec4(s.rgb, 1.0) : s;
}`),r.uniforms.add(new Float3BindUniform.d("anchorPoint",(o=>o.clouds.parallax.anchorPoint)),new Float3BindUniform.d("anchorPointNew",(o=>o.clouds.parallaxNew.anchorPoint)),new Matrix4BindUniform.F("rotationClouds",(o=>o.clouds.parallax.transform)),new Matrix4BindUniform.F("rotationCloudsNew",(o=>o.clouds.parallaxNew.transform)),new FloatBindUniform.U("cloudsOpacity",(o=>o.clouds.opacity)),new FloatBindUniform.U("fadeFactor",(o=>o.clouds.fadeFactor)),new BooleanBindUniform.o("crossFade",(o=>o.clouds.fadeState===CloudsParameters.c.CROSS_FADE))).code.add(glsl.H`vec4 renderClouds(vec3 worldRay, vec3 cameraPosition) {
vec3 intersectionPoint = intersectWithCloudLayer(worldRay, cameraPosition, anchorPoint);
vec3 worldRayRotated = rotateDirectionToAnchorPoint(rotationClouds, normalize(intersectionPoint));
vec3 worldRayRotatedCorrected = correctForPlanetCurvature(worldRayRotated);
vec4 cloudData = sampleCloud(worldRayRotatedCorrected, crossFade);
vec3 cameraPositionN = normalize(cameraPosition);
vec4 cloudColor = vec4(calculateCloudColor(cameraPositionN, worldRay, cloudData), cloudData.a);
if(crossFade) {
intersectionPoint = intersectWithCloudLayer(worldRay, cameraPosition, anchorPointNew);
worldRayRotated = rotateDirectionToAnchorPoint(rotationCloudsNew, normalize(intersectionPoint));
worldRayRotatedCorrected = correctForPlanetCurvature(worldRayRotated);
cloudData = sampleCloud(worldRayRotatedCorrected, false);
vec4 cloudColorNew = vec4(calculateCloudColor(cameraPositionN, worldRay, cloudData), cloudData.a);
cloudColor = mix(cloudColor, cloudColorNew, fadeFactor);
}
float totalTransmittance = length(cloudColor.rgb) == 0.0 ?
1.0 :
clamp(cloudColor.a * cloudsOpacity + (1.0 - cloudsOpacity), 0.0 , 1.0);
return vec4(cloudColor.rgb, totalTransmittance);
}`)}const C=(Ellipsoid.$O.radius+weather.k9)**2;function ToneMapping_glsl_o(o){o.code.add(glsl.H`vec3 tonemapACES(vec3 x) {
return clamp((x * (2.51 * x + 0.03)) / (x * (2.43 * x + 0.59) + 0.14), 0.0, 1.0);
}`)}function m(m,v){m.include(PhysicallyBasedRendering_glsl.f,v),m.include(e),m.include(FoamRendering_glsl.v),v.cloudReflections&&m.include(h),m.include(d,v);const u=m.fragment;u.include(ToneMapping_glsl_o),u.constants.add("fresnelSky","vec3",[.02,1,15]),u.constants.add("fresnelMaterial","vec2",[.02,.1]),u.constants.add("roughness","float",.015),u.constants.add("foamIntensityExternal","float",1.7),u.constants.add("ssrIntensity","float",.65),u.constants.add("ssrHeightFadeStart","float",ScreenSpaceConstants.O),u.constants.add("ssrHeightFadeEnd","float",ScreenSpaceConstants.b),u.constants.add("waterDiffusion","float",.92),u.constants.add("waterSeaColorMod","float",.8),u.constants.add("correctionViewingPowerFactor","float",.4),u.constants.add("skyZenitColor","vec3",[.52,.68,.9]),u.constants.add("skyColor","vec3",[.67,.79,.9]),u.constants.add("cloudFresnelModifier","vec2",[1.2,.01]),u.code.add(glsl.H`PBRShadingWater shadingInfo;
vec3 getSkyGradientColor(in float cosTheta, in vec3 horizon, in vec3 zenit) {
float exponent = pow((1.0 - cosTheta), fresnelSky[2]);
return mix(zenit, horizon, exponent);
}`),u.uniforms.add(new FloatBindUniform.U("lightingSpecularStrength",(e=>e.lighting.mainLight.specularStrength)),new FloatBindUniform.U("lightingEnvironmentStrength",(e=>e.lighting.mainLight.environmentStrength))),u.code.add(glsl.H`vec3 getSeaColor(in vec3 n, in vec3 v, in vec3 l, vec3 color, in vec3 lightIntensity, in vec3 localUp, in float shadow, float foamIntensity, vec3 viewPosition, vec3 position) {
float reflectionHit = 0.0;
float reflectionHitDiffused = 0.0;
vec3 seaWaterColor = linearizeGamma(color);
vec3 h = normalize(l + v);
shadingInfo.NdotV = clamp(dot(n, v), 0.001, 1.0);
shadingInfo.VdotN = clamp(dot(v, n), 0.001, 1.0);
shadingInfo.NdotH = clamp(dot(n, h), 0.0, 1.0);
shadingInfo.VdotH = clamp(dot(v, h), 0.0, 1.0);
shadingInfo.LdotH = clamp(dot(l, h), 0.0, 1.0);
float upDotV = max(dot(localUp,v), 0.0);
vec3 skyHorizon = linearizeGamma(skyColor);
vec3 skyZenit = linearizeGamma(skyZenitColor);
vec3 skyColor = getSkyGradientColor(upDotV, skyHorizon, skyZenit );
float upDotL = max(dot(localUp,l),0.0);
float daytimeMod = 0.1 + upDotL * 0.9;
skyColor *= daytimeMod;
float shadowModifier = clamp(shadow, 0.8, 1.0);
vec3 fresnelModifier = fresnelReflection(shadingInfo.VdotN, vec3(fresnelSky[0]), fresnelSky[1]);
vec3 reflSky = lightingEnvironmentStrength * fresnelModifier * skyColor * shadowModifier;
vec3 reflSea = seaWaterColor * mix(skyColor, upDotL * lightIntensity * LIGHT_NORMALIZATION, 2.0 / 3.0) * shadowModifier;
vec3 specular = vec3(0.0);
if(upDotV > 0.0 && upDotL > 0.0) {
vec3 specularSun = brdfSpecularWater(shadingInfo, roughness, vec3(fresnelMaterial[0]), fresnelMaterial[1]);
vec3 incidentLight = lightIntensity * LIGHT_NORMALIZATION * shadow;
float NdotL = clamp(dot(n, l), 0.0, 1.0);
specular = lightingSpecularStrength * NdotL * incidentLight * specularSun;
}
vec3 foam = vec3(0.0);
if(upDotV > 0.0) {
foam = foamIntensity2FoamColor(foamIntensityExternal, foamIntensity, skyZenitColor, daytimeMod);
}
float correctionViewingFactor = pow(max(dot(v, localUp), 0.0), correctionViewingPowerFactor);
vec3 normalCorrectedClouds = mix(localUp, n, correctionViewingFactor);
vec3 reflectedWorld = normalize(reflect(-v, normalCorrectedClouds));`),v.cloudReflections&&u.uniforms.add(new FloatBindUniform.U("cloudsOpacity",(e=>e.clouds.opacity))).code.add(glsl.H`vec4 cloudsColor = renderClouds(reflectedWorld, position);
cloudsColor.a = 1.0 - cloudsColor.a;
cloudsColor = pow(cloudsColor, vec4(GAMMA));
cloudsColor *= clamp(fresnelModifier.y * cloudFresnelModifier[0] - cloudFresnelModifier[1], 0.0, 1.0) * cloudsOpacity;`),v.screenSpaceReflections?u.uniforms.add(new Matrix4BindUniform.F("view",(e=>e.camera.viewMatrix)),new Texture2DBindUniform.x("lastFrameColorTexture",(e=>e.ssr.lastFrameColor?.getTexture())),new FloatBindUniform.U("fadeFactorSSR",(e=>e.ssr.fadeFactor))).code.add(glsl.H`vec3 viewDir = normalize(viewPosition);
vec4 viewNormalVectorCoordinate = view * vec4(n, 0.0);
vec3 viewNormal = normalize(viewNormalVectorCoordinate.xyz);
vec4 viewUp = view * vec4(localUp, 0.0);
vec3 viewNormalCorrectedSSR = mix(viewUp.xyz, viewNormal, correctionViewingFactor);
vec3 reflected = normalize(reflect(viewDir, viewNormalCorrectedSSR));
vec3 hitCoordinate = screenSpaceIntersection(reflected, viewPosition, viewDir, viewUp.xyz);
vec3 reflectedColor = vec3(0.0);
if (hitCoordinate.z > 0.0)
{
vec2 reprojectedCoordinate = reprojectionCoordinate(hitCoordinate);
vec2 dCoords = smoothstep(0.3, 0.6, abs(vec2(0.5, 0.5) - hitCoordinate.xy));
float heightMod = smoothstep(ssrHeightFadeEnd, ssrHeightFadeStart, -viewPosition.z);
reflectionHit = clamp(1.0 - (1.3 * dCoords.y), 0.0, 1.0) * heightMod * fadeFactorSSR;
reflectionHitDiffused = waterDiffusion * reflectionHit;
reflectedColor = linearizeGamma(texture(lastFrameColorTexture, reprojectedCoordinate).xyz) *
reflectionHitDiffused * fresnelModifier.y * ssrIntensity;
}
float seaColorMod =  mix(waterSeaColorMod, waterSeaColorMod * 0.5, reflectionHitDiffused);
vec3 waterRenderedColor = tonemapACES((1.0 - reflectionHitDiffused) * reflSky + reflectedColor +
reflSea * seaColorMod + specular + foam);`):u.code.add(glsl.H`vec3 waterRenderedColor = tonemapACES(reflSky + reflSea * waterSeaColorMod + specular + foam);`),v.cloudReflections?v.screenSpaceReflections?u.code.add(glsl.H`return waterRenderedColor * (1.0 - (1.0 - reflectionHit) * cloudsColor.a) + (1.0 - reflectionHit) * cloudsColor.xyz;
}`):u.code.add(glsl.H`return waterRenderedColor * (1.0 - cloudsColor.a) + cloudsColor.xyz;
}`):u.code.add(glsl.H`return waterRenderedColor;
}`)}},"./node_modules/@arcgis/core/views/3d/webgl-engine/lib/DefaultVertexBufferLayouts.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{SL:()=>o,wR:()=>O});var _VertexAttribute_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/lib/VertexAttribute.js"),_webgl_enums_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@arcgis/core/views/webgl/enums.js"),_webgl_VertexElementDescriptor_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@arcgis/core/views/webgl/VertexElementDescriptor.js");const O=[],o=[new _webgl_VertexElementDescriptor_js__WEBPACK_IMPORTED_MODULE_2__._(_VertexAttribute_js__WEBPACK_IMPORTED_MODULE_0__.r.POSITION,3,_webgl_enums_js__WEBPACK_IMPORTED_MODULE_1__.pe.FLOAT,0,12)];new _webgl_VertexElementDescriptor_js__WEBPACK_IMPORTED_MODULE_2__._(_VertexAttribute_js__WEBPACK_IMPORTED_MODULE_0__.r.POSITION,2,_webgl_enums_js__WEBPACK_IMPORTED_MODULE_1__.pe.FLOAT,0,8),new _webgl_VertexElementDescriptor_js__WEBPACK_IMPORTED_MODULE_2__._(_VertexAttribute_js__WEBPACK_IMPORTED_MODULE_0__.r.POSITION,2,_webgl_enums_js__WEBPACK_IMPORTED_MODULE_1__.pe.FLOAT,0,16),new _webgl_VertexElementDescriptor_js__WEBPACK_IMPORTED_MODULE_2__._(_VertexAttribute_js__WEBPACK_IMPORTED_MODULE_0__.r.UV0,2,_webgl_enums_js__WEBPACK_IMPORTED_MODULE_1__.pe.FLOAT,8,16)},"./node_modules/@arcgis/core/views/3d/webgl-engine/lib/ModelDirtyTypes.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{var E,I;__webpack_require__.d(__webpack_exports__,{k:()=>I,q:()=>E}),function(E){E[E.ADD=0]="ADD",E[E.UPDATE=1]="UPDATE",E[E.REMOVE=2]="REMOVE"}(E||(E={})),function(E){E[E.NONE=0]="NONE",E[E.VISIBILITY=1]="VISIBILITY",E[E.GEOMETRY=2]="GEOMETRY",E[E.TRANSFORMATION=4]="TRANSFORMATION",E[E.HIGHLIGHT=8]="HIGHLIGHT",E[E.OCCLUDEE=16]="OCCLUDEE"}(I||(I={}))},"./node_modules/@arcgis/core/views/3d/webgl-engine/lib/RenderGeometry.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{$:()=>g});var _core_uid_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/@arcgis/core/core/uid.js"),_core_libs_gl_matrix_2_math_mat4_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@arcgis/core/core/libs/gl-matrix-2/math/mat4.js"),_core_libs_gl_matrix_2_factories_mat4f64_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@arcgis/core/core/libs/gl-matrix-2/factories/mat4f64.js"),_chunks_vec32_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@arcgis/core/chunks/vec32.js"),_chunks_sphere_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@arcgis/core/chunks/sphere.js"),_support_mathUtils_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/@arcgis/core/views/3d/support/mathUtils.js");class g{constructor(r,i={}){this.geometry=r,this.screenToWorldRatio=1,this._transformation=(0,_core_libs_gl_matrix_2_factories_mat4f64_js__WEBPACK_IMPORTED_MODULE_1__.vt)(),this._shaderTransformation=null,this._boundingSphere=null,this.id=(0,_core_uid_js__WEBPACK_IMPORTED_MODULE_5__.c)(),this.layerUid=i.layerUid,this.graphicUid=i.graphicUid,this.castShadow=i.castShadow??!1,i.objectShaderTransformation&&this.objectShaderTransformationChanged(i.objectShaderTransformation)}get transformation(){return this._transformation}set transformation(t){(0,_core_libs_gl_matrix_2_math_mat4_js__WEBPACK_IMPORTED_MODULE_0__.C)(this._transformation,t),this._boundingSphere=null}get boundingInfo(){return this.geometry.boundingInfo}objectShaderTransformationChanged(t){null==t?this._shaderTransformation=null:(this._shaderTransformation??=(0,_core_libs_gl_matrix_2_factories_mat4f64_js__WEBPACK_IMPORTED_MODULE_1__.vt)(),(0,_core_libs_gl_matrix_2_math_mat4_js__WEBPACK_IMPORTED_MODULE_0__.lw)(this._shaderTransformation,t,this.geometry.transformation)),this._boundingSphere=null}get boundingSphere(){return this.boundingInfo?(null==this._boundingSphere&&(this._boundingSphere??=(0,_chunks_sphere_js__WEBPACK_IMPORTED_MODULE_3__.c)(),(0,_chunks_vec32_js__WEBPACK_IMPORTED_MODULE_2__.t)((0,_chunks_sphere_js__WEBPACK_IMPORTED_MODULE_3__.a)(this._boundingSphere),this.boundingInfo.center,this.shaderTransformation),this._boundingSphere[3]=this.boundingInfo.radius*(0,_support_mathUtils_js__WEBPACK_IMPORTED_MODULE_4__.hG)(this.shaderTransformation)),this._boundingSphere):_chunks_sphere_js__WEBPACK_IMPORTED_MODULE_3__.N}get material(){return this.geometry.material}get type(){return this.geometry.type}get shaderTransformation(){return this._shaderTransformation??this.transformation}get attributes(){return this.geometry.attributes}get highlight(){return this.geometry.highlights}foreachHighlightOptions(t){this.geometry.foreachHighlightOptions(t)}get hasHighlights(){return this.geometry.hasHighlights}get occludees(){return this.geometry.occludees}get visible(){return this.geometry.visible}set visible(t){this.geometry.visible=t}}},"./node_modules/@arcgis/core/views/3d/webgl-engine/materials/ColorMaterial.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{v:()=>A});var vec4f64=__webpack_require__("./node_modules/@arcgis/core/core/libs/gl-matrix-2/factories/vec4f64.js"),InterleavedLayout=__webpack_require__("./node_modules/@arcgis/core/views/3d/support/buffer/InterleavedLayout.js"),ShaderOutput=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/ShaderOutput.js"),olidUtils=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/effects/geometry/olidUtils.js"),basicInterfaces=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/lib/basicInterfaces.js"),GLMaterial=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/lib/GLMaterial.js"),OrderIndependentTransparency=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/lib/OrderIndependentTransparency.js"),RenderSlot=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/lib/RenderSlot.js"),VertexAttribute=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/lib/VertexAttribute.js"),DefaultBufferWriter=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/materials/DefaultBufferWriter.js"),TriangleMaterial=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/materials/TriangleMaterial.js"),VisualVariablePassParameters=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/materials/VisualVariablePassParameters.js"),ReloadableShaderModule=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderTechnique/ReloadableShaderModule.js"),ShaderTechnique=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderTechnique/ShaderTechnique.js"),OITPass=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/lib/OITPass.js"),StencilUtils=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/lib/StencilUtils.js"),ColorMaterial_glsl=__webpack_require__("./node_modules/@arcgis/core/chunks/ColorMaterial.glsl.js"),enums=__webpack_require__("./node_modules/@arcgis/core/views/webgl/enums.js"),renderState=__webpack_require__("./node_modules/@arcgis/core/views/webgl/renderState.js");VisualVariablePassParameters.S;class S extends ShaderTechnique.w{constructor(e,r){super(e,r,new ReloadableShaderModule.$(ColorMaterial_glsl.C,(()=>__webpack_require__.e(905).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@arcgis/core/views/3d/webgl-engine/shaders/ColorMaterial.glsl.js")))))}_createPipeline(e,s){const{oitPass:i,output:d,transparent:h,cullFace:O,draped:S,hasOccludees:_,polygonOffset:w,enableOffset:x}=e,y=i===OITPass.Y.NONE,N=i===OITPass.Y.FrontFace;return(0,renderState.Ey)({blending:(0,ShaderOutput.RN)(d)&&h?(0,OrderIndependentTransparency.Yf)(i):null,culling:(0,renderState.Xt)(O),depthTest:S?null:{func:(0,OrderIndependentTransparency.K_)(i)},depthWrite:(0,OrderIndependentTransparency.z5)(e),drawBuffers:d===ShaderOutput.V.Depth?{buffers:[enums.Hr.NONE]}:(0,OrderIndependentTransparency.m6)(i,d),colorWrite:renderState.kn,stencilWrite:_?StencilUtils.v0:null,stencilTest:_?s?StencilUtils.a9:StencilUtils.qh:null,polygonOffset:y||N?w?T:null:(0,OrderIndependentTransparency.aB)(x)})}initializePipeline(e){return this._occludeePipelineState=this._createPipeline(e,!0),this._createPipeline(e,!1)}getPipeline(e){return e?this._occludeePipelineState:super.getPipeline()}}const T={factor:1,units:1};var tslib_es6=__webpack_require__("./node_modules/@arcgis/core/chunks/tslib.es6.js"),TextureCoordinateAttribute_glsl=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/attributes/TextureCoordinateAttribute.glsl.js"),Emissions_glsl=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/output/Emissions.glsl.js"),ShaderTechniqueConfiguration=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderTechnique/ShaderTechniqueConfiguration.js"),DefaultTechniqueConfiguration=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/materials/DefaultTechniqueConfiguration.js");class a extends DefaultTechniqueConfiguration.E{constructor(){super(...arguments),this.cullFace=basicInterfaces.s2.None,this.hasVertexColors=!1,this.transparent=!1,this.discardInvisibleFragments=!1,this.polygonOffset=!1,this.enableOffset=!0,this.writeDepth=!0,this.hasOccludees=!1,this.terrainDepthTest=!1,this.cullAboveTerrain=!1,this.objectAndLayerIdColorInstanced=!1,this.vvColor=!1,this.draped=!1,this.textureCoordinateType=TextureCoordinateAttribute_glsl.I.None,this.emissionSource=Emissions_glsl.ZX.None,this.occlusionPass=!1,this.hasVvInstancing=!0,this.vvSize=!1,this.vvOpacity=!1}}(0,tslib_es6._)([(0,ShaderTechniqueConfiguration.W)({count:basicInterfaces.s2.COUNT})],a.prototype,"cullFace",void 0),(0,tslib_es6._)([(0,ShaderTechniqueConfiguration.W)()],a.prototype,"hasVertexColors",void 0),(0,tslib_es6._)([(0,ShaderTechniqueConfiguration.W)()],a.prototype,"transparent",void 0),(0,tslib_es6._)([(0,ShaderTechniqueConfiguration.W)()],a.prototype,"discardInvisibleFragments",void 0),(0,tslib_es6._)([(0,ShaderTechniqueConfiguration.W)()],a.prototype,"polygonOffset",void 0),(0,tslib_es6._)([(0,ShaderTechniqueConfiguration.W)()],a.prototype,"enableOffset",void 0),(0,tslib_es6._)([(0,ShaderTechniqueConfiguration.W)()],a.prototype,"writeDepth",void 0),(0,tslib_es6._)([(0,ShaderTechniqueConfiguration.W)()],a.prototype,"hasOccludees",void 0),(0,tslib_es6._)([(0,ShaderTechniqueConfiguration.W)()],a.prototype,"terrainDepthTest",void 0),(0,tslib_es6._)([(0,ShaderTechniqueConfiguration.W)()],a.prototype,"cullAboveTerrain",void 0),(0,tslib_es6._)([(0,ShaderTechniqueConfiguration.W)()],a.prototype,"objectAndLayerIdColorInstanced",void 0),(0,tslib_es6._)([(0,ShaderTechniqueConfiguration.W)()],a.prototype,"vvColor",void 0),(0,tslib_es6._)([(0,ShaderTechniqueConfiguration.W)()],a.prototype,"draped",void 0);var AlphaCutoff=__webpack_require__("./node_modules/@arcgis/core/webscene/support/AlphaCutoff.js");class A extends TriangleMaterial.W{constructor(t){super(t,P),this._configuration=new a,this.supportsEdges=!0,this.produces=new Map([[RenderSlot.N.OPAQUE_MATERIAL,t=>this._isOpaqueMaterialPass(t)],[RenderSlot.N.OPAQUE_MATERIAL_WITHOUT_NORMALS,t=>this._isOpaqueNoSSAODepthPass(t)],[RenderSlot.N.TRANSPARENT_MATERIAL,t=>(0,ShaderOutput.QG)(t)&&this._transparent&&this.parameters.writeDepth],[RenderSlot.N.TRANSPARENT_MATERIAL_WITHOUT_NORMALS,t=>(0,ShaderOutput.eh)(t)&&this._transparent&&this.parameters.writeDepth],[RenderSlot.N.TRANSPARENT_MATERIAL_WITHOUT_DEPTH,t=>(0,ShaderOutput.QG)(t)&&this._transparent&&!this.parameters.writeDepth],[RenderSlot.N.DRAPED_MATERIAL,t=>(0,ShaderOutput.i3)(t)]])}getConfiguration(t,r){return this._configuration.output=t,this._configuration.cullFace=this.parameters.cullFace,this._configuration.hasVertexColors=this.parameters.hasVertexColors&&!this.parameters.vvColor,this._configuration.hasSlicePlane=this.parameters.hasSlicePlane,this._configuration.transparent=this._transparent,this._configuration.discardInvisibleFragments=this._transparent&&!this._isOpaquePass(t)&&this.parameters.discardInvisibleFragments,this._configuration.polygonOffset=this.parameters.polygonOffset,this._configuration.writeDepth=this.parameters.writeDepth,this._configuration.hasOccludees=r.hasOccludees,this._configuration.oitPass=r.oitPass,this._configuration.enableOffset=r.camera.relativeElevation<OrderIndependentTransparency.xt,this._configuration.terrainDepthTest=r.terrainDepthTest&&(0,ShaderOutput.RN)(t),this._configuration.cullAboveTerrain=r.cullAboveTerrain,this._configuration.vvColor=!!this.parameters.vvColor,this._configuration.draped=this.parameters.draped,this._configuration}get visible(){return this.parameters.color[3]>=AlphaCutoff.Q}get _transparent(){return this.parameters.color[3]<1||this.parameters.forceTransparentMode}_isOpaquePass(t){return this._isOpaqueMaterialPass(t)||this._isOpaqueNoSSAODepthPass(t)}_isOpaqueMaterialPass(t){return t===ShaderOutput.V.Highlight||(0,ShaderOutput.QG)(t)&&!this._transparent}_isOpaqueNoSSAODepthPass(t){return(0,ShaderOutput.eh)(t)&&this.parameters.writeDepth&&!this._transparent}createGLMaterial(t){return new d(t)}createBufferWriter(){const t=(0,InterleavedLayout.BP)().vec3f(VertexAttribute.r.POSITION);return(0,olidUtils.E)()&&t.vec4u8(VertexAttribute.r.OBJECTANDLAYERIDCOLOR),this.parameters.vvColor?t.f32(VertexAttribute.r.COLORFEATUREATTRIBUTE):t.vec4u8(VertexAttribute.r.COLOR),new DefaultBufferWriter.Z(t)}}class d extends GLMaterial.A{beginSlot(t){return this.getTechnique(S,t)}}class P extends VisualVariablePassParameters.S{constructor(){super(...arguments),this.color=vec4f64.uY,this.forceTransparentMode=!1,this.writeDepth=!0,this.hasVertexColors=!1,this.polygonOffset=!1,this.hasSlicePlane=!1,this.cullFace=basicInterfaces.s2.None,this.draped=!1,this.discardInvisibleFragments=!1}}},"./node_modules/@arcgis/core/views/3d/webgl-engine/materials/DefaultLayouts.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Ci:()=>t,Dq:()=>I,dB:()=>r,zK:()=>f});var _support_buffer_InterleavedLayout_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@arcgis/core/views/3d/support/buffer/InterleavedLayout.js"),_lib_VertexAttribute_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/lib/VertexAttribute.js");const t=(0,_support_buffer_InterleavedLayout_js__WEBPACK_IMPORTED_MODULE_0__.BP)().vec3f(_lib_VertexAttribute_js__WEBPACK_IMPORTED_MODULE_1__.r.POSITION),f=(0,_support_buffer_InterleavedLayout_js__WEBPACK_IMPORTED_MODULE_0__.BP)().vec3f(_lib_VertexAttribute_js__WEBPACK_IMPORTED_MODULE_1__.r.POSITION).vec2f(_lib_VertexAttribute_js__WEBPACK_IMPORTED_MODULE_1__.r.UV0),r=(0,_support_buffer_InterleavedLayout_js__WEBPACK_IMPORTED_MODULE_0__.BP)().vec3f(_lib_VertexAttribute_js__WEBPACK_IMPORTED_MODULE_1__.r.POSITION).vec4u8(_lib_VertexAttribute_js__WEBPACK_IMPORTED_MODULE_1__.r.COLOR),I=(0,_support_buffer_InterleavedLayout_js__WEBPACK_IMPORTED_MODULE_0__.BP)().vec3f(_lib_VertexAttribute_js__WEBPACK_IMPORTED_MODULE_1__.r.POSITION).vec2f(_lib_VertexAttribute_js__WEBPACK_IMPORTED_MODULE_1__.r.UV0).vec4u8(_lib_VertexAttribute_js__WEBPACK_IMPORTED_MODULE_1__.r.OBJECTANDLAYERIDCOLOR)},"./node_modules/@arcgis/core/views/3d/webgl-engine/materials/TriangleMaterial.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{W:()=>e});var _lib_Material_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/lib/Material.js"),_lib_RayIntersections_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/lib/RayIntersections.js");class e extends _lib_Material_js__WEBPACK_IMPORTED_MODULE_0__.im{intersect(r,e,i,s,o,n){return(0,_lib_RayIntersections_js__WEBPACK_IMPORTED_MODULE_1__.Uy)(r,i,s,o,void 0,n)}}},"./node_modules/@arcgis/core/views/3d/webgl-engine/materials/lineStippleUtils.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Xq:()=>n,wk:()=>h});const t={dash:[4,3],dot:[1,3],"long-dash":[8,3],"short-dash":[4,1],"short-dot":[1,1]},o={dash:t.dash,"dash-dot":[...t.dash,...t.dot],dot:t.dot,"long-dash":t["long-dash"],"long-dash-dot":[...t["long-dash"],...t.dot],"long-dash-dot-dot":[...t["long-dash"],...t.dot,...t.dot],none:null,"short-dash":t["short-dash"],"short-dash-dot":[...t["short-dash"],...t["short-dot"]],"short-dash-dot-dot":[...t["short-dash"],...t["short-dot"],...t["short-dot"]],"short-dot":t["short-dot"],solid:null},d=8;function h(t){return{pattern:[t,t],pixelRatio:2}}function n(t){return"style"===t?.type?function l(t){return null!=t?function s(t,o){return null==t?t:{pattern:t.slice(),pixelRatio:o}}(o[t],d):null}(t.style):null}}}]);
//# sourceMappingURL=8186.fe0d0f44.iframe.bundle.js.map