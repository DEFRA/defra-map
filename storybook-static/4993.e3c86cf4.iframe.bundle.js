"use strict";(self.webpackChunk_defra_flood_map=self.webpackChunk_defra_flood_map||[]).push([[4993],{"./node_modules/@arcgis/core/chunks/Compositing.glsl.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{C:()=>m,a:()=>c,b:()=>g});var _views_3d_webgl_engine_core_shaderLibrary_ScreenSpacePass_glsl_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/ScreenSpacePass.glsl.js"),_views_3d_webgl_engine_core_shaderLibrary_output_ReadDepth_glsl_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/output/ReadDepth.glsl.js"),_views_3d_webgl_engine_core_shaderLibrary_util_RgbaFloatEncoding_glsl_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/util/RgbaFloatEncoding.glsl.js"),_views_3d_webgl_engine_core_shaderModules_Float2BindUniform_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderModules/Float2BindUniform.js"),_views_3d_webgl_engine_core_shaderModules_FloatPassUniform_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderModules/FloatPassUniform.js"),_views_3d_webgl_engine_core_shaderModules_glsl_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderModules/glsl.js"),_views_3d_webgl_engine_core_shaderModules_Texture2DPassUniform_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderModules/Texture2DPassUniform.js"),_views_3d_webgl_engine_shaders_CompositingTechniqueConfiguration_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/shaders/CompositingTechniqueConfiguration.js"),_views_webgl_NoParameters_js__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./node_modules/@arcgis/core/views/webgl/NoParameters.js"),_views_webgl_ShaderBuilder_js__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./node_modules/@arcgis/core/views/webgl/ShaderBuilder.js");class m extends _views_webgl_NoParameters_js__WEBPACK_IMPORTED_MODULE_8__.Y{constructor(){super(...arguments),this.opacity=1}}function g(l){const m=new _views_webgl_ShaderBuilder_js__WEBPACK_IMPORTED_MODULE_9__.N5;m.include(_views_3d_webgl_engine_core_shaderLibrary_ScreenSpacePass_glsl_js__WEBPACK_IMPORTED_MODULE_0__.c),m.fragment.uniforms.add(new _views_3d_webgl_engine_core_shaderModules_Texture2DPassUniform_js__WEBPACK_IMPORTED_MODULE_6__.N("tex",(e=>e.texture))),l.hasOpacityFactor&&m.fragment.uniforms.add(new _views_3d_webgl_engine_core_shaderModules_FloatPassUniform_js__WEBPACK_IMPORTED_MODULE_4__.m("opacity",(e=>e.opacity)));const g=l.blitMode===_views_3d_webgl_engine_shaders_CompositingTechniqueConfiguration_js__WEBPACK_IMPORTED_MODULE_7__.d.Depth;return g&&(m.fragment.uniforms.add(new _views_3d_webgl_engine_core_shaderModules_Float2BindUniform_js__WEBPACK_IMPORTED_MODULE_3__.E("nearFar",(e=>e.camera.nearFar))),m.fragment.include(_views_3d_webgl_engine_core_shaderLibrary_output_ReadDepth_glsl_js__WEBPACK_IMPORTED_MODULE_1__.E),m.fragment.include(_views_3d_webgl_engine_core_shaderLibrary_util_RgbaFloatEncoding_glsl_js__WEBPACK_IMPORTED_MODULE_2__.W)),m.fragment.main.add(_views_3d_webgl_engine_core_shaderModules_glsl_js__WEBPACK_IMPORTED_MODULE_5__.H`
    ${g?_views_3d_webgl_engine_core_shaderModules_glsl_js__WEBPACK_IMPORTED_MODULE_5__.H`
          float normalizedLinearDepth = (-linearDepthFromTexture(tex, uv) - nearFar[0]) / (nearFar[1] - nearFar[0]);
          fragColor = float2rgba(normalizedLinearDepth);`:_views_3d_webgl_engine_core_shaderModules_glsl_js__WEBPACK_IMPORTED_MODULE_5__.H`
          fragColor = texture(tex, uv) ${l.hasOpacityFactor?"* opacity":""};`}`),m}const c=Object.freeze(Object.defineProperty({__proto__:null,CompositingPassParameters:m,build:g},Symbol.toStringTag,{value:"Module"}))},"./node_modules/@arcgis/core/chunks/ImageMaterial.glsl.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{I:()=>b,a:()=>u,b:()=>w});var _views_3d_webgl_engine_core_shaderLibrary_ShaderOutput_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/ShaderOutput.js"),_views_3d_webgl_engine_core_shaderLibrary_Slice_glsl_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/Slice.glsl.js"),_views_3d_webgl_engine_core_shaderLibrary_Transform_glsl_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/Transform.glsl.js"),_views_3d_webgl_engine_core_shaderLibrary_attributes_ObjectAndLayerIdColor_glsl_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/attributes/ObjectAndLayerIdColor.glsl.js"),_views_3d_webgl_engine_core_shaderLibrary_shading_TerrainDepthTest_glsl_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/shading/TerrainDepthTest.glsl.js"),_views_3d_webgl_engine_core_shaderLibrary_util_ColorConversion_glsl_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/util/ColorConversion.glsl.js"),_views_3d_webgl_engine_core_shaderLibrary_util_View_glsl_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/util/View.glsl.js"),_views_3d_webgl_engine_core_shaderModules_FloatPassUniform_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderModules/FloatPassUniform.js"),_views_3d_webgl_engine_core_shaderModules_glsl_js__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderModules/glsl.js"),_views_3d_webgl_engine_core_shaderModules_Texture2DPassUniform_js__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderModules/Texture2DPassUniform.js"),_views_3d_webgl_engine_lib_VertexAttribute_js__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/lib/VertexAttribute.js"),_views_3d_webgl_engine_shaders_OutputColorHighlightOID_glsl_js__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/shaders/OutputColorHighlightOID.glsl.js"),_views_webgl_NoParameters_js__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__("./node_modules/@arcgis/core/views/webgl/NoParameters.js"),_views_webgl_ShaderBuilder_js__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__("./node_modules/@arcgis/core/views/webgl/ShaderBuilder.js");class u extends _views_webgl_NoParameters_js__WEBPACK_IMPORTED_MODULE_12__.Y{}function w(c){const u=new _views_webgl_ShaderBuilder_js__WEBPACK_IMPORTED_MODULE_13__.N5,{vertex:w,fragment:b}=u,{output:f,perspectiveInterpolation:h}=c;return(0,_views_3d_webgl_engine_core_shaderLibrary_util_View_glsl_js__WEBPACK_IMPORTED_MODULE_6__.NB)(w,c),u.include(_views_3d_webgl_engine_core_shaderLibrary_Transform_glsl_js__WEBPACK_IMPORTED_MODULE_2__.d,c),u.include(_views_3d_webgl_engine_core_shaderLibrary_shading_TerrainDepthTest_glsl_js__WEBPACK_IMPORTED_MODULE_4__.Z,c),u.fragment.include(_views_3d_webgl_engine_core_shaderLibrary_Slice_glsl_js__WEBPACK_IMPORTED_MODULE_1__.HQ,c),u.include(_views_3d_webgl_engine_core_shaderLibrary_attributes_ObjectAndLayerIdColor_glsl_js__WEBPACK_IMPORTED_MODULE_3__.g,c),u.include(_views_3d_webgl_engine_shaders_OutputColorHighlightOID_glsl_js__WEBPACK_IMPORTED_MODULE_11__.z,c),u.attributes.add(_views_3d_webgl_engine_lib_VertexAttribute_js__WEBPACK_IMPORTED_MODULE_10__.r.POSITION,"vec3"),u.attributes.add(_views_3d_webgl_engine_lib_VertexAttribute_js__WEBPACK_IMPORTED_MODULE_10__.r.UV0,"vec2"),h&&u.attributes.add(_views_3d_webgl_engine_lib_VertexAttribute_js__WEBPACK_IMPORTED_MODULE_10__.r.PERSPECTIVEDIVIDE,"float"),w.main.add(_views_3d_webgl_engine_core_shaderModules_glsl_js__WEBPACK_IMPORTED_MODULE_8__.H`
    vpos = position;
    forwardViewPosDepth((view * vec4(vpos, 1.0)).xyz);
    vTexCoord = uv0;
    gl_Position = transformPosition(proj, view, vpos);
    ${(0,_views_3d_webgl_engine_core_shaderModules_glsl_js__WEBPACK_IMPORTED_MODULE_8__.If)(h,"gl_Position *= perspectiveDivide;")}`),u.varyings.add("vpos","vec3"),u.varyings.add("vTexCoord","vec2"),b.include(_views_3d_webgl_engine_core_shaderLibrary_util_ColorConversion_glsl_js__WEBPACK_IMPORTED_MODULE_5__.a),b.uniforms.add(new _views_3d_webgl_engine_core_shaderModules_FloatPassUniform_js__WEBPACK_IMPORTED_MODULE_7__.m("opacity",(e=>e.opacity)),new _views_3d_webgl_engine_core_shaderModules_Texture2DPassUniform_js__WEBPACK_IMPORTED_MODULE_9__.N("tex",(e=>e.texture))).main.add(_views_3d_webgl_engine_core_shaderModules_glsl_js__WEBPACK_IMPORTED_MODULE_8__.H`
    discardBySlice(vpos);
    discardByTerrainDepth();
    ${(0,_views_3d_webgl_engine_core_shaderModules_glsl_js__WEBPACK_IMPORTED_MODULE_8__.If)(f===_views_3d_webgl_engine_core_shaderLibrary_ShaderOutput_js__WEBPACK_IMPORTED_MODULE_0__.V.ObjectAndLayerIdColor,"fragColor = vec4(0, 0, 0, 1); return;")}
    vec4 finalColor = texture(tex, vTexCoord) * opacity;
    outputColorHighlightOID(finalColor, vpos);`),u}const b=Object.freeze(Object.defineProperty({__proto__:null,ImageMaterialPassParameters:u,build:w},Symbol.toStringTag,{value:"Module"}))},"./node_modules/@arcgis/core/chunks/LaserlinePath.glsl.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{L:()=>u,b:()=>w});var _core_libs_gl_matrix_2_math_mat4_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@arcgis/core/core/libs/gl-matrix-2/math/mat4.js"),_core_libs_gl_matrix_2_factories_mat4f64_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@arcgis/core/core/libs/gl-matrix-2/factories/mat4f64.js"),_core_libs_gl_matrix_2_math_vec2_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@arcgis/core/core/libs/gl-matrix-2/math/vec2.js"),_core_libs_gl_matrix_2_factories_vec2f64_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@arcgis/core/core/libs/gl-matrix-2/factories/vec2f64.js"),_views_3d_webgl_engine_core_shaderLibrary_Laserline_glsl_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/Laserline.glsl.js"),_views_3d_webgl_engine_core_shaderModules_Float2BindUniform_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderModules/Float2BindUniform.js"),_views_3d_webgl_engine_core_shaderModules_FloatBindUniform_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderModules/FloatBindUniform.js"),_views_3d_webgl_engine_core_shaderModules_FloatPassUniform_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderModules/FloatPassUniform.js"),_views_3d_webgl_engine_core_shaderModules_glsl_js__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderModules/glsl.js"),_views_3d_webgl_engine_core_shaderModules_Matrix4BindUniform_js__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderModules/Matrix4BindUniform.js"),_views_3d_webgl_engine_core_shaderModules_Matrix4PassUniform_js__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderModules/Matrix4PassUniform.js"),_views_3d_webgl_engine_lib_VertexAttribute_js__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/lib/VertexAttribute.js"),_views_webgl_ShaderBuilder_js__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__("./node_modules/@arcgis/core/views/webgl/ShaderBuilder.js");function w(t){const r=new _views_webgl_ShaderBuilder_js__WEBPACK_IMPORTED_MODULE_12__.N5;r.include(_views_3d_webgl_engine_core_shaderLibrary_Laserline_glsl_js__WEBPACK_IMPORTED_MODULE_4__.K,t);const{vertex:w,fragment:u}=r;w.uniforms.add(new _views_3d_webgl_engine_core_shaderModules_Matrix4PassUniform_js__WEBPACK_IMPORTED_MODULE_10__.X("modelView",((t,{camera:o})=>(0,_core_libs_gl_matrix_2_math_mat4_js__WEBPACK_IMPORTED_MODULE_0__.Tl)(f,o.viewMatrix,t.origin))),new _views_3d_webgl_engine_core_shaderModules_Matrix4BindUniform_js__WEBPACK_IMPORTED_MODULE_9__.F("proj",(({camera:e})=>e.projectionMatrix)),new _views_3d_webgl_engine_core_shaderModules_FloatPassUniform_js__WEBPACK_IMPORTED_MODULE_7__.m("glowWidth",((e,{camera:t})=>e.glowWidth*t.pixelRatio)),new _views_3d_webgl_engine_core_shaderModules_Float2BindUniform_js__WEBPACK_IMPORTED_MODULE_5__.E("pixelToNDC",(({camera:e})=>(0,_core_libs_gl_matrix_2_math_vec2_js__WEBPACK_IMPORTED_MODULE_2__.hZ)(g,2/e.fullViewport[2],2/e.fullViewport[3])))),r.attributes.add(_views_3d_webgl_engine_lib_VertexAttribute_js__WEBPACK_IMPORTED_MODULE_11__.r.START,"vec3"),r.attributes.add(_views_3d_webgl_engine_lib_VertexAttribute_js__WEBPACK_IMPORTED_MODULE_11__.r.END,"vec3"),t.spherical&&(r.attributes.add(_views_3d_webgl_engine_lib_VertexAttribute_js__WEBPACK_IMPORTED_MODULE_11__.r.START_UP,"vec3"),r.attributes.add(_views_3d_webgl_engine_lib_VertexAttribute_js__WEBPACK_IMPORTED_MODULE_11__.r.END_UP,"vec3")),r.attributes.add(_views_3d_webgl_engine_lib_VertexAttribute_js__WEBPACK_IMPORTED_MODULE_11__.r.EXTRUDE,"vec2"),r.varyings.add("uv","vec2"),r.varyings.add("vViewStart","vec3"),r.varyings.add("vViewEnd","vec3"),r.varyings.add("vViewSegmentNormal","vec3"),r.varyings.add("vViewStartNormal","vec3"),r.varyings.add("vViewEndNormal","vec3");const h=!t.spherical;return w.main.add(_views_3d_webgl_engine_core_shaderModules_glsl_js__WEBPACK_IMPORTED_MODULE_8__.H`
    vec3 pos = mix(start, end, extrude.x);

    vec4 viewPos = modelView * vec4(pos, 1);
    vec4 projPos = proj * viewPos;
    vec2 ndcPos = projPos.xy / projPos.w;

    // in planar we hardcode the up vectors to be Z-up */
    ${(0,_views_3d_webgl_engine_core_shaderModules_glsl_js__WEBPACK_IMPORTED_MODULE_8__.If)(h,_views_3d_webgl_engine_core_shaderModules_glsl_js__WEBPACK_IMPORTED_MODULE_8__.H`vec3 startUp = vec3(0, 0, 1);`)}
    ${(0,_views_3d_webgl_engine_core_shaderModules_glsl_js__WEBPACK_IMPORTED_MODULE_8__.If)(h,_views_3d_webgl_engine_core_shaderModules_glsl_js__WEBPACK_IMPORTED_MODULE_8__.H`vec3 endUp = vec3(0, 0, 1);`)}

    // up vector corresponding to the location of the vertex, selecting either startUp or endUp */
    vec3 up = extrude.y * mix(startUp, endUp, extrude.x);
    vec3 viewUp = (modelView * vec4(up, 0)).xyz;

    vec4 projPosUp = proj * vec4(viewPos.xyz + viewUp, 1);
    vec2 projUp = normalize(projPosUp.xy / projPosUp.w - ndcPos);

    // extrude ndcPos along projUp to the edge of the screen
    vec2 lxy = abs(sign(projUp) - ndcPos);
    ndcPos += length(lxy) * projUp;

    vViewStart = (modelView * vec4(start, 1)).xyz;
    vViewEnd = (modelView * vec4(end, 1)).xyz;

    vec3 viewStartEndDir = vViewEnd - vViewStart;

    vec3 viewStartUp = (modelView * vec4(startUp, 0)).xyz;

    // the normal of the plane that aligns with the segment and the up vector
    vViewSegmentNormal = normalize(cross(viewStartUp, viewStartEndDir));

    // the normal orthogonal to the segment normal and the start up vector
    vViewStartNormal = -normalize(cross(vViewSegmentNormal, viewStartUp));

    // the normal orthogonal to the segment normal and the end up vector
    vec3 viewEndUp = (modelView * vec4(endUp, 0)).xyz;
    vViewEndNormal = normalize(cross(vViewSegmentNormal, viewEndUp));

    // Add enough padding in the X screen space direction for "glow"
    float xPaddingPixels = sign(dot(vViewSegmentNormal, viewPos.xyz)) * (extrude.x * 2.0 - 1.0) * glowWidth;
    ndcPos.x += xPaddingPixels * pixelToNDC.x;

    // uv is used to read back depth to reconstruct the position at the fragment
    uv = ndcPos * 0.5 + 0.5;

    gl_Position = vec4(ndcPos, 0, 1);
  `),u.uniforms.add(new _views_3d_webgl_engine_core_shaderModules_FloatBindUniform_js__WEBPACK_IMPORTED_MODULE_6__.U("perScreenPixelRatio",(e=>e.camera.perScreenPixelRatio))),u.code.add(_views_3d_webgl_engine_core_shaderModules_glsl_js__WEBPACK_IMPORTED_MODULE_8__.H`float planeDistance(vec3 planeNormal, vec3 planeOrigin, vec3 pos) {
return dot(planeNormal, pos - planeOrigin);
}
float segmentDistancePixels(vec3 segmentNormal, vec3 startNormal, vec3 endNormal, vec3 pos, vec3 start, vec3 end) {
float distSegmentPlane = planeDistance(segmentNormal, start, pos);
float distStartPlane = planeDistance(startNormal, start, pos);
float distEndPlane = planeDistance(endNormal, end, pos);
float dist = max(max(distStartPlane, distEndPlane), abs(distSegmentPlane));
float width = fwidth(distSegmentPlane);
float maxPixelDistance = length(pos) * perScreenPixelRatio * 2.0;
float pixelDist = dist / min(width, maxPixelDistance);
return abs(pixelDist);
}`),u.main.add(_views_3d_webgl_engine_core_shaderModules_glsl_js__WEBPACK_IMPORTED_MODULE_8__.H`fragColor = vec4(0.0);
vec3 dEndStart = vViewEnd - vViewStart;
if (dot(dEndStart, dEndStart) < 1e-5) {
return;
}
vec3 pos;
vec3 normal;
float angleCutoffAdjust;
float depthDiscontinuityAlpha;
if (!laserlineReconstructFromDepth(pos, normal, angleCutoffAdjust, depthDiscontinuityAlpha)) {
return;
}
float distance = segmentDistancePixels(
vViewSegmentNormal,
vViewStartNormal,
vViewEndNormal,
pos,
vViewStart,
vViewEnd
);
vec4 color = laserlineProfile(distance);
float alpha = (1.0 - smoothstep(0.995 - angleCutoffAdjust, 0.999 - angleCutoffAdjust, abs(dot(normal, vViewSegmentNormal))));
fragColor = laserlineOutput(color * alpha * depthDiscontinuityAlpha);`),r}const g=(0,_core_libs_gl_matrix_2_factories_vec2f64_js__WEBPACK_IMPORTED_MODULE_3__.vt)(),f=(0,_core_libs_gl_matrix_2_factories_mat4f64_js__WEBPACK_IMPORTED_MODULE_1__.vt)(),u=Object.freeze(Object.defineProperty({__proto__:null,build:w},Symbol.toStringTag,{value:"Module"}))},"./node_modules/@arcgis/core/chunks/Laserlines.glsl.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{L:()=>$,b:()=>y,d:()=>V});var _core_mathUtils_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@arcgis/core/core/mathUtils.js"),_core_libs_gl_matrix_2_math_vec2_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@arcgis/core/core/libs/gl-matrix-2/math/vec2.js"),_core_libs_gl_matrix_2_factories_vec2f64_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@arcgis/core/core/libs/gl-matrix-2/factories/vec2f64.js"),_vec32_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@arcgis/core/chunks/vec32.js"),_core_libs_gl_matrix_2_factories_vec3f64_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/@arcgis/core/core/libs/gl-matrix-2/factories/vec3f64.js"),_vec42_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/@arcgis/core/chunks/vec42.js"),_core_libs_gl_matrix_2_factories_vec4f64_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./node_modules/@arcgis/core/core/libs/gl-matrix-2/factories/vec4f64.js"),_geometry_support_lineSegment_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./node_modules/@arcgis/core/geometry/support/lineSegment.js"),_geometry_support_plane_js__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./node_modules/@arcgis/core/geometry/support/plane.js"),_sphere_js__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./node_modules/@arcgis/core/chunks/sphere.js"),_views_3d_webgl_engine_core_shaderLibrary_Laserline_glsl_js__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/Laserline.glsl.js"),_views_3d_webgl_engine_core_shaderLibrary_ScreenSpacePass_glsl_js__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/ScreenSpacePass.glsl.js"),_views_3d_webgl_engine_core_shaderModules_Float2PassUniform_js__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderModules/Float2PassUniform.js"),_views_3d_webgl_engine_core_shaderModules_Float3BindUniform_js__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderModules/Float3BindUniform.js"),_views_3d_webgl_engine_core_shaderModules_Float3PassUniform_js__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderModules/Float3PassUniform.js"),_views_3d_webgl_engine_core_shaderModules_Float4PassUniform_js__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderModules/Float4PassUniform.js"),_views_3d_webgl_engine_core_shaderModules_FloatBindUniform_js__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderModules/FloatBindUniform.js"),_views_3d_webgl_engine_core_shaderModules_FloatPassUniform_js__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderModules/FloatPassUniform.js"),_views_3d_webgl_engine_core_shaderModules_glsl_js__WEBPACK_IMPORTED_MODULE_18__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderModules/glsl.js"),_views_webgl_ShaderBuilder_js__WEBPACK_IMPORTED_MODULE_19__=__webpack_require__("./node_modules/@arcgis/core/views/webgl/ShaderBuilder.js");const V=(0,_core_mathUtils_js__WEBPACK_IMPORTED_MODULE_0__.kU)(6);function y(e){const i=new _views_webgl_ShaderBuilder_js__WEBPACK_IMPORTED_MODULE_19__.N5;i.include(_views_3d_webgl_engine_core_shaderLibrary_ScreenSpacePass_glsl_js__WEBPACK_IMPORTED_MODULE_11__.c),i.include(_views_3d_webgl_engine_core_shaderLibrary_Laserline_glsl_js__WEBPACK_IMPORTED_MODULE_10__.K,e);const t=i.fragment;if(e.lineVerticalPlaneEnabled||e.heightManifoldEnabled)if(t.uniforms.add(new _views_3d_webgl_engine_core_shaderModules_FloatPassUniform_js__WEBPACK_IMPORTED_MODULE_17__.m("maxPixelDistance",((i,t)=>e.heightManifoldEnabled?2*t.camera.computeScreenPixelSizeAt(i.heightManifoldTarget):2*t.camera.computeScreenPixelSizeAt(i.lineVerticalPlaneSegment.origin)))),t.code.add(_views_3d_webgl_engine_core_shaderModules_glsl_js__WEBPACK_IMPORTED_MODULE_18__.H`float planeDistancePixels(vec4 plane, vec3 pos) {
float dist = dot(plane.xyz, pos) + plane.w;
float width = fwidth(dist);
dist /= min(width, maxPixelDistance);
return abs(dist);
}`),e.spherical){const e=(e,i,t)=>(0,_vec32_js__WEBPACK_IMPORTED_MODULE_3__.t)(e,i.heightManifoldTarget,t.camera.viewMatrix),i=(e,i)=>(0,_vec32_js__WEBPACK_IMPORTED_MODULE_3__.t)(e,[0,0,0],i.camera.viewMatrix);t.uniforms.add(new _views_3d_webgl_engine_core_shaderModules_Float4PassUniform_js__WEBPACK_IMPORTED_MODULE_15__.E("heightManifoldOrigin",((t,r)=>(e(F,t,r),i(H,r),(0,_vec32_js__WEBPACK_IMPORTED_MODULE_3__.d)(H,H,F),(0,_vec32_js__WEBPACK_IMPORTED_MODULE_3__.n)(G,H),G[3]=(0,_vec32_js__WEBPACK_IMPORTED_MODULE_3__.l)(H),G))),new _views_3d_webgl_engine_core_shaderModules_Float3BindUniform_js__WEBPACK_IMPORTED_MODULE_13__.d("globalOrigin",(e=>i(F,e))),new _views_3d_webgl_engine_core_shaderModules_FloatPassUniform_js__WEBPACK_IMPORTED_MODULE_17__.m("cosSphericalAngleThreshold",((e,i)=>1-Math.max(2,(0,_vec32_js__WEBPACK_IMPORTED_MODULE_3__.j)(i.camera.eye,e.heightManifoldTarget)*i.camera.perRenderPixelRatio)/(0,_vec32_js__WEBPACK_IMPORTED_MODULE_3__.l)(e.heightManifoldTarget)))),t.code.add(_views_3d_webgl_engine_core_shaderModules_glsl_js__WEBPACK_IMPORTED_MODULE_18__.H`float globeDistancePixels(float posInGlobalOriginLength) {
float dist = abs(posInGlobalOriginLength - heightManifoldOrigin.w);
float width = fwidth(dist);
dist /= min(width, maxPixelDistance);
return abs(dist);
}
float heightManifoldDistancePixels(vec4 heightPlane, vec3 pos) {
vec3 posInGlobalOriginNorm = normalize(globalOrigin - pos);
float cosAngle = dot(posInGlobalOriginNorm, heightManifoldOrigin.xyz);
vec3 posInGlobalOrigin = globalOrigin - pos;
float posInGlobalOriginLength = length(posInGlobalOrigin);
float sphericalDistance = globeDistancePixels(posInGlobalOriginLength);
float planarDistance = planeDistancePixels(heightPlane, pos);
return cosAngle < cosSphericalAngleThreshold ? sphericalDistance : planarDistance;
}`)}else t.code.add(_views_3d_webgl_engine_core_shaderModules_glsl_js__WEBPACK_IMPORTED_MODULE_18__.H`float heightManifoldDistancePixels(vec4 heightPlane, vec3 pos) {
return planeDistancePixels(heightPlane, pos);
}`);if(e.pointDistanceEnabled&&(t.uniforms.add(new _views_3d_webgl_engine_core_shaderModules_FloatPassUniform_js__WEBPACK_IMPORTED_MODULE_17__.m("maxPixelDistance",((e,i)=>2*i.camera.computeScreenPixelSizeAt(e.pointDistanceTarget)))),t.code.add(_views_3d_webgl_engine_core_shaderModules_glsl_js__WEBPACK_IMPORTED_MODULE_18__.H`float sphereDistancePixels(vec4 sphere, vec3 pos) {
float dist = distance(sphere.xyz, pos) - sphere.w;
float width = fwidth(dist);
dist /= min(width, maxPixelDistance);
return abs(dist);
}`)),e.intersectsLineEnabled&&t.uniforms.add(new _views_3d_webgl_engine_core_shaderModules_FloatBindUniform_js__WEBPACK_IMPORTED_MODULE_16__.U("perScreenPixelRatio",(e=>e.camera.perScreenPixelRatio))).code.add(_views_3d_webgl_engine_core_shaderModules_glsl_js__WEBPACK_IMPORTED_MODULE_18__.H`float lineDistancePixels(vec3 start, vec3 dir, float radius, vec3 pos) {
float dist = length(cross(dir, pos - start)) / (length(pos) * perScreenPixelRatio);
return abs(dist) - radius;
}`),(e.lineVerticalPlaneEnabled||e.intersectsLineEnabled)&&t.code.add(_views_3d_webgl_engine_core_shaderModules_glsl_js__WEBPACK_IMPORTED_MODULE_18__.H`bool pointIsWithinLine(vec3 pos, vec3 start, vec3 end) {
vec3 dir = end - start;
float t2 = dot(dir, pos - start);
float l2 = dot(dir, dir);
return t2 >= 0.0 && t2 <= l2;
}`),t.main.add(_views_3d_webgl_engine_core_shaderModules_glsl_js__WEBPACK_IMPORTED_MODULE_18__.H`vec3 pos;
vec3 normal;
float angleCutoffAdjust;
float depthDiscontinuityAlpha;
if (!laserlineReconstructFromDepth(pos, normal, angleCutoffAdjust, depthDiscontinuityAlpha)) {
fragColor = vec4(0.0);
return;
}
vec4 color = vec4(0.0);`),e.heightManifoldEnabled){t.uniforms.add(new _views_3d_webgl_engine_core_shaderModules_Float2PassUniform_js__WEBPACK_IMPORTED_MODULE_12__.G("angleCutoff",(e=>O(e))),new _views_3d_webgl_engine_core_shaderModules_Float4PassUniform_js__WEBPACK_IMPORTED_MODULE_15__.E("heightPlane",((e,i)=>R(e.heightManifoldTarget,e.renderCoordsHelper.worldUpAtPosition(e.heightManifoldTarget,F),i.camera.viewMatrix))));const i=e.spherical?_views_3d_webgl_engine_core_shaderModules_glsl_js__WEBPACK_IMPORTED_MODULE_18__.H`normalize(globalOrigin - pos)`:_views_3d_webgl_engine_core_shaderModules_glsl_js__WEBPACK_IMPORTED_MODULE_18__.H`heightPlane.xyz`;t.main.add(_views_3d_webgl_engine_core_shaderModules_glsl_js__WEBPACK_IMPORTED_MODULE_18__.H`
      vec2 angleCutoffAdjusted = angleCutoff - angleCutoffAdjust;
      // Fade out laserlines on flat surfaces
      float heightManifoldAlpha = 1.0 - smoothstep(angleCutoffAdjusted.x, angleCutoffAdjusted.y, abs(dot(normal, ${i})));
      vec4 heightManifoldColor = laserlineProfile(heightManifoldDistancePixels(heightPlane, pos));
      color = max(color, heightManifoldColor * heightManifoldAlpha);`)}return e.pointDistanceEnabled&&(t.uniforms.add(new _views_3d_webgl_engine_core_shaderModules_Float2PassUniform_js__WEBPACK_IMPORTED_MODULE_12__.G("angleCutoff",(e=>O(e))),new _views_3d_webgl_engine_core_shaderModules_Float4PassUniform_js__WEBPACK_IMPORTED_MODULE_15__.E("pointDistanceSphere",((e,i)=>function E(e,i){return(0,_vec32_js__WEBPACK_IMPORTED_MODULE_3__.t)((0,_sphere_js__WEBPACK_IMPORTED_MODULE_9__.a)(N),e.pointDistanceOrigin,i.camera.viewMatrix),N[3]=(0,_vec32_js__WEBPACK_IMPORTED_MODULE_3__.j)(e.pointDistanceOrigin,e.pointDistanceTarget),N}(e,i)))),t.main.add(_views_3d_webgl_engine_core_shaderModules_glsl_js__WEBPACK_IMPORTED_MODULE_18__.H`float pointDistanceSphereDistance = sphereDistancePixels(pointDistanceSphere, pos);
vec4 pointDistanceSphereColor = laserlineProfile(pointDistanceSphereDistance);
float pointDistanceSphereAlpha = 1.0 - smoothstep(angleCutoff.x, angleCutoff.y, abs(dot(normal, normalize(pos - pointDistanceSphere.xyz))));
color = max(color, pointDistanceSphereColor * pointDistanceSphereAlpha);`)),e.lineVerticalPlaneEnabled&&(t.uniforms.add(new _views_3d_webgl_engine_core_shaderModules_Float2PassUniform_js__WEBPACK_IMPORTED_MODULE_12__.G("angleCutoff",(e=>O(e))),new _views_3d_webgl_engine_core_shaderModules_Float4PassUniform_js__WEBPACK_IMPORTED_MODULE_15__.E("lineVerticalPlane",((e,i)=>function z(e,i){const t=(0,_geometry_support_lineSegment_js__WEBPACK_IMPORTED_MODULE_7__.sd)(e.lineVerticalPlaneSegment,.5,F),n=e.renderCoordsHelper.worldUpAtPosition(t,W),o=(0,_vec32_js__WEBPACK_IMPORTED_MODULE_3__.n)(H,e.lineVerticalPlaneSegment.vector),r=(0,_vec32_js__WEBPACK_IMPORTED_MODULE_3__.e)(F,n,o);return(0,_vec32_js__WEBPACK_IMPORTED_MODULE_3__.n)(r,r),R(e.lineVerticalPlaneSegment.origin,r,i.camera.viewMatrix)}(e,i))),new _views_3d_webgl_engine_core_shaderModules_Float3PassUniform_js__WEBPACK_IMPORTED_MODULE_14__.t("lineVerticalStart",((e,i)=>function I(e,i){const t=(0,_vec32_js__WEBPACK_IMPORTED_MODULE_3__.c)(F,e.lineVerticalPlaneSegment.origin);return e.renderCoordsHelper.setAltitude(t,0),(0,_vec32_js__WEBPACK_IMPORTED_MODULE_3__.t)(t,t,i.camera.viewMatrix)}(e,i))),new _views_3d_webgl_engine_core_shaderModules_Float3PassUniform_js__WEBPACK_IMPORTED_MODULE_14__.t("lineVerticalEnd",((e,i)=>function T(e,i){const t=(0,_vec32_js__WEBPACK_IMPORTED_MODULE_3__.g)(F,e.lineVerticalPlaneSegment.origin,e.lineVerticalPlaneSegment.vector);return e.renderCoordsHelper.setAltitude(t,0),(0,_vec32_js__WEBPACK_IMPORTED_MODULE_3__.t)(t,t,i.camera.viewMatrix)}(e,i)))),t.main.add(_views_3d_webgl_engine_core_shaderModules_glsl_js__WEBPACK_IMPORTED_MODULE_18__.H`if (pointIsWithinLine(pos, lineVerticalStart, lineVerticalEnd)) {
float lineVerticalDistance = planeDistancePixels(lineVerticalPlane, pos);
vec4 lineVerticalColor = laserlineProfile(lineVerticalDistance);
float lineVerticalAlpha = 1.0 - smoothstep(angleCutoff.x, angleCutoff.y, abs(dot(normal, lineVerticalPlane.xyz)));
color = max(color, lineVerticalColor * lineVerticalAlpha);
}`)),e.intersectsLineEnabled&&(t.uniforms.add(new _views_3d_webgl_engine_core_shaderModules_Float2PassUniform_js__WEBPACK_IMPORTED_MODULE_12__.G("angleCutoff",(e=>O(e))),new _views_3d_webgl_engine_core_shaderModules_Float3PassUniform_js__WEBPACK_IMPORTED_MODULE_14__.t("intersectsLineStart",((e,i)=>(0,_vec32_js__WEBPACK_IMPORTED_MODULE_3__.t)(F,e.lineStartWorld,i.camera.viewMatrix))),new _views_3d_webgl_engine_core_shaderModules_Float3PassUniform_js__WEBPACK_IMPORTED_MODULE_14__.t("intersectsLineEnd",((e,i)=>(0,_vec32_js__WEBPACK_IMPORTED_MODULE_3__.t)(F,e.lineEndWorld,i.camera.viewMatrix))),new _views_3d_webgl_engine_core_shaderModules_Float3PassUniform_js__WEBPACK_IMPORTED_MODULE_14__.t("intersectsLineDirection",((e,i)=>((0,_vec32_js__WEBPACK_IMPORTED_MODULE_3__.c)(G,e.intersectsLineSegment.vector),G[3]=0,(0,_vec32_js__WEBPACK_IMPORTED_MODULE_3__.n)(F,(0,_vec42_js__WEBPACK_IMPORTED_MODULE_5__.t)(G,G,i.camera.viewMatrix))))),new _views_3d_webgl_engine_core_shaderModules_FloatPassUniform_js__WEBPACK_IMPORTED_MODULE_17__.m("intersectsLineRadius",(e=>e.intersectsLineRadius))),t.main.add(_views_3d_webgl_engine_core_shaderModules_glsl_js__WEBPACK_IMPORTED_MODULE_18__.H`if (pointIsWithinLine(pos, intersectsLineStart, intersectsLineEnd)) {
float intersectsLineDistance = lineDistancePixels(intersectsLineStart, intersectsLineDirection, intersectsLineRadius, pos);
vec4 intersectsLineColor = laserlineProfile(intersectsLineDistance);
float intersectsLineAlpha = 1.0 - smoothstep(angleCutoff.x, angleCutoff.y, 1.0 - abs(dot(normal, intersectsLineDirection)));
color = max(color, intersectsLineColor * intersectsLineAlpha);
}`)),t.main.add(_views_3d_webgl_engine_core_shaderModules_glsl_js__WEBPACK_IMPORTED_MODULE_18__.H`fragColor = laserlineOutput(color * depthDiscontinuityAlpha);`),i}function O(t){return(0,_core_libs_gl_matrix_2_math_vec2_js__WEBPACK_IMPORTED_MODULE_1__.hZ)(U,Math.cos(t.angleCutoff),Math.cos(Math.max(0,t.angleCutoff-(0,_core_mathUtils_js__WEBPACK_IMPORTED_MODULE_0__.kU)(2))))}function R(e,i,t){return(0,_vec32_js__WEBPACK_IMPORTED_MODULE_3__.t)(_,e,t),(0,_vec32_js__WEBPACK_IMPORTED_MODULE_3__.c)(G,i),G[3]=0,(0,_vec42_js__WEBPACK_IMPORTED_MODULE_5__.t)(G,G,t),(0,_geometry_support_plane_js__WEBPACK_IMPORTED_MODULE_8__.O_)(_,G,B)}const U=(0,_core_libs_gl_matrix_2_factories_vec2f64_js__WEBPACK_IMPORTED_MODULE_2__.vt)(),F=(0,_core_libs_gl_matrix_2_factories_vec3f64_js__WEBPACK_IMPORTED_MODULE_4__.vt)(),G=(0,_core_libs_gl_matrix_2_factories_vec4f64_js__WEBPACK_IMPORTED_MODULE_6__.vt)(),W=(0,_core_libs_gl_matrix_2_factories_vec3f64_js__WEBPACK_IMPORTED_MODULE_4__.vt)(),H=(0,_core_libs_gl_matrix_2_factories_vec3f64_js__WEBPACK_IMPORTED_MODULE_4__.vt)(),_=(0,_core_libs_gl_matrix_2_factories_vec3f64_js__WEBPACK_IMPORTED_MODULE_4__.vt)(),B=(0,_geometry_support_plane_js__WEBPACK_IMPORTED_MODULE_8__.vt)(),N=(0,_sphere_js__WEBPACK_IMPORTED_MODULE_9__.c)(),$=Object.freeze(Object.defineProperty({__proto__:null,build:y,defaultAngleCutoff:V},Symbol.toStringTag,{value:"Module"}))},"./node_modules/@arcgis/core/chunks/ShadedColorMaterial.glsl.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{S:()=>u,b:()=>w});var _core_libs_gl_matrix_2_factories_vec4f64_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@arcgis/core/core/libs/gl-matrix-2/factories/vec4f64.js"),_views_3d_webgl_engine_core_shaderLibrary_ScreenSizeScaling_glsl_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/ScreenSizeScaling.glsl.js"),_views_3d_webgl_engine_core_shaderLibrary_Slice_glsl_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/Slice.glsl.js"),_views_3d_webgl_engine_core_shaderLibrary_Transform_glsl_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/Transform.glsl.js"),_views_3d_webgl_engine_core_shaderLibrary_shading_TerrainDepthTest_glsl_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/shading/TerrainDepthTest.glsl.js"),_views_3d_webgl_engine_core_shaderLibrary_util_ColorConversion_glsl_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/util/ColorConversion.glsl.js"),_views_3d_webgl_engine_core_shaderLibrary_util_View_glsl_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/util/View.glsl.js"),_views_3d_webgl_engine_core_shaderModules_Float3PassUniform_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderModules/Float3PassUniform.js"),_views_3d_webgl_engine_core_shaderModules_Float4PassUniform_js__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderModules/Float4PassUniform.js"),_views_3d_webgl_engine_core_shaderModules_glsl_js__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderModules/glsl.js"),_views_3d_webgl_engine_lib_VertexAttribute_js__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/lib/VertexAttribute.js"),_views_3d_webgl_engine_shaders_OutputColorHighlightOID_glsl_js__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/shaders/OutputColorHighlightOID.glsl.js"),_views_webgl_ShaderBuilder_js__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__("./node_modules/@arcgis/core/views/webgl/ShaderBuilder.js");function w(e){const w=new _views_webgl_ShaderBuilder_js__WEBPACK_IMPORTED_MODULE_12__.N5;w.include(_views_3d_webgl_engine_core_shaderLibrary_Transform_glsl_js__WEBPACK_IMPORTED_MODULE_3__.d,e),w.include(_views_3d_webgl_engine_core_shaderLibrary_ScreenSizeScaling_glsl_js__WEBPACK_IMPORTED_MODULE_1__.L,e),w.fragment.include(_views_3d_webgl_engine_core_shaderLibrary_Slice_glsl_js__WEBPACK_IMPORTED_MODULE_2__.HQ,e),w.include(_views_3d_webgl_engine_shaders_OutputColorHighlightOID_glsl_js__WEBPACK_IMPORTED_MODULE_11__.z,e),w.include(_views_3d_webgl_engine_core_shaderLibrary_shading_TerrainDepthTest_glsl_js__WEBPACK_IMPORTED_MODULE_4__.Z,e);const{vertex:b,fragment:u}=w;return u.include(_views_3d_webgl_engine_core_shaderLibrary_util_ColorConversion_glsl_js__WEBPACK_IMPORTED_MODULE_5__.a),(0,_views_3d_webgl_engine_core_shaderLibrary_util_View_glsl_js__WEBPACK_IMPORTED_MODULE_6__.NB)(b,e),u.uniforms.add(new _views_3d_webgl_engine_core_shaderModules_Float4PassUniform_js__WEBPACK_IMPORTED_MODULE_8__.E("uColor",(e=>e.color))),w.attributes.add(_views_3d_webgl_engine_lib_VertexAttribute_js__WEBPACK_IMPORTED_MODULE_10__.r.POSITION,"vec3"),w.varyings.add("vWorldPosition","vec3"),e.screenSizeEnabled&&w.attributes.add(_views_3d_webgl_engine_lib_VertexAttribute_js__WEBPACK_IMPORTED_MODULE_10__.r.OFFSET,"vec3"),e.shadingEnabled&&((0,_views_3d_webgl_engine_core_shaderLibrary_util_View_glsl_js__WEBPACK_IMPORTED_MODULE_6__.S7)(b),w.attributes.add(_views_3d_webgl_engine_lib_VertexAttribute_js__WEBPACK_IMPORTED_MODULE_10__.r.NORMAL,"vec3"),w.varyings.add("vViewNormal","vec3"),u.uniforms.add(new _views_3d_webgl_engine_core_shaderModules_Float3PassUniform_js__WEBPACK_IMPORTED_MODULE_7__.t("shadingDirection",(e=>e.shadingDirection))),u.uniforms.add(new _views_3d_webgl_engine_core_shaderModules_Float4PassUniform_js__WEBPACK_IMPORTED_MODULE_8__.E("shadedColor",(e=>f(e.shadingTint,e.color))))),b.main.add(_views_3d_webgl_engine_core_shaderModules_glsl_js__WEBPACK_IMPORTED_MODULE_9__.H`
      vWorldPosition = ${e.screenSizeEnabled?_views_3d_webgl_engine_core_shaderModules_glsl_js__WEBPACK_IMPORTED_MODULE_9__.H`screenSizeScaling(offset, position)`:_views_3d_webgl_engine_core_shaderModules_glsl_js__WEBPACK_IMPORTED_MODULE_9__.H`position`};
      ${e.shadingEnabled?_views_3d_webgl_engine_core_shaderModules_glsl_js__WEBPACK_IMPORTED_MODULE_9__.H`vec3 worldNormal = normal;
                 vViewNormal = (viewNormal * vec4(worldNormal, 1)).xyz;`:""}
      forwardViewPosDepth((view * vec4(vWorldPosition, 1.0)).xyz);
      gl_Position = transformPosition(proj, view, vWorldPosition);
  `),u.main.add(_views_3d_webgl_engine_core_shaderModules_glsl_js__WEBPACK_IMPORTED_MODULE_9__.H`
      discardBySlice(vWorldPosition);
      discardByTerrainDepth();
      ${e.shadingEnabled?_views_3d_webgl_engine_core_shaderModules_glsl_js__WEBPACK_IMPORTED_MODULE_9__.H`vec3 viewNormalNorm = normalize(vViewNormal);
             float shadingFactor = 1.0 - clamp(-dot(viewNormalNorm, shadingDirection), 0.0, 1.0);
             vec4 finalColor = mix(uColor, shadedColor, shadingFactor);`:_views_3d_webgl_engine_core_shaderModules_glsl_js__WEBPACK_IMPORTED_MODULE_9__.H`vec4 finalColor = uColor;`}
      outputColorHighlightOID(finalColor, vWorldPosition);`),w}function f(e,r){const i=1-e[3],o=e[3]+r[3]*i;return 0===o?(b[3]=o,b):(b[0]=(e[0]*e[3]+r[0]*r[3]*i)/o,b[1]=(e[1]*e[3]+r[1]*r[3]*i)/o,b[2]=(e[2]*e[3]+r[2]*r[3]*i)/o,b[3]=r[3],b)}const b=(0,_core_libs_gl_matrix_2_factories_vec4f64_js__WEBPACK_IMPORTED_MODULE_0__.vt)(),u=Object.freeze(Object.defineProperty({__proto__:null,build:w},Symbol.toStringTag,{value:"Module"}))},"./node_modules/@arcgis/core/chunks/SlicePlaneMaterial.glsl.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{S:()=>l,b:()=>g});var _views_3d_webgl_engine_core_shaderLibrary_util_View_glsl_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/util/View.glsl.js"),_views_3d_webgl_engine_core_shaderModules_Float4PassUniform_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderModules/Float4PassUniform.js"),_views_3d_webgl_engine_core_shaderModules_FloatPassUniform_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderModules/FloatPassUniform.js"),_views_3d_webgl_engine_core_shaderModules_glsl_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderModules/glsl.js"),_views_3d_webgl_engine_lib_VertexAttribute_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/lib/VertexAttribute.js"),_views_webgl_ShaderBuilder_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/@arcgis/core/views/webgl/ShaderBuilder.js");function g(g){const l=new _views_webgl_ShaderBuilder_js__WEBPACK_IMPORTED_MODULE_5__.N5,{vertex:t,fragment:s,attributes:n,varyings:c}=l;return(0,_views_3d_webgl_engine_core_shaderLibrary_util_View_glsl_js__WEBPACK_IMPORTED_MODULE_0__.NB)(t,g),n.add(_views_3d_webgl_engine_lib_VertexAttribute_js__WEBPACK_IMPORTED_MODULE_4__.r.POSITION,"vec3"),n.add(_views_3d_webgl_engine_lib_VertexAttribute_js__WEBPACK_IMPORTED_MODULE_4__.r.UV0,"vec2"),c.add("vUV","vec2"),t.main.add(_views_3d_webgl_engine_core_shaderModules_glsl_js__WEBPACK_IMPORTED_MODULE_3__.H`vUV = uv0;
gl_Position = proj * view * vec4(position, 1.0);`),s.uniforms.add(new _views_3d_webgl_engine_core_shaderModules_Float4PassUniform_js__WEBPACK_IMPORTED_MODULE_1__.E("backgroundColor",(e=>e.backgroundColor)),new _views_3d_webgl_engine_core_shaderModules_Float4PassUniform_js__WEBPACK_IMPORTED_MODULE_1__.E("gridColor",(e=>e.gridColor)),new _views_3d_webgl_engine_core_shaderModules_FloatPassUniform_js__WEBPACK_IMPORTED_MODULE_2__.m("gridWidth",(e=>e.gridWidth))).main.add(_views_3d_webgl_engine_core_shaderModules_glsl_js__WEBPACK_IMPORTED_MODULE_3__.H`const float LINE_WIDTH = 1.0;
vec2 uvScaled = vUV * gridWidth;
vec2 gridUV = (fract(uvScaled + 0.5) - 0.5) / (LINE_WIDTH * fwidth(uvScaled));
vec2 grid = (1.0 - step(0.5, gridUV)) * step(-0.5, gridUV);
grid.x *= step(0.5, uvScaled.x) * step(uvScaled.x, gridWidth - 0.5);
grid.y *= step(0.5, uvScaled.y) * step(uvScaled.y, gridWidth - 0.5);
float gridFade = max(grid.x, grid.y);
float gridAlpha = gridColor.a * gridFade;
fragColor =
vec4(backgroundColor.rgb * backgroundColor.a, backgroundColor.a) * (1.0 - gridAlpha) +
vec4(gridColor.rgb, 1.0) * gridAlpha;`),l}const l=Object.freeze(Object.defineProperty({__proto__:null,build:g},Symbol.toStringTag,{value:"Module"}))},"./node_modules/@arcgis/core/chunks/earcut.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{function e(e,t,x){x=x||2;var i,u,v,y,o,p,a,l=t&&t.length,h=l?t[0]*x:e.length,c=n(e,0,h,x,!0),s=[];if(!c||c.next===c.prev)return s;if(l&&(c=f(e,t,c,x)),e.length>80*x){i=v=e[0],u=y=e[1];for(var Z=x;Z<h;Z+=x)(o=e[Z])<i&&(i=o),(p=e[Z+1])<u&&(u=p),o>v&&(v=o),p>y&&(y=p);a=0!==(a=Math.max(v-i,y-u))?1/a:0}return r(c,s,x,i,u,a),s}function n(e,n,t,r,x){var i,u;if(x===E(e,n,t,r)>0)for(i=n;i<t;i+=r)u=B(i,e[i],e[i+1],u);else for(i=t-r;i>=n;i-=r)u=B(i,e[i],e[i+1],u);if(u&&M(u,u.next)){var v=u.next;C(u),u=v}return u}function t(e,n){if(!e)return e;n||(n=e);var t,r=e;do{if(t=!1,r.steiner||!M(r,r.next)&&0!==w(r.prev,r,r.next))r=r.next;else{var x=r.prev;if(C(r),(r=n=x)===r.next)break;t=!0}}while(t||r!==n);return n}function r(e,n,f,y,o,p,a){if(e){!a&&p&&h(e,y,o,p);for(var l,c,s=e;e.prev!==e.next;)if(l=e.prev,c=e.next,p?i(e,y,o,p):x(e))n.push(l.i/f),n.push(e.i/f),n.push(c.i/f),C(e),e=c.next,s=c.next;else if((e=c)===s){a?1===a?r(e=u(t(e),n,f),n,f,y,o,p,2):2===a&&v(e,n,f,y,o,p):r(t(e),n,f,y,o,p,1);break}}}function x(e){var n=e.prev,t=e,r=e.next;if(w(n,t,r)>=0)return!1;for(var x=e.next.next;x!==e.prev;){if(g(n.x,n.y,t.x,t.y,r.x,r.y,x.x,x.y)&&w(x.prev,x,x.next)>=0)return!1;x=x.next}return!0}function i(e,n,t,r){var x=e.prev,i=e,u=e.next;if(w(x,i,u)>=0)return!1;for(var v=x.x<i.x?x.x<u.x?x.x:u.x:i.x<u.x?i.x:u.x,f=x.y<i.y?x.y<u.y?x.y:u.y:i.y<u.y?i.y:u.y,y=x.x>i.x?x.x>u.x?x.x:u.x:i.x>u.x?i.x:u.x,o=x.y>i.y?x.y>u.y?x.y:u.y:i.y>u.y?i.y:u.y,p=s(v,f,n,t,r),a=s(y,o,n,t,r),l=e.prevZ,h=e.nextZ;l&&l.z>=p&&h&&h.z<=a;){if(l!==e.prev&&l!==e.next&&g(x.x,x.y,i.x,i.y,u.x,u.y,l.x,l.y)&&w(l.prev,l,l.next)>=0)return!1;if(l=l.prevZ,h!==e.prev&&h!==e.next&&g(x.x,x.y,i.x,i.y,u.x,u.y,h.x,h.y)&&w(h.prev,h,h.next)>=0)return!1;h=h.nextZ}for(;l&&l.z>=p;){if(l!==e.prev&&l!==e.next&&g(x.x,x.y,i.x,i.y,u.x,u.y,l.x,l.y)&&w(l.prev,l,l.next)>=0)return!1;l=l.prevZ}for(;h&&h.z<=a;){if(h!==e.prev&&h!==e.next&&g(x.x,x.y,i.x,i.y,u.x,u.y,h.x,h.y)&&w(h.prev,h,h.next)>=0)return!1;h=h.nextZ}return!0}function u(e,n,r){var x=e;do{var i=x.prev,u=x.next.next;!M(i,u)&&z(i,x,x.next,u)&&j(i,u)&&j(u,i)&&(n.push(i.i/r),n.push(x.i/r),n.push(u.i/r),C(x),C(x.next),x=e=u),x=x.next}while(x!==e);return t(x)}function v(e,n,x,i,u,v){var f=e;do{for(var y=f.next.next;y!==f.prev;){if(f.i!==y.i&&d(f,y)){var o=A(f,y);return f=t(f,f.next),o=t(o,o.next),r(f,n,x,i,u,v),void r(o,n,x,i,u,v)}y=y.next}f=f.next}while(f!==e)}function f(e,r,x,i){var u,v,f,o=[];for(u=0,v=r.length;u<v;u++)(f=n(e,r[u]*i,u<v-1?r[u+1]*i:e.length,i,!1))===f.next&&(f.steiner=!0),o.push(Z(f));for(o.sort(y),u=0;u<o.length;u++)x=t(x=p(o[u],x),x.next);return x}function y(e,n){return e.x-n.x}function o(e){if(e.next.prev===e)return e;let n=e;for(;;){const t=n.next;if(t.prev===n||t===n||t===e)break;n=t}return n}function p(e,n){var r=function a(e,n){var t,r=n,x=e.x,i=e.y,u=-1/0;do{if(i<=r.y&&i>=r.next.y&&r.next.y!==r.y){var v=r.x+(i-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(v<=x&&v>u){if(u=v,v===x){if(i===r.y)return r;if(i===r.next.y)return r.next}t=r.x<r.next.x?r:r.next}}r=r.next}while(r!==n);if(!t)return null;if(x===u)return t;var f,y=t,o=t.x,p=t.y,a=1/0;r=t;do{x>=r.x&&r.x>=o&&x!==r.x&&g(i<p?x:u,i,o,p,i<p?u:x,i,r.x,r.y)&&(f=Math.abs(i-r.y)/(x-r.x),j(r,e)&&(f<a||f===a&&(r.x>t.x||r.x===t.x&&l(t,r)))&&(t=r,a=f)),r=r.next}while(r!==y);return t}(e,n);if(!r)return n;var x=A(r,e),i=t(r,r.next);let u=o(x);return t(u,u.next),i=o(i),o(n===r?i:n)}function l(e,n){return w(e.prev,e,n.prev)<0&&w(n.next,e,e.next)<0}function h(e,n,t,r){var x=e;do{null===x.z&&(x.z=s(x.x,x.y,n,t,r)),x.prevZ=x.prev,x.nextZ=x.next,x=x.next}while(x!==e);x.prevZ.nextZ=null,x.prevZ=null,function c(e){var n,t,r,x,i,u,v,f,y=1;do{for(t=e,e=null,i=null,u=0;t;){for(u++,r=t,v=0,n=0;n<y&&(v++,r=r.nextZ);n++);for(f=y;v>0||f>0&&r;)0!==v&&(0===f||!r||t.z<=r.z)?(x=t,t=t.nextZ,v--):(x=r,r=r.nextZ,f--),i?i.nextZ=x:e=x,x.prevZ=i,i=x;t=r}i.nextZ=null,y*=2}while(u>1);return e}(x)}function s(e,n,t,r,x){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-t)*x)|e<<8))|e<<4))|e<<2))|e<<1))|(n=1431655765&((n=858993459&((n=252645135&((n=16711935&((n=32767*(n-r)*x)|n<<8))|n<<4))|n<<2))|n<<1))<<1}function Z(e){var n=e,t=e;do{(n.x<t.x||n.x===t.x&&n.y<t.y)&&(t=n),n=n.next}while(n!==e);return t}function g(e,n,t,r,x,i,u,v){return(x-u)*(n-v)-(e-u)*(i-v)>=0&&(e-u)*(r-v)-(t-u)*(n-v)>=0&&(t-u)*(i-v)-(x-u)*(r-v)>=0}function d(e,n){return e.next.i!==n.i&&e.prev.i!==n.i&&!function k(e,n){var t=e;do{if(t.i!==e.i&&t.next.i!==e.i&&t.i!==n.i&&t.next.i!==n.i&&z(t,t.next,e,n))return!0;t=t.next}while(t!==e);return!1}(e,n)&&(j(e,n)&&j(n,e)&&function q(e,n){var t=e,r=!1,x=(e.x+n.x)/2,i=(e.y+n.y)/2;do{t.y>i!=t.next.y>i&&t.next.y!==t.y&&x<(t.next.x-t.x)*(i-t.y)/(t.next.y-t.y)+t.x&&(r=!r),t=t.next}while(t!==e);return r}(e,n)&&(w(e.prev,e,n.prev)||w(e,n.prev,n))||M(e,n)&&w(e.prev,e,e.next)>0&&w(n.prev,n,n.next)>0)}function w(e,n,t){return(n.y-e.y)*(t.x-n.x)-(n.x-e.x)*(t.y-n.y)}function M(e,n){return e.x===n.x&&e.y===n.y}function z(e,n,t,r){var x=m(w(e,n,t)),i=m(w(e,n,r)),u=m(w(t,r,e)),v=m(w(t,r,n));return x!==i&&u!==v||!(0!==x||!b(e,t,n))||!(0!==i||!b(e,r,n))||!(0!==u||!b(t,e,r))||!(0!==v||!b(t,n,r))}function b(e,n,t){return n.x<=Math.max(e.x,t.x)&&n.x>=Math.min(e.x,t.x)&&n.y<=Math.max(e.y,t.y)&&n.y>=Math.min(e.y,t.y)}function m(e){return e>0?1:e<0?-1:0}function j(e,n){return w(e.prev,e,e.next)<0?w(e,n,e.next)>=0&&w(e,e.prev,n)>=0:w(e,n,e.prev)<0||w(e,e.next,n)<0}function A(e,n){var t=new D(e.i,e.x,e.y),r=new D(n.i,n.x,n.y),x=e.next,i=n.prev;return e.next=n,n.prev=e,t.next=x,x.prev=t,r.next=t,t.prev=r,i.next=r,r.prev=i,r}function B(e,n,t,r){var x=new D(e,n,t);return r?(x.next=r.next,x.prev=r,r.next.prev=x,r.next=x):(x.prev=x,x.next=x),x}function C(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function D(e,n,t){this.i=e,this.x=n,this.y=t,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function E(e,n,t,r){for(var x=0,i=n,u=t-r;i<t;i+=r)x+=(e[u]-e[i])*(e[i+1]+e[u+1]),u=i;return x}__webpack_require__.d(__webpack_exports__,{e:()=>e}),e.deviation=function(e,n,t,r){var x=n&&n.length,i=x?n[0]*t:e.length,u=Math.abs(E(e,0,i,t));if(x)for(var v=0,f=n.length;v<f;v++){var y=n[v]*t,o=v<f-1?n[v+1]*t:e.length;u-=Math.abs(E(e,y,o,t))}var p=0;for(v=0;v<r.length;v+=3){var a=r[v]*t,l=r[v+1]*t,h=r[v+2]*t;p+=Math.abs((e[a]-e[h])*(e[l+1]-e[a+1])-(e[a]-e[l])*(e[h+1]-e[a+1]))}return 0===u&&0===p?0:Math.abs((p-u)/u)},e.flatten=function(e){for(var n=e[0][0].length,t={vertices:[],holes:[],dimensions:n},r=0,x=0;x<e.length;x++){for(var i=0;i<e[x].length;i++)for(var u=0;u<n;u++)t.vertices.push(e[x][i][u]);x>0&&(r+=e[x-1].length,t.holes.push(r))}return t}},"./node_modules/@arcgis/core/core/ByteSizeUnit.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{var E;__webpack_require__.d(__webpack_exports__,{u:()=>E}),function(E){E[E.KILOBYTES=1024]="KILOBYTES",E[E.MEGABYTES=1048576]="MEGABYTES",E[E.GIGABYTES=1073741824]="GIGABYTES"}(E||(E={}))},"./node_modules/@arcgis/core/core/MD5.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{T:()=>n,d:()=>x});const n={Base64:0,Hex:1,String:2,Raw:3},t=8,r=(1<<t)-1;function e(n,t){const r=(65535&n)+(65535&t);return(n>>16)+(t>>16)+(r>>16)<<16|65535&r}function o(n){const e=[];for(let o=0,u=n.length*t;o<u;o+=t)e[o>>5]|=(n.charCodeAt(o/t)&r)<<o%32;return e}function u(n){const e=[];for(let o=0,u=32*n.length;o<u;o+=t)e.push(String.fromCharCode(n[o>>5]>>>o%32&r));return e.join("")}function i(n,t,r,o,u,c){return e(function s(n,t){return n<<t|n>>>32-t}(e(e(t,n),e(o,c)),u),r)}function h(n,t,r,e,o,u,c){return i(t&r|~t&e,n,t,o,u,c)}function a(n,t,r,e,o,u,c){return i(t&e|r&~e,n,t,o,u,c)}function l(n,t,r,e,o,u,c){return i(t^r^e,n,t,o,u,c)}function g(n,t,r,e,o,u,c){return i(r^(t|~e),n,t,o,u,c)}function p(n,t){n[t>>5]|=128<<t%32,n[14+(t+64>>>9<<4)]=t;let r=1732584193,o=-271733879,u=-1732584194,c=271733878;for(let f=0;f<n.length;f+=16){const t=r,s=o,i=u,p=c;r=h(r,o,u,c,n[f],7,-680876936),c=h(c,r,o,u,n[f+1],12,-389564586),u=h(u,c,r,o,n[f+2],17,606105819),o=h(o,u,c,r,n[f+3],22,-1044525330),r=h(r,o,u,c,n[f+4],7,-176418897),c=h(c,r,o,u,n[f+5],12,1200080426),u=h(u,c,r,o,n[f+6],17,-1473231341),o=h(o,u,c,r,n[f+7],22,-45705983),r=h(r,o,u,c,n[f+8],7,1770035416),c=h(c,r,o,u,n[f+9],12,-1958414417),u=h(u,c,r,o,n[f+10],17,-42063),o=h(o,u,c,r,n[f+11],22,-1990404162),r=h(r,o,u,c,n[f+12],7,1804603682),c=h(c,r,o,u,n[f+13],12,-40341101),u=h(u,c,r,o,n[f+14],17,-1502002290),o=h(o,u,c,r,n[f+15],22,1236535329),r=a(r,o,u,c,n[f+1],5,-165796510),c=a(c,r,o,u,n[f+6],9,-1069501632),u=a(u,c,r,o,n[f+11],14,643717713),o=a(o,u,c,r,n[f],20,-373897302),r=a(r,o,u,c,n[f+5],5,-701558691),c=a(c,r,o,u,n[f+10],9,38016083),u=a(u,c,r,o,n[f+15],14,-660478335),o=a(o,u,c,r,n[f+4],20,-405537848),r=a(r,o,u,c,n[f+9],5,568446438),c=a(c,r,o,u,n[f+14],9,-1019803690),u=a(u,c,r,o,n[f+3],14,-187363961),o=a(o,u,c,r,n[f+8],20,1163531501),r=a(r,o,u,c,n[f+13],5,-1444681467),c=a(c,r,o,u,n[f+2],9,-51403784),u=a(u,c,r,o,n[f+7],14,1735328473),o=a(o,u,c,r,n[f+12],20,-1926607734),r=l(r,o,u,c,n[f+5],4,-378558),c=l(c,r,o,u,n[f+8],11,-2022574463),u=l(u,c,r,o,n[f+11],16,1839030562),o=l(o,u,c,r,n[f+14],23,-35309556),r=l(r,o,u,c,n[f+1],4,-1530992060),c=l(c,r,o,u,n[f+4],11,1272893353),u=l(u,c,r,o,n[f+7],16,-155497632),o=l(o,u,c,r,n[f+10],23,-1094730640),r=l(r,o,u,c,n[f+13],4,681279174),c=l(c,r,o,u,n[f],11,-358537222),u=l(u,c,r,o,n[f+3],16,-722521979),o=l(o,u,c,r,n[f+6],23,76029189),r=l(r,o,u,c,n[f+9],4,-640364487),c=l(c,r,o,u,n[f+12],11,-421815835),u=l(u,c,r,o,n[f+15],16,530742520),o=l(o,u,c,r,n[f+2],23,-995338651),r=g(r,o,u,c,n[f],6,-198630844),c=g(c,r,o,u,n[f+7],10,1126891415),u=g(u,c,r,o,n[f+14],15,-1416354905),o=g(o,u,c,r,n[f+5],21,-57434055),r=g(r,o,u,c,n[f+12],6,1700485571),c=g(c,r,o,u,n[f+3],10,-1894986606),u=g(u,c,r,o,n[f+10],15,-1051523),o=g(o,u,c,r,n[f+1],21,-2054922799),r=g(r,o,u,c,n[f+8],6,1873313359),c=g(c,r,o,u,n[f+15],10,-30611744),u=g(u,c,r,o,n[f+6],15,-1560198380),o=g(o,u,c,r,n[f+13],21,1309151649),r=g(r,o,u,c,n[f+4],6,-145523070),c=g(c,r,o,u,n[f+11],10,-1120210379),u=g(u,c,r,o,n[f+2],15,718787259),o=g(o,u,c,r,n[f+9],21,-343485551),r=e(r,t),o=e(o,s),u=e(u,i),c=e(c,p)}return[r,o,u,c]}function x(r,e=n.Hex){const s=e||n.Base64,i=p(o(r),r.length*t);switch(s){case n.Raw:return i;case n.Hex:return function c(n){const t="0123456789abcdef",r=[];for(let e=0,o=4*n.length;e<o;e++)r.push(t.charAt(n[e>>2]>>e%4*8+4&15)+t.charAt(n[e>>2]>>e%4*8&15));return r.join("")}(i);case n.String:return u(i);case n.Base64:return function f(n){const e=[];for(let o=0,u=4*n.length;o<u;o+=3){const u=(n[o>>2]>>o%4*8&255)<<16|(n[o+1>>2]>>(o+1)%4*8&255)<<8|n[o+2>>2]>>(o+2)%4*8&255;for(let c=0;c<4;c++)8*o+6*c>32*n.length?e.push("="):e.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(u>>6*(3-c)&63))}return e.join("")}(i)}}},"./node_modules/@arcgis/core/core/accessorSupport/decorators/persistable.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{P:()=>v});var _Error_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@arcgis/core/core/Error.js"),_MD5_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@arcgis/core/core/MD5.js"),_multiOriginJSONSupportUtils_js__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./node_modules/@arcgis/core/core/multiOriginJSONSupportUtils.js"),_urlUtils_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@arcgis/core/core/urlUtils.js"),_uuid_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@arcgis/core/core/uuid.js"),_metadata_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/metadata.js"),_PropertyOrigin_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/PropertyOrigin.js"),_property_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/decorators/property.js"),_portal_support_resourceExtension_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./node_modules/@arcgis/core/portal/support/resourceExtension.js"),_chunks_persistableUrlUtils_js__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./node_modules/@arcgis/core/chunks/persistableUrlUtils.js");function v(r){const t=r?.origins??[void 0];return(e,o)=>{const s=function U(r,t,e){if("resource"===r?.type)return function w(r,t,n){const i=(0,_metadata_js__WEBPACK_IMPORTED_MODULE_4__.z4)(t,n);return{type:String,read:(r,t,e)=>{const o=(0,_chunks_persistableUrlUtils_js__WEBPACK_IMPORTED_MODULE_8__.r)(r,t,e);return i.type===String?o:"function"==typeof i.type?new i.type({url:o}):void 0},write:{isRequired:i.json?.write?.isRequired,writer(t,p,c,u){if(!u?.resources)return"string"==typeof t?void(p[c]=(0,_chunks_persistableUrlUtils_js__WEBPACK_IMPORTED_MODULE_8__.t)(t,u)):void(p[c]=t.write({},u));const l=function x(r){return null==r?null:"string"==typeof r?r:r.url}(t),m=(0,_chunks_persistableUrlUtils_js__WEBPACK_IMPORTED_MODULE_8__.t)(l,{...u,verifyItemRelativeUrls:u?.verifyItemRelativeUrls?{writtenUrls:u.verifyItemRelativeUrls.writtenUrls,rootPath:void 0}:void 0},_chunks_persistableUrlUtils_js__WEBPACK_IMPORTED_MODULE_8__.M.NO),d=i.type!==String&&(!(0,_multiOriginJSONSupportUtils_js__WEBPACK_IMPORTED_MODULE_9__.H)(this)||u?.origin&&this.originIdOf(n)>(0,_PropertyOrigin_js__WEBPACK_IMPORTED_MODULE_5__.aB)(u.origin)),h={object:this,propertyName:n,value:t,targetUrl:m,dest:p,targetPropertyName:c,context:u,params:r};u?.portalItem&&m&&!(0,_urlUtils_js__WEBPACK_IMPORTED_MODULE_2__.oP)(m)?d&&r?.contentAddressed?I(h):d?function N(r){const{context:t,targetUrl:e,params:o,value:s,dest:n,targetPropertyName:i}=r;if(!t.portalItem)return;const c=t.portalItem.resourceFromPath(e),u=S(s,e,t),a=(0,_portal_support_resourceExtension_js__WEBPACK_IMPORTED_MODULE_7__.n)(u),l=(0,_urlUtils_js__WEBPACK_IMPORTED_MODULE_2__.Zo)(c.path),d=o?.compress??!1;a===l?(t.resources&&b({...r,resource:c,content:u,compress:d,updates:t.resources.toUpdate}),n[i]=e):I(r)}(h):function P({context:r,targetUrl:t,dest:e,targetPropertyName:o}){r.portalItem&&r.resources&&(r.resources.toKeep.push({resource:r.portalItem.resourceFromPath(t),compress:!1}),e[o]=t)}(h):u?.portalItem&&(null==m||null!=(0,_chunks_persistableUrlUtils_js__WEBPACK_IMPORTED_MODULE_8__.i)(m)||(0,_urlUtils_js__WEBPACK_IMPORTED_MODULE_2__.w8)(m)||d)?I(h):p[c]=m}}}}(r,t,e);switch(r?.type??"other"){case"other":return{read:!0,write:!0};case"url":{const{read:r,write:t}=_chunks_persistableUrlUtils_js__WEBPACK_IMPORTED_MODULE_8__.b;return{read:r,write:t}}}}(r,e,o);for(const r of t){const t=(0,_property_js__WEBPACK_IMPORTED_MODULE_6__.rM)(e,r,o);for(const r in s)t[r]=s[r]}}}function I(e){const{targetUrl:o,params:p,value:u,context:a,dest:l,targetPropertyName:d}=e;if(!a.portalItem)return;const f=(0,_chunks_persistableUrlUtils_js__WEBPACK_IMPORTED_MODULE_8__.p)(o),y=S(u,o,a);if(p?.contentAddressed&&"json"!==y.type)return void a.messages?.push(new _Error_js__WEBPACK_IMPORTED_MODULE_0__.A("persistable:contentAddressingUnsupported",`Property "${d}" is trying to serializing a resource with content of type ${y.type} with content addressing. Content addressing is only supported for json resources.`,{content:y}));const g=p?.contentAddressed&&"json"===y.type?(0,_MD5_js__WEBPACK_IMPORTED_MODULE_1__.d)(y.jsonString):f?.filename??(0,_uuid_js__WEBPACK_IMPORTED_MODULE_3__.lk)(),j=(0,_urlUtils_js__WEBPACK_IMPORTED_MODULE_2__.fj)(p?.prefix??f?.prefix,g),v=`${j}.${(0,_portal_support_resourceExtension_js__WEBPACK_IMPORTED_MODULE_7__.n)(y)}`;if(p?.contentAddressed&&a.resources&&"json"===y.type){const r=a.resources.toKeep.find((({resource:r})=>r.path===v))??a.resources.toAdd.find((({resource:r})=>r.path===v));if(r)return void(l[d]=r.resource.itemRelativeUrl)}const U=a.portalItem.resourceFromPath(v);(0,_urlUtils_js__WEBPACK_IMPORTED_MODULE_2__.w8)(o)&&a.resources&&a.resources.pendingOperations.push((0,_urlUtils_js__WEBPACK_IMPORTED_MODULE_2__.tk)(o).then((r=>{U.path=`${j}.${(0,_portal_support_resourceExtension_js__WEBPACK_IMPORTED_MODULE_7__.n)({type:"blob",blob:r})}`,l[d]=U.itemRelativeUrl})).catch((()=>{})));const w=p?.compress??!1;a.resources&&b({...e,resource:U,content:y,compress:w,updates:a.resources.toAdd}),l[d]=U.itemRelativeUrl}function b({object:r,propertyName:t,updates:e,resource:o,content:s,compress:n}){e.push({resource:o,content:s,compress:n,finish:e=>{!function O(r,t,e){"string"==typeof r[t]?r[t]=e.url:r[t].url=e.url}(r,t,e)}})}function S(r,t,e){return"string"==typeof r?{type:"url",url:t}:{type:"json",jsonString:JSON.stringify(r.toJSON(e))}}},"./node_modules/@arcgis/core/core/colorUtils.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{$:()=>U,IB:()=>i,Iy:()=>T,N2:()=>B,QP:()=>F,RH:()=>H,Vl:()=>D,Ws:()=>L,ZD:()=>C,_L:()=>P,bJ:()=>E,e$:()=>I,f6:()=>S,pW:()=>R,pf:()=>N});var _Color_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@arcgis/core/Color.js"),_arrayUtils_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@arcgis/core/core/arrayUtils.js"),_lang_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@arcgis/core/core/lang.js"),_libs_gl_matrix_2_factories_vec4f64_js__WEBPACK_IMPORTED_MODULE_5__=(__webpack_require__("./node_modules/@arcgis/core/core/mathUtils.js"),__webpack_require__("./node_modules/@arcgis/core/chunks/vec42.js"),__webpack_require__("./node_modules/@arcgis/core/core/libs/gl-matrix-2/factories/vec4f64.js"));function i(n){return"r"in n&&"g"in n&&"b"in n}function a(n){return"h"in n&&"s"in n&&"v"in n}function s(n){return"l"in n&&"a"in n&&"b"in n}function f(n){return"l"in n&&"c"in n&&"h"in n}const l=[[.4124,.3576,.1805],[.2126,.7152,.0722],[.0193,.1192,.9505]],g=[[3.2406,-1.5372,-.4986],[-.9689,1.8758,.0415],[.0557,-.204,1.057]];function b(n,t){const r=[];let o,e;if(n[0].length!==t.length)throw new Error("dimensions do not match");const u=n.length,c=n[0].length;let i=0;for(o=0;o<u;o++){for(i=0,e=0;e<c;e++)i+=n[o][e]*t[e];r.push(i)}return r}function m(n){const t=[n.r/255,n.g/255,n.b/255].map((n=>n<=.04045?n/12.92:((n+.055)/1.055)**2.4)),r=b(l,t);return{x:100*r[0],y:100*r[1],z:100*r[2]}}function M(n){const t=b(g,[n.x/100,n.y/100,n.z/100]).map((n=>{const t=n<=.0031308?12.92*n:1.055*n**(1/2.4)-.055;return Math.min(1,Math.max(t,0))}));return{r:Math.round(255*t[0]),g:Math.round(255*t[1]),b:Math.round(255*t[2])}}function d(n){const t=[n.x/95.047,n.y/100,n.z/108.883].map((n=>n>(6/29)**3?n**(1/3):1/3*(29/6)**2*n+4/29));return{l:116*t[1]-16,a:500*(t[0]-t[1]),b:200*(t[1]-t[2])}}function p(n){const t=n.l,r=[(t+16)/116+n.a/500,(t+16)/116,(t+16)/116-n.b/200].map((n=>n>6/29?n**3:3*(6/29)**2*(n-4/29)));return{x:95.047*r[0],y:100*r[1],z:108.883*r[2]}}function j(n){return function w(n){const t=n.l,r=n.a,o=n.b,e=Math.sqrt(r*r+o*o);let u=Math.atan2(o,r);return u=u>0?u:u+2*Math.PI,{l:t,c:e,h:u}}(d(m(n)))}function v(n){return M(p(function x(n){const t=n.l,r=n.c,o=n.h;return{l:t,a:r*Math.cos(o),b:r*Math.sin(o)}}(n)))}function U(n){return i(n)?n:f(n)?v(n):s(n)?function y(n){return M(p(n))}(n):function h(n){return"x"in n&&"y"in n&&"z"in n}(n)?M(n):a(n)?function A(n){const t=(n.h+360)%360/60,r=n.s/100,o=n.v/100*255,e=o*r,u=e*(1-Math.abs(t%2-1));let c;switch(Math.floor(t)){case 0:c={r:e,g:u,b:0};break;case 1:c={r:u,g:e,b:0};break;case 2:c={r:0,g:e,b:u};break;case 3:c={r:0,g:u,b:e};break;case 4:c={r:u,g:0,b:e};break;case 5:case 6:c={r:e,g:0,b:u};break;default:c={r:0,g:0,b:0}}return c.r=Math.round(c.r+o-e),c.g=Math.round(c.g+o-e),c.b=Math.round(c.b+o-e),c}(n):n}function B(n){return a(n)?n:function z(n){const t=n.r,r=n.g,o=n.b,e=Math.max(t,r,o),u=e-Math.min(t,r,o);let c=e,i=0===u?0:e===t?(r-o)/u%6:e===r?(o-t)/u+2:(t-r)/u+4,a=0===u?0:u/c;return i<0&&(i+=6),i*=60,a*=100,c*=100/255,{h:i,s:a,v:c}}(U(n))}function C(n){return s(n)?n:function k(n){return d(m(n))}(U(n))}function H(n){return f(n)?n:j(U(n))}function G(t){let{r,g:o,b:e,a:u}=t;return u<1&&(r=Math.round(u*r+255*(1-u)),o=Math.round(u*o+255*(1-u)),e=Math.round(u*e+255*(1-u))),new _Color_js__WEBPACK_IMPORTED_MODULE_0__.A({r,g:o,b:e})}function L(n,t){const{r,g:o,b:e}=t?.ignoreAlpha?n:G(n);return.2126*r+.7152*o+.0722*e}var R;function E(t,r=R.High){return L(t,{ignoreAlpha:!0})>r?new _Color_js__WEBPACK_IMPORTED_MODULE_0__.A([0,0,0,t.a]):new _Color_js__WEBPACK_IMPORTED_MODULE_0__.A([255,255,255,t.a])}function I(n,t){const r=C(n);r.l*=1-t;const o=U(r),e=n.clone();return e.setColor(o),e.a=n.a,e}function P(n,t){const r=n.clone();return r.a*=t,r}function D(n,t){const r=B(n);r.s*=t;const o=U(r),e=n.clone();return e.setColor(o),e.a=n.a,e}function F(t){return _Color_js__WEBPACK_IMPORTED_MODULE_0__.A.toUnitRGBA(t)}function N(n){return(0,_libs_gl_matrix_2_factories_vec4f64_js__WEBPACK_IMPORTED_MODULE_5__.fA)(n[0],n[1],n[2],n.length>3?n[3]:1)}function S(t,r){const o=_Color_js__WEBPACK_IMPORTED_MODULE_0__.A.toUnitRGBA(t);return o[3]*=r,o}function T(r,e,u={}){if(0===r.length||e<=0)return[];if(1===(r=r.map((t=>"string"==typeof t?new _Color_js__WEBPACK_IMPORTED_MODULE_0__.A(t):t))).length||1===e){const n=[],t=r[0];for(let r=0;r<e;r++)n.push(t.clone());return n}if(u.shuffle&&(r=(0,_arrayUtils_js__WEBPACK_IMPORTED_MODULE_1__.k4)((0,_lang_js__WEBPACK_IMPORTED_MODULE_2__.o8)(r),u.seed)),r.length>=e){const n=[],t=(r.length-1)/(e-1);for(let o=0;o<e;o++){const e=Math.round(o*t);n.push(r[e].clone())}return n}return function V(n,r,o={}){const e=[],u=n.length-1,c=Math.ceil((r-n.length)/u);n:for(let t=0;t<u;t++){const u=n[t],i=n[t+1];for(let t=1;t<=c;t++){const a=t/(c+1);if(e.push(X(u,i,a,o)),e.length+n.length===r)break n}}return[...n.map((n=>n.clone())),...(0,_arrayUtils_js__WEBPACK_IMPORTED_MODULE_1__.k4)(e,o.seed??1)]}(r,e,u)}!function(n){n[n.Low=160]="Low",n[n.High=225]="High"}(R||(R={}));const W=(n,t)=>{const r=Math.floor(10*t())-5;return Math.min(255,Math.max(0,n+r))};function X(t,o,e,u={}){const c=t.r,i=t.g,a=t.b,s=o.r,f=o.g,h=o.b,l=Math.round(c+(s-c)*e),g=Math.round(i+(f-i)*e),b=Math.round(a+(h-a)*e);if(!u.offset)return new _Color_js__WEBPACK_IMPORTED_MODULE_0__.A([l,g,b]);const m=(0,_arrayUtils_js__WEBPACK_IMPORTED_MODULE_1__.Mo)(u.seed);return new _Color_js__WEBPACK_IMPORTED_MODULE_0__.A([W(l,m),W(g,m),W(b,m)])}},"./node_modules/@arcgis/core/core/multiOriginJSONSupportUtils.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{function i(i){return i&&"getAtOrigin"in i&&"originOf"in i}__webpack_require__.d(__webpack_exports__,{H:()=>i})},"./node_modules/@arcgis/core/geometry/support/meshUtils/deduplicate.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{b:()=>e});var _core_mathUtils_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@arcgis/core/core/mathUtils.js"),_Indices_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@arcgis/core/geometry/support/Indices.js");function e(e,s,u){const c=Array.isArray(e),a=c?e.length/s:e.byteLength/(4*s),h=c?e:new Uint32Array(e,0,a*s),y=u?.minReduction??0,A=u?.originalIndices||null,g=A?A.length:0,m=u?.componentOffsets||null;let w=0;if(m)for(let t=0;t<m.length-1;t++){const n=m[t+1]-m[t];n>w&&(w=n)}else w=a;const U=Math.floor(1.1*w)+1;(null==i||i.length<2*U)&&(i=new Uint32Array((0,_core_mathUtils_js__WEBPACK_IMPORTED_MODULE_0__.cU)(2*U)));for(let t=0;t<2*U;t++)i[t]=0;let b=0;const d=!!m&&!!A,p=d?g:a;let M=(0,_Indices_js__WEBPACK_IMPORTED_MODULE_1__.my)(a);const j=new Uint32Array(g),q=1.96;let I=0!==y?Math.ceil(4*q*q/(y*y)*y*(1-y)):p,k=1,x=m?m[1]:p;for(let t=0;t<p;t++){if(t===I){const n=1-b/t;if(n+q*Math.sqrt(n*(1-n)/t)<y)return null;I*=2}if(t===x){for(let t=0;t<2*U;t++)i[t]=0;if(A)for(let t=m[k-1];t<m[k];t++)j[t]=M[A[t]];x=m[++k]}const n=d?A[t]:t,r=n*s,e=f(h,r,s);let o=e%U,u=b;for(;0!==i[2*o+1];){if(i[2*o]===e){const t=i[2*o+1]-1;if(l(h,r,t*s,s)){u=M[t];break}}o++,o>=U&&(o-=U)}u===b&&(i[2*o]=e,i[2*o+1]=n+1,b++),M[n]=u}if(0!==y&&1-b/a<y)return null;if(d){for(let t=m[k-1];t<j.length;t++)j[t]=M[A[t]];M=(0,_Indices_js__WEBPACK_IMPORTED_MODULE_1__.Dg)(j)}const C=c?new Array(b):new Uint32Array(b*s);b=0;for(let t=0;t<p;t++)M[t]===b&&(o(h,(d?A[t]:t)*s,C,b*s,s),b++);if(A&&!d){const t=new Uint32Array(g);for(let n=0;n<t.length;n++)t[n]=M[A[n]];M=(0,_Indices_js__WEBPACK_IMPORTED_MODULE_1__.Dg)(t)}return{buffer:Array.isArray(C)?C:C.buffer,indices:M,uniqueCount:b}}function l(t,n,r,e){for(let l=0;l<e;l++)if(t[n+l]!==t[r+l])return!1;return!0}function o(t,n,r,e,l){for(let o=0;o<l;o++)r[e+o]=t[n+o]}function f(t,n,r){let e=0;for(let l=0;l<r;l++)e=t[n+l]+e|0,e=e+(e<<11)+(e>>>2)|0;return e>>>0}let i=null},"./node_modules/@arcgis/core/geometry/support/polygonUtils.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{S:()=>c});var _core_mathUtils_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@arcgis/core/core/mathUtils.js"),_core_unitUtils_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@arcgis/core/core/unitUtils.js"),_chunks_vec32_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@arcgis/core/chunks/vec32.js"),_Axis_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@arcgis/core/geometry/support/Axis.js"),_plane_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/@arcgis/core/geometry/support/plane.js");function c(t,o,s){const a=function e(r,i,a,n){const c=(r=>!Array.isArray(r[0]))(i)?(r,t)=>i[3*r+t]:(r,t)=>i[r][t],e=n?(0,_core_unitUtils_js__WEBPACK_IMPORTED_MODULE_1__.GA)(n)/(0,_core_unitUtils_js__WEBPACK_IMPORTED_MODULE_1__.G9)(n):1;return(0,_plane_js__WEBPACK_IMPORTED_MODULE_4__.lU)(r,((r,t)=>(0,_chunks_vec32_js__WEBPACK_IMPORTED_MODULE_2__.i)(r,c(t,0)*e,c(t,1)*e,c(t,2))),a)}(f,t,o,s)?(0,_plane_js__WEBPACK_IMPORTED_MODULE_4__.Qj)(f):[0,0,1];return Math.abs(a[2])>Math.cos((0,_core_mathUtils_js__WEBPACK_IMPORTED_MODULE_0__.kU)(80))?_Axis_js__WEBPACK_IMPORTED_MODULE_3__._.Z:Math.abs(a[1])>Math.abs(a[0])?_Axis_js__WEBPACK_IMPORTED_MODULE_3__._.Y:_Axis_js__WEBPACK_IMPORTED_MODULE_3__._.X}const f=(0,_plane_js__WEBPACK_IMPORTED_MODULE_4__.vt)()},"./node_modules/@arcgis/core/geometry/support/triangulationUtils.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Wq:()=>p,lO:()=>f,oR:()=>a});var p,_chunks_earcut_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@arcgis/core/chunks/earcut.js"),_Axis_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@arcgis/core/geometry/support/Axis.js"),_coordsUtils_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@arcgis/core/geometry/support/coordsUtils.js"),_DoubleArray_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@arcgis/core/geometry/support/DoubleArray.js"),_Indices_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/@arcgis/core/geometry/support/Indices.js"),_polygonUtils_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/@arcgis/core/geometry/support/polygonUtils.js"),_meshUtils_deduplicate_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./node_modules/@arcgis/core/geometry/support/meshUtils/deduplicate.js");function f(t){const e=a(t.rings,t.hasZ,p.CCW_IS_HOLE,t.spatialReference),s=new Array;let l=0,f=0;for(const r of e.polygons){const t=r.count,c=r.index,h=(0,_DoubleArray_js__WEBPACK_IMPORTED_MODULE_3__.l5)(e.position,3*c,3*t),a=r.holeIndices.map((n=>n-c)),g=(0,_Indices_js__WEBPACK_IMPORTED_MODULE_4__.Dg)((0,_chunks_earcut_js__WEBPACK_IMPORTED_MODULE_0__.e)(h,a,3));s.push({position:h,faces:g}),l+=h.length,f+=g.length}const g=function h(n,t,e){if(1===n.length)return n[0];const o=(0,_DoubleArray_js__WEBPACK_IMPORTED_MODULE_3__.jh)(t),r=new Array(e);let l=0,c=0,f=0;for(const s of n){for(let n=0;n<s.position.length;n++)o[l++]=s.position[n];for(const n of s.faces)r[c++]=n+f;f=l/3}return{position:o,faces:(0,_Indices_js__WEBPACK_IMPORTED_MODULE_4__.Dg)(r)}}(s,l,f),u=Array.isArray(g.position)?(0,_meshUtils_deduplicate_js__WEBPACK_IMPORTED_MODULE_6__.b)(g.position,3,{originalIndices:g.faces}):(0,_meshUtils_deduplicate_js__WEBPACK_IMPORTED_MODULE_6__.b)(g.position.buffer,6,{originalIndices:g.faces});return g.position=(0,_DoubleArray_js__WEBPACK_IMPORTED_MODULE_3__.xm)(new Float64Array(u.buffer)),g.faces=u.indices,g}function a(n,t,e,o){const r=n.length,i=new Array(r),l=new Array(r),c=new Array(r);let f=0;for(let s=0;s<r;++s)f+=n[s].length;let h=0,a=0,m=0;const d=(0,_DoubleArray_js__WEBPACK_IMPORTED_MODULE_3__.jh)(3*f);let y=0;for(let s=r-1;s>=0;s--){const f=n[s],A=e===p.CCW_IS_HOLE&&u(f,t,o);if(A&&1!==r)i[h++]=f;else{let n=f.length;for(let t=0;t<h;++t)n+=i[t].length;const e={index:y,pathLengths:new Array(h+1),count:n,holeIndices:new Array(h)};e.pathLengths[0]=f.length,f.length>0&&(c[m++]={index:y,count:f.length}),y=A?g(f,f.length-1,-1,d,y,f.length,t):g(f,0,1,d,y,f.length,t);for(let o=0;o<h;++o){const n=i[o];e.holeIndices[o]=y,e.pathLengths[o+1]=n.length,n.length>0&&(c[m++]={index:y,count:n.length}),y=g(n,0,1,d,y,n.length,t)}h=0,e.count>0&&(l[a++]=e)}}for(let s=0;s<h;++s){const n=i[s];n.length>0&&(c[m++]={index:y,count:n.length}),y=g(n,0,1,d,y,n.length,t)}return l.length=a,c.length=m,{position:d,polygons:l,outlines:c}}function g(n,t,e,o,r,s,i){r*=3;for(let l=0;l<s;++l){const s=n[t];o[r++]=s[0],o[r++]=s[1],o[r++]=i&&s[2]?s[2]:0,t+=e}return r/3}function u(n,o,r){if(!o)return!(0,_coordsUtils_js__WEBPACK_IMPORTED_MODULE_2__.$3)(n);const s=n.length-1;switch((0,_polygonUtils_js__WEBPACK_IMPORTED_MODULE_5__.S)(n,s,r)){case _Axis_js__WEBPACK_IMPORTED_MODULE_1__._.X:return!(0,_coordsUtils_js__WEBPACK_IMPORTED_MODULE_2__.$3)(n,_Axis_js__WEBPACK_IMPORTED_MODULE_1__._.Y,_Axis_js__WEBPACK_IMPORTED_MODULE_1__._.Z);case _Axis_js__WEBPACK_IMPORTED_MODULE_1__._.Y:return!(0,_coordsUtils_js__WEBPACK_IMPORTED_MODULE_2__.$3)(n,_Axis_js__WEBPACK_IMPORTED_MODULE_1__._.X,_Axis_js__WEBPACK_IMPORTED_MODULE_1__._.Z);case _Axis_js__WEBPACK_IMPORTED_MODULE_1__._.Z:return!(0,_coordsUtils_js__WEBPACK_IMPORTED_MODULE_2__.$3)(n,_Axis_js__WEBPACK_IMPORTED_MODULE_1__._.X,_Axis_js__WEBPACK_IMPORTED_MODULE_1__._.Y)}}!function(n){n[n.NONE=0]="NONE",n[n.CCW_IS_HOLE=1]="CCW_IS_HOLE"}(p||(p={}))},"./node_modules/@arcgis/core/intl.js":(__unused_webpack_module,__unused_webpack___webpack_exports__,__webpack_require__)=>{__webpack_require__("./node_modules/@arcgis/core/intl/date.js"),__webpack_require__("./node_modules/@arcgis/core/intl/number.js"),__webpack_require__("./node_modules/@arcgis/core/intl/substitute.js"),__webpack_require__("./node_modules/@arcgis/core/intl/locale.js");var messages=__webpack_require__("./node_modules/@arcgis/core/intl/messages.js"),request=__webpack_require__("./node_modules/@arcgis/core/request.js"),Error=__webpack_require__("./node_modules/@arcgis/core/core/Error.js");async function o(t){if(null!=a.fetchBundleAsset)return a.fetchBundleAsset(t);const n=await(0,request.A)(t,{responseType:"text"});return JSON.parse(n.data)}class s{constructor({base:e="",pattern:t,location:n=new URL(window.location.href)}){let r;r="string"==typeof n?e=>new URL(e,new URL(n,window.location.href)).href:n instanceof URL?e=>new URL(e,n).href:n,this.pattern="string"==typeof t?new RegExp(`^${t}`):t,this.getAssetUrl=r,e=e?e.endsWith("/")?e:e+"/":"",this.matcher=new RegExp(`^${e}(?:(.*)\\/)?(.*)$`)}fetchMessageBundle(e,t){return async function r(e,r,s,i){const a=r.exec(s);if(!a)throw new Error.A("esri-intl:invalid-bundle",`Bundle id "${s}" is not compatible with the pattern "${r}"`);const c=a[1]?`${a[1]}/`:"",l=a[2],w=(0,messages.xO)(i),h=`${c}${l}.json`,u=w?`${c}${l}_${w}.json`:h;let d;try{d=await o(e(u))}catch(f){if(u===h)throw new Error.A("intl:unknown-bundle",`Bundle "${s}" cannot be loaded`,{error:f});try{d=await o(e(h))}catch(f){throw new Error.A("intl:unknown-bundle",`Bundle "${s}" cannot be loaded`,{error:f})}}return d}(this.getAssetUrl,this.matcher,e,t)}}const a={};var assets=__webpack_require__("./node_modules/@arcgis/core/assets.js");(0,messages.ao)(function i(e){return new s(e)}({pattern:"esri/",location:assets.s}))},"./node_modules/@arcgis/core/intl/number.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{$J:()=>o,ZV:()=>l,yx:()=>i});var _locale_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@arcgis/core/intl/locale.js");const t={ar:"ar-u-nu-latn"};let u=new WeakMap,r={};function a(e){const a=e||r;if(!u.has(a)){const r=(0,_locale_js__WEBPACK_IMPORTED_MODULE_0__.JK)(),i=t[(0,_locale_js__WEBPACK_IMPORTED_MODULE_0__.JK)()]||r;u.set(a,new Intl.NumberFormat(i,e))}return u.get(a)}function i(e={}){const n={};return null!=e.digitSeparator&&(n.useGrouping=e.digitSeparator),null!=e.places&&(n.minimumFractionDigits=n.maximumFractionDigits=e.places),n}function l(e,n){return Object.is(e,-0)&&(e=0),a(n).format(e)}function o(e,t=(0,_locale_js__WEBPACK_IMPORTED_MODULE_0__.JK)()){if(!e)return null;let u=p.get(t);if(!u){const e=a().formatToParts(12345.6),n=[...a({useGrouping:!1}).format(9876543210)].reverse(),r=new Map(n.map(((e,n)=>[e,n]))),i=new RegExp(`[${e.find((e=>"group"===e.type))?.value}]`,"g"),l=new RegExp(`[${e.find((e=>"decimal"===e.type))?.value}]`),o=new RegExp(`[${n.join("")}]`,"g"),c=/[\u200E\u200F\u202A\u202B\u202C\u202D\u202E\u2066\u2067\u2068\u2069\u061C]/g,s=/[-\u2212\u2013\u2014\u2015]/g;u=e=>{if(""===(e=e.trim().replaceAll(i,"").replace(l,".").replace(o,(e=>String(r.get(e)))).replaceAll(c,"").replaceAll(s,"-")))return null;const n=Number(e);return isNaN(n)?null:n},p.set(t,u)}return u(e)}(0,_locale_js__WEBPACK_IMPORTED_MODULE_0__.Ml)((()=>{u=new WeakMap,r={}}));const p=new Map},"./node_modules/@arcgis/core/intl/substitute.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{V:()=>s});var _core_Logger_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@arcgis/core/core/Logger.js"),_core_object_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@arcgis/core/core/object.js"),_core_string_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@arcgis/core/core/string.js"),_date_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@arcgis/core/intl/date.js"),_number_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/@arcgis/core/intl/number.js");const i=()=>_core_Logger_js__WEBPACK_IMPORTED_MODULE_0__.A.getLogger("esri.intl.substitute");function s(t,r,n={}){const{format:o={}}=n;return(0,_core_string_js__WEBPACK_IMPORTED_MODULE_2__.HC)(t,(t=>function u(t,e,n){let o,i;const s=t.indexOf(":");if(-1===s?o=t.trim():(o=t.slice(0,s).trim(),i=t.slice(s+1).trim()),!o)return"";const u=(0,_core_object_js__WEBPACK_IMPORTED_MODULE_1__.wc)(o,e);if(null==u)return"";const m=(i?n?.[i]:null)??n?.[o];return m?c(u,m):i?a(u,i):f(u)}(t,r,o)))}function c(t,r){switch(r.type){case"date":return(0,_date_js__WEBPACK_IMPORTED_MODULE_3__.Yq)(t,r.intlOptions);case"number":return(0,_number_js__WEBPACK_IMPORTED_MODULE_4__.ZV)(t,r.intlOptions);default:return i().warn("missing format descriptor for key {key}"),f(t)}}function a(t,r){switch(r.toLowerCase()){case"dateformat":return(0,_date_js__WEBPACK_IMPORTED_MODULE_3__.Yq)(t);case"numberformat":return(0,_number_js__WEBPACK_IMPORTED_MODULE_4__.ZV)(t);default:return i().warn(`inline format is unsupported since 4.12: ${r}`),/^(dateformat|datestring)/i.test(r)?(0,_date_js__WEBPACK_IMPORTED_MODULE_3__.Yq)(t):/^numberformat/i.test(r)?(0,_number_js__WEBPACK_IMPORTED_MODULE_4__.ZV)(t):f(t)}}function f(t){switch(typeof t){case"string":return t;case"number":return(0,_number_js__WEBPACK_IMPORTED_MODULE_4__.ZV)(t);case"boolean":return""+t;default:return t instanceof Date?(0,_date_js__WEBPACK_IMPORTED_MODULE_3__.Yq)(t):""}}},"./node_modules/@arcgis/core/portal/support/resourceExtension.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{n:()=>p});var _core_urlUtils_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@arcgis/core/core/urlUtils.js");function p(i){return o[function t(i){return"json"===i.type?"application/json":"blob"===i.type?i.blob.type:function n(p){const t=(0,_core_urlUtils_js__WEBPACK_IMPORTED_MODULE_0__.Zo)(p);return g[t]||a}(i.url)}(i)]||e}const o={},a="text/plain",e=o[a],g={png:"image/png",jpeg:"image/jpeg",jpg:"image/jpg",bmp:"image/bmp",gif:"image/gif",json:"application/json",txt:"text/plain",xml:"application/xml",svg:"image/svg+xml",zip:"application/zip",pbf:"application/vnd.mapbox-vector-tile",gz:"application/gzip","bin.gz":"application/octet-stream"};for(const l in g)o[g[l]]=l},"./node_modules/@arcgis/core/views/3d/interactive/editingTools.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{DrawGraphicTool3D:()=>DrawGraphicTool3D_z,ExtentTransformTool:()=>ExtentTransformTool_S,ManipulatedObject3DGraphic:()=>ManipulatedObject3DGraphic_u,MoveTool3D:()=>MoveTool3D_K,ReshapeTool3D:()=>ReshapeTool3D_h,TransformTool3D:()=>TransformTool3D_z});var tslib_es6=__webpack_require__("./node_modules/@arcgis/core/chunks/tslib.es6.js"),colorUtils=__webpack_require__("./node_modules/@arcgis/core/core/colorUtils.js"),handleUtils=__webpack_require__("./node_modules/@arcgis/core/core/handleUtils.js"),maybe=__webpack_require__("./node_modules/@arcgis/core/core/maybe.js"),reactiveUtils=__webpack_require__("./node_modules/@arcgis/core/core/reactiveUtils.js"),property=__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/decorators/property.js"),has=__webpack_require__("./node_modules/@arcgis/core/core/has.js"),subclass=(__webpack_require__("./node_modules/@arcgis/core/core/Logger.js"),__webpack_require__("./node_modules/@arcgis/core/core/RandomLCG.js"),__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/decorators/subclass.js")),vec32=__webpack_require__("./node_modules/@arcgis/core/chunks/vec32.js"),vec3f64=__webpack_require__("./node_modules/@arcgis/core/core/libs/gl-matrix-2/factories/vec3f64.js"),elevationInfoUtils=__webpack_require__("./node_modules/@arcgis/core/support/elevationInfoUtils.js"),ElevationInfo=__webpack_require__("./node_modules/@arcgis/core/symbols/support/ElevationInfo.js"),screenUtils=__webpack_require__("./node_modules/@arcgis/core/core/screenUtils.js"),viewUtils=(__webpack_require__("./node_modules/@arcgis/core/core/Error.js"),__webpack_require__("./node_modules/@arcgis/core/views/3d/interactive/support/viewUtils.js")),Color=__webpack_require__("./node_modules/@arcgis/core/Color.js"),Accessor=(__webpack_require__("./node_modules/@arcgis/core/intl.js"),__webpack_require__("./node_modules/@arcgis/core/core/Accessor.js")),asyncUtils=__webpack_require__("./node_modules/@arcgis/core/core/asyncUtils.js"),mathUtils=__webpack_require__("./node_modules/@arcgis/core/core/mathUtils.js"),quantityFormatUtils=__webpack_require__("./node_modules/@arcgis/core/core/quantityFormatUtils.js"),unitUtils=__webpack_require__("./node_modules/@arcgis/core/core/unitUtils.js"),vec2=__webpack_require__("./node_modules/@arcgis/core/core/libs/gl-matrix-2/math/vec2.js"),vec2f64=__webpack_require__("./node_modules/@arcgis/core/core/libs/gl-matrix-2/factories/vec2f64.js"),coordsUtils=__webpack_require__("./node_modules/@arcgis/core/geometry/support/coordsUtils.js"),vectorStacks=__webpack_require__("./node_modules/@arcgis/core/geometry/support/vectorStacks.js"),messages=__webpack_require__("./node_modules/@arcgis/core/intl/messages.js"),getDefaultUnitForView=__webpack_require__("./node_modules/@arcgis/core/support/getDefaultUnitForView.js");__webpack_require__("./node_modules/@arcgis/core/libs/maquette/projection.js");let h_e=e=>({vnodeSelector:"",properties:void 0,children:void 0,text:e.toString(),domNode:null}),h_r=(t,o,n)=>{for(let l=0,i=o.length;l<i;l++){let i=o[l];Array.isArray(i)?h_r(t,i,n):null!=i&&!1!==i&&("string"==typeof i&&(i=h_e(i)),n.push(i))}};__webpack_require__("./node_modules/@arcgis/core/libs/maquette/projector.js");const TextOverlayItem_l={bottom:"esri-text-overlay-item-anchor-bottom","bottom-right":"esri-text-overlay-item-anchor-bottom-right","bottom-left":"esri-text-overlay-item-anchor-bottom-left",top:"esri-text-overlay-item-anchor-top","top-right":"esri-text-overlay-item-anchor-top-right","top-left":"esri-text-overlay-item-anchor-top-left",center:"esri-text-overlay-item-anchor-center",right:"esri-text-overlay-item-anchor-right",left:"esri-text-overlay-item-anchor-left"};let TextOverlayItem_n=class extends Accessor.A{get position(){return[this.x,this.y]}set position(t){this._set("x",t[0]),this._set("y",t[1])}get _textShadowColor(){const{textColor:t,backgroundColor:e}=this,o=e.clone();return o.a*=t.a,o}get _textShadow(){const t=this._textShadowColor.toCss(!0);return`0 0 ${this._textShadowSize}px ${t}`}get padding(){return.5*this.fontSize}get borderRadius(){return this.padding}set borderRadius(t){this._overrideIfSome("borderRadius",t)}constructor(t){super(t),this.x=0,this.y=0,this.text="-",this.fontSize=14,this.anchor="center",this.visible=!0,this.isDecoration=!0,this.backgroundColor=new Color.A([0,0,0,.6]),this.textColor=new Color.A([255,255,255]),this._textShadowSize=1}render(){return function h_t(e,t,o){if(Array.isArray(t))o=t,t=void 0;else if(t&&("string"==typeof t||t.hasOwnProperty("vnodeSelector"))||o&&("string"==typeof o||o.hasOwnProperty("vnodeSelector")))throw new Error("h called with invalid arguments");let n,l;return o&&1===o.length&&"string"==typeof o[0]?n=o[0]:o&&(l=[],h_r(e,o,l),0===l.length&&(l=void 0)),{vnodeSelector:e,properties:t,children:l,text:""===n?void 0:n,domNode:null}}("div",{classes:this._cssClasses(),styles:{left:Math.floor(this.x)+"px",top:Math.floor(this.y)+"px",visibility:this.visible?"visible":"hidden",fontSize:this.fontSize+"px",lineHeight:this.fontSize+"px",backgroundColor:this.backgroundColor.toCss(!0),color:this.textColor.toCss(!0),padding:this.padding+"px",borderRadius:this.borderRadius+"px",textShadow:this._textShadow}},[this.text])}renderCanvas(t){if(!this.visible)return;const e=t.font.replace(/^(.*?)px/,"");t.font=`${this.fontSize}px ${e}`;const{padding:o,borderRadius:i}=this,r=t.measureText(this.text).width,s=""!==this.text?this.fontSize:0,l=h[this.anchor];t.textAlign="center",t.textBaseline="middle";const n=r+2*o,a=s+2*o,x=this.x+l.x*n,d=this.y+l.y*a;this._roundedRect(t,x,d,n,a,i),t.fillStyle=this.backgroundColor.toCss(!0),t.fill();const p=this.x+(l.x+.5)*n,c=this.y+(l.y+.5)*a;this._renderTextShadow(t,this.text,p,c),t.fillStyle=this.textColor.toCss(!0),t.fillText(this.text,p,c)}_renderTextShadow(t,e,o,i){t.lineJoin="miter",t.fillStyle=`rgba(${this._textShadowColor.r}, ${this._textShadowColor.g}, ${this._textShadowColor.b}, ${1/a.length})`;const r=this._textShadowSize;for(const[s,l]of a)t.fillText(e,o+r*s,i+r*l)}_roundedRect(t,e,o,i,r,s){s=Math.min(s,r/2,i/2),t.beginPath(),t.moveTo(e,o+s),t.arcTo(e,o,e+s,o,s),t.lineTo(e+i-s,o),t.arcTo(e+i,o,e+i,o+s,s),t.lineTo(e+i,o+r-s),t.arcTo(e+i,o+r,e+i-s,o+r,s),t.lineTo(e+s,o+r),t.arcTo(e,o+r,e,o+r-s,s),t.closePath()}_cssClasses(){const t={"esri-text-overlay-item":!0};let e;for(e in TextOverlayItem_l)t[TextOverlayItem_l[e]]=this.anchor===e;return t}};(0,tslib_es6._)([(0,property.MZ)()],TextOverlayItem_n.prototype,"x",void 0),(0,tslib_es6._)([(0,property.MZ)()],TextOverlayItem_n.prototype,"y",void 0),(0,tslib_es6._)([(0,property.MZ)()],TextOverlayItem_n.prototype,"position",null),(0,tslib_es6._)([(0,property.MZ)()],TextOverlayItem_n.prototype,"text",void 0),(0,tslib_es6._)([(0,property.MZ)()],TextOverlayItem_n.prototype,"fontSize",void 0),(0,tslib_es6._)([(0,property.MZ)()],TextOverlayItem_n.prototype,"anchor",void 0),(0,tslib_es6._)([(0,property.MZ)()],TextOverlayItem_n.prototype,"visible",void 0),(0,tslib_es6._)([(0,property.MZ)()],TextOverlayItem_n.prototype,"isDecoration",void 0),(0,tslib_es6._)([(0,property.MZ)()],TextOverlayItem_n.prototype,"backgroundColor",void 0),(0,tslib_es6._)([(0,property.MZ)()],TextOverlayItem_n.prototype,"textColor",void 0),(0,tslib_es6._)([(0,property.MZ)()],TextOverlayItem_n.prototype,"_textShadowSize",void 0),(0,tslib_es6._)([(0,property.MZ)()],TextOverlayItem_n.prototype,"_textShadowColor",null),(0,tslib_es6._)([(0,property.MZ)()],TextOverlayItem_n.prototype,"_textShadow",null),(0,tslib_es6._)([(0,property.MZ)()],TextOverlayItem_n.prototype,"padding",null),(0,tslib_es6._)([(0,property.MZ)()],TextOverlayItem_n.prototype,"borderRadius",null),TextOverlayItem_n=(0,tslib_es6._)([(0,subclass.$)("esri.views.overlay.TextOverlayItem")],TextOverlayItem_n);const h={bottom:{x:-.5,y:-1,textAlign:"center",textBaseline:"bottom"},"bottom-left":{x:0,y:-1,textAlign:"left",textBaseline:"bottom"},"bottom-right":{x:-1,y:-1,textAlign:"right",textBaseline:"bottom"},center:{x:-.5,y:-.5,textAlign:"center",textBaseline:"middle"},left:{x:0,y:-.5,textAlign:"left",textBaseline:"middle"},right:{x:-1,y:-.5,textAlign:"right",textBaseline:"middle"},top:{x:-.5,y:0,textAlign:"center",textBaseline:"top"},"top-left":{x:0,y:0,textAlign:"left",textBaseline:"top"},"top-right":{x:-1,y:0,textAlign:"right",textBaseline:"top"}},a=[];{const t=16;for(let e=0;e<360;e+=360/t)a.push([Math.cos(Math.PI*e/180),Math.sin(Math.PI*e/180)])}const TextOverlayItem_x=TextOverlayItem_n;var automaticLengthMeasurementUtils=__webpack_require__("./node_modules/@arcgis/core/views/support/automaticLengthMeasurementUtils.js"),locale=__webpack_require__("./node_modules/@arcgis/core/intl/locale.js");const SegmentLabels_V={default:15,far:25};let SegmentLabels_A=class extends Accessor.A{constructor(t){super(t),this.context=null,this.stagedVertex=null,this.visible=!0,this.edgeDistance="default",this._messageUnitsTask=null,this._labelInfos=[],this._nextLabelIndex=0}initialize(){this.addHandles([(0,reactiveUtils.watch)((()=>[null!=this.context&&this.getCameraOrExtent(this.context),this.visible,this._edgeDistancePixels,this.stagedVertex,this._messagesUnits]),(()=>this._update())),...["vertex-add","vertex-update","vertex-remove"].map((t=>(0,reactiveUtils.on)((()=>this.context?.editGeometryOperations),t,(()=>this._update())))),(0,reactiveUtils.watch)((()=>this._colors),(t=>this._updateStyle(t))),(0,locale.oQ)((()=>this._refreshMessages())),(0,handleUtils.hA)((()=>this._messageUnitsTask?.abort()))]),this._refreshMessages()}destroy(){for(this._nextLabelIndex=0;this._labelInfos.length;)this._destroyLabel(this._labelInfos.pop())}get updating(){return null==this._messagesUnits}get test(){}get _messagesUnits(){return this._messageUnitsTask?.value}get _edgeDistancePixels(){return SegmentLabels_V[this.edgeDistance]}get _colors(){const t=this.context?.view.effectiveTheme.textColor??Color.A.fromArray([255,255,255]);return{textColor:t,backgroundColor:(0,colorUtils._L)((0,colorUtils.bJ)(t,colorUtils.pW.Low),.6)}}_update(){if(this.destroyed)return;this._nextLabelIndex=0;const{context:t,stagedVertex:e}=this;if(!t)return this._destroyUnusedLabels();const{editGeometryOperations:s}=t,{components:o,geometry:r,coordinateHelper:i}=s.data;if(!r)return this._destroyUnusedLabels();const n=o.length;for(let l=0;l<n;++l){const o=SegmentLabels_G(r,s,e,i,l);if(o.length<2||!SegmentLabels_R(o,t.view,t.elevationInfo,i.spatialReference))continue;const a=1===n&&!(0,coordsUtils.$3)(o);let c=SegmentLabels_H,h=SegmentLabels_X;this.toScreenPointArray(t,o[0],c);for(let e=1;e<o.length;++e){const s=o[e-1],r=o[e];this.toScreenPointArray(t,r,h),this._addLabel(t,s,c,r,h,a),[c,h]=[h,c]}}this._destroyUnusedLabels()}_updateStyle({textColor:t,backgroundColor:e}){const s=this._nextLabelIndex,o=this._labelInfos;for(let r=0;r<s;++r){const{label:s}=o[r];s.textColor=t,s.backgroundColor=e}}_addLabel(t,e,s,o,r,i){const{label:n}=this._getOrCreateLabel(t);if(!this.visible||(0,vec2.hG)(s,r)<3025)return void(n.visible=!1);const{spatialReference:l}=t.editGeometryOperations.data,a=(0,automaticLengthMeasurementUtils.Do)(e,o,l),h=this._messagesUnits,p=(0,getDefaultUnitForView.c)(t.view);n.text=null!=h&&null!=a?(0,quantityFormatUtils.ix)(h,a,p):"",n.visible=!0;const m=r[0]-s[0],d=r[1]-s[1];i?(0,vec2.hZ)(SegmentLabels_z,-d,m):(0,vec2.hZ)(SegmentLabels_z,d,-m),(0,vec2.S8)(SegmentLabels_z,SegmentLabels_z),(0,vec2.hs)(SegmentLabels_z,SegmentLabels_z,this._edgeDistancePixels),(0,vec2.Cc)(F,s,r,.5),(0,vec2.WQ)(F,F,SegmentLabels_z),n.position=[F[0],F[1]],Math.abs(SegmentLabels_z[0])>Math.abs(SegmentLabels_z[1])?n.anchor=SegmentLabels_z[0]>0?"left":"right":n.anchor=-SegmentLabels_z[1]<0?"top":"bottom"}_getOrCreateLabel(t){const e=this._labelInfos.length>this._nextLabelIndex,{textColor:s,backgroundColor:o}=this._colors;if(e){const t=this._labelInfos[this._nextLabelIndex++],{label:e}=t;return e.textColor=s,e.backgroundColor=o,t}const r=new TextOverlayItem_x({anchor:"center",fontSize:8,textColor:s,backgroundColor:o});t.view.overlay?.items.add(r);const i={label:r};return this._labelInfos.push(i),this._nextLabelIndex=this._labelInfos.length,i}_destroyUnusedLabels(){for(;this._labelInfos.length>this._nextLabelIndex;)this._destroyLabel(this._labelInfos.pop())}_destroyLabel({label:t}){this.context?.view.overlay?.items.remove(t),t.destroy()}_refreshMessages(){this._messageUnitsTask?.abort(),this._messageUnitsTask=(0,asyncUtils.UT)((()=>(0,messages.ud)("esri/core/t9n/Units")))}};function SegmentLabels_G(t,e,s,o,r){const i=[];if(e.data.components[r].iterateVertices((t=>{i.push(o.toXYZ(t.pos,vectorStacks.rq.get()))})),0===r&&null!=s&&i.push(o.toXYZ(s,vectorStacks.rq.get())),i.length<2)return i;const n=i[0],l=i[i.length-1];return"polygon"===t.type&&i.length>2&&!(0,vec32.I)(n,l)&&i.push(n),i}function SegmentLabels_R(t,e,s,o){if("2d"===e.type)return!0;const r=(0,unitUtils.Ao)(o)??1,i=(0,unitUtils.G9)(o),n=t=>(0,elevationInfoUtils.xS)(e,t,o,s,elevationInfoUtils.qt)??0;for(let l=1;l<t.length;++l){const e=t[l-1],s=t[l],o=(s[0]-e[0])*r,a=(s[1]-e[1])*r,c=(n(s)-n(e))*i;if(Math.abs(c)/Math.sqrt(o*o+a*a)>SegmentLabels_q)return!1}return!0}(0,tslib_es6._)([(0,property.MZ)()],SegmentLabels_A.prototype,"context",void 0),(0,tslib_es6._)([(0,property.MZ)()],SegmentLabels_A.prototype,"stagedVertex",void 0),(0,tslib_es6._)([(0,property.MZ)()],SegmentLabels_A.prototype,"visible",void 0),(0,tslib_es6._)([(0,property.MZ)()],SegmentLabels_A.prototype,"edgeDistance",void 0),(0,tslib_es6._)([(0,property.MZ)()],SegmentLabels_A.prototype,"updating",null),(0,tslib_es6._)([(0,property.MZ)()],SegmentLabels_A.prototype,"_messageUnitsTask",void 0),(0,tslib_es6._)([(0,property.MZ)()],SegmentLabels_A.prototype,"_messagesUnits",null),(0,tslib_es6._)([(0,property.MZ)()],SegmentLabels_A.prototype,"_edgeDistancePixels",null),(0,tslib_es6._)([(0,property.MZ)()],SegmentLabels_A.prototype,"_colors",null),SegmentLabels_A=(0,tslib_es6._)([(0,subclass.$)("esri.views.interactive.SegmentLabels")],SegmentLabels_A);const SegmentLabels_q=(0,mathUtils.kU)(5),SegmentLabels_z=(0,vec2f64.vt)(),F=(0,vec2f64.vt)(),SegmentLabels_H=(0,screenUtils.gs)(),SegmentLabels_X=(0,screenUtils.gs)();let SegmentLabels3D_a=class extends SegmentLabels_A{getCameraOrExtent({view:e}){return e.state.camera}toScreenPointArray({view:e,elevationInfo:t,editGeometryOperations:o},i,a=(0,screenUtils.gs)()){const{spatialReference:m}=o.data.coordinateHelper;return(0,viewUtils.X)(i,m,t,e,SegmentLabels3D_c),e.state.camera.projectToScreen(SegmentLabels3D_c,a),a}};SegmentLabels3D_a=(0,tslib_es6._)([(0,subclass.$)("esri.views.3d.interactive.SegmentLabels3D")],SegmentLabels3D_a);const SegmentLabels3D_c=(0,vec3f64.vt)();var projectVectorToVector=__webpack_require__("./node_modules/@arcgis/core/geometry/projection/projectVectorToVector.js"),vec42=__webpack_require__("./node_modules/@arcgis/core/chunks/vec42.js"),vec4f64=__webpack_require__("./node_modules/@arcgis/core/core/libs/gl-matrix-2/factories/vec4f64.js"),clipRay=__webpack_require__("./node_modules/@arcgis/core/geometry/support/clipRay.js"),frustum=__webpack_require__("./node_modules/@arcgis/core/geometry/support/frustum.js"),lineSegment=__webpack_require__("./node_modules/@arcgis/core/geometry/support/lineSegment.js"),ray=__webpack_require__("./node_modules/@arcgis/core/geometry/support/ray.js"),Identifiable=__webpack_require__("./node_modules/@arcgis/core/core/Identifiable.js"),interfaces=__webpack_require__("./node_modules/@arcgis/core/views/3d/layers/interfaces.js"),ModelDirtyTypes=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/lib/ModelDirtyTypes.js"),UpdatePolicy=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/lib/UpdatePolicy.js");class DrapedVisualElementResources_d{constructor(e){this._resourceFactory=e,this._resources=null,this._visible=!0,this._attached=!1,this._renderGroup=interfaces.O7.Outline}destroy(){this._destroyResources()}get resources(){return null!=this._resources?this._resources.external:null}get visible(){return this._visible}set visible(e){e!==this._visible&&(this._visible=e,this._syncGeometriesToRenderer())}get attached(){return this._attached}set attached(e){e!==this._attached&&(this._attached=e,this._createOrDestroyResources())}get renderGroup(){return this._renderGroup}set renderGroup(e){this._renderGroup=e;const r=this._resources?.layerView;r&&(r.renderGroup=e)}recreate(){this.attached&&this._createResources()}recreateGeometry(){this._resourceFactory.recreateGeometry?null!=this._resources&&(this._ensureRenderGeometriesRemoved(),this._resourceFactory.recreateGeometry(this._resources.external),this._syncGeometriesToRenderer()):this.recreate()}_createOrDestroyResources(){this._attached?null==this._resources&&this._createResources():this._destroyResources()}_createResources(){this._destroyResources();const e=this._resourceFactory.createResources(),r=new DrapedVisualElementResources_a({view:this._resourceFactory.view,renderGroup:this._renderGroup}),s=this._resourceFactory.view.basemapTerrain?.overlayManager;this._resources={layerView:new DrapedVisualElementResources_a({view:this._resourceFactory.view,renderGroup:this._renderGroup}),external:e,geometriesAdded:!1},s&&(this._resources.drapeSourceRenderer=s.registerGeometryDrapeSource(r)),this._syncGeometriesToRenderer()}_destroyResources(){if(null==this._resources)return;this._ensureRenderGeometriesRemoved();const e=this._resourceFactory.view.basemapTerrain?.overlayManager;e&&e.unregisterDrapeSource(this._resources.layerView),this._resourceFactory.destroyResources(this._resources.external),this._resources=null}_syncGeometriesToRenderer(){this._visible?this._ensureRenderGeometriesAdded():this._ensureRenderGeometriesRemoved()}_ensureRenderGeometriesRemoved(){null!=this._resources?.drapeSourceRenderer&&this._resources.geometriesAdded&&(this._resources.drapeSourceRenderer.removeGeometries(this._resources.external.geometries,ModelDirtyTypes.q.UPDATE),this._resources.geometriesAdded=!1)}_ensureRenderGeometriesAdded(){null!=this._resources?.drapeSourceRenderer&&(this._resources.geometriesAdded||(this._resources.drapeSourceRenderer.addGeometries(this._resources.external.geometries,ModelDirtyTypes.q.UPDATE),this._resources.geometriesAdded=!0))}}let DrapedVisualElementResources_a=class extends(Identifiable.A.IdentifiableMixin(Accessor.A)){constructor(e){super(e),this.drapeSourceType=interfaces.Om.Features,this.updatePolicy=UpdatePolicy.q.SYNC,this.renderGroup=interfaces.O7.Outline}};(0,tslib_es6._)([(0,property.MZ)({constructOnly:!0})],DrapedVisualElementResources_a.prototype,"view",void 0),(0,tslib_es6._)([(0,property.MZ)({readOnly:!0})],DrapedVisualElementResources_a.prototype,"drapeSourceType",void 0),(0,tslib_es6._)([(0,property.MZ)()],DrapedVisualElementResources_a.prototype,"renderGroup",void 0),DrapedVisualElementResources_a=(0,tslib_es6._)([(0,subclass.$)("esri.views.3d.interactive.visualElements.DrapedVisualElementResources")],DrapedVisualElementResources_a);class VisualElement_t{get isDecoration(){return this._isDecoration}set isDecoration(e){this._isDecoration=e}constructor(t){this._isDecoration=!1,this._attached=!1,this._resourcesCreated=!1,this._visible=!0,this.view=t.view,this._handle=(0,reactiveUtils.watch)((()=>t.view.ready),(e=>{this._resourcesCreated&&(e?this._createResources():this._destroyResources())}))}applyProperties(e){let t=!1;for(const s in e)s in this&&("attached"===s?t=!!e[s]:this[s]=e[s]);this.attached=t}destroy(){this.attached=!1,this._handle.remove()}get attached(){return this._attached}set attached(e){e!==this._attached&&this.view._stage&&(this._attached=e,this._attached&&!this._resourcesCreated?this._createResources():!this._attached&&this._resourcesCreated&&this._destroyResources(),this.onAttachedChange(e))}onAttachedChange(e){}get visible(){return this._visible}set visible(e){e!==this._visible&&(this._visible=e,this.attached&&this.updateVisibility(e))}_createResources(){this.createResources(),this._resourcesCreated=!0,this.updateVisibility(this.visible)}_destroyResources(){this.destroyResources(),this._resourcesCreated=!1}}var ContentObjectType=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/lib/ContentObjectType.js"),Object3D=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/lib/Object3D.js"),WebGLLayer=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/lib/WebGLLayer.js");class VisualElementResources_c{constructor(e){this._resourceFactory=e,this._resources=null,this._visible=!0,this._attached=!1}destroy(){this._destroyResources()}get object(){return null!=this._resources?this._resources.object:null}get resources(){return null!=this._resources?this._resources.external:null}get visible(){return this._visible}set visible(e){e!==this._visible&&(this._visible=e,this._syncVisible())}get attached(){return this._attached}set attached(e){e!==this._attached&&(this._attached=e,this._createOrDestroyResources())}recreate(){this.attached&&this._createResources()}recreateGeometry(){if(!this._resourceFactory.recreateGeometry)return void this.recreate();const e=this._resourceFactory.view._stage;if(null==this._resources||!e)return;const s=this._resources.object;this._resources.external.forEach((s=>{s.type!==ContentObjectType.X.Mesh&&s.type!==ContentObjectType.X.Line&&s.type!==ContentObjectType.X.Point||e.remove(s)})),s.removeAllGeometries(),this._resourceFactory.recreateGeometry(this._resources.external,s,this._resources.layer),this._resources.external.forEach((s=>{s.type!==ContentObjectType.X.Mesh&&s.type!==ContentObjectType.X.Line&&s.type!==ContentObjectType.X.Point||e.add(s)}))}_createOrDestroyResources(){this._attached?this._resources||this._createResources():this._destroyResources()}_createResources(){this._destroyResources();const c=this._resourceFactory,a=c.view,h=a._stage;if(!h)return;const u=new WebGLLayer.x(h,{pickable:!1,updatePolicy:UpdatePolicy.q.SYNC}),l=new Object3D.B({castShadow:!1}),n=c.createResources(l,u);n.forEach((e=>{h.add(e),e.type===ContentObjectType.X.Texture&&e.load(h.renderView.renderingContext)})),h.add(l),u.add(l);const _=c.cameraChanged,y=_?(0,reactiveUtils.watch)((()=>a.state.camera),(e=>_(e)),reactiveUtils.Vh):null;this._resources={layer:u,object:l,external:n,cameraHandle:y},this._syncVisible()}_destroyResources(){if(null==this._resources)return;const e=this._resourceFactory.view._stage;e&&(e.remove(this._resources.object),this._resources.layer.destroy(),this._resources.external.forEach((s=>{e.remove(s),s.type===ContentObjectType.X.Texture&&s.unload()}))),this._resources.object.dispose(),this._resources.cameraHandle?.remove(),this._resourceFactory.destroyResources(this._resources.external),this._resources=null}_syncVisible(){null!=this._resources&&(this._resources.object.visible=this._visible)}}class EngineVisualElement_t extends VisualElement_t{constructor(s){super(s),this._isDraped=!1,this.object3dResources=new VisualElementResources_c(this.createObject3DResourceFactory(s.view)),this.drapedResources=new DrapedVisualElementResources_d(this.createDrapedResourceFactory(s.view)),this.isDraped=s.isDraped??!1}get isDraped(){return this._isDraped}set isDraped(e){e!==this._isDraped&&(this._isDraped=e,this.object3dResources.attached=this.attached&&!e,this.drapedResources.attached=this.attached&&e)}get renderGroup(){return this.drapedResources.renderGroup}set renderGroup(e){this.drapedResources.renderGroup=e}createResources(){this.object3dResources.attached=!this._isDraped,this.drapedResources.attached=this._isDraped}destroyResources(){this.object3dResources.attached=!1,this.drapedResources.attached=!1}recreate(){this.object3dResources.recreate(),this.drapedResources.recreate()}recreateGeometry(){this.object3dResources.recreateGeometry(),this.drapedResources.recreateGeometry()}destroy(){this.object3dResources.destroy(),this.drapedResources.destroy(),super.destroy()}updateVisibility(e){this.object3dResources.visible=e,this.drapedResources.visible=e}}var ViewingMode=__webpack_require__("./node_modules/@arcgis/core/views/ViewingMode.js"),webgl=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl.js"),RenderNode=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl/RenderNode.js"),Compositing_glsl=__webpack_require__("./node_modules/@arcgis/core/chunks/Compositing.glsl.js"),compilerUtils=__webpack_require__("./node_modules/@arcgis/core/core/compilerUtils.js"),ReloadableShaderModule=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderTechnique/ReloadableShaderModule.js"),ShaderTechnique=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderTechnique/ShaderTechnique.js"),CompositingTechniqueConfiguration=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/shaders/CompositingTechniqueConfiguration.js"),renderState=__webpack_require__("./node_modules/@arcgis/core/views/webgl/renderState.js");class CompositingTechnique_a extends ShaderTechnique.w{constructor(e,o){super(e,o,new ReloadableShaderModule.$(Compositing_glsl.a,(()=>__webpack_require__.e(9015).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@arcgis/core/views/3d/webgl-engine/shaders/Compositing.glsl.js")))))}initializePipeline(r){switch(r.blitMode){case CompositingTechniqueConfiguration.d.None:case CompositingTechniqueConfiguration.d.Depth:return(0,renderState.Ey)({colorWrite:renderState.kn});case CompositingTechniqueConfiguration.d.Alpha:return(0,renderState.Ey)({blending:renderState.Ky,colorWrite:renderState.kn});default:(0,compilerUtils.Xb)(r.blitMode);case CompositingTechniqueConfiguration.d.PremultipliedAlpha:case CompositingTechniqueConfiguration.d.COUNT:return(0,renderState.Ey)({blending:renderState.Os,colorWrite:renderState.kn})}}}var enums=__webpack_require__("./node_modules/@arcgis/core/views/webgl/enums.js");class Blit_o{constructor(s,o=CompositingTechniqueConfiguration.d.None){this._techniques=s,this._parameters=new Compositing_glsl.C,this._configuration=new CompositingTechniqueConfiguration.N,this._configuration.blitMode=o,s.precompile(CompositingTechnique_a,this._configuration)}blit(e,i,r,o){e.bindFramebuffer(r.fbo),e.setClearColor(0,0,0,1),e.clear(enums.NV.COLOR),this._parameters.texture=i.getTexture();const n=this._techniques.get(CompositingTechnique_a,this._configuration);e.bindTechnique(n,o,this._parameters),e.screen.draw()}blend(e,i,r,s,o=1){this._configuration.hasOpacityFactor=o<1;const n=this._techniques.get(CompositingTechnique_a,this._configuration);return!!n.compiled&&(e.bindFramebuffer(r.fbo),this._parameters.texture=i.getTexture(),this._parameters.opacity=o,e.bindTechnique(n,s,this._parameters),e.screen.draw(),!0)}}var DoubleArray=__webpack_require__("./node_modules/@arcgis/core/geometry/support/DoubleArray.js"),glUtil=__webpack_require__("./node_modules/@arcgis/core/views/3d/support/buffer/glUtil.js"),InterleavedLayout=__webpack_require__("./node_modules/@arcgis/core/views/3d/support/buffer/InterleavedLayout.js"),Laserlines_glsl=__webpack_require__("./node_modules/@arcgis/core/chunks/Laserlines.glsl.js"),NoParameters=__webpack_require__("./node_modules/@arcgis/core/views/webgl/NoParameters.js");class LaserlineTechnique_a extends NoParameters.Y{constructor(){super(...arguments),this.innerColor=(0,vec3f64.fA)(1,1,1),this.innerWidth=1,this.glowColor=(0,vec3f64.fA)(1,.5,0),this.glowWidth=8,this.glowFalloff=8,this.globalAlpha=.75,this.globalAlphaContrastBoost=2,this.angleCutoff=(0,mathUtils.kU)(6),this.pointDistanceOrigin=(0,vec3f64.vt)(),this.pointDistanceTarget=(0,vec3f64.vt)(),this.lineVerticalPlaneSegment=(0,lineSegment.vt)(),this.intersectsLineSegment=(0,lineSegment.vt)(),this.intersectsLineRadius=3,this.heightManifoldTarget=(0,vec3f64.vt)(),this.lineStartWorld=(0,vec3f64.vt)(),this.lineEndWorld=(0,vec3f64.vt)()}}class LaserlineTechnique_h extends ShaderTechnique.w{constructor(e,t){super(e,t,new ReloadableShaderModule.$(Laserlines_glsl.L,(()=>__webpack_require__.e(985).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@arcgis/core/views/3d/webgl-engine/shaders/Laserlines.glsl.js")))))}}var VertexAttribute=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/lib/VertexAttribute.js"),LaserlinePath_glsl=__webpack_require__("./node_modules/@arcgis/core/chunks/LaserlinePath.glsl.js");class LaserlinePathTechnique_a extends LaserlineTechnique_a{constructor(){super(...arguments),this.origin=(0,vec3f64.vt)()}}class LaserlinePathTechnique_c extends ShaderTechnique.w{constructor(e,s){super(e,s,new ReloadableShaderModule.$(LaserlinePath_glsl.L,(()=>__webpack_require__.e(2397).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@arcgis/core/views/3d/webgl-engine/shaders/LaserlinePath.glsl.js")))),LaserlinePathTechnique_n)}}const LaserlinePathTechnique_n=new Map([[VertexAttribute.r.START,0],[VertexAttribute.r.END,1],[VertexAttribute.r.EXTRUDE,2],[VertexAttribute.r.START_UP,3],[VertexAttribute.r.END_UP,4]]);var VertexArrayObject=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/lib/VertexArrayObject.js"),BufferObject=__webpack_require__("./node_modules/@arcgis/core/views/webgl/BufferObject.js");class LaserlinePathData_{constructor(e){this._renderCoordsHelper=e,this._buffers=null,this._origin=(0,vec3f64.vt)(),this._dirty=!1,this._count=0,this._vao=null}set vertices(e){const t=(0,DoubleArray.jh)(3*e.length);let r=0;for(const s of e)t[r++]=s[0],t[r++]=s[1],t[r++]=s[2];this.buffers=[t]}set buffers(t){if(this._buffers=t,this._buffers.length>0){const t=this._buffers[0],r=3*Math.floor(t.length/3/2);(0,vec32.i)(this._origin,t[r],t[r+1],t[r+2])}else(0,vec32.i)(this._origin,0,0,0);this._dirty=!0}get origin(){return this._origin}draw(e){const t=this._ensureVAO(e);null!=t&&(e.bindVAO(t),e.drawArrays(enums.WR.TRIANGLES,0,this._count))}dispose(){null!=this._vao&&this._vao.dispose()}get _layout(){return this._renderCoordsHelper.viewingMode===ViewingMode.RT.Global?LaserlinePathData_b:LaserlinePathData_g}_ensureVAO(e){return null==this._buffers?null:(this._vao??=this._createVAO(e,this._buffers),this._ensureVertexData(this._vao,this._buffers),this._vao)}_createVAO(e,t){const r=this._createDataBuffer(t);return this._dirty=!1,new VertexArrayObject.Z(e,LaserlinePathTechnique_n,new Map([["data",(0,glUtil.U)(this._layout)]]),new Map([["data",BufferObject.g.createVertex(e,enums._U.STATIC_DRAW,r)]]))}_ensureVertexData(e,t){if(!this._dirty)return;const r=this._createDataBuffer(t);e.vertexBuffers.get("data")?.setData(r),this._dirty=!1}_createDataBuffer(r){const s=r.reduce(((e,t)=>e+LaserlinePathData_d(t)),0);this._count=s;const i=this._layout.createBuffer(s),o=this._origin;let f=0,n=0;const u="startUp"in i?this._setUpVectors.bind(this,i):void 0;for(const a of r){for(let r=0;r<a.length;r+=3){const s=(0,vec32.i)(LaserlinePathData_m,a[r],a[r+1],a[r+2]);0===r?n=this._renderCoordsHelper.getAltitude(s):this._renderCoordsHelper.setAltitude(s,n);const l=f+2*r;u?.(r,l,a,s);const c=(0,vec32.d)(LaserlinePathData_m,s,o);if(r<a.length-3){for(let e=0;e<6;e++)i.start.setVec(l+e,c);i.extrude.setValues(l,0,-1),i.extrude.setValues(l+1,1,-1),i.extrude.setValues(l+2,1,1),i.extrude.setValues(l+3,0,-1),i.extrude.setValues(l+4,1,1),i.extrude.setValues(l+5,0,1)}if(r>0)for(let e=-6;e<0;e++)i.end.setVec(l+e,c)}f+=LaserlinePathData_d(a)}return i.buffer}_setUpVectors(e,t,r,s,i){const o=this._renderCoordsHelper.worldUpAtPosition(i,LaserlinePathData_p);if(t<s.length-3)for(let f=0;f<6;f++)e.startUp.setVec(r+f,o);if(t>0)for(let f=-6;f<0;f++)e.endUp.setVec(r+f,o)}}function LaserlinePathData_d(e){return 2*(e.length/3-1)*3}const LaserlinePathData_p=(0,vec3f64.vt)(),LaserlinePathData_m=(0,vec3f64.vt)(),LaserlinePathData_b=(0,InterleavedLayout.BP)().vec3f(VertexAttribute.r.START).vec3f(VertexAttribute.r.END).vec2f(VertexAttribute.r.EXTRUDE).vec3f(VertexAttribute.r.START_UP).vec3f(VertexAttribute.r.END_UP),LaserlinePathData_g=(0,InterleavedLayout.BP)().vec3f(VertexAttribute.r.START).vec3f(VertexAttribute.r.END).vec2f(VertexAttribute.r.EXTRUDE);var ShaderTechniqueConfiguration=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderTechnique/ShaderTechniqueConfiguration.js");class LaserlinePathTechniqueConfiguration_e extends ShaderTechniqueConfiguration.K{constructor(){super(...arguments),this.contrastControlEnabled=!1,this.spherical=!1}}(0,tslib_es6._)([(0,ShaderTechniqueConfiguration.W)()],LaserlinePathTechniqueConfiguration_e.prototype,"contrastControlEnabled",void 0),(0,tslib_es6._)([(0,ShaderTechniqueConfiguration.W)()],LaserlinePathTechniqueConfiguration_e.prototype,"spherical",void 0);class LaserlineTechniqueConfiguration_n extends LaserlinePathTechniqueConfiguration_e{constructor(){super(...arguments),this.heightManifoldEnabled=!1,this.pointDistanceEnabled=!1,this.lineVerticalPlaneEnabled=!1,this.intersectsLineEnabled=!1}}(0,tslib_es6._)([(0,ShaderTechniqueConfiguration.W)()],LaserlineTechniqueConfiguration_n.prototype,"heightManifoldEnabled",void 0),(0,tslib_es6._)([(0,ShaderTechniqueConfiguration.W)()],LaserlineTechniqueConfiguration_n.prototype,"pointDistanceEnabled",void 0),(0,tslib_es6._)([(0,ShaderTechniqueConfiguration.W)()],LaserlineTechniqueConfiguration_n.prototype,"lineVerticalPlaneEnabled",void 0),(0,tslib_es6._)([(0,ShaderTechniqueConfiguration.W)()],LaserlineTechniqueConfiguration_n.prototype,"intersectsLineEnabled",void 0);var basicInterfaces=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/lib/basicInterfaces.js"),MaterialUtil=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/materials/internal/MaterialUtil.js");let LaserLineRenderer_j=class extends RenderNode.A{constructor(e){super(e),this.produces=webgl.OG.LASERLINES,this.consumes={required:[webgl.OG.LASERLINES,"normals"]},this.requireGeometryDepth=!0,this._configuration=new LaserlineTechniqueConfiguration_n,this._pathTechniqueConfiguration=new LaserlinePathTechniqueConfiguration_e,this._heightManifoldEnabled=!1,this._pointDistanceEnabled=!1,this._lineVerticalPlaneEnabled=!1,this._intersectsLineEnabled=!1,this._intersectsLineInfinite=!1,this._pathVerticalPlaneEnabled=!1,this._passParameters=new LaserlinePathTechnique_a;const t=e.view._stage.renderView.techniques,i=new LaserlinePathTechniqueConfiguration_e;i.contrastControlEnabled=e.contrastControlEnabled,t.precompile(LaserlinePathTechnique_c,i)}initialize(){this._passParameters.renderCoordsHelper=this.view.renderCoordsHelper,this._pathTechniqueConfiguration.spherical=this.view.state.viewingMode===ViewingMode.RT.Global,this._pathTechniqueConfiguration.contrastControlEnabled=this.contrastControlEnabled,this._techniques.precompile(LaserlinePathTechnique_c,this._pathTechniqueConfiguration),this._blit=new Blit_o(this._techniques,CompositingTechniqueConfiguration.d.PremultipliedAlpha)}destroy(){this._pathVerticalPlaneData=(0,maybe.WD)(this._pathVerticalPlaneData),this._blit=null}get _techniques(){return this.view._stage.renderView.techniques}get heightManifoldEnabled(){return this._heightManifoldEnabled}set heightManifoldEnabled(e){this._heightManifoldEnabled!==e&&(this._heightManifoldEnabled=e,this.requestRender(basicInterfaces.C7.UPDATE))}get heightManifoldTarget(){return this._passParameters.heightManifoldTarget}set heightManifoldTarget(e){(0,vec32.c)(this._passParameters.heightManifoldTarget,e),this.requestRender(basicInterfaces.C7.UPDATE)}get pointDistanceEnabled(){return this._pointDistanceEnabled}set pointDistanceEnabled(e){e!==this._pointDistanceEnabled&&(this._pointDistanceEnabled=e,this.requestRender(basicInterfaces.C7.UPDATE))}get pointDistanceTarget(){return this._passParameters.pointDistanceTarget}set pointDistanceTarget(e){(0,vec32.c)(this._passParameters.pointDistanceTarget,e),this.requestRender(basicInterfaces.C7.UPDATE)}get pointDistanceOrigin(){return this._passParameters.pointDistanceOrigin}set pointDistanceOrigin(e){(0,vec32.c)(this._passParameters.pointDistanceOrigin,e),this.requestRender(basicInterfaces.C7.UPDATE)}get lineVerticalPlaneEnabled(){return this._lineVerticalPlaneEnabled}set lineVerticalPlaneEnabled(e){e!==this._lineVerticalPlaneEnabled&&(this._lineVerticalPlaneEnabled=e,this.requestRender(basicInterfaces.C7.UPDATE))}get lineVerticalPlaneSegment(){return this._passParameters.lineVerticalPlaneSegment}set lineVerticalPlaneSegment(e){(0,lineSegment.C)(e,this._passParameters.lineVerticalPlaneSegment),this.requestRender(basicInterfaces.C7.UPDATE)}get intersectsLineEnabled(){return this._intersectsLineEnabled}set intersectsLineEnabled(e){e!==this._intersectsLineEnabled&&(this._intersectsLineEnabled=e,this.requestRender(basicInterfaces.C7.UPDATE))}get intersectsLineSegment(){return this._passParameters.intersectsLineSegment}set intersectsLineSegment(e){(0,lineSegment.C)(e,this._passParameters.intersectsLineSegment),this.requestRender(basicInterfaces.C7.UPDATE)}get intersectsLineInfinite(){return this._intersectsLineInfinite}set intersectsLineInfinite(e){e!==this._intersectsLineInfinite&&(this._intersectsLineInfinite=e,this.requestRender(basicInterfaces.C7.UPDATE))}get pathVerticalPlaneEnabled(){return this._pathVerticalPlaneEnabled}set pathVerticalPlaneEnabled(e){e!==this._pathVerticalPlaneEnabled&&(this._pathVerticalPlaneEnabled=e,null!=this._pathVerticalPlaneData&&this.requestRender(basicInterfaces.C7.UPDATE))}set pathVerticalPlaneVertices(e){null==this._pathVerticalPlaneData&&(this._pathVerticalPlaneData=new LaserlinePathData_(this._passParameters.renderCoordsHelper)),this._pathVerticalPlaneData.vertices=e,this.pathVerticalPlaneEnabled&&this.requestRender(basicInterfaces.C7.UPDATE)}set pathVerticalPlaneBuffers(e){null==this._pathVerticalPlaneData&&(this._pathVerticalPlaneData=new LaserlinePathData_(this._passParameters.renderCoordsHelper)),this._pathVerticalPlaneData.buffers=e,this.pathVerticalPlaneEnabled&&this.requestRender(basicInterfaces.C7.UPDATE)}setParameters(e){(0,MaterialUtil.MB)(this._passParameters,e)&&this.requestRender(basicInterfaces.C7.UPDATE)}precompile(){this._acquireTechnique()}render(e){const t=e.find((({name:e})=>e===this.produces));if(!this.bindParameters.decorations||null==this._blit)return t;const i=this.renderingContext,n=e.find((({name:e})=>"normals"===e));this._passParameters.normals=n?.getTexture();const s=()=>{(this.heightManifoldEnabled||this.pointDistanceEnabled||this.lineVerticalPlaneSegment||this.intersectsLineEnabled)&&this._renderUnified(),this.pathVerticalPlaneEnabled&&this._renderPath()};if(!this.contrastControlEnabled)return i.bindFramebuffer(t.fbo),s(),t;this._passParameters.colors=t.getTexture();const r=this.fboCache.acquire(t.fbo.width,t.fbo.height,"laser lines");return i.bindFramebuffer(r.fbo),i.setClearColor(0,0,0,0),i.clear(enums.NV.COLOR|enums.NV.DEPTH),s(),i.unbindTexture(t.getTexture()),this._blit.blend(i,r,t,this.bindParameters)||this.requestRender(basicInterfaces.C7.UPDATE),r.release(),t}_acquireTechnique(){return this._configuration.heightManifoldEnabled=this.heightManifoldEnabled,this._configuration.lineVerticalPlaneEnabled=this.lineVerticalPlaneEnabled,this._configuration.pointDistanceEnabled=this.pointDistanceEnabled,this._configuration.intersectsLineEnabled=this.intersectsLineEnabled,this._configuration.contrastControlEnabled=this.contrastControlEnabled,this._configuration.spherical=this.view.state.viewingMode===ViewingMode.RT.Global,this._techniques.get(LaserlineTechnique_h,this._configuration)}_renderUnified(){if(!this._updatePassParameters())return;const e=this._acquireTechnique();if(e.compiled){const t=this.renderingContext;t.bindTechnique(e,this.bindParameters,this._passParameters),t.screen.draw()}else this.requestRender(basicInterfaces.C7.UPDATE)}_renderPath(){if(null==this._pathVerticalPlaneData)return;const e=this._techniques.get(LaserlinePathTechnique_c,this._pathTechniqueConfiguration);if(e.compiled){const t=this.renderingContext;this._passParameters.origin=this._pathVerticalPlaneData.origin,t.bindTechnique(e,this.bindParameters,this._passParameters),this._pathVerticalPlaneData.draw(t)}else this.requestRender(basicInterfaces.C7.UPDATE)}_updatePassParameters(){if(!this._intersectsLineEnabled)return!0;const e=this.bindParameters.camera,t=this._passParameters;if(this._intersectsLineInfinite){if((0,clipRay.$e)((0,ray.LV)(t.intersectsLineSegment.origin,t.intersectsLineSegment.vector),LaserLineRenderer_w),LaserLineRenderer_w.c0=-Number.MAX_VALUE,!(0,frustum.ig)(e.frustum,LaserLineRenderer_w))return!1;(0,clipRay.j1)(LaserLineRenderer_w,t.lineStartWorld),(0,clipRay.mO)(LaserLineRenderer_w,t.lineEndWorld)}else(0,vec32.c)(t.lineStartWorld,t.intersectsLineSegment.origin),(0,vec32.g)(t.lineEndWorld,t.intersectsLineSegment.origin,t.intersectsLineSegment.vector);return!0}get test(){}};(0,tslib_es6._)([(0,property.MZ)({constructOnly:!0})],LaserLineRenderer_j.prototype,"contrastControlEnabled",void 0),(0,tslib_es6._)([(0,property.MZ)({constructOnly:!0})],LaserLineRenderer_j.prototype,"isDecoration",void 0),(0,tslib_es6._)([(0,property.MZ)()],LaserLineRenderer_j.prototype,"produces",void 0),(0,tslib_es6._)([(0,property.MZ)()],LaserLineRenderer_j.prototype,"consumes",void 0),LaserLineRenderer_j=(0,tslib_es6._)([(0,subclass.$)("esri.views.3d.webgl-engine.effects.laserlines.LaserLineRenderer")],LaserLineRenderer_j);const LaserLineRenderer_w=(0,clipRay.vt)();class LaserlineVisualElement_c extends VisualElement_t{constructor(e){super(e),this._angleCutoff=Laserlines_glsl.d,this._style={},this._heightManifoldTarget=(0,vec3f64.vt)(),this._heightManifoldEnabled=!1,this._intersectsLine=(0,lineSegment.vt)(),this._intersectsLineEnabled=!1,this._intersectsLineInfinite=!1,this._lineVerticalPlaneSegment=null,this._pathVerticalPlaneBuffers=null,this._pointDistanceLine=null,this.applyProperties(e)}get testData(){}createResources(){this._ensureRenderer()}destroyResources(){this._disposeRenderer()}updateVisibility(){this._syncRenderer(),this._syncHeightManifold(),this._syncIntersectsLine(),this._syncPathVerticalPlane(),this._syncLineVerticalPlane(),this._syncPointDistance()}get angleCutoff(){return this._angleCutoff}set angleCutoff(e){this._angleCutoff!==e&&(this._angleCutoff=e,this._syncAngleCutoff())}get style(){return this._style}set style(e){this._style=e,this._syncStyle()}get heightManifoldTarget(){return this._heightManifoldEnabled?this._heightManifoldTarget:null}set heightManifoldTarget(t){null!=t?((0,vec32.c)(this._heightManifoldTarget,t),this._heightManifoldEnabled=!0):this._heightManifoldEnabled=!1,this._syncRenderer(),this._syncHeightManifold()}set intersectsWorldUpAtLocation(e){if(null==e)return void(this.intersectsLine=null);const t=this.view.renderCoordsHelper.worldUpAtPosition(e,LaserlineVisualElement_);this.intersectsLine=(0,lineSegment.fA)(e,t),this.intersectsLineInfinite=!0}get intersectsLine(){return this._intersectsLineEnabled?this._intersectsLine:null}set intersectsLine(e){null!=e?((0,lineSegment.C)(e,this._intersectsLine),this._intersectsLineEnabled=!0):this._intersectsLineEnabled=!1,this._syncIntersectsLine(),this._syncRenderer()}get intersectsLineInfinite(){return this._intersectsLineInfinite}set intersectsLineInfinite(e){this._intersectsLineInfinite=e,this._syncIntersectsLineInfinite()}get lineVerticalPlaneSegment(){return this._lineVerticalPlaneSegment}set lineVerticalPlaneSegment(e){this._lineVerticalPlaneSegment=null!=e?(0,lineSegment.C)(e):null,this._syncLineVerticalPlane(),this._syncRenderer()}get pathVerticalPlane(){return this._pathVerticalPlaneBuffers}set pathVerticalPlane(e){this._pathVerticalPlaneBuffers=e,this._syncPathVerticalPlane(),this._syncLineVerticalPlane(),this._syncPointDistance(),this._syncRenderer()}get pointDistanceLine(){return this._pointDistanceLine}set pointDistanceLine(e){this._pointDistanceLine=null!=e?{origin:(0,vec3f64.o8)(e.origin),target:e.target?(0,vec3f64.o8)(e.target):null}:null,this._syncPointDistance(),this._syncRenderer()}_syncRenderer(){this.attached&&this.visible&&(this._intersectsLineEnabled||this._heightManifoldEnabled||null!=this._pointDistanceLine||null!=this._pathVerticalPlaneBuffers)?this._ensureRenderer():this._disposeRenderer()}_ensureRenderer(){null==this._renderer&&(this._renderer=new LaserLineRenderer_j({view:this.view,contrastControlEnabled:!0,isDecoration:this.isDecoration}),this._syncStyle(),this._syncHeightManifold(),this._syncIntersectsLine(),this._syncIntersectsLineInfinite(),this._syncPathVerticalPlane(),this._syncLineVerticalPlane(),this._syncPointDistance(),this._syncAngleCutoff())}_syncStyle(){null!=this._renderer&&this._renderer.setParameters(this._style)}_syncAngleCutoff(){this._renderer?.setParameters({angleCutoff:this._angleCutoff})}_syncHeightManifold(){null!=this._renderer&&(this._renderer.heightManifoldEnabled=this._heightManifoldEnabled&&this.visible,this._heightManifoldEnabled&&(this._renderer.heightManifoldTarget=this._heightManifoldTarget))}_syncIntersectsLine(){null!=this._renderer&&(this._renderer.intersectsLineEnabled=this._intersectsLineEnabled&&this.visible,this._intersectsLineEnabled&&(this._renderer.intersectsLineSegment=this._intersectsLine))}_syncIntersectsLineInfinite(){null!=this._renderer&&(this._renderer.intersectsLineInfinite=this._intersectsLineInfinite)}_syncPathVerticalPlane(){null!=this._renderer&&(this._renderer.pathVerticalPlaneEnabled=null!=this._pathVerticalPlaneBuffers&&this.visible,null!=this._pathVerticalPlaneBuffers&&(this._renderer.pathVerticalPlaneBuffers=this._pathVerticalPlaneBuffers))}_syncLineVerticalPlane(){null!=this._renderer&&(this._renderer.lineVerticalPlaneEnabled=null!=this._lineVerticalPlaneSegment&&this.visible,null!=this._lineVerticalPlaneSegment&&(this._renderer.lineVerticalPlaneSegment=this._lineVerticalPlaneSegment))}_syncPointDistance(){if(null==this._renderer)return;const e=this._pointDistanceLine,t=null!=e;this._renderer.pointDistanceEnabled=t&&null!=e.target&&this.visible,t&&(this._renderer.pointDistanceOrigin=e.origin,null!=e.target&&(this._renderer.pointDistanceTarget=e.target))}_disposeRenderer(){null!=this._renderer&&this.view._stage&&(this._renderer.destroy(),this._renderer=null)}}const LaserlineVisualElement_=(0,vec3f64.vt)();var OverlayRenderer=__webpack_require__("./node_modules/@arcgis/core/views/3d/terrain/OverlayRenderer.js"),GeometryUtil=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/lib/GeometryUtil.js"),Material=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/lib/Material.js"),RenderGeometry=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/lib/RenderGeometry.js"),RibbonLineMaterial=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/materials/RibbonLineMaterial.js");class ExtendedLineVisualElement_G extends EngineVisualElement_t{constructor(e){super(e),this._ray=(0,ray.vt)(),this._isWorldDown=!1,this._start=(0,vec3f64.vt)(),this._end=(0,vec3f64.fA)(1,0,0),this._width=1,this._color=(0,vec4f64.fA)(1,0,1,1),this._polygonOffset=!1,this._writeDepthEnabled=!0,this._innerWidth=0,this._innerColor=(0,vec4f64.fA)(1,1,1,1),this._stipplePattern=null,this._stippleOffColor=null,this._stipplePreferContinuous=!0,this._falloff=0,this._extensionType=ExtendedLineVisualElement_M.LINE,this._laserlineStyle=null,this._laserlineEnabled=!1,this._renderOccluded=Material.m$.OccludeAndTransparent,this._fadedExtensions=ExtendedLineVisualElement_L,this._laserline=new LaserlineVisualElement_c({view:this.view,isDecoration:e.isDecoration}),this.applyProperties(e)}destroy(){this._laserline.destroy(),super.destroy()}createObject3DResourceFactory(e){return{view:e,createResources:e=>this._createObject3DResources(e),destroyResources:ExtendedLineVisualElement_P,recreateGeometry:(e,t)=>this._recreateObject3DGeometry(e,t),cameraChanged:()=>this._updateGeometry()}}createDrapedResourceFactory(e){return{view:e,createResources:()=>this._createDrapedResources(),destroyResources:ExtendedLineVisualElement_P,recreateGeometry:e=>this._recreateDrapedGeometry(e)}}updateVisibility(e){super.updateVisibility(e),this._laserline.visible=e}onAttachedChange(){this._laserline.attached=this._laserlineAttached}setStartEndFromWorldDownAtLocation(r){this._isWorldDown=!0,(0,vec32.c)(this._start,r),this.view.renderCoordsHelper.worldUpAtPosition(r,this._end),(0,vec32.d)(this._end,r,this._end),(0,ray.Cr)(this._start,this._end,this._ray),this._updateGeometry()}get start(){return this._start}set start(t){this._isWorldDown=!1,(0,vec32.p)(this._start,t)||((0,vec32.c)(this._start,t),(0,ray.Cr)(this._start,this._end,this._ray),this._updateGeometry())}get end(){return this._end}set end(t){this._isWorldDown=!1,(0,vec32.p)(this._end,t)||((0,vec32.c)(this._end,t),(0,ray.Cr)(this._start,this._end,this._ray),this._updateGeometry())}get width(){return this._width}set width(e){e!==this._width&&(this._width=e,this._updateMaterial())}get color(){return this._color}set color(e){(0,vec42.a)(e,this._color)||((0,vec42.c)(this._color,e),this._updateMaterial())}get polygonOffset(){return this._polygonOffset}set polygonOffset(e){e!==this._polygonOffset&&(this._polygonOffset=e,this._updateMaterial())}get writeDepthEnabled(){return this._writeDepthEnabled}set writeDepthEnabled(e){this._writeDepthEnabled!==e&&(this._writeDepthEnabled=e,this._updateMaterial())}get innerWidth(){return this._innerWidth}set innerWidth(e){e!==this._innerWidth&&(this._innerWidth=e,this._updateMaterial())}get innerColor(){return this._innerColor}set innerColor(e){(0,vec42.a)(e,this._innerColor)||((0,vec42.c)(this._innerColor,e),this._updateMaterial())}get stipplePattern(){return this._stipplePattern}set stipplePattern(e){const t=null!=e!=(null!=this._stipplePattern);this._stipplePattern=e,t?this.recreate():this._updateMaterial()}get stippleOffColor(){return this._stippleOffColor}set stippleOffColor(e){null!=e&&null!=this._stippleOffColor&&(0,vec42.a)(e,this._stippleOffColor)||(this._stippleOffColor=null!=e?(0,vec4f64.o8)(e):null,this._updateMaterial())}get stipplePreferContinuous(){return this._stipplePreferContinuous}set stipplePreferContinuous(e){e!==this._stipplePreferContinuous&&(this._stipplePreferContinuous=e,this._updateMaterial())}get falloff(){return this._falloff}set falloff(e){e!==this._falloff&&(this._falloff=e,this._updateMaterial())}get extensionType(){return this._extensionType}set extensionType(e){e!==this._extensionType&&(this._extensionType=e,this.recreateGeometry())}get _laserlineAttached(){return this._laserlineEnabled&&null!=this._laserlineStyle&&this.attached&&!this.isDraped}get laserlineStyle(){return this._laserlineStyle}set laserlineStyle(e){this._laserlineStyle=e,this._laserline.attached=this._laserlineAttached,null!=e&&(this._laserline.style=e)}get laserlineEnabled(){return this._laserlineEnabled}set laserlineEnabled(e){this._laserlineEnabled!==e&&(this._laserlineEnabled=e,this._laserline.attached=this._laserlineAttached)}get renderOccluded(){return this._renderOccluded}set renderOccluded(e){e!==this._renderOccluded&&(this._renderOccluded=e,this._updateMaterial())}get _normalizedRenderOccluded(){return this.isDraped&&this._renderOccluded===Material.m$.OccludeAndTransparentStencil?Material.m$.OccludeAndTransparent:this._renderOccluded}get fadedExtensions(){return this._fadedExtensions}set fadedExtensions(e){this._fadedExtensions=e??ExtendedLineVisualElement_L,this.recreateGeometry()}_updateMaterial(){const{materialParameters:e}=this;this.object3dResources.resources?.material.setParameters(e),this.drapedResources.resources?.material.setParameters(e)}get materialParameters(){return{width:this._width,color:this._color,stippleOffColor:this._stippleOffColor,stipplePattern:this._stipplePattern,stipplePreferContinuous:this._stipplePreferContinuous,innerWidth:this._innerWidth,innerColor:this._innerColor,falloff:this._falloff,hasPolygonOffset:this._polygonOffset,renderOccluded:this._normalizedRenderOccluded,isDecoration:this.isDecoration,writeDepth:this._writeDepthEnabled}}_createObject3DResources(e){const t=new RibbonLineMaterial.W(this.materialParameters),r=new Array;return this._createObject3DGeometry(t,e,r),{material:t,geometries:r,forEach:e=>{e(t),r.forEach(e)}}}_recreateObject3DGeometry(e,t){e.geometries.length=0,this._createObject3DGeometry(e.material,t,e.geometries)}_createObject3DGeometry(e,t,r){const i=this._createGeometry(e);r.push(i),t.addGeometry(i),this._updateVerticesObject3D(t)}_createDrapedResources(){const e=new RibbonLineMaterial.W(this.materialParameters);return{material:e,geometries:[this._createDrapedGeometry(e)]}}_recreateDrapedGeometry(e){e.geometries=[this._createDrapedGeometry(e.material)]}_createDrapedGeometry(e){const t=this._createGeometry(e);return this._updateVerticesDraped(t),new RenderGeometry.$(t)}_createGeometry(e){const t=this.extensionType===ExtendedLineVisualElement_M.FADED,r=t?[(0,vec3f64.vt)(),(0,vec3f64.vt)(),(0,vec3f64.vt)(),(0,vec3f64.vt)()]:[(0,vec3f64.vt)(),(0,vec3f64.vt)()];return(0,GeometryUtil.Z8)(e,r,null,t?[1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,0]:null)}_updateGeometry(){if(this.isDraped)this.drapedResources.recreateGeometry();else{const e=this.object3dResources.object;e&&this._updateVerticesObject3D(e)}}_updateVerticesObject3D(e){const t=this._lineSegment;this._updateVertexAttributesObject3D(e,t),this._laserline.intersectsLine=t}_updateVerticesDraped(e){this._updateVertexAttributesDraped(e,this._lineSegment)}get _lineSegment(){return this._extensionType===ExtendedLineVisualElement_M.FADED?this._updateLineSegmentFinite(ExtendedLineVisualElement_V):this._updateLineSegmentInfinite(this._extensionType,ExtendedLineVisualElement_V)}_updateLineSegmentFinite(e){return(0,lineSegment.Cr)(this._start,this._end,e)}_updateLineSegmentInfinite(e,t){const r=this.view.state.camera;switch((0,clipRay.$e)(this._ray,ExtendedLineVisualElement_x),e){case ExtendedLineVisualElement_M.LINE:ExtendedLineVisualElement_x.c0=-Number.MAX_VALUE;break;case ExtendedLineVisualElement_M.RAY:case ExtendedLineVisualElement_M.GROUND_RAY:{const e=this._ray.origin,t=this.view.elevationProvider.getElevation(e[0],e[1],e[2],this.view.renderCoordsHelper.spatialReference,"ground")??0,r=this.view.renderCoordsHelper.getAltitude(e);this._isWorldDown&&r<t&&(0,vec32.v)(ExtendedLineVisualElement_x.ray.direction,ExtendedLineVisualElement_x.ray.direction),this._extensionType===ExtendedLineVisualElement_M.GROUND_RAY&&null!=t&&(ExtendedLineVisualElement_x.c1=Math.abs(r-t));break}}if(!(0,frustum.ig)(r.frustum,ExtendedLineVisualElement_x))return this._updateLineSegmentFinite(t);const s=(0,clipRay.j1)(ExtendedLineVisualElement_x,ExtendedLineVisualElement_v),n=(0,clipRay.mO)(ExtendedLineVisualElement_x,ExtendedLineVisualElement_S);return(0,lineSegment.Cr)(s,n,t)}_updateVertexAttributesObject3D(e,t){const r=e.geometries[0].getMutableAttribute(VertexAttribute.r.POSITION)?.data;if(!r)return;let i=0;for(const s of this._lineVertices(t))r[i++]=s[0],r[i++]=s[1],r[i++]=s[2];e.geometryVertexAttributeUpdated(e.geometries[0],VertexAttribute.r.POSITION)}_updateVertexAttributesDraped(e,t){const r=e.getMutableAttribute(VertexAttribute.r.POSITION)?.data;if(!r)return;let i=0;for(const s of this._lineVertices(t))r[i++]=s[0],r[i++]=s[1],r[i++]=OverlayRenderer.bi;e.invalidateBoundingInfo()}*_lineVertices(e){this.extensionType===ExtendedLineVisualElement_M.FADED?(yield(0,lineSegment.sd)(e,-this.fadedExtensions.start,ExtendedLineVisualElement_v),yield(0,lineSegment.sd)(e,0,ExtendedLineVisualElement_v),yield(0,lineSegment.sd)(e,1,ExtendedLineVisualElement_v),yield(0,lineSegment.sd)(e,1+this.fadedExtensions.end,ExtendedLineVisualElement_v)):(yield(0,lineSegment.sd)(e,0,ExtendedLineVisualElement_v),yield(0,lineSegment.sd)(e,1,ExtendedLineVisualElement_v))}}function ExtendedLineVisualElement_P(e){e.geometries=[]}const ExtendedLineVisualElement_x=(0,clipRay.vt)(),ExtendedLineVisualElement_v=(0,vec3f64.vt)(),ExtendedLineVisualElement_S=(0,vec3f64.vt)(),ExtendedLineVisualElement_V=(0,lineSegment.vt)();var ExtendedLineVisualElement_M;!function(e){e[e.LINE=0]="LINE",e[e.RAY=1]="RAY",e[e.GROUND_RAY=2]="GROUND_RAY",e[e.FADED=3]="FADED"}(ExtendedLineVisualElement_M||(ExtendedLineVisualElement_M={}));const ExtendedLineVisualElement_L={start:.3333333333333333,end:.3333333333333333};var dehydratedPoint=__webpack_require__("./node_modules/@arcgis/core/layers/graphics/dehydratedPoint.js");class ParallelLineVisualElement_v extends EngineVisualElement_t{constructor(e){super(e),this._location=(0,vec3f64.vt)(),this._direction=(0,vec3f64.fA)(1,0,0),this._width=1,this._offset=1,this._length=18,this._color=(0,vec4f64.fA)(1,0,1,1),this._renderOccluded=Material.m$.OccludeAndTransparent,this.applyProperties(e)}createObject3DResourceFactory(e){return{view:e,createResources:e=>this._createObject3DResources(e),destroyResources:ParallelLineVisualElement_A,recreateGeometry:(e,t)=>this._recreateObject3DGeometry(e,t),cameraChanged:()=>this._updateGeometry()}}createDrapedResourceFactory(e){return{view:e,createResources:()=>this._createDrapedResources(),destroyResources:ParallelLineVisualElement_M,recreateGeometry:e=>this._recreateDrapedGeometry(e)}}get location(){return this._location}set location(e){(0,vec32.p)(this._location,e)||((0,vec32.c)(this._location,e),this._updateGeometry())}get direction(){return this._direction}set direction(e){(0,vec32.p)(this._direction,e)||((0,vec32.c)(this._direction,e),this._updateGeometry())}setDirectionFromPoints(e,t){(0,vec32.n)(this._direction,(0,vec32.d)(this._direction,t,e)),this._updateGeometry()}get width(){return this._width}set width(e){e!==this._width&&(this._width=e,this._updateMaterial())}get offset(){return this._offset}set offset(e){e!==this._offset&&(this._offset=e,this._updateGeometry())}get length(){return this._length}set length(e){e!==this._length&&(this._length=e,this._updateGeometry())}get color(){return this._color}set color(e){(0,vec42.a)(e,this._color)||((0,vec42.c)(this._color,e),this._updateMaterial())}get renderOccluded(){return this._renderOccluded}set renderOccluded(e){e!==this._renderOccluded&&(this._renderOccluded=e,this._updateMaterial())}_createObject3DResources(e){const t=new RibbonLineMaterial.W(this.materialParameters),r=new Array;return this._createObject3DGeometry(t,e,r),{material:t,geometries:r,forEach:e=>{e(t),r.forEach(e)}}}_recreateObject3DGeometry(e,t){e.geometries.length=0,this._createObject3DGeometry(e.material,t,e.geometries)}_createObject3DGeometry(e,t,r){const[i,s]=ParallelLineVisualElement_P(e);t.addGeometry(i),t.addGeometry(s),r.push(i),r.push(s),this._updateVerticesObject3D(t)}_createDrapedResources(){const t=new RibbonLineMaterial.W(this.materialParameters),r=(0,reactiveUtils.watch)((()=>this.view.state.contentPixelRatio),(()=>this.drapedResources.recreateGeometry()));return{material:t,geometries:this._createDrapedGeometry(t),pixelRatioHandle:r}}_recreateDrapedGeometry(e){e.geometries=this._createDrapedGeometry(e.material)}_createDrapedGeometry(e){const t=ParallelLineVisualElement_P(e);return this._updateVerticesDraped(t),t.map((e=>new RenderGeometry.$(e)))}_updateMaterial(){const{materialParameters:e}=this;this.object3dResources.resources?.material.setParameters(e),this.drapedResources.resources?.material.setParameters(e)}get materialParameters(){return{width:this._width,color:this._color,renderOccluded:this._renderOccluded,isDecoration:this.isDecoration}}_updateGeometry(){if(this.isDraped)this.drapedResources.recreateGeometry();else{const e=this.object3dResources.object;e&&this._updateVerticesObject3D(e)}}_updateVerticesObject3D(e){const t=this.view.state.camera;t.projectToScreen(this.location,ParallelLineVisualElement_U),(0,vec32.g)(ParallelLineVisualElement_I,this.location,this.direction),t.projectToScreen(ParallelLineVisualElement_I,ParallelLineVisualElement_E),(0,vec2.S8)(ParallelLineVisualElement_E,(0,vec2.Re)(ParallelLineVisualElement_E,ParallelLineVisualElement_E,ParallelLineVisualElement_U)),this._updateVertexAttributesObject3D(t,e,0,ParallelLineVisualElement_U,ParallelLineVisualElement_E,1),this._updateVertexAttributesObject3D(t,e,1,ParallelLineVisualElement_U,ParallelLineVisualElement_E,-1)}_updateVertexAttributesObject3D(e,r,i,s,o,a){const c=r.geometries[i],n=c.getMutableAttribute(VertexAttribute.r.POSITION)?.data;if(!n)return;const{start:d,end:h}=ParallelLineVisualElement_V(o,s,a,this.offset,this.width,this.length);e.unprojectFromScreen((0,screenUtils.PR)(d),ParallelLineVisualElement_I),n[0]=ParallelLineVisualElement_I[0],n[1]=ParallelLineVisualElement_I[1],n[2]=ParallelLineVisualElement_I[2],e.unprojectFromScreen((0,screenUtils.PR)(h),ParallelLineVisualElement_I),n[3]=ParallelLineVisualElement_I[0],n[4]=ParallelLineVisualElement_I[1],n[5]=ParallelLineVisualElement_I[2],r.geometryVertexAttributeUpdated(c,VertexAttribute.r.POSITION)}_updateVerticesDraped(e){const{view:{basemapTerrain:{overlayManager:t},state:{contentPixelRatio:r}}}=this,{location:i,width:s,length:o,offset:a}=this,c=ParallelLineVisualElement_N;c.spatialReference=t.renderer.spatialReference,c.x=i[0],c.y=i[1];const n=this.view.overlayPixelSizeInMapUnits(c)*r,d=s*n,h=o*n,l=a*n;this._updateVertexAttributesDraped(e[0],d,h,l,-1),this._updateVertexAttributesDraped(e[1],d,h,l,1)}_updateVertexAttributesDraped(e,t,r,i,s){const o=e.getMutableAttribute(VertexAttribute.r.POSITION)?.data;if(!o)return;const{location:a,direction:c}=this,{start:n,end:d}=ParallelLineVisualElement_V(c,a,s,i,t,r);o[0]=n[0],o[1]=n[1],o[2]=OverlayRenderer.bi,o[3]=d[0],o[4]=d[1],o[5]=OverlayRenderer.bi,e.invalidateBoundingInfo()}}function ParallelLineVisualElement_P(e){return[(0,GeometryUtil.Z8)(e,[(0,vec3f64.vt)(),(0,vec3f64.vt)()]),(0,GeometryUtil.Z8)(e,[(0,vec3f64.vt)(),(0,vec3f64.vt)()])]}function ParallelLineVisualElement_V(e,t,r,i,s,n){const d=(0,vec2.hs)(ParallelLineVisualElement_S,(0,vec2.hZ)(ParallelLineVisualElement_S,e[1]*r,e[0]*-r),i+s/2),h=(0,vec2.WQ)(ParallelLineVisualElement_T,(0,vec2.WQ)(ParallelLineVisualElement_T,(0,vec2.WQ)(ParallelLineVisualElement_T,t,(0,vec2.hs)(ParallelLineVisualElement_T,e,n/2)),d),d);return{start:h,end:(0,vec2.WQ)(ParallelLineVisualElement_F,h,(0,vec2.hs)(ParallelLineVisualElement_F,e,-n))}}function ParallelLineVisualElement_A(e){e.geometries.length=0}function ParallelLineVisualElement_M(e){e.pixelRatioHandle.remove(),e.geometries=[]}const ParallelLineVisualElement_I=(0,vec3f64.vt)(),ParallelLineVisualElement_S=(0,vec2f64.vt)(),ParallelLineVisualElement_T=(0,vec2f64.vt)(),ParallelLineVisualElement_F=(0,vec2f64.vt)(),ParallelLineVisualElement_U=(0,screenUtils.gs)(),ParallelLineVisualElement_E=(0,screenUtils.gs)(),ParallelLineVisualElement_N=(0,dehydratedPoint.T)(0,0,void 0,null);var aaBoundingBox=__webpack_require__("./node_modules/@arcgis/core/geometry/support/aaBoundingBox.js"),mat4=__webpack_require__("./node_modules/@arcgis/core/core/libs/gl-matrix-2/math/mat4.js"),mat4f64=__webpack_require__("./node_modules/@arcgis/core/core/libs/gl-matrix-2/factories/mat4f64.js");class Object3DVisualElement_a extends VisualElement_t{constructor(e){super(e),this._resources=null,this._transform=(0,mat4f64.vt)()}get object(){return null!=this._resources?this._resources.object:null}get transform(){return this._transform}set transform(s){(0,mat4.C)(this._transform,s),null!=this._resources&&(this._resources.object.transformation=this._transform)}recreate(){this.attached&&this.createResources()}recreateGeometry(){if(null==this._resources)return;const e=this._resources.object,s=this.view._stage;s.removeMany(e.geometries),e.removeAllGeometries(),this.createGeometries(e),e.visible=this.visible,s.addMany(e.geometries)}createResources(){this.destroyResources();const e=this.view._stage;if(!e)return;const s=new WebGLLayer.x(e,{pickable:!1,updatePolicy:UpdatePolicy.q.SYNC}),r=new Object3D.B({castShadow:!1});r.transformation=this._transform,this.createExternalResources(),this.createGeometries(r),e.addMany(r.geometries),this.forEachExternalMaterial((s=>e.add(s))),e.add(r),s.add(r),r.visible=this.visible,this._resources={layer:s,object:r}}destroyResources(){const e=this.view._stage;null!=this._resources&&e&&(e.remove(this._resources.object),this._resources.layer.destroy(),this.forEachExternalMaterial((s=>{e.remove(s)})),e.removeMany(this._resources.object.geometries),this._resources.object.dispose(),this.destroyExternalResources(),this._resources=null)}updateVisibility(e){null!=this._resources&&(this._resources.object.visible=e)}}var elevationAlignmentUtils=__webpack_require__("./node_modules/@arcgis/core/views/3d/layers/graphics/elevationAlignmentUtils.js"),ElevationContext=__webpack_require__("./node_modules/@arcgis/core/views/3d/layers/graphics/ElevationContext.js"),sdfPrimitives=__webpack_require__("./node_modules/@arcgis/core/views/3d/support/engineContent/sdfPrimitives.js"),HUDMaterial=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/materials/HUDMaterial.js");class PointVisualElement_S extends Object3DVisualElement_a{constructor(e){super(e),this._material=null,this._texture=null,this._geometry=null,this._size=3,this._color=(0,vec4f64.fA)(1,0,1,1),this._pixelSnappingEnabled=!0,this._primitive="square",this._outlineSize=1,this._outlineColor=(0,vec4f64.fA)(1,1,1,1),this._elevationInfo=null,this.applyProperties(e)}get geometry(){return this._geometry}set geometry(e){this._geometry=e,this.recreateGeometry()}get size(){return this._size}set size(e){if(e!==this._size){const t=this._preferredTextureSize;this._size=e,t<this._preferredTextureSize?this.recreate():this._updateSizeAttribute()}}get color(){return this._color}set color(e){(0,vec42.a)(e,this._color)||((0,vec42.c)(this._color,e),this._updateMaterial())}get pixelSnappingEnabled(){return this._pixelSnappingEnabled}set pixelSnappingEnabled(e){this._pixelSnappingEnabled!==e&&(this._pixelSnappingEnabled=e,this._updateMaterial())}get primitive(){return this._primitive}set primitive(e){this._primitive!==e&&(this._primitive=e,this.recreate())}get outlineSize(){return this._outlineSize}set outlineSize(e){e!==this._outlineSize&&(this._outlineSize=e,this._updateMaterial())}get outlineColor(){return this._outlineColor}set outlineColor(e){(0,vec42.a)(e,this._outlineColor)||((0,vec42.c)(this._outlineColor,e),this._updateMaterial())}get elevationInfo(){return this._elevationInfo}set elevationInfo(e){this._elevationInfo=e,this.recreateGeometry()}_updateMaterial(){this._material?.setParameters(this._materialParameters)}_updateSizeAttribute(){const e=this.object;if(null==e)return;const t=e.geometries[0];if(null==t)return;const i=t.getMutableAttribute(VertexAttribute.r.SIZE).data,r=this._geometrySize;i[0]=r,i[1]=r,e.geometryVertexAttributeUpdated(e.geometries[0],VertexAttribute.r.SIZE)}get _materialParameters(){return{color:this._color,textureIsSignedDistanceField:!0,sampleSignedDistanceFieldTexelCenter:(0,sdfPrimitives.ny)(this._primitive),distanceFieldBoundingBox:sdfPrimitives.PY,occlusionTest:!1,outlineColor:this._outlineColor,outlineSize:this._outlineSize,textureId:this._texture?.id,polygonOffset:!1,shaderPolygonOffset:0,drawAsLabel:!0,depthEnabled:!1,pixelSnappingEnabled:this.pixelSnappingEnabled,isDecoration:this.isDecoration}}get _geometrySize(){return this._size/sdfPrimitives.CN}createExternalResources(){this._texture=(0,sdfPrimitives.sZ)(this._primitive,this._preferredTextureSize),this._material=new HUDMaterial.R(this._materialParameters,this.view.state.viewingMode===ViewingMode.RT.Global);const e=this.view._stage;this._texture.load(e.renderView.renderingContext),e.add(this._texture)}destroyExternalResources(){this._texture&&(this.view._stage.remove(this._texture),this._texture.dispose(),this._texture=null),this._material=null}createGeometries(e){const t=this._createRenderGeometry();null!=t&&e.addGeometry(t)}forEachExternalMaterial(e){this._material&&e(this._material)}get _preferredTextureSize(){return(0,mathUtils.qE)(2*this._geometrySize,16,128)}calculateMapBounds(e){const t=this.object?.geometries[0];if(!t)return!1;const i=t.attributes.get(VertexAttribute.r.POSITION).data;return(0,projectVectorToVector.F)(i,this.view.renderCoordsHelper.spatialReference,PointVisualElement_b,this.view.spatialReference),(0,aaBoundingBox.Hq)(e,PointVisualElement_b),!0}_createRenderGeometry(){const{geometry:e,_material:i}=this;if(null==e||null==i)return null;const{renderCoordsHelper:r,elevationProvider:s}=this.view,o=(0,elevationAlignmentUtils.nG)(e,s,ElevationContext.F.fromElevationInfo(this.elevationInfo),r),a=(0,vec32.i)(vectorStacks.rq.get(),e.x,e.y,o),h=vectorStacks.rq.get();(0,projectVectorToVector.F)(a,e.spatialReference,h,r.spatialReference);const u=this._geometrySize;return(0,GeometryUtil.DJ)(i,{position:h,size:[u,u],centerOffsetAndDistance:[0,0,0,1]})}}const PointVisualElement_b=(0,vec3f64.vt)();var Attribute=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/lib/Attribute.js"),Geometry=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/lib/Geometry.js"),ColorMaterial=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/materials/ColorMaterial.js");class RightAngleQuadVisualElement_D extends EngineVisualElement_t{constructor(e){super(e),this._maxSize=0,this._position=(0,vec3f64.vt)(),this._up=(0,vec3f64.vt)(),this._right=(0,vec3f64.vt)(),this._renderOccluded=Material.m$.OccludeAndTransparent,this._color=(0,vec4f64.fA)(1,0,0,1),this._outlineColor=(0,vec4f64.fA)(0,0,0,1),this._outlineSize=0,this._size=32,this._outlineRenderOccluded=Material.m$.Opaque,this.applyProperties(e)}createObject3DResourceFactory(e){return{view:e,createResources:e=>this._createObject3DResources(e),destroyResources:()=>{},cameraChanged:()=>this._updateTransformObject3D()}}createDrapedResourceFactory(e){return{view:e,createResources:()=>this._createDrapedResources(),destroyResources:RightAngleQuadVisualElement_P}}get renderOccluded(){return this._renderOccluded}set renderOccluded(e){e!==this._renderOccluded&&(this._renderOccluded=e,this._updateQuadMaterial())}get color(){return this._color}set color(e){(0,vec42.c)(this._color,e),this._updateQuadMaterial()}get outlineColor(){return this._outlineColor}set outlineColor(e){(0,vec42.c)(this._outlineColor,e),this._updateOutlineMaterial()}get outlineSize(){return this._outlineSize}set outlineSize(e){const t=0===this._outlineSize!=(0===e);this._outlineSize=e,t?this.recreateGeometry():this._updateOutlineMaterial()}get size(){return this._size}set size(e){e!==this._size&&(this._size=e,this._updateTransform())}get outlineRenderOccluded(){return this._outlineRenderOccluded}set outlineRenderOccluded(e){this._outlineRenderOccluded=e,this._updateOutlineMaterial()}set geometry({previous:e,center:t,next:r}){this._maxSize=Math.min((0,vec32.j)(t,e),(0,vec32.j)(t,r))/3,(0,vec32.n)(this._up,(0,vec32.d)(this._up,e,t)),(0,vec32.n)(this._right,(0,vec32.d)(this._right,r,t)),(0,vec32.c)(this._position,t),this.recreateGeometry()}_createObject3DResources(e){const t=new ColorMaterial.v(this._quadMaterialParameters),r=0===this._outlineSize?void 0:new RibbonLineMaterial.W(this._outlineMaterialParameters);return this._createObject3DGeometries(e,t,r),{quadMaterial:t,outlineMaterial:r,forEach:e=>{e(t),r&&e(r)}}}_createObject3DGeometries(e,t,r){if((0,vec32.p)(this._up,vec3f64.uY)&&(0,vec32.p)(this._right,vec3f64.uY))return;const i=this._createGeometries(t,r);for(const s of i)e.addGeometry(s);this._updateTransformObject3D(e)}_createDrapedResources(){const t=new ColorMaterial.v(this._quadMaterialParameters),r=0===this._outlineSize?void 0:new RibbonLineMaterial.W(this._outlineMaterialParameters),i=this._createGeometries(t,r).map((e=>new RenderGeometry.$(e)));return this._setTransformDraped(i),{quadMaterial:t,outlineMaterial:r,geometries:i,pixelRatioHandle:(0,reactiveUtils.watch)((()=>this.view.state.contentPixelRatio),(()=>this.drapedResources.recreateGeometry()))}}_createGeometries(e,t){const{up:r,right:i,corner:s}=this._getVertices(),o=function RightAngleQuadVisualElement_v(e,t,r,i){return new Geometry.V(i,[[VertexAttribute.r.POSITION,new Attribute.n([0,0,0,...t,...e,...r],[0,1,2,1,2,3],3,!0)]])}(r,i,s,e);return t?[o,(0,GeometryUtil.Z8)(t,[r,s,i])]:[o]}_getVertices(){let e=this._up,t=this._right;const r=(0,vec32.g)(vectorStacks.rq.get(),e,t);return this.isDraped&&(e=(0,vec32.c)(vectorStacks.rq.get(),e),t=(0,vec32.c)(vectorStacks.rq.get(),t),e[2]=0,t[2]=0,r[2]=0),{up:e,right:t,corner:r}}_updateTransform(){this.isDraped?this.drapedResources.recreateGeometry():this._updateTransformObject3D()}_updateTransformObject3D(e=this.object3dResources.object){if(!e)return;const i=this.view.state.camera,s=this._size*i.computeScreenPixelSizeAt(this._position),o=Math.min(this._maxSize,s);(0,mat4.kN)(RightAngleQuadVisualElement_x,this._position),(0,mat4.hs)(RightAngleQuadVisualElement_x,RightAngleQuadVisualElement_x,[o,o,o]),e.transformation=RightAngleQuadVisualElement_x}_setTransformDraped(e){if(0===e.length)return;const{view:{basemapTerrain:{overlayManager:i},state:{contentPixelRatio:s}}}=this,{_position:o,_size:a}=this,c=(0,vec32.c)(vectorStacks.rq.get(),o);c[2]=OverlayRenderer.bi;const l=RightAngleQuadVisualElement_S;l.spatialReference=i.renderer.spatialReference,l.x=c[0],l.y=c[1];const u=a*(this.view.overlayPixelSizeInMapUnits(l)*s),d=Math.min(this._maxSize,u);(0,mat4.kN)(RightAngleQuadVisualElement_x,c),(0,mat4.hs)(RightAngleQuadVisualElement_x,RightAngleQuadVisualElement_x,[d,d,1]);for(const t of e)t.transformation=RightAngleQuadVisualElement_x}get _quadMaterialParameters(){return{color:this._color,forceTransparentMode:!0,writeDepth:!1,polygonOffset:!0,renderOccluded:this._renderOccluded,isDecoration:this.isDecoration}}_updateQuadMaterial(){this.object3dResources.resources?.quadMaterial.setParameters(this._quadMaterialParameters),this.drapedResources.resources?.quadMaterial.setParameters(this._quadMaterialParameters)}get _outlineMaterialParameters(){return{color:this._outlineColor,width:this._outlineSize,renderOccluded:this._outlineRenderOccluded,isDecoration:this.isDecoration}}_updateOutlineMaterial(){this.object3dResources.resources?.outlineMaterial?.setParameters(this._outlineMaterialParameters),this.drapedResources.resources?.outlineMaterial?.setParameters(this._outlineMaterialParameters)}}function RightAngleQuadVisualElement_P(e){e.pixelRatioHandle.remove(),e.geometries=[]}const RightAngleQuadVisualElement_x=(0,mat4f64.vt)(),RightAngleQuadVisualElement_S=(0,dehydratedPoint.T)(0,0,void 0,null);var normalizedPoint=__webpack_require__("./node_modules/@arcgis/core/views/interactive/sketch/normalizedPoint.js"),Settings=__webpack_require__("./node_modules/@arcgis/core/views/interactive/snapping/Settings.js"),SnappingDomain=__webpack_require__("./node_modules/@arcgis/core/views/interactive/snapping/SnappingDomain.js"),snappingUtils=__webpack_require__("./node_modules/@arcgis/core/views/interactive/snapping/snappingUtils.js"),SnappingVisualizer=__webpack_require__("./node_modules/@arcgis/core/views/interactive/snapping/SnappingVisualizer.js"),LineSnappingHint=__webpack_require__("./node_modules/@arcgis/core/views/interactive/snapping/hints/LineSnappingHint.js");class SnappingVisualizer3D_R extends SnappingVisualizer.b{sortUniqueHints(e){return e.sort(((e,i)=>(i instanceof LineSnappingHint.c?i.length:0)-(e instanceof LineSnappingHint.c?e.length:0)))}visualizeIntersectionPoint(e,i){const{spatialReference:t,view:r}=i,o=SnappingVisualizer3D_D(i);return(0,handleUtils.DQ)(new PointVisualElement_S({view:r,primitive:"circle",geometry:(0,normalizedPoint.io)(e.intersectionPoint,t),elevationInfo:e.isDraped?elevationInfoUtils.Tq:elevationInfoUtils.qt,size:20,outlineSize:2,color:o.intersectionPointColor,outlineColor:o.intersectionPointOutlineColor,pixelSnappingEnabled:!1,isDecoration:!0,attached:!0}))}visualizePoint(e,i){const{view:t,spatialReference:r}=i,o=SnappingVisualizer3D_D(i),a=SnappingVisualizer3D_x(e.point,e.domain,i);return(0,handleUtils.DQ)(new PointVisualElement_S({view:t,primitive:"circle",geometry:(0,normalizedPoint.io)(a,r),elevationInfo:SnappingVisualizer3D_A(e),size:20,outlineSize:2,color:o.pointColor,outlineColor:o.pointOutlineColor,pixelSnappingEnabled:!1,isDecoration:!0,attached:!0}))}visualizeLine(e,i){const{view:t,spatialReference:r}=i,o=SnappingVisualizer3D_D(i),a=SnappingVisualizer3D_x(e.lineStart,e.domain,i),l=SnappingVisualizer3D_x(e.lineEnd,e.domain,i);return(0,handleUtils.DQ)(function SnappingVisualizer3D_H(e,i,n,t,r,o,a,l=!1,s=!0,d=!0){const m=SnappingVisualizer3D_z(i,t,r,o,l),u=SnappingVisualizer3D_z(n,t,r,o,l),v=new ExtendedLineVisualElement_G({view:o,extensionType:ExtendedLineVisualElement_M.FADED,start:m,end:u,isDraped:l,color:a.lineColor,renderOccluded:l?Material.m$.OccludeAndTransparent:Material.m$.Opaque,renderGroup:interfaces.O7.SnappingHint,isDecoration:!0});switch(e){case snappingUtils.H3.TARGET:v.width=Settings.N.lineHintWidthTarget,v.fadedExtensions={start:0,end:Settings.N.lineHintFadedExtensions};break;case snappingUtils.H3.REFERENCE_EXTENSION:v.width=Settings.N.lineHintWidthReference,v.fadedExtensions={start:0,end:0};break;case snappingUtils.H3.REFERENCE:v.width=Settings.N.lineHintWidthReference,v.fadedExtensions={start:s?Settings.N.lineHintFadedExtensions:0,end:d?Settings.N.lineHintFadedExtensions:0}}return v.attached=!0,v}(e.type,a,l,r,SnappingVisualizer3D_A(e),t,o,e.isDraped,e.fadeLeft,e.fadeRight))}visualizeParallelSign(e,i){const{view:r,spatialReference:o}=i,a=SnappingVisualizer3D_D(i),{isDraped:l}=e,s=SnappingVisualizer3D_A(e),p=SnappingVisualizer3D_x(e.lineStart,e.domain,i),c=SnappingVisualizer3D_x(e.lineEnd,e.domain,i),m=SnappingVisualizer3D_z(p,o,s,r,l),u=SnappingVisualizer3D_z(c,o,s,r,l),v=(0,vec32.m)(u,m,u,.5),h=new ParallelLineVisualElement_v({view:r,attached:!1,offset:Settings.N.parallelLineHintOffset,length:Settings.N.parallelLineHintLength,width:Settings.N.parallelLineHintWidth,color:a.parallelSignColor,location:v,renderOccluded:l?Material.m$.OccludeAndTransparent:Material.m$.Opaque,isDraped:l,renderGroup:interfaces.O7.SnappingHint,isDecoration:!0});return h.setDirectionFromPoints(m,v),h.attached=!0,(0,handleUtils.DQ)(h)}visualizeRightAngleQuad(e,i){const{view:t,spatialReference:r}=i,o=SnappingVisualizer3D_D(i),a=SnappingVisualizer3D_A(e),{isDraped:l}=e,s=SnappingVisualizer3D_x(e.previousVertex,e.domain,i),p=SnappingVisualizer3D_x(e.centerVertex,e.domain,i),c=SnappingVisualizer3D_x(e.nextVertex,e.domain,i),d=SnappingVisualizer3D_z(s,r,a,t,l),m=SnappingVisualizer3D_z(p,r,a,t,l),v=SnappingVisualizer3D_z(c,r,a,t,l);return(0,handleUtils.DQ)(new RightAngleQuadVisualElement_D({view:t,attached:!0,color:l?o.rightAngleColorDraped:o.rightAngleColor,renderOccluded:l?Material.m$.OccludeAndTransparent:Material.m$.Transparent,outlineRenderOccluded:l?Material.m$.OccludeAndTransparent:Material.m$.Opaque,outlineColor:o.rightAngleOutlineColor,outlineSize:Settings.N.rightAngleHintOutlineSize,size:Settings.N.rightAngleHintSize,isDraped:l,geometry:{previous:d,center:m,next:v},renderGroup:interfaces.O7.SnappingHint,isDecoration:!0}))}}function SnappingVisualizer3D_D(n){const{effectiveTheme:t}=n.view,r=Color.A.toUnitRGBA(t.accentColor),o=[0,0,0,0];return{intersectionPointColor:o,intersectionPointOutlineColor:r,pointColor:o,pointOutlineColor:r,lineColor:r,lineOutlineColor:void 0,parallelSignColor:r,rightAngleColor:r,rightAngleColorDraped:Color.A.toUnitRGBA((0,colorUtils._L)(t.accentColor,.5)),rightAngleOutlineColor:r}}function SnappingVisualizer3D_x(e,i,{selfSnappingZ:n,view:t,spatialReference:r}){return i&SnappingDomain.n.SELF&&(0,normalizedPoint.Ex)(e)&&null!=n?(0,normalizedPoint.FH)(e,n,t,r):e}function SnappingVisualizer3D_A(e){return e.isDraped?elevationInfoUtils.Tq:elevationInfoUtils.qt}function SnappingVisualizer3D_z(e,i,n,t,a){const l=(0,vec3f64.vt)();if(a){const n=t.basemapTerrain.overlayManager.renderer.spatialReference;(0,projectVectorToVector.F)(e,i,l,n)}else(0,viewUtils.X)(e,i,n,t,l);return l}var sources_interfaces=__webpack_require__("./node_modules/@arcgis/core/layers/graphics/sources/interfaces.js");function meshFastUpdateUtils_a(a){const t=a.graphic;return t?[(0,reactiveUtils.watch)((()=>"visible"in a?a.visible:a.displaying),(s=>{s&&t.notifyMeshTransformChanged({action:sources_interfaces.$.EnableFastUpdates})}),{...reactiveUtils.pc}),(0,handleUtils.hA)((()=>t.notifyMeshTransformChanged({action:sources_interfaces.$.DisableFastUpdates})))]:[]}var lineStippleUtils=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/materials/lineStippleUtils.js");function settings_u(o,t){t&&Object.assign(o,t)}class settings_g{constructor(o){this.height=90,this.coneHeight=40,this.coneWidth=23,this.width=3,this.renderOccluded=Material.m$.Opaque,this.color=o.accent}}class settings_f{constructor({colors:o,...t}){this.size=11,this.outlineSize=1,this.collisionPadding=9,this.color=o.accent,this.outlineColor=o.outline,this.renderOccluded=Material.m$.Opaque,this.hoverOutlineColor=o.selectedOutline,settings_u(this,t)}applyColor(o){this._apply(this.color,o)}applyOutline(o){this._apply(this.outlineColor,o)}applyHoverOutline(o){this._apply(this.hoverOutlineColor,o)}_apply(o,t){t.setParameters({color:(0,colorUtils.QP)(o),renderOccluded:this.renderOccluded})}}class settings_w{constructor({colors:o,...t}){this.size=40,this.height=.2,this.offset=.25,this.collisionPadding=2,this.renderOccluded=Material.m$.Transparent,this.minSquaredEdgeLength=900,this.color=(0,colorUtils._L)(o.accent,.5),this.hoverColor=o.accent,settings_u(this,t)}applyColor(o){this._apply(this.color,o)}applyHover(o){this._apply(this.hoverColor,o)}_apply(o,t){t.setParameters({color:(0,colorUtils.QP)(o),renderOccluded:this.renderOccluded})}}class settings_C{constructor(o){this.vertex=new settings_f({colors:o,color:o.accent,outlineColor:o.outline}),this.edge=new settings_f({colors:o,color:(0,colorUtils.Vl)((0,colorUtils._L)(o.accent,2/3),.5),outlineColor:(0,colorUtils._L)(o.outline,.5),size:8,collisionPadding:8}),this.selected=new settings_f({colors:o,color:o.selected,outlineColor:o.outline}),this.edgeOffset=new settings_w({colors:o})}}class settings_m{constructor({colors:o,...t}){this.width=1.5,this.stipplePattern=(0,lineStippleUtils.wk)(3.3),this.falloff=0,this.innerWidth=1.5,this.renderOccluded=Material.m$.OccludeAndTransparent,this.color=o.selected,this.stippleOffColor=o.outline,this.innerColor=o.selected,settings_u(this,t)}apply(o){o.color=(0,colorUtils.QP)(this.color),o.width=this.width,o.stipplePattern=this.stipplePattern,o.stippleOffColor=(0,colorUtils.QP)(this.stippleOffColor),o.falloff=this.falloff,o.innerWidth=this.innerWidth,o.innerColor=(0,colorUtils.QP)(this.innerColor),o.renderOccluded=this.renderOccluded}}class settings_O{constructor({colors:o,...t}){this.size=4,this.outlineSize=1,this.shape="square",this.color=o.selected,this.outlineColor=o.outline,settings_u(this,t)}apply(o){o.color=(0,colorUtils.QP)(this.color),o.size=this.size,o.outlineSize=this.outlineSize,o.outlineColor=(0,colorUtils.QP)(this.outlineColor),o.primitive=this.shape}}class y{constructor({colors:o,...t}){this.innerWidth=1,this.glowWidth=8,this.glowFalloff=8,this.globalAlpha=.3,this.globalAlphaContrastBoost=1.5,this.radius=3,this.innerColor=o.selected,this.glowColor=o.accent,this.heightFillColor=o.accent,settings_u(this,t)}apply(o,e=1){const l={glowColor:Color.A.toUnitRGB(this.glowColor),glowFalloff:this.glowFalloff,glowWidth:this.glowWidth,innerColor:Color.A.toUnitRGB(this.innerColor),innerWidth:this.innerWidth,globalAlpha:this.globalAlpha*e*this.glowColor.a,globalAlphaContrastBoost:this.globalAlphaContrastBoost,intersectsLineRadius:this.radius};"style"in o?o.style=l:o.laserlineStyle=l}}class settings_A{constructor(o){this.outline=new settings_m({colors:o,color:o.stippleOff,renderOccluded:Material.m$.OccludeAndTransparentStencil,stippleOffColor:o.stippleOn,innerWidth:0}),this.staged=new settings_m({colors:o,color:o.stippleOn,renderOccluded:Material.m$.OccludeAndTransparentStencil,innerColor:o.stagedSolid,stippleOffColor:o.stippleOff}),this.shadowStyle=new y({colors:o,globalAlpha:.3,glowColor:o.accent,glowFalloff:8,glowWidth:8,innerColor:o.selected,innerWidth:1})}}class settings_W{constructor(o){this.outline=new settings_O({colors:o,color:o.selected,outlineColor:o.outline,outlineSize:1,shape:"circle",size:4}),this.shadowStyle=new y({colors:o,globalAlpha:.3,glowColor:o.accent,glowFalloff:1.5,glowWidth:6,innerColor:o.selected,innerWidth:1,radius:2})}}class settings_b extends settings_m{constructor({colors:o,...t}){super({colors:o}),this.extensionType=ExtendedLineVisualElement_M.GROUND_RAY,settings_u(this,t)}}class settings_S{constructor(o){this.laserlineAlphaMultiplier=1.5,this.heightPlaneAngleCutoff=20,this.lineObjects=new settings_A(o),this.pointObjects=new settings_W(o),this.heightPlane=new y({colors:o,globalAlpha:.3,glowColor:o.accent,glowFalloff:8,glowWidth:8,innerColor:o.selected,innerWidth:1}),this.heightBox=new y({colors:o,globalAlpha:.3,glowColor:o.accent,glowFalloff:8,glowWidth:8,innerColor:o.selected,innerWidth:0,heightFillColor:o.accent}),this.zVerticalLine=new settings_b({colors:o,color:(0,colorUtils._L)(o.accent,.5),falloff:2,innerColor:(0,colorUtils._L)(o.selected,0),renderOccluded:Material.m$.OccludeAndTransparent,stipplePattern:null,width:5,extensionType:ExtendedLineVisualElement_M.GROUND_RAY})}}let settings_j=class extends Accessor.A{constructor(o){super(o)}get colors(){const o=this.getTheme().accentColor,e=o.a;return{accent:o,contrast:(0,colorUtils.bJ)(o),selected:Color.A.fromArray([255,255,255,e]),selectedOutline:Color.A.fromArray([255,255,255,e]),staged:Color.A.fromArray([12,207,255,e]),stagedSolid:Color.A.fromArray([12,207,255,1]),outline:Color.A.fromArray([0,0,0,.5*e]),stippleOn:Color.A.fromArray([255,255,255,1]),stippleOff:Color.A.fromArray([0,0,0,.5])}}get visualElements(){return new settings_S(this.colors)}get manipulators(){return new settings_C(this.colors)}get zManipulator(){return new settings_g(this.colors)}};(0,tslib_es6._)([(0,property.MZ)()],settings_j.prototype,"colors",null),(0,tslib_es6._)([(0,property.MZ)()],settings_j.prototype,"visualElements",null),(0,tslib_es6._)([(0,property.MZ)()],settings_j.prototype,"manipulators",null),(0,tslib_es6._)([(0,property.MZ)()],settings_j.prototype,"zManipulator",null),(0,tslib_es6._)([(0,property.MZ)()],settings_j.prototype,"getTheme",void 0),settings_j=(0,tslib_es6._)([(0,subclass.$)("esri.views.3d.interactive.editingTools.settings")],settings_j);var Evented=__webpack_require__("./node_modules/@arcgis/core/core/Evented.js"),projectBuffer=__webpack_require__("./node_modules/@arcgis/core/geometry/projection/projectBuffer.js"),line=__webpack_require__("./node_modules/@arcgis/core/views/3d/support/engineContent/line.js"),renderInfoUtils_line=__webpack_require__("./node_modules/@arcgis/core/views/3d/support/renderInfoUtils/line.js");class OutlineVisualElement_j extends EngineVisualElement_t{constructor(t){super(t),this._attachmentOrigin=(0,dehydratedPoint.T)(0,0,0,null),this._attachmentOriginDirty=!0,this.events=new Evented.A,this._geometry=null,this._width=1,this._color=(0,vec4f64.fA)(1,0,1,1),this._innerWidth=0,this._innerColor=(0,vec4f64.fA)(1,1,1,1),this._stipplePattern=null,this._stippleOffColor=null,this._falloff=0,this._elevationInfo=null,this._laserlineStyle=null,this._laserlineEnabled=!1,this._renderOccluded=Material.m$.OccludeAndTransparentStencil,this._attachmentOrigin.spatialReference=t.view.spatialReference,this._laserline=new LaserlineVisualElement_c({view:t.view,isDecoration:t.isDecoration}),this.applyProperties(t),this.attached=t.attached??!0}destroy(){this._laserline.destroy(),super.destroy()}createObject3DResourceFactory(e){return{view:e,createResources:e=>this._createObject3DResources(e),destroyResources:OutlineVisualElement_D,recreateGeometry:(e,t)=>{e.geometries.length=0,this._recreateGeometry(t,e.material,e.geometries)}}}createDrapedResourceFactory(e){return{view:e,createResources:()=>this._createDrapedResources(),destroyResources:OutlineVisualElement_D,recreateGeometry:e=>{e.geometries=this._createRenderGeometriesDraped(e.material),this._attachmentOriginChanged()}}}get _laserlineAttached(){return this.attached&&this.visible&&null!=this._laserlineStyle&&!this.isDraped&&this.laserlineEnabled}onAttachedChange(e){this._laserline.attached=this._laserlineAttached,e&&this._attachmentOriginChanged()}get geometry(){return this._geometry}set geometry(e){this._geometry=e,this.recreateGeometry()}get width(){return this._width}set width(e){e!==this._width&&(this._width=e,this._updateMaterial())}get color(){return this._color}set color(e){(0,vec42.a)(e,this._color)||((0,vec42.c)(this._color,e),this._updateMaterial())}get innerWidth(){return this._innerWidth}set innerWidth(e){e!==this._innerWidth&&(this._innerWidth=e,this._updateMaterial())}get innerColor(){return this._innerColor}set innerColor(e){(0,vec42.a)(e,this._innerColor)||((0,vec42.c)(this._innerColor,e),this._updateMaterial())}get stipplePattern(){return this._stipplePattern}set stipplePattern(e){const t=null!=e!=(null!=this._stipplePattern);this._stipplePattern=e,t?this.recreate():this._updateMaterial()}get stippleOffColor(){return this._stippleOffColor}set stippleOffColor(e){e&&this._stippleOffColor&&(0,vec42.a)(e,this._stippleOffColor)||(this._stippleOffColor=e?(0,vec4f64.o8)(e):null,this._updateMaterial())}get falloff(){return this._falloff}set falloff(e){e!==this._falloff&&(this._falloff=e,this._updateMaterial())}get elevationInfo(){return this._elevationInfo}set elevationInfo(e){this._elevationInfo=e,this.recreateGeometry()}get laserlineStyle(){return this._laserlineStyle}set laserlineStyle(e){this._laserlineStyle=e,this._laserline.attached=this._laserlineAttached,null!=e&&(this._laserline.style=e)}get laserlineEnabled(){return this._laserlineEnabled}set laserlineEnabled(e){this._laserlineEnabled!==e&&(this._laserlineEnabled=e,this._laserline.attached=this._laserlineAttached)}get renderOccluded(){return this._renderOccluded}set renderOccluded(e){e!==this._renderOccluded&&(this._renderOccluded=e,this._updateMaterial())}get attachmentOrigin(){if(!this._attachmentOriginDirty)return this._attachmentOrigin;const e=this.object3dResources.resources?.geometries;if(!e||0===e.length)return null;(0,vec32.i)(OutlineVisualElement_E,0,0,0);let s=0;for(const t of e)t.computeAttachmentOrigin(OutlineVisualElement_P)&&((0,vec32.g)(OutlineVisualElement_E,OutlineVisualElement_E,OutlineVisualElement_P),s++);return 0===s?null:((0,vec32.h)(OutlineVisualElement_E,OutlineVisualElement_E,1/s),this.view.renderCoordsHelper.fromRenderCoords(OutlineVisualElement_E,this._attachmentOrigin),this._attachmentOriginDirty=!1,this._attachmentOrigin)}_updateMaterial(){this.object3dResources.resources?.material.setParameters(this._materialParameters),this.drapedResources.resources?.material.setParameters(this._materialParameters)}get _isClosed(){return null!=this.geometry&&"polygon"===this.geometry.type}get _materialParameters(){return{width:this._width,color:this._color,stippleOffColor:this._stippleOffColor,stipplePattern:this._stipplePattern,stipplePreferContinuous:!1,isClosed:this._isClosed,falloff:this._falloff,innerColor:this._innerColor,innerWidth:this._innerWidth,join:"round",hasPolygonOffset:!0,renderOccluded:this._normalizedRenderOccluded,isDecoration:this.isDecoration}}get _normalizedRenderOccluded(){return this.isDraped&&this._renderOccluded===Material.m$.OccludeAndTransparentStencil?Material.m$.OccludeAndTransparent:this._renderOccluded}_recreateGeometry(e,t,r){this._createRenderGeometries(t,r);for(const i of r)e.addGeometry(i);this._attachmentOriginChanged()}_attachmentOriginChanged(){this._attachmentOriginDirty=!0,this.events.emit("attachment-origin-changed")}_createObject3DResources(e){const t=new RibbonLineMaterial.W(this._materialParameters),r=new Array;return this._recreateGeometry(e,t,r),{material:t,geometries:r,forEach:e=>{e(t),r.forEach(e)}}}_createDrapedResources(){const e=new RibbonLineMaterial.W(this._materialParameters);return{material:e,geometries:this._createRenderGeometriesDraped(e)}}_createRenderGeometriesDraped(e){const{geometry:t,view:r}=this,i=r.basemapTerrain.spatialReference;return null==t||null==i?[]:(0,renderInfoUtils_line.A)(t,i).lines.map((({position:t})=>{const s={overlayInfo:{spatialReference:i,renderCoordsHelper:r.renderCoordsHelper},attributeData:{position:t},removeDuplicateStartEnd:this._isClosed};return new RenderGeometry.$((0,line.t)(e,s))}))}calculateMapBounds(e){if(null==this.object3dResources.resources)return!1;const t=this.view.renderCoordsHelper;for(const r of this.object3dResources.resources.geometries){const i=r.attributes.get(VertexAttribute.r.POSITION),s=(0,DoubleArray.jh)(i.data.length);(0,projectBuffer.projectBuffer)(i.data,t.spatialReference,0,s,this.view.spatialReference,0),(0,aaBoundingBox.Hq)(e,s)}return!0}_createRenderGeometries(e,t){const r=this.geometry;if(null==r)return;const i=(0,renderInfoUtils_line.C)(r,this.view.elevationProvider,this.view.renderCoordsHelper,ElevationContext.F.fromElevationInfo(this.elevationInfo??new ElevationInfo.A({mode:(0,elevationInfoUtils.w7)(r,null)}))),s=new Array;for(const{position:n,mapPositions:o}of i.lines){const r={mapPositions:o,attributeData:{position:n},removeDuplicateStartEnd:this._isClosed};t.push((0,line.t)(e,r)),s.push(n)}this._laserline.pathVerticalPlane=s}}function OutlineVisualElement_D(e){e.geometries=[]}const OutlineVisualElement_P=(0,vec3f64.vt)(),OutlineVisualElement_E=(0,vec3f64.vt)();var BufferView=__webpack_require__("./node_modules/@arcgis/core/geometry/support/buffer/BufferView.js"),ShaderOutput=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/ShaderOutput.js"),GLMaterial=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/lib/GLMaterial.js"),RayIntersections=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/lib/RayIntersections.js"),RenderSlot=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/lib/RenderSlot.js"),Util=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/lib/Util.js"),bufferWriterUtils=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/materials/internal/bufferWriterUtils.js"),OITPass=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/lib/OITPass.js"),OrderIndependentTransparency=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/lib/OrderIndependentTransparency.js"),ShadedColorMaterial_glsl=__webpack_require__("./node_modules/@arcgis/core/chunks/ShadedColorMaterial.glsl.js");class ShadedColorMaterialTechnique_h extends ShaderTechnique.w{constructor(e,t){super(e,t,new ReloadableShaderModule.$(ShadedColorMaterial_glsl.S,(()=>__webpack_require__.e(8226).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@arcgis/core/views/3d/webgl-engine/shaders/ShadedColorMaterial.glsl.js")))),ShadedColorMaterialTechnique_f)}initializePipeline(r){const{oitPass:t,output:l,transparent:d,cullFace:h,shadingEnabled:f}=r,S=t===OITPass.Y.NONE,b=t===OITPass.Y.FrontFace;return(0,renderState.Ey)({blending:(0,ShaderOutput.RN)(l)&&d?(0,OrderIndependentTransparency.Yf)(t):null,culling:(0,renderState.Xt)(h),depthTest:{func:b?enums.MT.LESS:f?enums.MT.LEQUAL:enums.MT.LESS},depthWrite:(0,OrderIndependentTransparency.z5)(r),drawBuffers:(0,OrderIndependentTransparency.m6)(t,l),colorWrite:renderState.kn,polygonOffset:S||b?null:OrderIndependentTransparency.SE})}}const ShadedColorMaterialTechnique_f=new Map([[VertexAttribute.r.POSITION,0],[VertexAttribute.r.NORMAL,1],[VertexAttribute.r.OFFSET,2]]);var TextureCoordinateAttribute_glsl=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/attributes/TextureCoordinateAttribute.glsl.js"),Emissions_glsl=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/output/Emissions.glsl.js"),DefaultTechniqueConfiguration=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/materials/DefaultTechniqueConfiguration.js");class ShadedColorMaterialTechniqueConfiguration_n extends DefaultTechniqueConfiguration.E{constructor(){super(...arguments),this.cullFace=basicInterfaces.s2.None,this.transparent=!1,this.writeDepth=!0,this.screenSizeEnabled=!0,this.shadingEnabled=!0,this.terrainDepthTest=!1,this.cullAboveTerrain=!1,this.textureCoordinateType=TextureCoordinateAttribute_glsl.I.None,this.emissionSource=Emissions_glsl.ZX.None,this.occlusionPass=!1,this.objectAndLayerIdColorInstanced=!1}get discardInvisibleFragments(){return this.transparent}}(0,tslib_es6._)([(0,ShaderTechniqueConfiguration.W)({count:basicInterfaces.s2.COUNT})],ShadedColorMaterialTechniqueConfiguration_n.prototype,"cullFace",void 0),(0,tslib_es6._)([(0,ShaderTechniqueConfiguration.W)()],ShadedColorMaterialTechniqueConfiguration_n.prototype,"transparent",void 0),(0,tslib_es6._)([(0,ShaderTechniqueConfiguration.W)()],ShadedColorMaterialTechniqueConfiguration_n.prototype,"writeDepth",void 0),(0,tslib_es6._)([(0,ShaderTechniqueConfiguration.W)()],ShadedColorMaterialTechniqueConfiguration_n.prototype,"screenSizeEnabled",void 0),(0,tslib_es6._)([(0,ShaderTechniqueConfiguration.W)()],ShadedColorMaterialTechniqueConfiguration_n.prototype,"shadingEnabled",void 0),(0,tslib_es6._)([(0,ShaderTechniqueConfiguration.W)()],ShadedColorMaterialTechniqueConfiguration_n.prototype,"terrainDepthTest",void 0),(0,tslib_es6._)([(0,ShaderTechniqueConfiguration.W)()],ShadedColorMaterialTechniqueConfiguration_n.prototype,"cullAboveTerrain",void 0);var AlphaCutoff=__webpack_require__("./node_modules/@arcgis/core/webscene/support/AlphaCutoff.js");class ShadedColorMaterial_x extends Material.im{constructor(e){super(e,ShadedColorMaterial_O),this._configuration=new ShadedColorMaterialTechniqueConfiguration_n,this.vertexAttributeLocations=ShadedColorMaterialTechnique_f,this.supportsEdges=!0,this.produces=new Map([[RenderSlot.N.OPAQUE_MATERIAL,e=>e===ShaderOutput.V.Highlight||(0,ShaderOutput.zW)(e)&&!this.parameters.transparent],[RenderSlot.N.TRANSPARENT_MATERIAL,e=>(0,ShaderOutput.zW)(e)&&this.parameters.transparent&&this.parameters.writeDepth],[RenderSlot.N.TRANSPARENT_MATERIAL_WITHOUT_DEPTH,e=>(0,ShaderOutput.zW)(e)&&this.parameters.transparent&&!this.parameters.writeDepth]])}getConfiguration(e,t){return this._configuration.output=e,this._configuration.cullFace=this.parameters.cullFace,this._configuration.hasSlicePlane=this.parameters.hasSlicePlane,this._configuration.transparent=this.parameters.transparent,this._configuration.writeDepth=this.parameters.writeDepth,this._configuration.screenSizeEnabled=this.parameters.screenSizeEnabled,this._configuration.shadingEnabled=this.parameters.shadingEnabled,this._configuration.oitPass=t.oitPass,this._configuration.terrainDepthTest=t.terrainDepthTest&&(0,ShaderOutput.RN)(e),this._configuration.cullAboveTerrain=t.cullAboveTerrain,this._configuration}get visible(){return this.parameters.color[3]>=AlphaCutoff.Q}intersect(e,s,a,c,h,l){if(this.parameters.screenSizeEnabled){const s=e.attributes.get(VertexAttribute.r.OFFSET),p={applyToVertex:(e,o,n,c)=>{const h=(0,vec32.i)(ShadedColorMaterial_P,s.data[3*c],s.data[3*c+1],s.data[3*c+2]),l=(0,vec32.i)(ShadedColorMaterial_I,e,o,n);return(0,vec32.h)(h,h,this.parameters.screenSizeScale*a.camera.computeScreenPixelSizeAt(h)),(0,vec32.g)(l,l,h),[l[0],l[1],l[2]]},applyToAabb:e=>{const t=(0,aaBoundingBox.gX)(e,ShadedColorMaterial_P);return(0,aaBoundingBox.hs)(e,this.parameters.screenSizeScale*a.camera.computeScreenPixelSizeAt(t))}};(0,RayIntersections.Uy)(e,a,c,h,p,l)}else(0,RayIntersections.Uy)(e,a,c,h,void 0,l)}createGLMaterial(e){return new ShadedColorMaterial_z(e)}createBufferWriter(){return new ShadedColorMaterial_M(this.parameters.screenSizeEnabled)}}class ShadedColorMaterial_z extends GLMaterial.A{beginSlot(e){return this.getTechnique(ShadedColorMaterialTechnique_h,e)}}class ShadedColorMaterial_O extends Material.qA{constructor(){super(...arguments),this.color=(0,vec4f64.fA)(1,1,1,1),this.shadingTint=(0,vec4f64.fA)(0,0,0,.25),this.shadingDirection=(0,vec32.n)((0,vec3f64.vt)(),[.5,-.5,-.5]),this.screenSizeScale=14,this.forceTransparentMode=!1,this.writeDepth=!0,this.hasSlicePlane=!1,this.cullFace=basicInterfaces.s2.None,this.screenSizeEnabled=!1,this.shadingEnabled=!0}get transparent(){return this.color[3]<1||this.forceTransparentMode}}class ShadedColorMaterial_M{constructor(e){this.screenSizeEnabled=e;const t=(0,InterleavedLayout.BP)().vec3f(VertexAttribute.r.POSITION).vec3f(VertexAttribute.r.NORMAL);this.screenSizeEnabled&&t.vec3f(VertexAttribute.r.OFFSET),this.vertexBufferLayout=t}elementCount(e){return e.get(VertexAttribute.r.POSITION).indices.length}write(e,t,r,i,s,a){if((0,bufferWriterUtils.SA)(r,i,this.vertexBufferLayout,e,t,s,a),this.screenSizeEnabled){if(!r.has(VertexAttribute.r.OFFSET))throw new Error(`${VertexAttribute.r.OFFSET} vertex attribute required for screenSizeEnabled ShadedColorMaterial`);{const e=r.get(VertexAttribute.r.OFFSET);(0,Util.vA)(3===e.size);const i=s.getField(VertexAttribute.r.OFFSET,BufferView.xs);if(!i)throw new Error("unable to acquire view for "+VertexAttribute.r.OFFSET);(0,bufferWriterUtils.Hk)(e,t,i,a)}}}}const ShadedColorMaterial_P=(0,vec3f64.vt)(),ShadedColorMaterial_I=(0,vec3f64.vt)();class VerticesVisualElement_d extends Object3DVisualElement_a{constructor(e){super(e),this.view=null,this._renderOccluded=Material.m$.OccludeAndTransparent,this._vertices=null,this._spatialReference=null,this._color=(0,vec4f64.ci)([1,127/255,0,1]),this._size=11,this._outlineColor=(0,vec4f64.ci)([0,0,0,.5]),this._outlineSize=1,this._elevationInfo=null,this.applyProperties(e)}get renderOccluded(){return this._renderOccluded}set renderOccluded(e){e!==this._renderOccluded&&(this._renderOccluded=e,this._updateMaterial(),this._updateOutlineMaterial())}get vertices(){return this._vertices}set vertices(e){this._vertices=e,this.recreateGeometry()}get spatialReference(){return this._spatialReference}set spatialReference(e){this._spatialReference=e,this.recreateGeometry()}get color(){return this._color}set color(e){(0,vec42.a)(e,this._color)||((0,vec42.c)(this._color,e),this._updateMaterial())}get size(){return this._size}set size(e){e!==this._size&&(this._size=e,this._updateMaterial())}get outlineColor(){return this._outlineColor}set outlineColor(e){(0,vec42.a)(e,this._outlineColor)||((0,vec42.c)(this._outlineColor,e),this._updateOutlineMaterial())}get outlineSize(){return this._outlineSize}set outlineSize(e){e!==this._outlineSize&&(this._outlineSize=e,this._updateOutlineMaterial())}get elevationInfo(){return this._elevationInfo}set elevationInfo(e){this._elevationInfo=e,this.recreateGeometry()}get _vertexMaterialParameters(){return{color:this._color,screenSizeScale:this.size,renderOccluded:this._renderOccluded,isDecoration:this.isDecoration}}get _vertexOutlineMaterialParameters(){return{color:this._outlineColor,screenSizeScale:this.size+2*this.outlineSize,renderOccluded:this._renderOccluded,isDecoration:this.isDecoration}}_updateMaterial(){this.attached&&this._vertexMaterial.setParameters(this._vertexMaterialParameters)}_updateOutlineMaterial(){this.attached&&this._vertexOutlineMaterial.setParameters(this._vertexOutlineMaterialParameters)}_createRenderGeometries(){const t=this.vertices;if(null==t||0===t.length)return[];const s=function point_o(o,n,r,s,i){const l=(0,DoubleArray.jh)(3*o.length),p=(0,DoubleArray.jh)(l.length);o.forEach(((t,e)=>{l[3*e]=t[0],l[3*e+1]=t[1],l[3*e+2]=t.length>2?t[2]:0}));const c=(0,elevationAlignmentUtils.au)(l,n,0,p,0,l,0,l.length/3,r,s,i),m=null!=c;return{numVertices:o.length,position:l,mapPositions:p,projectionSuccess:m,sampledElevation:c}}(t,this.spatialReference,this.view.elevationProvider,this.view.renderCoordsHelper,ElevationContext.F.fromElevationInfo(this.elevationInfo)),a=[],n=s.numVertices,c=s.position;for(let l=0;l<n;++l){const t=(0,vec32.i)(VerticesVisualElement_,c[3*l],c[3*l+1],c[3*l+2]),s=VerticesVisualElement_m(this._vertexMaterial,.5,t),o=VerticesVisualElement_m(this._vertexOutlineMaterial,.5,t);a.push({vertexGeometry:s,vertexOutlineGeometry:o})}return a}createGeometries(e){const t=this._createRenderGeometries();for(const{vertexGeometry:r,vertexOutlineGeometry:i}of t)e.addGeometry(r),e.addGeometry(i)}createExternalResources(){this._vertexMaterial=new ShadedColorMaterial_x({...this._vertexMaterialParameters,writeDepth:!0,cullFace:basicInterfaces.s2.Back,screenSizeEnabled:!0}),this._vertexOutlineMaterial=new ShadedColorMaterial_x({...this._vertexOutlineMaterialParameters,forceTransparentMode:!0,writeDepth:!0,cullFace:basicInterfaces.s2.Front,screenSizeEnabled:!0,shadingEnabled:!1})}destroyExternalResources(){this._vertexMaterial=null,this._vertexOutlineMaterial=null}forEachExternalMaterial(e){e(this._vertexMaterial),e(this._vertexOutlineMaterial)}}const VerticesVisualElement_=(0,vec3f64.vt)();function VerticesVisualElement_m(e,t,r){return(0,GeometryUtil.CM)(e,t,16,16,{offset:r})}let GraphicState_e=class extends Evented.A.EventedAccessor{constructor(r){super(r),this.tracking=!1,this.displaying=!1,this.error=null,this.isDraped=!1}};(0,tslib_es6._)([(0,property.MZ)({constructOnly:!0})],GraphicState_e.prototype,"graphic",void 0),(0,tslib_es6._)([(0,property.MZ)()],GraphicState_e.prototype,"tracking",void 0),(0,tslib_es6._)([(0,property.MZ)()],GraphicState_e.prototype,"displaying",void 0),(0,tslib_es6._)([(0,property.MZ)()],GraphicState_e.prototype,"error",void 0),(0,tslib_es6._)([(0,property.MZ)()],GraphicState_e.prototype,"isDraped",void 0),GraphicState_e=(0,tslib_es6._)([(0,subclass.$)("esri.views.3d.layers.graphics.GraphicState")],GraphicState_e);var DrawGraphicTool=__webpack_require__("./node_modules/@arcgis/core/views/draw/DrawGraphicTool.js"),DrawOperation=__webpack_require__("./node_modules/@arcgis/core/views/draw/DrawOperation.js"),drawSurfaces=__webpack_require__("./node_modules/@arcgis/core/views/draw/drawSurfaces.js"),tooltipCommonUtils=__webpack_require__("./node_modules/@arcgis/core/views/interactive/tooltip/tooltipCommonUtils.js"),trackingUtils=__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/trackingUtils.js");let DrawGraphicTool3D_z=class extends DrawGraphicTool.N{constructor(e){super(e),this._activeVertexVisualElement=null,this._createGraphicState=null,this._outlineVisualElement=null,this._verticesVisualElement=null,this._verticalLineVisualElement=null,this._settings=new settings_j({getTheme:()=>this.view.effectiveTheme}),this.geometryType=null,this.type="draw-3d"}initialize(){const{mode:e,offset:t,unit:i}=this.elevationInfo;this.internalGraphicsLayer.elevationInfo=new ElevationInfo.A({mode:e,offset:t,unit:i})}normalizeCtorArgs(e){if(!e.elevationInfo){const t=e.hasZ??!0;return{...e,elevationInfo:(0,elevationInfoUtils.bK)(t)}}return e}initializeGraphic(e){const{view:t}=this,r=this._createGraphicState=new GraphicState_e({graphic:e});return(0,handleUtils.vE)([t.maskOccludee(e),t.trackGraphicState(r),(0,reactiveUtils.watch)((()=>({element:this._outlineVisualElement,isDraped:r.isDraped})),(({element:e,isDraped:t})=>{e&&(e.isDraped=t)}),reactiveUtils.pc),(0,trackingUtils.fm)((()=>{(0,tooltipCommonUtils.IA)(this.tooltipInfos.mesh,this.geometryToPlace)})),this._setupLoadingIndicator(r),...meshFastUpdateUtils_a(r)])}makeDrawOperation(){const{geometryType:e}=this,t="circle"!==e&&"rectangle"!==e;return new DrawOperation.O0({view:this.view,manipulators:this.manipulators,geometryType:(0,DrawGraphicTool.l)(e),drawingMode:this.mode,hasZ:this.hasZ,defaultZ:this.defaultZ,snapToSceneEnabled:this.snapToScene,drawSurface:new drawSurfaces.IX(this.view,this.elevationInfo,[this.internalGraphicsLayer]),elevationDrawSurface:new drawSurfaces.rT(this.elevationInfo,this.defaultZ,this.view,this.internalGraphicsLayer),hasM:!1,elevationInfo:this.elevationInfo,snappingManager:this.snappingManager,snappingVisualizer:new SnappingVisualizer3D_R,segmentLabels:t?new SegmentLabels3D_a:null,labelOptions:this.sketchOptions.labels,isDraped:this._createGraphicState?this._createGraphicState.isDraped:"on-the-ground"===(0,elevationInfoUtils.wF)(this.hasZ,this.elevationInfo),cursor:this.cursor,constraintsEnabled:!0})}onActiveVertexChanged(e){const{view:n}=this;if(this._activeVertexVisualElement)return this._activeVertexVisualElement.vertices=[e],this._activeVertexVisualElement.recreate(),this._updateVerticalLineVisualElement(e),(0,handleUtils.hA)();const a=this._settings,c=a.manipulators.vertex,m=new VerticesVisualElement_d({view:n,spatialReference:n.spatialReference,vertices:[e],elevationInfo:this.internalGraphicsLayer.elevationInfo,size:c.size,outlineSize:c.outlineSize,renderOccluded:c.renderOccluded,attached:!1,isDecoration:!0});this._activeVertexVisualElement=m;const p=a.visualElements.zVerticalLine,h=new ExtendedLineVisualElement_G({view:n,extensionType:p.extensionType,innerWidth:1,attached:!1,writeDepthEnabled:!1,renderOccluded:Material.m$.OccludeAndTransparent,isDecoration:!0});this._verticalLineVisualElement=h;const u=(0,handleUtils.vE)([(0,reactiveUtils.watch)((()=>a.visualElements.zVerticalLine),(e=>e.apply(h)),reactiveUtils.Vh),(0,reactiveUtils.watch)((()=>({selectedColor:(0,colorUtils.QP)(a.colors.selected),outlineColor:(0,colorUtils.QP)(a.manipulators.vertex.outlineColor)})),(({selectedColor:e,outlineColor:t})=>{m.color=e,m.outlineColor=t}),reactiveUtils.Vh),(0,handleUtils.hA)((()=>{this._activeVertexVisualElement=(0,maybe.pR)(this._activeVertexVisualElement),this._verticalLineVisualElement=(0,maybe.pR)(this._verticalLineVisualElement)}))]);return m.attached=!0,this._updateVerticalLineVisualElement(e),u}_updateVerticalLineVisualElement(e){const t=this._verticalLineVisualElement;if(!t)return;const{renderCoordsHelper:i,elevationProvider:r}=this.view;(0,vec32.i)(DrawGraphicTool3D_A,e[0],e[1],e[2]),DrawGraphicTool3D_U.setFromElevationInfo(this.elevationInfo),DrawGraphicTool3D_A[2]=(0,elevationAlignmentUtils.nG)(DrawGraphicTool3D_A,r,DrawGraphicTool3D_U,i),i.toRenderCoords(DrawGraphicTool3D_A,this.view.spatialReference,DrawGraphicTool3D_A)?(t.setStartEndFromWorldDownAtLocation(DrawGraphicTool3D_A),t.attached=!0):t.attached=!1}onOutlineChanged(e){if(this._outlineVisualElement)return this._outlineVisualElement.geometry=e,(0,handleUtils.hA)();const t=this.internalGraphicsLayer.elevationInfo,{view:n}=this,a=this._settings,c=new OutlineVisualElement_j({view:n,geometry:e,elevationInfo:t,isDraped:this._createGraphicState?this._createGraphicState.isDraped:"on-the-ground"===(0,elevationInfoUtils.wF)(this.hasZ,t),attached:!1,isDecoration:!0});this._outlineVisualElement=c;const m=(0,handleUtils.vE)([(0,reactiveUtils.watch)((()=>a.visualElements.lineObjects.outline),(e=>e.apply(c)),reactiveUtils.Vh),(0,reactiveUtils.watch)((()=>a.visualElements.lineObjects.shadowStyle),(e=>e.apply(c)),reactiveUtils.Vh),(0,handleUtils.hA)((()=>{this._outlineVisualElement=(0,maybe.pR)(this._outlineVisualElement)}))]);return c.attached=!0,c.laserlineEnabled=!0,m}onRegularVerticesChanged(e){if(this._verticesVisualElement)return this._verticesVisualElement.vertices=e,(0,handleUtils.hA)();const{view:n}=this,a=this._settings,c=a.manipulators.vertex,m=new VerticesVisualElement_d({view:n,spatialReference:n.spatialReference,vertices:e,elevationInfo:this.internalGraphicsLayer.elevationInfo,size:c.size,outlineSize:c.outlineSize,renderOccluded:c.renderOccluded,attached:!1,isDecoration:!0}),p=(0,handleUtils.vE)([(0,reactiveUtils.watch)((()=>({color:(0,colorUtils.QP)(a.manipulators.vertex.color),outlineColor:(0,colorUtils.QP)(a.manipulators.vertex.outlineColor)})),(({color:e,outlineColor:t})=>{m.color=e,m.outlineColor=t}),reactiveUtils.Vh),(0,handleUtils.hA)((()=>{this._verticesVisualElement=(0,maybe.pR)(this._verticesVisualElement)}))]);return m.attached=!0,this._verticesVisualElement=m,p}updateGraphicGeometry(e){if("mesh"!==this.geometryType||"point"!==e?.type)super.updateGraphicGeometry(e);else{const t=this.geometryToPlace;t?.centerAt(e),(0,tooltipCommonUtils.IA)(this.tooltipInfos.mesh,t);const i=this._graphic;t&&i.geometry===t||(i.geometry=t)}}_setupLoadingIndicator(e){const{drawOperation:t}=this;if(!this.geometryToPlace)return t.loading=!1,null;t.loading=!0;const s=(0,handleUtils.hA)((()=>{t.loading=!1}));let o;const l=()=>o&&cancelAnimationFrame(o);return(0,handleUtils.vE)([(0,reactiveUtils.when)((()=>e.displaying),(()=>{l(),o=requestAnimationFrame((()=>s.remove()))}),{...reactiveUtils.pc,once:!0}),(0,handleUtils.hA)(l),s])}};(0,tslib_es6._)([(0,property.MZ)({constructOnly:!0})],DrawGraphicTool3D_z.prototype,"elevationInfo",void 0),(0,tslib_es6._)([(0,property.MZ)({constructOnly:!0})],DrawGraphicTool3D_z.prototype,"geometryType",void 0),(0,tslib_es6._)([(0,property.MZ)()],DrawGraphicTool3D_z.prototype,"type",void 0),(0,tslib_es6._)([(0,property.MZ)({constructOnly:!0})],DrawGraphicTool3D_z.prototype,"view",void 0),DrawGraphicTool3D_z=(0,tslib_es6._)([(0,subclass.$)("esri.views.3d.interactive.editingTools.draw.DrawGraphicTool3D")],DrawGraphicTool3D_z);const DrawGraphicTool3D_U=new ElevationContext.F,DrawGraphicTool3D_A=(0,vec3f64.vt)();var arrayUtils=__webpack_require__("./node_modules/@arcgis/core/core/arrayUtils.js"),Collection=__webpack_require__("./node_modules/@arcgis/core/core/Collection.js"),quantityUtils=__webpack_require__("./node_modules/@arcgis/core/core/quantityUtils.js"),UpdatingHandles=__webpack_require__("./node_modules/@arcgis/core/core/support/UpdatingHandles.js"),common=__webpack_require__("./node_modules/@arcgis/core/core/libs/gl-matrix-2/math/common.js");function geometryUtils_r(t){if(null==t||"polyline"!==t.type&&"polygon"!==t.type)return 0;const n="polyline"===t.type?t.paths:t.rings,r=(0,common.FD)();for(const o of n)for(let t=0;t<o.length-1;t++){const n=o[t],e=o[t+1],i=n[0]-e[0],l=n[1]-e[1];if(i*i+l*l>r)return Math.atan2(e[1]-n[1],e[0]-n[0])}return 0}var isSupportedObjectUtils=__webpack_require__("./node_modules/@arcgis/core/views/3d/interactive/editingTools/isSupportedObjectUtils.js");function manipulatedObjectUtils_t(t){return t?.operations?.data.geometry}function manipulatorUtils_o(e,n){return function manipulatorUtils_t(e,o){return!!e&&"on-the-ground"!==o.mode&&!(0,elevationInfoUtils.v9)(o)}(e?.data.coordinateHelper.hasZ(),n)}var editGeometry_interfaces=__webpack_require__("./node_modules/@arcgis/core/views/interactive/editGeometry/interfaces.js"),euclideanLengthMeasurementUtils=__webpack_require__("./node_modules/@arcgis/core/views/support/euclideanLengthMeasurementUtils.js");function tooltipUtils3D_m(o,e,s){function l(){const t=s(),o=t.sketchOptions.tooltips.effectiveEnabled?t.activeTooltipInfo:null;return{...t,activeTooltipInfo:o}}let p=!1;function u(t){p||(p=!0,t(),p=!1)}function f({activeTooltipInfo:t,sketchOptions:i,scaleRotateTransform:n}){u((()=>{t&&(t.sketchOptions=i,tooltipUtils3D_y(t,e),function tooltipUtils3D_k(t,i){if("transform-point"!==t?.type)return;if(!i)return t.orientation.actual=void 0,t.size.actual=void 0,t.orientation.visible=!1,void(t.size.visible=!1);const n=i.mode,{size:r,orientationClockwise:a}=i.adapter,{visualVariables:s}=t.sketchOptions.tooltips,c=s?.rotation,l=null!=a&&(null==n||"rotate"===n),p=c?.rotationType??"geographic";t.orientation.actual=l?(0,quantityUtils.Wq)(a,"radians",p):void 0,t.orientation.precision=tooltipUtils3D_T(c?.valueType),t.orientation.visible=l;const u=s?.size,f=null!=r&&(null==n||"scale"===n);t.size.actual=f?(0,quantityUtils.d_)(r,u?.unit??"meters"):void 0,t.size.precision=tooltipUtils3D_T(u?.valueType),t.size.visible=f}(t,n)),o.info=t}))}return(0,handleUtils.vE)([(0,reactiveUtils.watch)(l,f,reactiveUtils.pc),(0,reactiveUtils.watch)((()=>{const t=l(),{activeTooltipInfo:o}=t;if(o)return{context:t,activeTooltipInfo:o,key:o.key,geometry:manipulatedObjectUtils_t(e)}}),((t,o)=>{t&&o&&o.key!==t.key&&u((()=>tooltipUtils3D_v(e,t.context)))}),reactiveUtils.OH),e.on("committed",(()=>{queueMicrotask((()=>f(l())))})),(0,tooltipCommonUtils.sZ)(o,{onBeforePaste:()=>{p=!0},onAfterPaste:()=>{tooltipUtils3D_v(e,l()),p=!1}})])}function tooltipUtils3D_v(t,{activeTooltipInfo:o,callbacks:e}){if(!o)return;e.onBeforeUpdate();const i=manipulatedObjectUtils_t(t);switch(i?.type){case"mesh":tooltipUtils3D_d(o,i.origin,t,e),"orientation"in o&&"scale"in o&&(0,tooltipCommonUtils.IA)(o,i,e);break;case"point":tooltipUtils3D_d(o,i,t,e)}}function tooltipUtils3D_d(t,o,e,i){const{dx:n,dy:r,dz:a}=(0,tooltipCommonUtils.mu)(t,o);0===n&&0===r&&0===a||(i.onMoveStart(),e.operations?.move(n,r,a,editGeometry_interfaces.Y.NEW_STEP),i.onMove(n,r,a),i.onMoveStop())}function tooltipUtils3D_y(t,o){const e=manipulatedObjectUtils_t(o),i=e?.type;if(!t||!e||"mesh"!==i&&"point"!==i)return;const n="mesh"===i,r=n?e.origin:e;t.setLocationFromPoint(r),tooltipUtils3D_h(t,r,o),"transform-mesh"===t.type&&n&&(0,tooltipCommonUtils.Ue)(t,e),t.clearInputValues()}function tooltipUtils3D_h(t,o,e){t.elevation.actual=(0,euclideanLengthMeasurementUtils.Of)(o),t.elevation.visible=!!e.operations?.data.coordinateHelper.hasZ(),t.elevation.readOnly=!1,t.elevation.showAsZ=!0}function tooltipUtils3D_T(t){switch(t){case"integer":case"long":return 0;default:return null}}var signal=__webpack_require__("./node_modules/@arcgis/core/core/signal.js"),mat3=__webpack_require__("./node_modules/@arcgis/core/core/libs/gl-matrix-2/math/mat3.js"),mat3f64=__webpack_require__("./node_modules/@arcgis/core/core/libs/gl-matrix-2/factories/mat3f64.js"),ellipsoidUtils=__webpack_require__("./node_modules/@arcgis/core/geometry/ellipsoidUtils.js"),Point=__webpack_require__("./node_modules/@arcgis/core/geometry/Point.js"),geometry_projection=__webpack_require__("./node_modules/@arcgis/core/geometry/projection.js"),localRotationUtils=__webpack_require__("./node_modules/@arcgis/core/geometry/projection/localRotationUtils.js"),projectors=__webpack_require__("./node_modules/@arcgis/core/geometry/projection/projectors.js"),aaBoundingRect=__webpack_require__("./node_modules/@arcgis/core/geometry/support/aaBoundingRect.js"),plane=__webpack_require__("./node_modules/@arcgis/core/geometry/support/plane.js"),hydratedFeatures=__webpack_require__("./node_modules/@arcgis/core/layers/graphics/hydratedFeatures.js"),ElevationProvider=__webpack_require__("./node_modules/@arcgis/core/views/3d/support/ElevationProvider.js");function ray_m(e,n,o=(0,ray.vt)()){return ray_g(e,(0,screenUtils.WA)(n),o),(0,vec32.n)(o.direction,o.direction),o}function ray_g(r,n,t){return function ray_l(r,t,i){const c=(0,screenUtils.sc)((0,vec2.C)(vectorStacks.rq.get(),t));if(c[2]=0,!r.unprojectFromRenderScreen(c,i.origin))return null;const s=(0,screenUtils.sc)((0,vec2.C)(vectorStacks.rq.get(),t));s[2]=1;const m=r.unprojectFromRenderScreen(s,vectorStacks.rq.get());return null==m?null:((0,vec32.d)(i.direction,m,i.origin),i)}(r,r.screenToRender(n,(0,screenUtils.sc)(vectorStacks.rq.get())),t)}var RenderCamera=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl/RenderCamera.js"),interactive_interfaces=__webpack_require__("./node_modules/@arcgis/core/views/interactive/interfaces.js");class ee{constructor(e){this.metadata=void 0,this._camera=new RenderCamera.A,this._elevation={offset:0,override:null},this.collisionType={type:"point"},this.collisionPriority=0,this._renderObjects=new Array,this.autoScaleRenderObjects=!0,this._available=!0,this._noDisplayCount=0,this._radius=10,this._worldSized=!1,this.focusMultiplier=2,this.touchMultiplier=2.5,this.worldOriented=!1,this._modelTransform=(0,mat4f64.vt)(),this._worldFrame=null,this._renderLocation=(0,vec3f64.vt)(),this._renderLocationDirty=!0,this._location=new Point.default({x:0,y:0,z:0}),this._elevationAlignedLocation=new Point.default,this._elevationAlignedLocationDirty=!0,this.interactive=!0,this.selectable=!1,this.grabbable=!0,this.consumesClicks=!0,this.cursor=null,this.grabCursor=null,this._grabbing=!1,this.dragging=!1,this._hovering=!1,this._selected=!1,this._state=interactive_interfaces.SJ.None,this._focused=!1,this.events=new Evented.A.EventEmitter,this._screenLocation={screenPointArray:(0,screenUtils.gs)(),renderScreenPointArray:(0,screenUtils.r_)(),pixelSize:0},this._screenLocationDirty=!0,this._engineResourcesAddedToStage=!1,this._attached=!1,this._location.spatialReference=e.view.spatialReference,Object.assign(this,e);const i=this.view.state?.camera;i&&this._camera.copyFrom(i)}destroy(){this._applyObjectTransform=pe,this._removeResourcesFromStage(),this._engineResources=null,this.view=null,this._camera=null}get _stage(){return this.view?._stage}get elevationInfo(){return this._elevationInfo}set elevationInfo(e){this._elevationInfo=e,this._elevationAlignedLocationDirty=!0,this._renderLocationDirty=!0,this._updateEngineObject()}get renderObjects(){return this._renderObjects}set renderObjects(e){this._removeResourcesFromStage(),this._engineResources=null,this._renderObjects=e.slice(),this._updateEngineObject()}set available(e){e!==this._available&&(this._available=e,this._updateEngineObject())}get available(){return this._available}disableDisplay(){return this._noDisplayCount++,1===this._noDisplayCount&&this._updateEngineObject(),(0,handleUtils.hA)((()=>{this._noDisplayCount--,0===this._noDisplayCount&&this._updateEngineObject()}))}set radius(e){e!==this._radius&&(this._radius=e,this._updateEngineObject())}get radius(){return this._radius}set worldSized(e){e!==this._worldSized&&(this._worldSized=e,this._updateEngineObject())}get worldSized(){return this._worldSized}get modelTransform(){return this._modelTransform}set modelTransform(e){te(e)&&(this._screenLocationDirty=!0),(0,mat4.C)(this._modelTransform,e),this._updateEngineObject()}get renderLocation(){return this._renderLocationDirty&&(this._renderLocationDirty=!1,this.view.renderCoordsHelper.toRenderCoords(this.elevationAlignedLocation,this._renderLocation),this.worldOriented?(this._worldFrame||(this._worldFrame=(0,mat4f64.vt)()),function ie(e,t,i){switch(e.viewingMode){case"local":return(0,mat4.D_)(i),!0;case"global":{const o=(0,ellipsoidUtils.tO)(e.renderCoordsHelper.spatialReference);return(0,projectors.n4)(t,0,he,0,o.radius),(0,localRotationUtils.z)((0,mathUtils.kU)(he[0]),(0,mathUtils.kU)(he[1]),i),!0}}}(this.view,this._renderLocation,this._worldFrame)):this._worldFrame&&(this._worldFrame=null)),this._renderLocation}set renderLocation(e){this.view.renderCoordsHelper.fromRenderCoords(e,this._location),this.elevationAlignedLocation=this._location}get location(){return this._location}set location(e){(0,hydratedFeatures.EL)(e,this._location),this._notifyLocationChanged()}_notifyLocationChanged(){this._renderLocationDirty=!0,this._screenLocationDirty=!0,this._elevationAlignedLocationDirty=!0,this._updateEngineObject(),this.events.emit("location-update",{location:this._location})}get elevationAlignedLocation(){return this._elevationAlignedLocationDirty?(this._evaluateElevationAlignment(),this._updateElevationAlignedLocation(),this._elevationAlignedLocation):this._elevationAlignedLocation}set elevationAlignedLocation(e){(0,hydratedFeatures.EL)(e,this._location),this._evaluateElevationAlignment(),this._location.z-=this._elevation.offset,this._updateElevationAlignedLocation(),this._updateEngineObject(),this.events.emit("location-update",{location:this._location})}_updateElevationAlignedLocation(){const e=null!=this._elevation.override?this._elevation.override:this.location.z||0;this._elevationAlignedLocation.x=this.location.x,this._elevationAlignedLocation.y=this.location.y,this._elevationAlignedLocation.z=e+this._elevation.offset,this._elevationAlignedLocation.spatialReference=(0,hydratedFeatures.RS)(this.location.spatialReference),this._renderLocationDirty=!0,this._screenLocationDirty=!0,this._elevationAlignedLocationDirty=!1}grabbableForEvent(){return!0}get grabbing(){return this._grabbing}set grabbing(e){e!==this._grabbing&&(this._grabbing=e,this._setFocused(this._hovering||this._grabbing),this._updateEngineObject())}get hovering(){return this._hovering}set hovering(e){e!==this._hovering&&(this._hovering=e,this._setFocused(this._hovering||this._grabbing),this._updateEngineObject())}get selected(){return this._selected}set selected(e){e!==this._selected&&(this._selected=e,this._updateEngineObject(),this.events.emit("select-changed",{action:e?"select":"deselect"}))}get state(){return this._state}set state(e){e!==this._state&&(this._state=e,this._updateEngineObject())}updateStateEnabled(e,t){t?this.state|=e:this.state&=~e}_setFocused(e){e!==this._focused&&(this._focused=e,this.events.emit("focus-changed",{action:!0===e?"focus":"unfocus"}))}get focused(){return this._focused}get screenLocation(){return this._ensureScreenLocation(),this._screenLocation}_ensureScreenLocation(){if(!this._screenLocationDirty)return;let e;if(this._screenLocation.pixelSize=this._camera.computeScreenPixelSizeAt(this.renderLocation),this._screenLocationDirty=!1,te(this._modelTransform)){const t=this._calculateModelTransformOffset(me);e=(0,vec32.g)(t,t,this.renderLocation)}else e=this.renderLocation;this._camera.projectToRenderScreen(e,this._screenLocation.renderScreenPointArray),this._camera.renderToScreen(this._screenLocation.renderScreenPointArray,this._screenLocation.screenPointArray)}get applyObjectTransform(){return this._applyObjectTransform}set applyObjectTransform(e){this._applyObjectTransform=e,this._screenLocationDirty=!0,this._updateEngineObject()}get attached(){return this._attached}intersectionDistance(t,i){if(!this.available)return null;const s=(0,screenUtils.WA)(t,se),o=this._getCollisionRadius(i),r=-1*this.collisionPriority;switch(this.collisionType.type){case"point":if((0,vec2.hG)(this.screenLocation.screenPointArray,s)<o*o)return this.screenLocation.renderScreenPointArray[2]+r;break;case"line":{const e=this.collisionType.paths,t=this._getWorldToScreenObjectScale(),i=this._calculateObjectTransform(t,ce),n=o*this.screenLocation.pixelSize,a=ray_g(this._camera,s,re);if(null==a)return null;for(const s of e){if(0===s.length)continue;const e=(0,vec32.t)(he,s[0],i);for(let t=1;t<s.length;t++){const o=(0,vec32.t)(de,s[t],i),l=(0,lineSegment.dz)((0,lineSegment.Cr)(e,o,oe),a);if(null!=l&&l<n*n){const t=(0,vec32.g)(vectorStacks.rq.get(),e,o);(0,vec32.h)(t,t,.5);const i=(0,screenUtils.rX)(vectorStacks.rq.get());return this._camera.projectToRenderScreen(t,i),i[2]+r}(0,vec32.c)(e,o)}}break}case"disc":{const e=this.collisionType.direction,t=this.collisionType.offset??vec3f64.uY,i=this._getWorldToScreenObjectScale(),n=this._calculateObjectTransform(i,ce),a=o*this.screenLocation.pixelSize,c=ray_g(this._camera,s,re);if(null==c)return null;const h=(0,mat3.z0)(ne,n),d=(0,vec32.q)(ue,e,h),_=(0,vec32.t)(ge,t,n);(0,plane.O_)(_,d,le);const u=_e;if((0,plane.Ui)(le,c,u)&&(0,vec32.s)(u,_)<a*a)return this.screenLocation.renderScreenPointArray[2]+r;break}case"ribbon":{const{paths:e,direction:t}=this.collisionType,i=this._getWorldToScreenObjectScale(),n=this._calculateObjectTransform(i,ce),a=o*this._camera.computeScreenPixelSizeAt(this.renderLocation),h=ray_g(this._camera,s,re);if(null==h)return null;const d=(0,mat3.z0)(ne,n),_=(0,vec32.q)(ue,t,d),u=this._calculateModelTransformPosition(ge);(0,plane.O_)(u,_,le);const g=_e;if(!(0,plane.Ui)(le,h,g))break;for(const s of e){if(0===s.length)continue;const e=(0,vec32.t)(he,s[0],n);for(let t=1;t<s.length;t++){const i=(0,vec32.t)(de,s[t],n),o=(0,lineSegment.kb)((0,lineSegment.Cr)(e,i,oe),g);if(null!=o&&o<a*a){const t=(0,vec32.g)(vectorStacks.rq.get(),e,i);(0,vec32.h)(t,t,.5);const s=(0,screenUtils.rX)(vectorStacks.rq.get());return this._camera.projectToRenderScreen(t,s),s[2]+r}(0,vec32.c)(e,i)}}break}default:(0,compilerUtils.Xb)(this.collisionType)}return null}attach(e={manipulator3D:{}}){const t=this._stage;if(!t)return;const i=e.manipulator3D;null==i.engineLayerId?(this._engineLayer=new WebGLLayer.x(t,{pickable:!1,updatePolicy:UpdatePolicy.q.SYNC}),i.engineLayerId=this._engineLayer.id):t?.getObject&&(this._engineLayer=t.getObject(i.engineLayerId)),i.engineLayerReferences=(i.engineLayerReferences||0)+1,this._materialIdReferences=i.materialIdReferences,null==this._materialIdReferences&&(this._materialIdReferences=new Map,i.materialIdReferences=this._materialIdReferences),this._camera.copyFrom(this.view.state.camera),this._attached=!0,this._updateEngineObject(),(0,geometry_projection.canProjectWithoutEngine)(this._location.spatialReference,this.view.spatialReference)||(this.location=new Point.default({x:0,y:0,z:0,spatialReference:this.view.spatialReference}))}detach(e={manipulator3D:{}}){const t=e.manipulator3D;t.engineLayerReferences--;const i=0===t.engineLayerReferences;this._removeResourcesFromStage(),i&&(t.engineLayerId=null,(0,maybe.pR)(this._engineLayer)),this._engineResources=null,this._engineLayer=null,this._materialIdReferences=null,this._attached=!1}onViewChange(){this._camera.copyFrom(this.view.state.camera),this._screenLocationDirty=!0,this._updateEngineObject()}onElevationChange(e){(0,geometry_projection.projectPoint)(this.location,fe,e.spatialReference)&&(0,aaBoundingRect.vR)(e.extent,fe)&&this._notifyLocationChanged()}_evaluateElevationAlignment(){if(null==this.elevationInfo)return;let e=null,t=0;const i=(0,elevationInfoUtils.Ze)(this.elevationInfo,this.location.spatialReference??this.view.elevationProvider.spatialReference);switch(this.elevationInfo.mode){case"on-the-ground":e=(0,ElevationProvider.R1)(this.view.elevationProvider,this.location,"ground")??0;break;case"relative-to-ground":t=((0,ElevationProvider.R1)(this.view.elevationProvider,this.location,"ground")??0)+i;break;case"relative-to-scene":t=((0,ElevationProvider.R1)(this.view.elevationProvider,this.location,"scene")??0)+i;break;case"absolute-height":t=i}return t!==this._elevation.offset||e!==this._elevation.override?(this._elevation.offset=t,void(this._elevation.override=e)):void 0}_updateEngineObject(){if(!this._attached)return;if(!this.available)return void this._removeResourcesFromStage();const e=this._getWorldToScreenObjectScale(),t=ce;if(!0===this.autoScaleRenderObjects){const i=this._getFocusedSize(this._radius,this.focused)*e;this._calculateObjectTransform(i,t)}else this._calculateObjectTransform(e,t);const{objectsByState:i}=this._ensureEngineResources(),s=(this.focused?interactive_interfaces.p7.Focused:interactive_interfaces.p7.Unfocused)|(this.selected?interactive_interfaces.p7.Selected:interactive_interfaces.p7.Unselected),o=this._noDisplayCount>0;for(const{stateMask:r,objects:n}of i){if(o){for(const e of n)e.visible=!1;continue}const e=(r&interactive_interfaces.p7.All)!==interactive_interfaces.p7.None,i=(r&interactive_interfaces.SJ.All)!==interactive_interfaces.SJ.None,a=!e||(s&r)==(r&interactive_interfaces.p7.All),c=!i||(this.state&r)==(r&interactive_interfaces.SJ.All);if(a&&c)for(const s of n)s.visible=!0,s.transformation=t;else for(const t of n)t.visible=!1}}_ensureEngineResources(){if(null==this._engineResources){const e=this._engineLayer,t=[],i=new Set;this.renderObjects.forEach((({geometry:{material:e}})=>{i.has(e)||(t.push(e),i.add(e))}));const s=new Map;this._renderObjects.forEach((e=>{const t=new Object3D.B({castShadow:!1,geometries:[e.geometry]}),i=s.get(e.stateMask)||[];i.push(t),s.set(e.stateMask,i)}));const o=[];s.forEach(((e,t)=>o.push({stateMask:t,objects:e}))),this._engineResources={objectsByState:o,layer:e,materials:t}}return this._addResourcesToStage(),this._engineResources}_addResourcesToStage(){const e=this._stage;if(this._engineResourcesAddedToStage||null==this._engineResources||!e)return;const{objectsByState:t,layer:i,materials:s}=this._engineResources;s.forEach((t=>{const i=this._materialIdReferences,s=i.get(t.id)||0;0===s&&e.add(t),i.set(t.id,s+1)})),t.forEach((({objects:t})=>{i.addMany(t),e.addMany(t)})),this._engineResourcesAddedToStage=!0}_removeResourcesFromStage(){const e=this._stage;if(!this._engineResourcesAddedToStage||null==this._engineResources||!e)return;const{objectsByState:t,layer:i,materials:s}=this._engineResources;t.forEach((({objects:t})=>{i.removeMany(t),e.removeMany(t)})),s.forEach((t=>{const i=this._materialIdReferences,s=i.get(t.id);1===s?(e.remove(t),i.delete(t.id)):i.set(t.id,s-1)})),this._engineResourcesAddedToStage=!1}_getCollisionRadius(e){return this._getFocusedSize(this.radius,!0)*("touch"===e?this.touchMultiplier:1)}_getFocusedSize(e,t){return e*(t?this.focusMultiplier:1)}_getWorldToScreenObjectScale(){return this._worldSized?1:this.screenLocation.pixelSize}_calculateModelTransformPosition(e){const t=this._getWorldToScreenObjectScale(),i=this._calculateObjectTransform(t,ae);return(0,vec32.i)(e,i[12],i[13],i[14])}_calculateModelTransformOffset(e){const t=this._calculateModelTransformPosition(e);return(0,vec32.d)(e,t,this.renderLocation)}_calculateObjectTransform(e,t){return(0,mat4.hZ)(t,e,0,0,0,0,e,0,0,0,0,e,0,0,0,0,1),this._worldFrame&&(0,mat4.lw)(t,t,this._worldFrame),(0,mat4.lw)(t,t,this._modelTransform),t[12]+=this.renderLocation[0],t[13]+=this.renderLocation[1],t[14]+=this.renderLocation[2],t[15]=1,null!=this._applyObjectTransform&&this._applyObjectTransform(t),t}get test(){}}function te(e){return 0!==e[12]||0!==e[13]||0!==e[14]}const se=(0,screenUtils.gs)(),oe=(0,lineSegment.vt)(),re=(0,ray.vt)(),ne=(0,mat3f64.vt)(),ae=(0,mat4f64.vt)(),ce=(0,mat4f64.vt)(),le=(0,plane.vt)(),he=(0,vec3f64.vt)(),de=(0,vec3f64.vt)(),_e=(0,vec3f64.vt)(),ue=(0,vec3f64.vt)(),ge=(0,vec3f64.vt)(),me=(0,vec3f64.vt)(),fe=new Point.default({x:0,y:0,z:0,spatialReference:null}),pe=()=>{};var GrabbingState_N,ManipulatorType_A;!function(N){N[N.NONE=0]="NONE",N[N.ANY=1]="ANY",N[N.Z=2]="Z",N[N.XY=4]="XY"}(GrabbingState_N||(GrabbingState_N={})),function(A){A[A.TRANSLATE_Z=0]="TRANSLATE_Z",A[A.TRANSLATE_XY=1]="TRANSLATE_XY",A[A.SCALE=2]="SCALE",A[A.ROTATE=3]="ROTATE",A[A.SCALE_ROTATE=4]="SCALE_ROTATE"}(ManipulatorType_A||(ManipulatorType_A={}));class ManipulatorState_a{constructor(){this.grabbingState=GrabbingState_N.NONE,this.zManipulator=null,this.firstSelected=null,this.numSelected=0,this.firstGrabbedXY=null}update(a){this.grabbingState=GrabbingState_N.NONE,this.zManipulator=null,this.numSelected=0,this.firstSelected=null,this.firstGrabbedXY=null,a.forEachManipulator(((a,s)=>{if(s===ManipulatorType_A.TRANSLATE_Z&&(this.zManipulator=a),a instanceof ee&&(a.selected&&(0===this.numSelected&&(this.firstSelected=a),this.numSelected++),null==this.firstGrabbedXY&&a.grabbing&&s===ManipulatorType_A.TRANSLATE_XY&&(this.firstGrabbedXY=a)),a.grabbing)switch(this.grabbingState|=GrabbingState_N.ANY,s){case ManipulatorType_A.TRANSLATE_Z:this.grabbingState|=GrabbingState_N.Z;break;case ManipulatorType_A.TRANSLATE_XY:this.grabbingState|=GrabbingState_N.XY}}))}}function lineObjectVisualElementUtils_y(t){const{object:n}=t,a=function lineObjectVisualElementUtils_S(e){const{view:a,object:l}=e,s=manipulatedObjectUtils_t(l),r=new OutlineVisualElement_j({view:a,geometry:lineObjectVisualElementUtils_D(s)?s:null,elevationInfo:l.elevationInfo,attached:!1,isDecoration:!0}),c=new settings_j({getTheme:()=>a.effectiveTheme}),m=()=>{r.attached=l.visible},u=(0,handleUtils.vE)([(0,reactiveUtils.watch)((()=>c.visualElements.lineObjects.outline),(e=>e.apply(r)),reactiveUtils.Vh),(0,reactiveUtils.watch)((()=>c.visualElements.lineObjects.shadowStyle),(e=>e.apply(r)),reactiveUtils.Vh),(0,reactiveUtils.watch)((()=>l.visible),m),(0,reactiveUtils.watch)((()=>l.isDraped),(e=>{r.isDraped=e}),reactiveUtils.Vh),l.on("committed",(()=>{const e=manipulatedObjectUtils_t(l);r.geometry=lineObjectVisualElementUtils_D(e)?e:null})),(0,handleUtils.DQ)(r)]);return m(),{visualElement:r,remove:()=>u.remove()}}(t),l=[a,lineObjectVisualElementUtils_M(t,a.visualElement)];return n.maskOccludee&&l.push(n.maskOccludee()),{visualElement:a.visualElement,remove:()=>(0,handleUtils.a0)(l)}}function lineObjectVisualElementUtils_M(r,c){const{object:m,view:u}=r,p=[],v=m.elevationInfo,j="on-the-ground"===v.mode||!v.offset&&"absolute-height"!==v.mode,y=new ManipulatorState_a,S=new settings_j({getTheme:()=>u.effectiveTheme}),M=S.visualElements,L=new ExtendedLineVisualElement_G({view:u,extensionType:M.zVerticalLine.extensionType,innerWidth:1,attached:!1,writeDepthEnabled:!1,renderOccluded:Material.m$.OccludeAndTransparent,isDecoration:!0}),A=(0,mathUtils.kU)(M.heightPlaneAngleCutoff),x=new LaserlineVisualElement_c({view:u,attached:!1,angleCutoff:A,isDecoration:!0}),C=(0,signal.v)(1);p.push((0,reactiveUtils.watch)((()=>({lineShadowStyle:S.visualElements.lineObjects.shadowStyle,pointShadowStyle:S.visualElements.pointObjects.shadowStyle,alpha:C.value})),(({lineShadowStyle:e,pointShadowStyle:t,alpha:n})=>{e.apply(c,n),t.apply(L,n)}),reactiveUtils.Vh));const V=(0,signal.v)(1);p.push((0,reactiveUtils.watch)((()=>({heightPlane:S.visualElements.heightPlane,alpha:V.value})),(({heightPlane:e,alpha:t})=>e.apply(x,t)),reactiveUtils.Vh));const P=()=>{y.update(r);const e=manipulatedObjectUtils_t(m);if(!m.visible||j&&(m.isDraped||!lineObjectVisualElementUtils_D(e)||!e.hasZ))return c.laserlineEnabled=!1,L.attached=!1,void(x.attached=!1);c.laserlineEnabled=!0;const t=y.grabbingState&GrabbingState_N.XY?M.laserlineAlphaMultiplier:1;C.value=t;const n=y.grabbingState&GrabbingState_N.Z?M.laserlineAlphaMultiplier:1;V.value=n,function lineObjectVisualElementUtils_T(e,t){const n=1===t.numSelected?t.firstSelected:t.numSelected>1&&null!=t.firstGrabbedXY?t.firstGrabbedXY:null;null!=n?(e.setStartEndFromWorldDownAtLocation(n.renderLocation),e.attached=!0):e.attached=!1}(L,y),function lineObjectVisualElementUtils_O(e,t,n,a){if(a.numSelected>0){(0,vec32.i)(lineObjectVisualElementUtils_L,0,0,0);let t=0;e.forEachManipulator(((e,n)=>{n===ManipulatorType_A.TRANSLATE_XY&&e.selected&&e instanceof ee&&((0,vec32.g)(lineObjectVisualElementUtils_L,lineObjectVisualElementUtils_L,e.renderLocation),t++)})),t>0?(n.heightManifoldTarget=(0,vec32.h)(lineObjectVisualElementUtils_L,lineObjectVisualElementUtils_L,1/t),n.attached=!0):n.attached=!1}else{const a=t.attachmentOrigin;null!=a&&e.view.renderCoordsHelper.toRenderCoords(a,lineObjectVisualElementUtils_L)?(n.heightManifoldTarget=lineObjectVisualElementUtils_L,n.attached=!0):n.attached=!1}}(r,c,x,y)};p.push((0,reactiveUtils.watch)((()=>S.visualElements.zVerticalLine),(e=>e.apply(L)),reactiveUtils.Vh)),p.push(m.on("committed",P),(0,reactiveUtils.watch)((()=>m.visible),P),c.events.on("attachment-origin-changed",P),(0,handleUtils.DQ)(L),(0,handleUtils.DQ)(x));const U=[],X=()=>{(0,handleUtils.a0)(U),U.length=0,r.forEachManipulator((e=>U.push(e.events.on("grab-changed",P)))),r.forEachManipulator((e=>U.push(e.events.on("select-changed",P)))),P()};return X(),p.push(r.onManipulatorsChanged(X),(0,handleUtils.a2)((()=>(0,handleUtils.vE)(U)))),(0,handleUtils.vE)(p)}function lineObjectVisualElementUtils_D(e){return null!=e&&("polygon"===e.type||"polyline"===e.type)}const lineObjectVisualElementUtils_L=(0,vec3f64.vt)();var projectPointToVector=__webpack_require__("./node_modules/@arcgis/core/geometry/projection/projectPointToVector.js");function originGeometryVisualElementUtils_P(t){const o=[],n=function originGeometryVisualElementUtils_S(e,o){const{view:n,object:i}=e,l=new PointVisualElement_S({view:n,geometry:originGeometryVisualElementUtils_V(manipulatedObjectUtils_t(i)),elevationInfo:i.elevationInfo,isDecoration:!0});return function originGeometryVisualElementUtils_A(e,t,o){const{view:n,object:r}=e,a=()=>{t.attached=r.visible},s=new settings_j({getTheme:()=>n.effectiveTheme});(function originGeometryVisualElementUtils_L(e,t,n){const{view:i,object:l}=e;let r=null;const a=e=>{null!=r&&(r.remove(),r=null),l.isDraped&&null!=e&&(r=function originGeometryVisualElementUtils_M(e,t,o){const n=e.elevationProvider.spatialReference;(0,projectPointToVector.g)(t,originGeometryVisualElementUtils_U,n);const i=originGeometryVisualElementUtils_U[0],l=originGeometryVisualElementUtils_U[1];return e.elevationProvider.on("elevation-change",(e=>{(0,aaBoundingRect.Rj)(e.extent,i,l)&&o()}))}(i,e,(()=>{t.geometry=e})))},s=()=>{const e=originGeometryVisualElementUtils_V(manipulatedObjectUtils_t(l));null!=e&&(0,elevationInfoUtils.x)(l.elevationInfo)&&(e.z=0),a(e),t.geometry=e};n.push(l.on("committed",s),(0,handleUtils.a2)((()=>r))),s()})(e,t,o),s.visualElements.pointObjects.outline.apply(t),o.push((0,reactiveUtils.watch)((()=>r.visible),a,reactiveUtils.Vh))}(e,l,o),o.push((0,handleUtils.DQ)(l)),l}(t,o);return function originGeometryVisualElementUtils_I(e,o,s){const{view:c,object:m}=e,h=new settings_j({getTheme:()=>c.effectiveTheme}),E=new ExtendedLineVisualElement_G({view:c,extensionType:h.visualElements.zVerticalLine.extensionType,innerWidth:1,attached:!1,writeDepthEnabled:!1,renderOccluded:Material.m$.OccludeAndTransparent,isDecoration:!0});o.push((0,reactiveUtils.watch)((()=>h.visualElements.zVerticalLine),(e=>e.apply(E)),reactiveUtils.Vh));const P=new LaserlineVisualElement_c({view:c,intersectsLineInfinite:!0,attached:!1,isDecoration:!0}),I=(0,mathUtils.kU)(h.visualElements.heightPlaneAngleCutoff),S=new LaserlineVisualElement_c({view:c,attached:!1,angleCutoff:I,isDecoration:!0}),A=m.elevationInfo,L=ElevationContext.F.fromElevationInfo(A),M="on-the-ground"===A.mode||!A.offset&&"absolute-height"!==A.mode,R=new ManipulatorState_a,O=(0,signal.v)(1);o.push((0,reactiveUtils.watch)((()=>({heightPlane:h.visualElements.heightPlane,alpha:O.value})),(({heightPlane:e,alpha:t})=>e.apply(S,t)),reactiveUtils.Vh));const z=(0,signal.v)(1);o.push((0,reactiveUtils.watch)((()=>({shadowStyle:h.visualElements.pointObjects.shadowStyle,alpha:z.value})),(({shadowStyle:e,alpha:t})=>e.apply(P,t)),reactiveUtils.Vh));const B=()=>{R.update(e);let t=originGeometryVisualElementUtils_V(manipulatedObjectUtils_t(m));const o=M&&(m.isDraped||null==t||!t.hasZ);let n=!0;if(o||null==t)n=!1;else{(0,elevationInfoUtils.x)(m.elevationInfo)&&(t=t.clone(),t.z=0);const e=(0,elevationAlignmentUtils.nG)(t,c.elevationProvider,L,c.renderCoordsHelper);(0,vec32.i)(originGeometryVisualElementUtils_U,t.x,t.y,e),(0,projectVectorToVector.F)(originGeometryVisualElementUtils_U,t.spatialReference,originGeometryVisualElementUtils_U,c.renderCoordsHelper.spatialReference),E.setStartEndFromWorldDownAtLocation(originGeometryVisualElementUtils_U),P.intersectsWorldUpAtLocation=originGeometryVisualElementUtils_U}const i=R.grabbingState&GrabbingState_N.Z?h.visualElements.laserlineAlphaMultiplier:1;O.value=i;const l=(0,aaBoundingBox.Ie)(originGeometryVisualElementUtils_C);!o&&m.visible&&s.calculateMapBounds(l)&&(0,projectVectorToVector.F)((0,aaBoundingBox.pg)(l,originGeometryVisualElementUtils_U),c.spatialReference,originGeometryVisualElementUtils_U,c.renderCoordsHelper.spatialReference)?(S.heightManifoldTarget=originGeometryVisualElementUtils_U,S.attached=!0):S.attached=!1;const r=R.grabbingState&GrabbingState_N.XY?h.visualElements.laserlineAlphaMultiplier:1;z.value=r;const j=n&&m.visible&&!o;P.attached=j,E.attached=j};o.push((0,reactiveUtils.watch)((()=>[m.visible,m.isDraped]),B),m.on("committed",B)),e.forEachManipulator((e=>{o.push(e.events.on("grab-changed",B))})),o.push((0,handleUtils.DQ)(P)),o.push((0,handleUtils.DQ)(E)),o.push((0,handleUtils.DQ)(S)),B()}(t,o,n),{visualElement:n,remove:()=>(0,handleUtils.a0)(o)}}function originGeometryVisualElementUtils_V(e){return null==e?null:"point"===e.type?e:"mesh"===e.type?e.origin.clone():null}const originGeometryVisualElementUtils_U=(0,vec3f64.vt)(),originGeometryVisualElementUtils_C=(0,aaBoundingBox.vt)();function visualElementUtils_l(l){switch(manipulatedObjectUtils_t(l.object)?.type){case"point":case"mesh":return originGeometryVisualElementUtils_P(l);case"polygon":case"polyline":return lineObjectVisualElementUtils_y(l);default:return null}}const config_o=Math.ceil(70/3*2),config_x=5*Math.PI/12,config_b=1*Math.PI/3;var Handles=__webpack_require__("./node_modules/@arcgis/core/core/Handles.js");class Manipulation_t{constructor(){this._available=!0}set location(a){this._forEachManipulator3D((t=>t.location=a))}set elevationAlignedLocation(a){this._forEachManipulator3D((t=>t.elevationAlignedLocation=a))}set elevationInfo(a){this._forEachManipulator3D((t=>t.elevationInfo=a))}get renderLocation(){let a;return this._forEachManipulator3D((t=>{a||(a=t.renderLocation)})),a}set renderLocation(a){this._forEachManipulator3D((t=>t.renderLocation=a))}get available(){return this._available}set available(a){this._available=a,this._forEachManipulator3D((t=>t.available=a))}get hovering(){return this.someManipulator((a=>a.hovering))}get grabbing(){return this.someManipulator((a=>a.grabbing))}get dragging(){return this.someManipulator((a=>a.dragging))}get selected(){return this.someManipulator((a=>a.selected))}hasManipulator(a){return this.someManipulator((t=>t===a))}someManipulator(a){let t=!1;return this.forEachManipulator((o=>{!t&&a(o)&&(t=!0)})),t}_forEachManipulator3D(t){this.forEachManipulator(((o,e)=>{o instanceof ee&&t(o,e)}))}}class InteractiveManipulation_i extends Manipulation_t{constructor(){super(...arguments),this._interactive=!0}get interactive(){return this._interactive}set interactive(t){this._interactive!==t&&(this._interactive=t),this._updateManipulatorInteractivity()}_updateManipulatorInteractivity(){const t=!this.grabbing&&this._interactive;this.forEachManipulator((i=>{i.interactive=t||i.grabbing}))}}class RenderObject_e{constructor(e,s=interactive_interfaces.p7.None){this.geometry=e,this.stateMask=s}}var dragEventPipeline3D_q,vector=__webpack_require__("./node_modules/@arcgis/core/geometry/support/vector.js"),dragEventPipeline=(__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/lib/Intersector.js"),__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/lib/IntersectorInterfaces.js"),__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/lib/verticalOffsetUtils.js"),__webpack_require__("./node_modules/@arcgis/core/views/interactive/dragEventPipeline.js"));function dragEventPipeline3D_C(e,n){return dragEventPipeline3D_T(e,(()=>n))}function dragEventPipeline3D_T(r,t){const o=(0,vec3f64.vt)(),l=(0,vec3f64.vt)();let s=!1;return c=>{const a=t(c);if("start"===c.action){const t=(0,screenUtils.WA)(c.screenStart,(0,screenUtils.PR)(vectorStacks.oG.get())),l=ray_g(r.state.camera,t,dragEventPipeline3D_Q);null!=l&&(s=(0,plane.Ui)(a,l,o))}if(!s)return null;const i=(0,screenUtils.WA)(c.screenEnd,(0,screenUtils.PR)(vectorStacks.oG.get())),u=ray_g(r.state.camera,i,dragEventPipeline3D_Q);return null==u?null:(0,plane.Ui)(a,u,l)?{...c,renderStart:o,renderEnd:l,plane:a,ray:u}:null}}function dragEventPipeline3D_M(e,n,r,t=null,o=null){return function dragEventPipeline3D_D(e,n,t=0,o=null,l=null){let s=null;return c=>{if("start"===c.action&&(s=e.sceneIntersectionHelper.intersectElevationFromScreen((0,screenUtils.gs)(c.screenStart.x,c.screenStart.y),n,t,l),null!=s&&null!=o&&!(0,geometry_projection.projectPoint)(s,s,o)))return null;if(null==s)return null;const a=e.sceneIntersectionHelper.intersectElevationFromScreen((0,screenUtils.gs)(c.screenEnd.x,c.screenEnd.y),n,t,l);return null==a||null!=o&&!(0,geometry_projection.projectPoint)(a,a,o)?null:{...c,mapStart:s,mapEnd:a}}}(e,r,(0,elevationInfoUtils.id)(n,e,r),t,o)}function dragEventPipeline3D_G(e,n,r){let t=null;const o=new dragEventPipeline.rh;return o.next(dragEventPipeline3D_C(e,function dragEventPipeline3D_h(e,n){const r=dragEventPipeline3D_K,t=dragEventPipeline3D_L,o=(0,plane.vt)();e.renderCoordsHelper.worldUpAtPosition(n,r);const l=(0,vec32.e)((0,plane.Qj)(o),r,(0,vec32.d)(t,n,e.state.camera.eye));return(0,vec32.e)(l,l,r),(0,plane.O_)(n,l,o)}(e,n))).next(function dragEventPipeline3D_k(e,n){const r=(0,vec3f64.vt)(),t=(0,vec32.l)(n);e.renderCoordsHelper.worldUpAtPosition(n,r);const s=(0,vec3f64.vt)(),m=(0,vec3f64.vt)(),d=l=>((0,vec32.d)(l,l,n),(0,vector._I)(r,l,l),"global"===e.viewingMode&&(0,vec32.l)(l)*Math.sign((0,vec32.f)(r,l))<.001-t&&(0,vec32.d)(l,(0,vec32.h)(l,r,.001),n),(0,vec32.g)(l,l,n),l);return e=>(e.renderStart=d((0,vec32.c)(s,e.renderStart)),e.renderEnd=d((0,vec32.c)(m,e.renderEnd)),e)}(e,n)).next(dragEventPipeline3D_F(e,r)).next((e=>{e.mapEnd.x=e.mapStart.x,e.mapEnd.y=e.mapStart.y,t=e})),e=>(t=null,o.execute(e),t)}function dragEventPipeline3D_F(e,n){const r=e.renderCoordsHelper;return e=>{const t=r.fromRenderCoords(e.renderStart,new Point.default({spatialReference:n})),o=r.fromRenderCoords(e.renderEnd,new Point.default({spatialReference:n}));return null!=t&&null!=o?{...e,mapStart:t,mapEnd:o}:null}}!function(e){e[e.GROUND=0]="GROUND",e[e.OTHER=1]="OTHER"}(dragEventPipeline3D_q||(dragEventPipeline3D_q={}));(0,vec2f64.vt)();const dragEventPipeline3D_K=(0,vec3f64.vt)(),dragEventPipeline3D_L=(0,vec3f64.vt)(),dragEventPipeline3D_Q=(0,ray.vt)();function moveUtils_n(n,a,r){const c=(t,e)=>{a({action:t,object:n,dxScreen:e.screenDeltaX,dyScreen:e.screenDeltaY})};return r(((a,r,s)=>(r.next((t=>("start"===t.action&&c("start",t),t))).next((0,dragEventPipeline.Wp)(n)).next((t=>{switch(t.action){case"start":case"update":(t.translationX||t.translationY||t.translationZ)&&c("update",t);break;case"end":c("end",t)}return t})),{steps:r,cancel:s=s.next((0,dragEventPipeline.dp)(n)).next((t=>(c("end",{screenDeltaX:0,screenDeltaY:0}),t)))})))}function moveUtils_a(t){if(null==t?.axis)return 1;const{mapStart:e,mapEnd:n,axis:a}=t,r=[n.x-e.x,n.y-e.y];return r[0]*a[0]+r[1]*a[1]>0?1:-1}class MoveXYAxisManipulation_C extends Manipulation_t{constructor(t){super(),this._handles=new Handles.A,this._arrowManipulatorInfos=new Array,this._angle=0,this._scale=1,this._radius=70,this._updateAfterDrag=!1,this.events=new Evented.A,this._tool=t.tool,this._view=t.view,this._opaqueMaterial=this._createMaterial(),this._transparentMaterial=this._createMaterial(.5),null!=t.radius&&(this._radius=t.radius),this._createManipulators(),this.forEachManipulator((t=>this._tool.manipulators.add(t)))}set orthogonalAvailable(t){this._arrowManipulatorInfos.length>=3&&(this._arrowManipulatorInfos[1].manipulator.available=t,this._arrowManipulatorInfos[3].manipulator.available=t)}destroy(){this._handles=(0,maybe.pR)(this._handles),this.forEachManipulator((t=>{this._tool.manipulators.remove(t),t.destroy()})),this._tool=null,this._view=null,this._arrowManipulatorInfos.length=0}forEachManipulator(t){for(const{manipulator:r}of this._arrowManipulatorInfos)t(r,ManipulatorType_A.TRANSLATE_XY)}createManipulatedObjectDragPipeline(t,r,a){if(!r.operations)return(0,handleUtils.hA)();const i=r.operations.data.spatialReference,o=r.graphic;return moveUtils_n(r,a,(a=>this.createDragPipeline(((r,e,i,o,s)=>(({steps:e,cancel:i}=t(r,e,i,o,s)),a(r,e,i))),r.elevationInfo,i,o)))}createDragPipeline(t,r,a,e){return(0,handleUtils.vE)(this._arrowManipulatorInfos.map((({manipulator:i},o)=>(0,dragEventPipeline.Xt)(i,((i,s,n,l,p)=>{const u=s.next((t=>({...t,manipulatorType:ManipulatorType_A.TRANSLATE_XY}))).next((0,dragEventPipeline.Tp)(this._view,i.elevationAlignedLocation)).next(dragEventPipeline3D_M(this._view,i.elevationAlignedLocation,r,a,e)).next((0,dragEventPipeline.an)(i.location,this.angle+(o+1)*Math.PI*.5)).next((0,dragEventPipeline.sO)());t(i,u,n,l,p)})))))}get angle(){return this._angle}set angle(t){this._angle=t,this.dragging?this._updateAfterDrag=!0:this._updateManipulatorTransform()}get displayScale(){return this._scale}set displayScale(t){this._scale=t,this._updateManipulatorTransform()}get radius(){return this._radius}set radius(t){this._radius!==t&&(this._radius=t,this._updateManipulators())}_updateManipulators(){for(let t=0;t<this._arrowManipulatorInfos.length;t++)this._updateArrowManipulator(this._arrowManipulatorInfos[t],t);this._updateManipulatorTransform()}_updateArrowManipulator({manipulator:t,transform:r},a){const e=this._radius/70,i=54*e,o=i*Math.sqrt(3)/2,s=(0,GeometryUtil._B)(this._opaqueMaterial,o,i/2,i/2,.02);(0,GeometryUtil.xh)(s,(0,mat4.kN)(vectorStacks.Rc.get(),(0,vec32.i)(vectorStacks.rq.get(),0,-o/3,0))),t.renderObjects=[new RenderObject_e(s,interactive_interfaces.p7.Focused),new RenderObject_e(s.instantiate({material:this._transparentMaterial}),interactive_interfaces.p7.Unfocused)],t.radius=o/3*2*1.2;const n=(0,mat4.N9)(vectorStacks.Rc.get(),a*Math.PI/2),h=(0,mat4.kN)(vectorStacks.Rc.get(),(0,vec32.i)(vectorStacks.rq.get(),0,100*e,0));(0,mat4.lw)(r,n,h)}_createManipulators(){for(let t=0;t<4;t++){const r=this._createArrowManipulator(t);this._arrowManipulatorInfos.push(r)}this._updateManipulatorTransform()}_updateManipulatorTransform(){const t=this.angle,r=(0,mat4.$0)(vectorStacks.Rc.get(),t,(0,vec3f64.fA)(0,0,1));if(null==r)return;const a=(0,mat4.CV)(vectorStacks.Rc.get(),(0,vec32.i)(vectorStacks.rq.get(),this.displayScale,this.displayScale,this.displayScale)),e=(0,mat4.lw)(vectorStacks.Rc.get(),a,r);for(const i of this._arrowManipulatorInfos){const t=(0,mat4.lw)(vectorStacks.Rc.get(),e,i.transform);i.manipulator.modelTransform=t}}_createArrowManipulator(t){const r=new ee({view:this._view,autoScaleRenderObjects:!1,worldOriented:!0,focusMultiplier:1,touchMultiplier:1,collisionType:{type:"disc",direction:(0,vec3f64.fA)(0,0,1)}}),a={manipulator:r,transform:(0,mat4f64.vt)()};return this._updateArrowManipulator(a,t),this._handles.add(r.events.on("drag",(t=>{this._updateAfterDrag&&"end"===t.action&&!this.dragging&&(this._updateManipulatorTransform(),this._updateAfterDrag=!1)}))),a}_createMaterial(r=1){const a=new ColorMaterial.v({cullFace:basicInterfaces.s2.Back,renderOccluded:Material.m$.Transparent,isDecoration:!0});return this._handles.add((0,reactiveUtils.watch)((()=>Color.A.toUnitRGBA(this._view.effectiveTheme.accentColor)),(t=>{t[3]*=r,a.setParameters({color:t})}),reactiveUtils.Vh)),a}get test(){}}class SnapToScene_e{constructor(){this._view=null,this._elevationInfo=null,this._lastDragEvent=null,this._next=null,this._enabled=!1}get enabled(){return this._enabled}set enabled(t){if(this._enabled!==t&&null!=this._lastDragEvent&&null!=this._next){const n=this._lastDragEvent.mapEnd,e=this._snap(this._lastDragEvent.screenEnd);if(null!=e){const s={action:"update",mapStart:this._lastDragEvent.mapStart,mapEnd:!0===t?e:n,screenStart:this._lastDragEvent.screenEnd,screenEnd:this._lastDragEvent.screenEnd};this._next.execute(s)}}this._enabled=t}_snap(n){const e=null!=this._view?this._view.toMap(n,{exclude:[]}):null;return null!=e&&null!=this._view&&(e.z=(0,elevationInfoUtils.id)(e,this._view,this._elevationInfo)),e}createDragEventPipelineStep(t,e){this._view=t,this._elevationInfo=e,this._lastDragEvent=null;const s=new dragEventPipeline.rh;return this._next=s,[t=>{if(this._lastDragEvent="end"!==t.action?{...t}:null,this._enabled){const n=this._snap(t.screenEnd);return null!=n?{action:t.action,mapStart:t.mapStart,mapEnd:n,screenStart:t.screenStart,screenEnd:t.screenEnd}:null}return{action:t.action,mapStart:t.mapStart,mapEnd:t.mapEnd,screenStart:t.screenStart,screenEnd:t.screenEnd}},s]}}class MoveXYDiscManipulation_O extends Manipulation_t{constructor(t){super(),this._handles=new Handles.A,this._snapToScene=new SnapToScene_e,this._scale=1,this._radius=70,this._view=t.view,this._tool=t.tool,this._discMaterial=this._createMaterial(),this._discMaterialTransparent=this._createMaterial(.5),null!=t.snapToScene&&(this.snapToScene=t.snapToScene),null!=t.radius&&(this._radius=t.radius),this._createManipulator(),this.forEachManipulator((t=>this._tool.manipulators.add(t)))}destroy(){this._handles=(0,maybe.pR)(this._handles),this.forEachManipulator((t=>{this._tool.manipulators.remove(t),t.destroy()})),this._tool=null,this._view=null,this._manipulator=null}forEachManipulator(t){t(this._manipulator,ManipulatorType_A.TRANSLATE_XY)}get displayScale(){return this._scale}set displayScale(t){this._scale=t,this._updateManipulatorTransform()}get snapToScene(){return this._snapToScene.enabled}set snapToScene(t){this._snapToScene.enabled=t}get radius(){return this._radius}set radius(t){t!==this._radius&&(this._radius=t,this._updateManipulator())}get discManipulator(){return this._manipulator}createManipulatedObjectDragPipeline(t,e,a){if(!e.operations)return(0,handleUtils.hA)();const r=e.graphic,s=e.elevationInfo,o=e.operations.data.spatialReference;return moveUtils_n(e,a,(e=>this.createDragPipeline(((i,a,r,s,o)=>(({steps:a,cancel:r}=t(i,a,r,s,o)),e(i,a,r))),s,o,r)))}createDragPipeline(t,e,i,a){const r=this._view;return(0,dragEventPipeline.Xt)(this._manipulator,((s,o,n,l,p)=>{const c=o.next((0,dragEventPipeline.Tp)(r,s.elevationAlignedLocation)).next(dragEventPipeline3D_M(r,s.elevationAlignedLocation,e,i,a)).next(...this._snapToScene.createDragEventPipelineStep(r,e)).next((t=>({...t,manipulatorType:ManipulatorType_A.TRANSLATE_XY}))).next((0,dragEventPipeline.sO)());t(s,c,n,l,p)}))}_updateManipulatorTransform(){const t=(0,mat4.CV)(vectorStacks.Rc.get(),(0,vec32.i)(vectorStacks.rq.get(),this.displayScale,this.displayScale,this.displayScale));this._manipulator.modelTransform=t}_createManipulator(){const t=this._view;this._manipulator=new ee({view:t,worldSized:!1,autoScaleRenderObjects:!1,focusMultiplier:1,touchMultiplier:1,collisionType:{type:"disc",direction:(0,vec3f64.fA)(0,0,1)},worldOriented:!0}),this._updateManipulator()}_updateManipulator(){const t=(0,GeometryUtil.nW)(this._discMaterial,.02,1,128,(0,vec3f64.fA)(0,0,1),(0,vec3f64.fA)(0,0,0));t.transformation=(0,mat4.CV)((0,mat4f64.vt)(),(0,vec3f64.fA)(this._radius,this._radius,this._radius)),this._manipulator.renderObjects=[new RenderObject_e(t,interactive_interfaces.p7.Focused),new RenderObject_e(t.instantiate({material:this._discMaterialTransparent}),interactive_interfaces.p7.Unfocused)],this._manipulator.radius=this._radius/70*80}_createMaterial(e=1){const i=new ColorMaterial.v({cullFace:basicInterfaces.s2.Back,renderOccluded:Material.m$.Transparent,isDecoration:!0});return this._handles.add((0,reactiveUtils.watch)((()=>Color.A.toUnitRGBA(this._view.effectiveTheme.accentColor)),(t=>{t[3]*=e,i.setParameters({color:t})}),reactiveUtils.Vh)),i}get test(){}}var graphicUtils=__webpack_require__("./node_modules/@arcgis/core/views/3d/layers/graphics/graphicUtils.js");function manipulatorUtils_f(t,r=Material.m$.OccludeAndTransparent,o=!0){const n=(0,colorUtils.pf)(t),i=!(t[3]<1);return o?new ShadedColorMaterial_x({color:n,writeDepth:i,cullFace:basicInterfaces.s2.Back,renderOccluded:r,isDecoration:!0}):new ColorMaterial.v({color:n,writeDepth:i,cullFace:basicInterfaces.s2.Back,renderOccluded:r,isDecoration:!0})}function manipulatorUtils_h(t,r=Material.m$.OccludeAndTransparent){const o=(0,colorUtils.pf)(t);return new ColorMaterial.v({color:o,writeDepth:!0,cullFace:basicInterfaces.s2.Front,renderOccluded:r,isDecoration:!0})}const manipulatorUtils_j=Object.freeze({calloutLength:40,calloutWidth:1,discRadius:27,focusMultiplier:1.1}),manipulatorUtils_b=Object.freeze({autoScaleRenderObjects:!1,worldSized:!0});function manipulatorUtils_w(e,i,a,s){const u=(0,vec32.d)(vectorStacks.rq.get(),e,a),m=manipulatorUtils_O(u,(0,vec32.e)(vectorStacks.rq.get(),s,u),a,vectorStacks.Rc.get());(0,mat4.B8)(m,m);const p=(0,vec32.t)(vectorStacks.rq.get(),i,m);return Math.atan2(p[1],p[0])}function manipulatorUtils_O(e,t,r,n){const l=(0,vec32.n)(vectorStacks.rq.get(),e),a=(0,vec32.n)(vectorStacks.rq.get(),t),s=(0,vec32.e)(vectorStacks.rq.get(),l,a);return n[0]=l[0],n[1]=l[1],n[2]=l[2],n[3]=0,n[4]=a[0],n[5]=a[1],n[6]=a[2],n[7]=0,n[8]=s[0],n[9]=s[1],n[10]=s[2],n[11]=0,n[12]=r[0],n[13]=r[1],n[14]=r[2],n[15]=1,n}function manipulatorUtils_F(e,t){const r=t.origin;null==r?function manipulatorUtils_y(e,t){if(null==t)return;const r="mesh"===t.type?t.origin:(0,graphicUtils.W$)(t);null!=r&&(e.location=(0,hydratedFeatures.wZ)(r))}(e,manipulatedObjectUtils_t(t)):e.elevationAlignedLocation=r}class MoveZManipulation_R extends Manipulation_t{constructor(t){super(),this._radius=70,this.events=new Evented.A,this._tool=t.tool,this._view=t.view;const e=new settings_j({getTheme:()=>this._view.effectiveTheme});this._settings=e,null!=t.radius&&(this._radius=t.radius);const r=this._view.effectiveTheme.accentColor;this._materials={materialUnfocused:manipulatorUtils_f(MoveZManipulation_C(r,1,.25),Material.m$.Occlude),materialFocused:manipulatorUtils_f(MoveZManipulation_C(r,1,0),Material.m$.Occlude),materialOccludedUnfocused:manipulatorUtils_f(MoveZManipulation_C(r,.7,0),e.zManipulator.renderOccluded),materialOccludedFocused:manipulatorUtils_f(MoveZManipulation_C(r,.85,0),e.zManipulator.renderOccluded)},this._themeHandle=(0,reactiveUtils.watch)((()=>this._view.effectiveTheme.accentColor),(t=>{const e=MoveZManipulation_C(t,1,.25),i=MoveZManipulation_C(t,1,0),r=MoveZManipulation_C(t,.7,0),a=MoveZManipulation_C(t,.85,0),{materialUnfocused:o,materialFocused:s,materialOccludedUnfocused:n,materialOccludedFocused:l}=this._materials;o.setParameters({color:e}),s.setParameters({color:i}),n.setParameters({color:r}),l.setParameters({color:a})})),this._createManipulator(),this.forEachManipulator((t=>this._tool.manipulators.add(t)))}destroy(){this._themeHandle=(0,maybe.xt)(this._themeHandle),this._manipulator.applyObjectTransform=MoveZManipulation_L,this.forEachManipulator((t=>{this._tool.manipulators.remove(t),t.destroy()}))}forEachManipulator(t){t(this._manipulator,ManipulatorType_A.TRANSLATE_Z)}createManipulatedObjectDragPipeline(t,e,i){if(!e.operations)return(0,handleUtils.hA)();const a=e.operations.data.spatialReference;return moveUtils_n(e,i,(e=>this.createDragPipeline(((i,r,a,o,s)=>(({steps:r,cancel:a}=t(i,r,a,o,s)),e(i,r,a))),a)))}createDragPipeline(t,e){const i=this._view;return(0,dragEventPipeline.Xt)(this._manipulator,((r,a,o,s,n)=>{const l=a.next((t=>({...t,manipulatorType:ManipulatorType_A.TRANSLATE_Z}))).next(dragEventPipeline3D_G(i,r.renderLocation,e)).next((0,dragEventPipeline.sO)());t(r,l,o,s,n)}))}get radius(){return this._radius}set radius(t){t!==this._radius&&(this._radius=t,this._updateManipulator())}_updateManipulator(){const t=this._settings,e=this._radius/70,i=t.zManipulator.height*e,r=t.zManipulator.coneHeight*e,a=t.zManipulator.coneWidth*e,o=t.zManipulator.width*e,s=[(0,vec3f64.fA)(0,0,0),(0,vec3f64.fA)(0,0,i)],m=[(0,vec3f64.fA)(0,0,0),(0,vec3f64.fA)(0,0,i+r)],d=(()=>{const t=(0,mat4f64.vt)();return(0,mat4.Tl)(t,t,[0,0,i]),(0,mat4.eL)(t,t,Math.PI/2),t})(),{materialUnfocused:u,materialFocused:p,materialOccludedUnfocused:h,materialOccludedFocused:f}=this._materials,_=(0,GeometryUtil.Nb)(u,s,o/2,16,!1),w=(0,GeometryUtil.EE)(u,r,a/2,16,!1);w.transformation=d,this._manipulator.renderObjects=[new RenderObject_e(w,interactive_interfaces.p7.Unfocused),new RenderObject_e(_,interactive_interfaces.p7.Unfocused),new RenderObject_e(w.instantiate({material:p}),interactive_interfaces.p7.Focused),new RenderObject_e(_.instantiate({material:p}),interactive_interfaces.p7.Focused),new RenderObject_e(w.instantiate({material:h}),interactive_interfaces.p7.Unfocused),new RenderObject_e(_.instantiate({material:h}),interactive_interfaces.p7.Unfocused),new RenderObject_e(w.instantiate({material:f}),interactive_interfaces.p7.Focused),new RenderObject_e(_.instantiate({material:f}),interactive_interfaces.p7.Focused)],this._manipulator.radius=o/2+2,this._manipulator.collisionType={type:"line",paths:[m]}}_createManipulator(){const t=this._view,e=new ee({view:t,autoScaleRenderObjects:!1,worldSized:!1,selectable:!1,cursor:"ns-resize",elevationInfo:this.elevationInfo,worldOriented:!0,collisionPriority:1.6});e.applyObjectTransform=e=>{const i=t.state.camera,r=MoveZManipulation_D;t.renderCoordsHelper.toRenderCoords(this._manipulator.elevationAlignedLocation,r);const o=(0,vec32.G)(i.eye,r),s=i.computeRenderPixelSizeAtDist(o),n=(0,vec32.d)(MoveZManipulation_H,r,i.eye);(0,vec32.n)(n,n);const l=MoveZManipulation_S;t.renderCoordsHelper.worldUpAtPosition(MoveZManipulation_D,l);const c=Math.abs((0,vec32.f)(n,l)),_=(0,vec32.e)(MoveZManipulation_H,n,l),j=(0,vec32.e)(MoveZManipulation_H,_,l),w=(0,mathUtils.qE)(c,.01,1),v=1-Math.sqrt(1-w*w)/w/i.fullWidth,g=this._settings,M=this._radius/70,U=g.zManipulator.width*M;(0,vec32.h)(j,(0,vec32.n)(j,j),(1/v-1)*o+s*U),e[12]-=MoveZManipulation_H[0],e[13]-=MoveZManipulation_H[1],e[14]-=MoveZManipulation_H[2]},this._manipulator=e,this._updateManipulator()}get test(){}}function MoveZManipulation_C(i,r,a){const o=(0,colorUtils.e$)(i,a);return o.a*=r,Color.A.toUnitRGBA(o)}const MoveZManipulation_D=(0,vec3f64.vt)(),MoveZManipulation_H=(0,vec3f64.vt)(),MoveZManipulation_S=(0,vec3f64.vt)(),MoveZManipulation_L=()=>{};class MoveManipulation_u extends InteractiveManipulation_i{constructor(a){super(),this._handles=new Handles.A;const{tool:t,view:n,snapToScene:e,radius:s}=a;this._view=n,this.xyManipulation=new MoveXYDiscManipulation_O({tool:t,view:n,snapToScene:e,radius:s}),this.xyAxisManipulation=new MoveXYAxisManipulation_C({tool:t,view:n,radius:s}),this.zManipulation=new MoveZManipulation_R({tool:t,view:n,radius:s}),this.xyManipulation.available=a.xyAvailable,this.xyAxisManipulation.available=a.xyAxisAvailable,this.zManipulation.available=a.zAvailable,this._autoHideXYAxis(),this.forEachManipulator((i=>this._handles.add(i.events.on("grab-changed",(()=>this._updateManipulatorInteractivity())))))}destroy(){this._handles.destroy(),this.xyManipulation.destroy(),this.xyAxisManipulation.destroy(),this.zManipulation.destroy()}createManipulatedObjectDragPipeline(i,t,n){return(0,handleUtils.vE)([this.xyManipulation.createManipulatedObjectDragPipeline(((a,t,n,e,s)=>i(MoveManipulation_c.XY,a,t,n,e,s)),t,n),this.xyAxisManipulation.createManipulatedObjectDragPipeline(((a,t,n,e,s)=>i(MoveManipulation_c.XY_AXIS,a,t,n,e,s)),t,n),this.zManipulation.createManipulatedObjectDragPipeline(((a,t,n,e,s)=>i(MoveManipulation_c.Z,a,t,n,e,s)),t,n)])}createDragPipeline(i,t,n,e){return(0,handleUtils.vE)([this.xyManipulation.createDragPipeline(((a,t,n,e,s)=>i(MoveManipulation_c.XY,a,t,n,e,s)),t,n,e),this.xyAxisManipulation.createDragPipeline(((a,t,n,e,s)=>i(MoveManipulation_c.XY_AXIS,a,t,n,e,s)),t,n,e),this.zManipulation.createDragPipeline(((a,t,n,e,s)=>i(MoveManipulation_c.Z,a,t,n,e,s)),n)])}set snapToScene(i){this.xyManipulation.snapToScene=i}set angle(i){this.xyAxisManipulation.angle=i}set radius(i){this.xyAxisManipulation.radius=i,this.xyManipulation.radius=i,this.zManipulation.radius=i}set displayScale(i){this.xyManipulation.displayScale=i,this.xyAxisManipulation.displayScale=i}forEachManipulator(i){this.xyManipulation.forEachManipulator((a=>i(a,ManipulatorType_A.TRANSLATE_XY))),this.xyAxisManipulation.forEachManipulator((a=>i(a,ManipulatorType_A.TRANSLATE_XY))),this.zManipulation.forEachManipulator((a=>i(a,ManipulatorType_A.TRANSLATE_Z)))}get _xyAxisVisible(){const i=this.xyManipulation.someManipulator((i=>i.focused))||this.xyAxisManipulation.someManipulator((i=>i.focused));return this._view.inputManager&&"touch"===this._view.inputManager.latestPointerType||i}_autoHideXYAxis(){const i=this.xyAxisManipulation,a=this.xyManipulation;if((0,has.A)("esri-mobile"))return;const n=[];a.forEachManipulator((i=>n.push(i))),i.forEachManipulator((i=>n.push(i)));const e=()=>{const a=[];this._xyAxisVisible||i.forEachManipulator((i=>a.push(i.disableDisplay()))),this._handles.remove(MoveManipulation_h),this._handles.add(a,MoveManipulation_h)};for(const t of n)this._handles.add(t.events.on("focus-changed",e));this._view.inputManager&&this._handles.add((0,reactiveUtils.when)((()=>this._view.inputManager?.latestPointerType),e)),e()}static radiusForSymbol(i){const a=null!=i&&"point-3d"===i.type&&i.symbolLayers;return a&&a.some((i=>"icon"===i.type))?config_o:70}}const MoveManipulation_h="disable-xy-axis-display";var MoveManipulation_c;!function(i){i[i.XY=0]="XY",i[i.XY_AXIS=1]="XY_AXIS",i[i.Z=2]="Z"}(MoveManipulation_c||(MoveManipulation_c={}));class MoveXYObjectManipulation_l extends Manipulation_t{constructor(t){super(),this._view=t.view,this._tool=t.tool,this._object=t.object,this._manipulator=this._object.createManipulator?.({selectable:!0,cursor:"move"}),this.forEachManipulator((t=>this._tool.manipulators.add(t)))}destroy(){this.forEachManipulator((t=>{this._tool.manipulators.remove(t),t.destroy()})),this._tool=null,this._view=null,this._manipulator=null}forEachManipulator(t){this._manipulator&&t(this._manipulator,ManipulatorType_A.TRANSLATE_XY)}createManipulatedObjectDragPipeline(t){return moveUtils_n(this._object,t,(t=>this.createDragPipeline(t)))}createDragPipeline(e){if(!this._manipulator)return(0,handleUtils.hA)();const o=this._view;return(0,dragEventPipeline.Xt)(this._manipulator,((t,r,a,l,p)=>{const h=this._object.operations?.data.spatialReference,u=r.next((t=>h?t:null)).next(function dragEventPipeline3D_N(e,n,r,t){const o=r.toMap(e.screenStart);return null!=o?dragEventPipeline3D_M(n,o,r.elevationInfo,t):null}(p,o,this._object,h)).next((0,dragEventPipeline.EX)()).next((0,dragEventPipeline.sO)());e(t,u,a,l,p)}))}}var isSupportedObject=__webpack_require__("./node_modules/@arcgis/core/views/3d/interactive/editingTools/move/isSupportedObject.js"),InteractiveToolBase=__webpack_require__("./node_modules/@arcgis/core/views/interactive/InteractiveToolBase.js"),EditGeometryOperations=__webpack_require__("./node_modules/@arcgis/core/views/interactive/editGeometry/EditGeometryOperations.js"),SketchOptions=__webpack_require__("./node_modules/@arcgis/core/views/interactive/sketch/SketchOptions.js"),SnappingContext=__webpack_require__("./node_modules/@arcgis/core/views/interactive/snapping/SnappingContext.js"),SnappingDragPipelineStep=__webpack_require__("./node_modules/@arcgis/core/views/interactive/snapping/SnappingDragPipelineStep.js"),MovePointTooltipInfo=__webpack_require__("./node_modules/@arcgis/core/views/interactive/tooltip/infos/MovePointTooltipInfo.js"),TranslateTooltipInfo=__webpack_require__("./node_modules/@arcgis/core/views/interactive/tooltip/infos/TranslateTooltipInfo.js"),SketchTooltipInfo=__webpack_require__("./node_modules/@arcgis/core/views/interactive/tooltip/infos/SketchTooltipInfo.js");let TranslateXYTooltipInfo_i=class extends SketchTooltipInfo.w{constructor(o){super(o),this.type="translate-xy",this.distance=quantityUtils.r7}};(0,tslib_es6._)([(0,property.MZ)()],TranslateXYTooltipInfo_i.prototype,"type",void 0),(0,tslib_es6._)([(0,property.MZ)()],TranslateXYTooltipInfo_i.prototype,"distance",void 0),TranslateXYTooltipInfo_i=(0,tslib_es6._)([(0,subclass.$)("esri.views.interactive.tooltip.infos.TranslateXYTooltipInfo")],TranslateXYTooltipInfo_i);let TranslateZTooltipInfo_i=class extends SketchTooltipInfo.w{constructor(o){super(o),this.type="translate-z",this.distance=quantityUtils.r7}clear(){this.distance=quantityUtils.r7}};(0,tslib_es6._)([(0,property.MZ)()],TranslateZTooltipInfo_i.prototype,"type",void 0),(0,tslib_es6._)([(0,property.MZ)()],TranslateZTooltipInfo_i.prototype,"distance",void 0),TranslateZTooltipInfo_i=(0,tslib_es6._)([(0,subclass.$)("esri.views.interactive.tooltip.infos.TranslateZTooltipInfo")],TranslateZTooltipInfo_i);class MoveTool3D_L{constructor(t){this.objects=t,this.type="move-start"}}class MoveTool3D_B{constructor(t,o,e){this.dx=t,this.dy=o,this.objects=e,this.type="move"}}class MoveTool3D_N{constructor(t){this.objects=t,this.type="move-stop"}}const MoveTool3D_q=Symbol("manipulators"),MoveTool3D_J=Symbol("tooltips");let MoveTool3D_K=class extends InteractiveToolBase.g{constructor(t){super(t),this._infos=new Map,this.events=new Evented.A,this.objects=new Collection.A,this.enableZ=!0,this.sketchOptions=new SketchOptions.A,this.type="move-3d",this._latestTooltipInfo=null,this._translateTooltipInfo=null,this._translateXYTooltipInfo=null,this._translateZTooltipInfo=null,this._updatingHandles=new UpdatingHandles.U,this._moveManipulation=null}initialize(){const{view:t}=this;this.tooltip=(0,tooltipCommonUtils.A)((()=>({view:t,options:this.sketchOptions.tooltips}))),this.addHandles([this.objects.on("change",(t=>{t.removed.forEach((t=>this.removeHandles(t))),this._updateObjectInfos(t),this._setupFastTransformUpdates(t.added),this._refreshManipulators()})),this.objects.on("change",(()=>this._connectTooltips()))]);const o=this.objects.toArray();this._updateObjectInfos({added:o,removed:[]}),this._setupFastTransformUpdates(o),this._refreshManipulators(),this._connectTooltips(),this.finishToolCreation()}destroy(){this.tooltip=(0,maybe.pR)(this.tooltip),this._moveManipulation=(0,maybe.pR)(this._moveManipulation),this._set("view",null),this._updatingHandles.destroy()}onInputEvent(t){if(!this.destroyed&&!(0,tooltipCommonUtils.wG)(t,this.tooltip))return super.onInputEvent(t)}get updating(){return this._updatingHandles.updating}get _shouldShowMovePointTooltip(){const{objects:t}=this;if(1!==t.length)return!1;const o=manipulatedObjectUtils_t(t.at(0))?.type;return"point"===o||"mesh"===o}get activeTooltipInfo(){return this._shouldShowMovePointTooltip?this._movePointTooltipInfo:this._latestTooltipInfo}reset(){}_updateObjectInfos({added:t,removed:o}){for(const e of t){if((0,isSupportedObject.Y)(e)!==isSupportedObjectUtils.d.SUPPORTED)continue;const t=new MoveTool3D_Q(e);this._infos.set(e,t)}for(const e of o)this._infos.delete(e)}_setupFastTransformUpdates(t){for(const o of t){const t=this._infos.get(o);this.addHandles(meshFastUpdateUtils_a(t.object),o)}}_refreshManipulators(){if(this.removeHandles(MoveTool3D_q),this._moveManipulation=(0,maybe.pR)(this._moveManipulation),this.manipulators.removeAll(),0===this._infos.size)return;const t=Array.from(this._infos.values());this._createManipulators(t),this._createVisualElements(t),this._updateMoveManipulation(t)}_createManipulators(t){for(const o of t){const e=o.object;o.manipulationXY=new MoveXYObjectManipulation_l({tool:this,view:this.view,object:e}),o.manipulationXY.forEachManipulator((t=>{this.addHandles([t.events.on("immediate-click",(t=>{this.events.emit("immediate-click",{...t,object:e}),t.stopPropagation()})),t.events.on("grab-changed",(({action:t})=>{"start"===t?this._showTooltip(MoveManipulation_c.XY):this._hideTooltip()}))],MoveTool3D_q)})),this.addHandles(o.manipulationXY.createDragPipeline(((o,e,i,n)=>this._buildDragEventPipeline(t,MoveManipulation_c.XY,o,e,i,n))),MoveTool3D_q)}this._createMoveManipulation(t)}_createMoveManipulation(t){const o=new MoveManipulation_u({tool:this,view:this.view,snapToScene:!1,xyAvailable:!0,xyAxisAvailable:!0,zAvailable:!0,radius:1===t.length?MoveManipulation_u.radiusForSymbol(t[0].object.graphic?.symbol):70});this._moveManipulation=o,o.elevationInfo={mode:"absolute-height",offset:0},o.forEachManipulator((t=>{this.addHandles(t.events.on("immediate-click",(e=>{const i=this.objects.at(0);!o.zManipulation.hasManipulator(t)&&1===this.objects.length&&i&&this.events.emit("immediate-click",{...e,object:i}),e.stopPropagation()})),MoveTool3D_q)}));const e=t=>o=>{this.addHandles([o.events.on("focus-changed",(({action:o})=>{"focus"===o?this._showTooltip(t):this._hideTooltip()})),o.events.on("grab-changed",(()=>{this._latestTooltipInfo&&(this._latestTooltipInfo.distance=quantityUtils.r7)}))],MoveTool3D_q)};this._moveManipulation.xyManipulation.forEachManipulator(e(MoveManipulation_c.XY)),this._moveManipulation.xyAxisManipulation.forEachManipulator(e(MoveManipulation_c.XY_AXIS)),this._moveManipulation.zManipulation.forEachManipulator(e(MoveManipulation_c.Z));const i=()=>this._updateMoveManipulation(t);for(const a of t)this.addHandles([a.object.on("committed",i),(0,reactiveUtils.watch)((()=>a.object.visible),i)],MoveTool3D_q);const n=t[t.length-1];this.addHandles(n.object.on("committed",(()=>this._updateMoveManipulationAngle(n))),MoveTool3D_q);const{object:s}=n,{operations:l}=s;if(l){const e=s.graphic;this.addHandles(o.createDragPipeline(((o,e,i,n,s)=>this._buildDragEventPipeline(t,o,e,i,n,s)),s.elevationInfo,l.data.spatialReference,e),MoveTool3D_q)}this._updateMoveManipulationAngle(n)}_createVisualElements(t){for(const o of t){const e=o.object,i=visualElementUtils_l({view:this.view,object:e,forEachManipulator:t=>{o.manipulationXY?.forEachManipulator(t),this._moveManipulation?.forEachManipulator(t)},onManipulatorsChanged:()=>(0,handleUtils.hA)()});null!=i&&(o.geometryRepresentation=i.visualElement,o.geometryRepresentation instanceof OutlineVisualElement_j&&this.addHandles([o.geometryRepresentation.events.on("attachment-origin-changed",(()=>{o.object.isDraped||this._updateMoveManipulation(t)})),(0,reactiveUtils.watch)((()=>o.object.isDraped),(()=>this._updateMoveManipulation(t)))],MoveTool3D_q),this.addHandles(i,MoveTool3D_q))}}_updateMoveManipulationAngle(t){this._moveManipulation&&(this._moveManipulation.angle=geometryUtils_r(manipulatedObjectUtils_t(t.object)))}_updateMoveManipulation(t){const o=(0,dehydratedPoint.T)(0,0,0,this.view.spatialReference);let e=0,i=!1;const n=this._moveManipulation;if(n){for(const n of t){if(!n.object.visible)continue;this.enableZ&&manipulatorUtils_o(n.object.operations,n.object.elevationInfo)&&(i=!0);const t=n.geometryRepresentation instanceof OutlineVisualElement_j&&!n.object.isDraped?n.geometryRepresentation.attachmentOrigin:n.object.origin;if(null!=t){const{x:i,y:n,z:s}=t;o.x+=i,o.y+=n,s&&(o.z??=0,o.z+=s),e++}}e>0?(o.x/=e,o.y/=e,o.z??=0,o.z/=e,n.location=o,n.xyManipulation.available=!0,n.xyAxisManipulation.available=!0,n.zManipulation.available=i):n.available=!1}}_buildDragEventPipeline(t,o,e,i,n,s){const a=[],l=[];let r=null,p=null;const c=()=>{for(const t of a)t.dragging=!1;a.length=0,l.length=0,r=null,p=null,this._moveManipulation&&(this._moveManipulation.interactive=!0)};if(1===t.length&&o===MoveManipulation_c.XY){const o=t[0].object;({steps:i,cancel:n}=this._buildSnappingPipelineSteps(o,o.elevationInfo,i,n,s))}return n=n.next((t=>p?.(t))).next((()=>(l.length&&this.events.emit("move-stop",new MoveTool3D_N(l)),this.destroyed||c(),null))),{steps:i=i.next((o=>{if("start"===o.action){a.length=0,l.length=0;for(const o of t)o.dragging||!o.manipulationXY?.hasManipulator(e)&&o.manipulationXY?.grabbing||(a.push(o),l.push(o.object),o.dragging=!0);if(0!==l.length&&(this._moveManipulation&&(this._moveManipulation.interactive=!1),r=(0,dragEventPipeline.bl)(l),p=(0,dragEventPipeline.mc)(l),this._emitRecordUndo(),this.events.emit("move-start",new MoveTool3D_L(l)),this.destroyed))return null}return 0!==l.length?o:null})).next((t=>r?.(t))).next((t=>(this._updateMoveTooltip(o,t),t))).next((t=>{switch(t.action){case"start":case"update":if(t.translationX||t.translationY||t.translationZ){const o=this.view.toScreen(t.mapStart),e=this.view.toScreen(t.mapEnd);if(!o||!e)return null;const i=e.x-o.x,n=e.y-o.y;if(this.events.emit("move",new MoveTool3D_B(i,n,l)),this.destroyed)return null}break;case"end":if(this.events.emit("move-stop",new MoveTool3D_N(l)),this.destroyed)return null;c()}return null})),cancel:n}}_connectTooltips(){let t;if(this.removeHandles(MoveTool3D_J),this._shouldShowMovePointTooltip){const o=this.objects.at(0),{events:e}=this;this._movePointTooltipInfo??=new MovePointTooltipInfo.F({viewType:this.view.type,sketchOptions:this.sketchOptions});const i={onBeforeUpdate:()=>this.endDrag(),onMoveStart:()=>{this._emitRecordUndo(),e.emit("move-start",new MoveTool3D_L([o]))},onMove:()=>e.emit("move",new MoveTool3D_B(0,0,[o])),onMoveStop:()=>e.emit("move-stop",new MoveTool3D_N([o])),onRotateStart:()=>{},onRotate:()=>{},onRotateStop:()=>{},onScaleStart:()=>{},onScale:()=>{},onScaleStop:()=>{}};t=tooltipUtils3D_m(this.tooltip,o,(()=>({sketchOptions:this.sketchOptions,activeTooltipInfo:this._movePointTooltipInfo,callbacks:i})))}else t=(0,reactiveUtils.watch)((()=>this.sketchOptions.tooltips.effectiveEnabled?this._latestTooltipInfo:null),(t=>{this.tooltip.info=t}),reactiveUtils.pc);this.addHandles(t,MoveTool3D_J)}_showTooltip(t){this._shouldShowMovePointTooltip||this._updateMoveTooltip(t)}_hideTooltip(){this._shouldShowMovePointTooltip||(this.tooltip?.clear(),this._latestTooltipInfo=null)}_updateMoveTooltip(t,o){if(this._shouldShowMovePointTooltip)return;const{sketchOptions:e}=this;switch(t){case MoveManipulation_c.XY:this._latestTooltipInfo=this._translateTooltipInfo??=new TranslateTooltipInfo.M({sketchOptions:e}),MoveTool3D_W(this._latestTooltipInfo,o,((t,o)=>(0,automaticLengthMeasurementUtils.Kt)(t,o)));break;case MoveManipulation_c.XY_AXIS:this._latestTooltipInfo=this._translateXYTooltipInfo??=new TranslateXYTooltipInfo_i({sketchOptions:e}),MoveTool3D_W(this._latestTooltipInfo,o,((t,e)=>(0,quantityUtils.hs)((0,automaticLengthMeasurementUtils.Kt)(t,e),moveUtils_a(o))));break;case MoveManipulation_c.Z:this._latestTooltipInfo=this._translateZTooltipInfo??=new TranslateZTooltipInfo_i({sketchOptions:e}),MoveTool3D_W(this._latestTooltipInfo,o,euclideanLengthMeasurementUtils.e5)}this._latestTooltipInfo.sketchOptions=e}_emitRecordUndo(){const t=this.objects.toArray().map((t=>t.createUndoRecord?.())).filter(arrayUtils.Ru);t.length>0&&this.events.emit("record-undo",{updates:t})}_buildSnappingPipelineSteps(t,o,e,i,n){const s=manipulatedObjectUtils_t(t);if(null==s||"point"!==s.type&&"mesh"!==s.type)return{steps:e,cancel:i};const a=("point"===s.type?s:s.origin).clone(),l=new SnappingContext.e({elevationInfo:o,pointer:n,editGeometryOperations:EditGeometryOperations.p.fromGeometry(a,this.view.state.viewingMode),visualizer:new SnappingVisualizer3D_R,excludeFeature:t.graphic}),r=this.snappingManager,{snappingStep:p,cancelSnapping:c}=(0,SnappingDragPipelineStep.L)({snappingContext:l,snappingManager:r,updatingHandles:this._updatingHandles});return i=i.next(c),{steps:e=e.next((o=>(a.z=(0,elevationInfoUtils.wS)(this.view,a,t.elevationInfo,{mode:"absolute-height",offset:0}),{...o,snapOrigin:l.coordinateHelper.pointToVector(a)}))).next(...p),cancel:i}}};(0,tslib_es6._)([(0,property.MZ)({constructOnly:!0,nonNullable:!0})],MoveTool3D_K.prototype,"view",void 0),(0,tslib_es6._)([(0,property.MZ)()],MoveTool3D_K.prototype,"objects",void 0),(0,tslib_es6._)([(0,property.MZ)({constructOnly:!0,nonNullable:!0})],MoveTool3D_K.prototype,"enableZ",void 0),(0,tslib_es6._)([(0,property.MZ)({constructOnly:!0,type:SketchOptions.A})],MoveTool3D_K.prototype,"sketchOptions",void 0),(0,tslib_es6._)([(0,property.MZ)({constructOnly:!0})],MoveTool3D_K.prototype,"snappingManager",void 0),(0,tslib_es6._)([(0,property.MZ)()],MoveTool3D_K.prototype,"type",void 0),(0,tslib_es6._)([(0,property.MZ)()],MoveTool3D_K.prototype,"updating",null),(0,tslib_es6._)([(0,property.MZ)()],MoveTool3D_K.prototype,"_latestTooltipInfo",void 0),(0,tslib_es6._)([(0,property.MZ)()],MoveTool3D_K.prototype,"_shouldShowMovePointTooltip",null),(0,tslib_es6._)([(0,property.MZ)()],MoveTool3D_K.prototype,"activeTooltipInfo",null),MoveTool3D_K=(0,tslib_es6._)([(0,subclass.$)("esri.views.3d.interactive.editingTools.move.MoveTool3D")],MoveTool3D_K);class MoveTool3D_Q{constructor(t){this.object=t,this.geometryRepresentation=null,this.manipulationXY=null,this.dragging=!1}}function MoveTool3D_W(t,o,e){if(null==o||"end"===o.action)return void(t.distance=quantityUtils.r7);const{mapStart:i,mapEnd:n}=o,s=e(i,n);t.distance=null!=s?s:quantityUtils.r7}var Polyline=__webpack_require__("./node_modules/@arcgis/core/geometry/Polyline.js"),SpatialReference=__webpack_require__("./node_modules/@arcgis/core/geometry/SpatialReference.js"),utils=__webpack_require__("./node_modules/@arcgis/core/symbols/support/utils.js"),geodesicUtils=__webpack_require__("./node_modules/@arcgis/core/geometry/support/geodesicUtils.js"),OffsetEdgeVertex=__webpack_require__("./node_modules/@arcgis/core/views/interactive/editGeometry/operations/OffsetEdgeVertex.js");function edgeOffsetUtils_U(e,r,o){const t="on-the-ground"===o.mode?OffsetEdgeVertex.B.XY:OffsetEdgeVertex.B.XYZ;return new OffsetEdgeVertex.L(e,t,r,0)}function edgeOffsetUtils_w(e,r,o){const t=(0,vec3f64.vt)();if(!e.renderCoordsHelper.toRenderCoords(r,t))return null;const n=edgeOffsetUtils_T(e,r,(0,plane.Qj)(o.plane)),i=edgeOffsetUtils_T(e,r,o.edgeDirection);if(null==n||null==i)return null;const c=(0,vec32.e)((0,vec3f64.vt)(),n,i);return(0,plane.O_)(t,c,(0,plane.vt)())}function edgeOffsetUtils_T(e,r,o){const t=(0,dehydratedPoint.T)(r.x+o[0],r.y+o[1],r.z+o[2],r.spatialReference),n=(0,vec3f64.vt)(),s=(0,vec3f64.vt)();return e.renderCoordsHelper.toRenderCoords(r,n)&&e.renderCoordsHelper.toRenderCoords(t,s)?(0,vec32.o)(s,n,s):null}function edgeOffsetUtils_A(e,r,t,n){const{elevationInfo:s,operations:i}=t;if(!i||!e)return null;const c=n.manipulator.elevationAlignedLocation,l=(0,elevationInfoUtils.id)(c,r,s),a=r.sceneIntersectionHelper.intersectElevationFromScreen((0,screenUtils.gs)(e.x,e.y),s,l);return a&&(0,geometry_projection.projectPoint)(a,a,i.data.spatialReference)?a:null}const edgeOffsetUtils_M=10;var fields=__webpack_require__("./node_modules/@arcgis/core/views/interactive/tooltip/fields/fields.js");let ReshapeEdgeOffsetTooltipInfo_a=class extends SketchTooltipInfo.w{constructor(t){super(t),this.type="reshape-edge-offset",this.distance=(0,fields.Y3)({lockable:!1}),this.area=(0,fields.Am)({visible:!1}),this.totalLength=(0,fields.fr)({visible:!1})}get allFields(){return[this.distance,this.area,this.totalLength]}};(0,tslib_es6._)([(0,property.MZ)()],ReshapeEdgeOffsetTooltipInfo_a.prototype,"type",void 0),(0,tslib_es6._)([(0,property.MZ)()],ReshapeEdgeOffsetTooltipInfo_a.prototype,"distance",void 0),(0,tslib_es6._)([(0,property.MZ)()],ReshapeEdgeOffsetTooltipInfo_a.prototype,"area",void 0),(0,tslib_es6._)([(0,property.MZ)()],ReshapeEdgeOffsetTooltipInfo_a.prototype,"totalLength",void 0),(0,tslib_es6._)([(0,property.MZ)()],ReshapeEdgeOffsetTooltipInfo_a.prototype,"allFields",null),ReshapeEdgeOffsetTooltipInfo_a=(0,tslib_es6._)([(0,subclass.$)("esri.views.interactive.tooltip.infos.ReshapeEdgeOffsetTooltipInfo")],ReshapeEdgeOffsetTooltipInfo_a);var SelectedVertexTooltipInfo=__webpack_require__("./node_modules/@arcgis/core/views/interactive/tooltip/infos/SelectedVertexTooltipInfo.js"),automaticAreaMeasurementUtils=__webpack_require__("./node_modules/@arcgis/core/views/support/automaticAreaMeasurementUtils.js");function reshapeTooltipUtils3D_M(e,o,r){function l(){const t=r(),e=t.sketchOptions.tooltips.effectiveEnabled?t.activeTooltipInfo:null;return{...t,activeTooltipInfo:e}}let p=!1;function c(t){p||(p=!0,t(),p=!1)}function f(t){c((()=>{(function reshapeTooltipUtils3D_E(t,{activeTooltipInfo:e,selectedVertexManipulatorInfo:o,sketchOptions:n}){if(e)switch(e.sketchOptions=n,e?.type){case"move-point":tooltipUtils3D_y(e,t);break;case"selected-vertex":!function reshapeTooltipUtils3D_S(t,e,o){if(!t||"selected-vertex"!==t.type)return;const n=e?.manipulator.location;t.setLocationFromPoint(n),tooltipUtils3D_h(t,n,o);const i=o.operations?.data.geometry;switch(i?.type){case"polygon":t.geometryType="polygon",t.totalLength.visible=!1,t.area.actual=(0,automaticAreaMeasurementUtils.n)(i);break;case"polyline":t.geometryType="polyline",t.totalLength.actual=(0,automaticLengthMeasurementUtils.ob)(i),t.area.visible=!1}}(e,o,t)}})(o,t),e.info=t.activeTooltipInfo}))}return(0,handleUtils.vE)([(0,reactiveUtils.watch)(l,f,reactiveUtils.pc),(0,reactiveUtils.watch)((()=>{const t=l(),{activeTooltipInfo:e}=t;if(e&&"key"in e)return{context:t,activeTooltipInfo:e,key:e.key,geometry:manipulatedObjectUtils_t(o)}}),((t,e)=>{t&&e&&e.key!==t.key&&c((()=>reshapeTooltipUtils3D_U(o,t.context)))}),reactiveUtils.OH),o.on("committed",(()=>f(l()))),(0,tooltipCommonUtils.sZ)(e,{onBeforePaste:()=>{p=!0},onAfterPaste:()=>{reshapeTooltipUtils3D_U(o,l()),p=!1}})])}function reshapeTooltipUtils3D_U(t,{activeTooltipInfo:e,selectedVertexManipulatorInfo:o,callbacks:n}){if(!e)return;n.onBeforeReshape();const i=manipulatedObjectUtils_t(t);switch(i?.type){case"mesh":"move-point"===e.type&&tooltipUtils3D_d(e,i.origin,t,n);break;case"point":"move-point"===e.type&&tooltipUtils3D_d(e,i,t,n);break;case"polyline":case"polygon":"selected-vertex"===e.type&&function reshapeTooltipUtils3D_L(t,e,o,n){if(!e)return;const{dx:i,dy:a,dz:s}=(0,tooltipCommonUtils.mu)(t,e.manipulator.location);0===i&&0===a&&0===s||(n.onReshapeStart(),o.operations?.moveVertices([e.handle],i,a,s,editGeometry_interfaces.Y.NEW_STEP),n.onReshape(),n.onReshapeStop())}(e,o,t,n)}}function reshapeTooltipUtils3D_R(t,o,n){if(null!=o&&"end"!==o.action){const{mapStart:i,mapEnd:a}=o,s=n(i,a);t.distance=null!=s?s:quantityUtils.r7}else t.distance=quantityUtils.r7}function reshapeTooltipUtils3D_X({operations:t},n,{sketchOptions:i,tooltipInfos:a}){const s=a.edgeOffset;if(s.distance.committed=null,null!=n&&null!=n.signedDistance&&"end"!==n.action&&null!=t){const e=t.data.coordinateHelper,{start:i,end:a}=n.operation.clampedStartAndEnd(n.mapEnd),r=(0,automaticLengthMeasurementUtils.Do)(i,a,e.spatialReference),l=Math.sign(n.signedDistance*n.operation.selectedArrow);s.distance.actual=null!=r?(0,quantityUtils.hs)(r,l):null}else s.distance.actual=quantityUtils.r7;const r=t?.data.geometry;switch(s.area.actual=null,s.area.visible=!1,s.totalLength.actual=null,s.totalLength.visible=!1,r?.type){case"polygon":s.area.actual=(0,automaticAreaMeasurementUtils.n)(r),s.area.visible=!0;break;case"polyline":s.totalLength.actual=(0,automaticLengthMeasurementUtils.ob)(r),s.totalLength.visible=!0}return s.sketchOptions=i,s}var IViewEvents=__webpack_require__("./node_modules/@arcgis/core/views/input/IViewEvents.js"),keybindings=__webpack_require__("./node_modules/@arcgis/core/views/interactive/keybindings.js");const Ie=Symbol();let Se=class extends Accessor.A{get _operations(){return this.object.operations}constructor(e){super(e),this._selectedIndex=0,this._manipulatorHandles=new Handles.A,this._manipulatorInfos=[],this._numGrabbing=0,this._numDragging=0,this._reshapeEventState=Ce.NONE,this._pendingEdgeOffsetInfo=null,this._updatingHandles=new UpdatingHandles.U,this._recreatingManipulators=!1,this._settings=new settings_j({getTheme:()=>this.view.effectiveTheme}),this.events=new Evented.A,this.activeTooltipInfo=null,this._vertexLaserLineVisualElement=null,this._tooltipCallbacks={onBeforeReshape:()=>this.tool.endDrag(),onReshapeStart:()=>this._updateEventState(Ce.RESHAPING),onReshape:()=>this.events.emit("reshape",{type:"reshape",object:this.object}),onReshapeStop:()=>this._updateEventState(Ce.NONE,{forceEnd:!0}),onMoveStart:()=>this._updateEventState(Ce.MOVING),onMove:()=>this.events.emit("move",{type:"move",object:this.object,dx:0,dy:0}),onMoveStop:()=>this._updateEventState(Ce.NONE,{forceEnd:!0})}}initialize(){const{view:e}=this,t=this._settings.manipulators,i=t.vertex;this.tooltipInfos=function reshapeTooltipUtils3D_x(t,e){const o=e?.type;return{edgeOffset:new ReshapeEdgeOffsetTooltipInfo_a({sketchOptions:t,viewType:o}),movePoint:new MovePointTooltipInfo.F({sketchOptions:t,viewType:o}),selectedVertex:new SelectedVertexTooltipInfo.d({sketchOptions:t,viewType:o}),translate:new TranslateTooltipInfo.M({sketchOptions:t,viewType:o}),translateXY:new TranslateXYTooltipInfo_i({sketchOptions:t,viewType:o}),translateZ:new TranslateZTooltipInfo_i({sketchOptions:t,viewType:o})}}(this._sketchOptions,e),this._vertexManipulatorMaterial=manipulatorUtils_f((0,colorUtils.QP)(i.color),i.renderOccluded),this._vertexManipulatorOutlineMaterial=manipulatorUtils_h((0,colorUtils.QP)(i.outlineColor),i.renderOccluded),this._vertexManipulatorHoverOutlineMaterial=manipulatorUtils_h((0,colorUtils.QP)(i.hoverOutlineColor),i.renderOccluded);const a=t.edge;this._edgeManipulatorMaterial=manipulatorUtils_f((0,colorUtils.QP)(a.color),a.renderOccluded),this._edgeManipulatorOutlineMaterial=manipulatorUtils_h((0,colorUtils.QP)(a.outlineColor),a.renderOccluded);const o=t.edgeOffset;this._edgeOffsetManipulatorMaterial=manipulatorUtils_f((0,colorUtils.QP)(o.color),o.renderOccluded,!1),this._edgeOffsetManipulatorHoverMaterial=manipulatorUtils_f((0,colorUtils.QP)(o.hoverColor),o.renderOccluded,!1);const s=t.selected;this._selectedManipulatorMaterial=manipulatorUtils_f((0,colorUtils.QP)(s.color),s.renderOccluded),this._selectedManipulatorOutlineMaterial=manipulatorUtils_h((0,colorUtils.QP)(s.outlineColor),s.renderOccluded),this._selectedManipulatorHoverOutlineMaterial=manipulatorUtils_h((0,colorUtils.QP)(s.hoverOutlineColor),s.renderOccluded),this.tooltip=(0,tooltipCommonUtils.A)((()=>({view:e,options:this._sketchOptions.tooltips}))),this.addHandles([(0,reactiveUtils.watch)((()=>{const e=this._settings.manipulators;return{vertexSettings:e.vertex,edgeSettings:e.edge,edgeOffsetSettings:e.edgeOffset,selectedSettings:e.selected}}),(({vertexSettings:e,edgeSettings:t,edgeOffsetSettings:i,selectedSettings:n})=>{e.applyColor(this._vertexManipulatorMaterial),e.applyOutline(this._vertexManipulatorOutlineMaterial),e.applyHoverOutline(this._vertexManipulatorHoverOutlineMaterial),t.applyColor(this._edgeManipulatorMaterial),t.applyOutline(this._edgeManipulatorOutlineMaterial),i.applyColor(this._edgeOffsetManipulatorMaterial),i.applyHover(this._edgeOffsetManipulatorHoverMaterial),n.applyColor(this._selectedManipulatorMaterial),n.applyOutline(this._selectedManipulatorOutlineMaterial),n.applyHoverOutline(this._selectedManipulatorHoverOutlineMaterial)})),(0,reactiveUtils.watch)((()=>this.object.visible),(e=>{for(const t of this._manipulatorInfos)t.manipulator.available=e,Ae(t)&&(t.edgeManipulator.available=e)})),(0,reactiveUtils.watch)((()=>this._numGrabbing+this._numDragging===0),(e=>this._toggleAutoHideManipulators(e))),(0,reactiveUtils.watch)((()=>({labels:this._segmentLabels,enabled:this._sketchOptions.labels.enabled,edgeOffsetEnabled:this.enableEdgeOffset})),(({labels:e,enabled:t,edgeOffsetEnabled:i})=>{null!=e&&(e.visible=t,e.edgeDistance=i?"far":"default")}),reactiveUtils.Vh),reshapeTooltipUtils3D_M(this.tooltip,this.object,(()=>this._tooltipsContext)),(0,reactiveUtils.watch)((()=>this.tooltip.mode),((e,t)=>{"input"===t&&"input"!==e&&this._resetTooltip()})),(0,reactiveUtils.on)((()=>this._operations),"vertex-update",(e=>this._updateManipulatorPositions(e.vertices)),{onListenerAdd:()=>this._recreateManipulators()}),(0,reactiveUtils.on)((()=>this._operations?.data),"change",(e=>{"undo"!==e.operation&&"redo"!==e.operation||this._recreateManipulators()}))])}destroy(){this._removeManipulators(),this._updatingHandles.destroy(),this._segmentLabels=(0,maybe.pR)(this._segmentLabels),this.tooltip=(0,maybe.pR)(this.tooltip)}get updating(){return this._updatingHandles.updating}get manipulators(){return this.tool.manipulators}get view(){return this.tool.view}get object(){return this.tool.object}get enableZShape(){return this.tool.enableZShape}get enableDeleteVertices(){return this.tool.enableDeleteVertices}get enableZVertex(){return this.tool.enableZVertex}get autoHideManipulators(){return this.tool.autoHideManipulators}get enableMoveObject(){return this.tool.enableMoveObject}get enableMidpoints(){return this.tool.enableMidpoints}get enableEdgeOffset(){return this.tool.enableEdgeOffset}get _sketchOptions(){return this.tool.sketchOptions}get _accentColor(){return this.view.effectiveTheme.accentColor}enterInputModeIfAvailable(e){return"key-down"===e.type&&e.key===keybindings.ac.enterInputMode&&("reshape-edge-offset"===this.activeTooltipInfo?.type?this._enterInputModeDuringEdgeOffset(e):!!(0,tooltipCommonUtils.wG)(e,this.tooltip)&&(this.tool.endDrag(),!0))}removeSelectedVertices(){const e=this._manipulatorInfos.filter((e=>e.manipulator.selected&&"vertex"===e.type));return this._removeVertices(e),e.length}onManipulatorSelectionChanged(){this.events.emit("manipulators-changed")}_removeManipulators(){this._manipulatorHandles.removeAll(),this._moveManipulation=(0,maybe.pR)(this._moveManipulation),this._objectMoveManipulation=(0,maybe.pR)(this._objectMoveManipulation),this.manipulators.removeAll(),this._manipulatorInfos=[],this._numGrabbing=0,this._numDragging=0}_createManipulators(e){if(null==this._operations)return;const t=this.object.elevationInfo;for(const i of this._operations.data.components){const n=e?.byComponentIndex.get(i.index);for(const e of i.vertices){const i=n?.has(e.index);this._createVertexOrEdgeManipulator(e,t,i)}for(const e of i.edges)this._createVertexOrEdgeManipulator(e,t)}this._createObjectMoveManipulation(),this._createMoveManipulation(t),this._createVisualElements()}get canRedo(){return null!=this._operations&&this._operations.canRedo}get canUndo(){return null!=this._operations&&this._operations.canUndo}redo(){return this._operations?.redo()}undo(){return this.events.emit("undo"),this._operations?.undo()}_recreateManipulators(){if(!this._recreatingManipulators){if(this._recreatingManipulators=!0,this._removeManipulators(),this._resetTooltip(),this._operations&&this._segmentLabels?.context?.editGeometryOperations===this._operations||(this._segmentLabels=(0,maybe.pR)(this._segmentLabels)),this._createManipulators(),!this._segmentLabels&&this._operations){const e=this._sketchOptions.labels;this._segmentLabels=new SegmentLabels3D_a({context:{view:this.view,editGeometryOperations:this._operations,elevationInfo:this.object.elevationInfo,labelOptions:e},visible:e.enabled})}this._recreatingManipulators=!1}}_perObjectManipulatorDragAction(e,t){if("end"===t.action)return t;let i=0;const n=[],a=this._manipulatorInfos.some((e=>"vertex"===e.type&&e.manipulator.selected)),o=e===Ne.SELECTED_OR_ALL&&a;for(const s of this._manipulatorInfos)"vertex"===s.type&&(s.manipulator.grabbing||o&&!s.manipulator.selected||n.push(s),i++);if(this._moveVertices(n,t),n.length===i){if(this._updateEventState(Ce.MOVING),this.destroyed)return t;this.events.emit("move",{type:"move",dx:t.screenDeltaX,dy:t.screenDeltaY,object:this.object})}else{if(this._updateEventState(Ce.RESHAPING),this.destroyed)return t;this.events.emit("reshape",{type:"reshape",object:this.object})}return t}_toggleAutoHideManipulators(e){this.autoHideManipulators&&(e?this.removeHandles(Ie):this.tool.manipulators.forEach((({manipulator:e})=>{const t=e.disableDisplay?.();t&&this.addHandles(t,Ie)})))}_isMultiVertexSelection(){return this._manipulatorInfos.reduce(((e,t)=>"vertex"===t.type&&t.manipulator.selected?e+1:e),0)>1}_perVertexManipulatorDragAction(e){if(this._updateEventState(Ce.RESHAPING),this.destroyed)return;const{mapDeltaX:t,mapDeltaY:i,mapDeltaZ:n}=e;if(!t&&!i&&!n)return;const a=[];for(const o of this._manipulatorInfos)"vertex"===o.type&&(o.manipulator.selected&&!o.manipulator.grabbing||o===e.info)&&a.push(o);this._moveVertices(a,e,editGeometry_interfaces.Y.ACCUMULATE_STEPS),this.events.emit("reshape",{type:"reshape",object:this.object})}_updateEventState(e,t={}){if(e===this._reshapeEventState)return!1;switch(e){case Ce.NONE:if(!t.forceEnd&&(0!==this._numGrabbing||0!==this._numDragging))return!1;switch(this._reshapeEventState){case Ce.MOVING:this.events.emit("move",{type:"move-stop",dx:0,dy:0,object:this.object});break;case Ce.RESHAPING:this.events.emit("reshape",{type:"reshape-stop",object:this.object})}break;case Ce.MOVING:switch(this._reshapeEventState){case Ce.NONE:this.events.emit("move",{type:"move-start",dx:0,dy:0,object:this.object});break;case Ce.RESHAPING:this.events.emit("reshape",{type:"reshape-stop",object:this.object}),this.destroyed||this.events.emit("move",{type:"move-start",dx:0,dy:0,object:this.object})}break;case Ce.RESHAPING:switch(this._reshapeEventState){case Ce.NONE:this.events.emit("reshape",{type:"reshape-start",object:this.object});break;case Ce.MOVING:this.events.emit("move",{type:"move-stop",dx:0,dy:0,object:this.object}),this.destroyed||this.events.emit("reshape",{type:"reshape-start",object:this.object})}}if(this.destroyed)return!1;const i=this._reshapeEventState!==e;return this._reshapeEventState=e,i}_createObjectMoveManipulation(){const{tool:e,view:t,object:i,_operations:n}=this;if(n){if(this._objectMoveManipulation=new MoveXYObjectManipulation_l({tool:e,view:t,object:i}),this.enableMoveObject){let e=null;this._manipulatorHandles.add(this._objectMoveManipulation.createDragPipeline(((t,i,a)=>{i.next((e=>this._trackNumDragging(e))).next((t=>("start"===t.action&&(e=n.createUndoGroup()),t))).next((e=>this._perObjectManipulatorDragAction(Ne.ALL,e))).next((e=>(this._updateTranslateObjectTooltip(MoveManipulation_c.XY,e),e))).next((t=>{"end"===t.action&&(this._resetTooltip(),e=(0,maybe.xt)(e))})),a.next((()=>this._onDragCancel(!0,(()=>e=(0,maybe.xt)(e)))))}))),this._objectMoveManipulation.forEachManipulator((e=>this._manipulatorHandles.add(this._watchAndUpdateGrabState(e,!1))))}else this._objectMoveManipulation.forEachManipulator((e=>{e.grabbable=!1,e.cursor=null}));this._objectMoveManipulation.forEachManipulator((e=>this._manipulatorHandles.add(e.events.on("immediate-click",(e=>{this._manipulatorInfos.some((e=>e.manipulator.selected))?this._clearSelection():this.events.emit("immediate-click",{...e,object:this.object}),e.stopPropagation()})))))}}_createMoveManipulation(e){const{object:t,tool:i,view:n,_operations:a}=this;if(!a)return;this._moveManipulation=new MoveManipulation_u({tool:i,view:n,xyAvailable:!0,xyAxisAvailable:!0,zAvailable:this.enableZShape&&manipulatorUtils_o(t.operations,t.elevationInfo),snapToScene:!1,radius:MoveManipulation_u.radiusForSymbol(t.graphic?.symbol)}),this._moveManipulation.forEachManipulator((e=>this.addHandles([e.events.on("immediate-click",(t=>{this._moveManipulation.zManipulation.hasManipulator(e)||this._manipulatorInfos.some((e=>e.manipulator.selected))||this.events.emit("immediate-click",{...t,object:this.object}),t.stopPropagation()})),this._watchAndUpdateGrabState(e,!1)])));const o=e=>t=>{this.addHandles([t.events.on("focus-changed",(({action:t})=>{"focus"===t?this._updateTranslateTooltip(e):this._resetTooltip()}))])};this._moveManipulation.xyManipulation.forEachManipulator(o(MoveManipulation_c.XY)),this._moveManipulation.xyAxisManipulation.forEachManipulator(o(MoveManipulation_c.XY_AXIS)),this._moveManipulation.zManipulation.forEachManipulator(o(MoveManipulation_c.Z)),this._moveManipulation.elevationInfo={mode:"absolute-height",offset:0};const s=a.data.spatialReference;this.addHandles([this._moveManipulation.createDragPipeline(((n,o,s,r,l)=>{const{snappingStep:p,cancelSnapping:d}=(0,SnappingDragPipelineStep.L)({predicate:e=>!!e.info,snappingManager:i.snappingManager,snappingContext:new SnappingContext.e({editGeometryOperations:a,elevationInfo:e,pointer:l,excludeFeature:t.graphic,visualizer:new SnappingVisualizer3D_R}),updatingHandles:this._updatingHandles,useZ:!1});return r=r.next((e=>(this._onDragCancel(),e))).next(d),{steps:s=s.next((e=>this._trackNumDragging(e))).next((e=>{const t=this._manipulatorInfos.filter((e=>"vertex"===e.type&&e.manipulator.selected));return e.manipulatorType===ManipulatorType_A.TRANSLATE_XY&&1===t.length?{...e,info:t[0],snapOrigin:t[0].handle.pos}:e})).next((0,dragEventPipeline.pg)(this.view,e,t.graphic??void 0)).next(...p).next((0,dragEventPipeline.EX)()).next((e=>this._perObjectManipulatorDragAction(Ne.SELECTED_OR_ALL,e))).next((e=>(this._updateTranslateTooltip(n,e),e))),cancel:r}}),e,s,t.graphic),(0,reactiveUtils.watch)((()=>t.visible),(()=>this._updateMoveManipulationPosition()),reactiveUtils.Vh),t.on("committed",(()=>{this._recreatingManipulators||this._updateMoveManipulationPosition()})),(0,reactiveUtils.watch)((()=>t.isDraped),(e=>{this._updateMoveManipulationPosition();const t="align-move-manipulation";e?this.addHandles(this.view.elevationProvider.on("elevation-change",(()=>this._updateMoveManipulationPosition())),t):this.removeHandles(t)}),reactiveUtils.Vh)])}_createVisualElements(){const{object:e,view:t}=this,i=visualElementUtils_l({view:t,object:e,forEachManipulator:e=>{if(!this.destroyed&&!this._recreatingManipulators){this._objectMoveManipulation.forEachManipulator(e),this._moveManipulation.forEachManipulator(e);for(const t of this._manipulatorInfos)e(t.manipulator,ManipulatorType_A.TRANSLATE_XY)}},onManipulatorsChanged:e=>this.events.on("manipulators-changed",e)});null!=i&&(this._outlineVisualElement=i.visualElement instanceof OutlineVisualElement_j?i.visualElement:null);const n=this._outlineVisualElement;if(null!=n){const t=()=>{e.isDraped||this._updateMoveManipulationPosition()};this._manipulatorHandles.add((0,reactiveUtils.on)((()=>n.events),"attachment-origin-changed",t,{onListenerAdd:t}))}this._manipulatorHandles.add(i)}_createEdgeOffsetManipulator(e,t=this.object.elevationInfo){const i=this.view,n=this._operations;if(e.component.vertices.length<=2||!n)return null;const a=n.data.spatialReference,o=this._settings.manipulators.edgeOffset,r=o.size/2,l=r+o.collisionPadding,p=r/l,d=p/2,h=p*Math.sqrt(3)/2,{height:u,offset:c}=o,m=this._edgeOffsetManipulatorMaterial;if(!this._edgeOffsetManipulatorGeometryInside){const e=(0,GeometryUtil._B)(m,h,d,d,u,c);this._edgeOffsetManipulatorGeometryInside=e}if(!this._edgeOffsetManipulatorGeometryOutside){const e=(0,GeometryUtil._B)(m,-h,d,d,u,-c);this._edgeOffsetManipulatorGeometryOutside=e}const f=[new RenderObject_e(this._edgeOffsetManipulatorGeometryInside.instantiate(),interactive_interfaces.p7.Unfocused),new RenderObject_e(this._edgeOffsetManipulatorGeometryInside.instantiate({material:this._edgeOffsetManipulatorHoverMaterial}),interactive_interfaces.p7.Focused),new RenderObject_e(this._edgeOffsetManipulatorGeometryOutside.instantiate(),interactive_interfaces.p7.Unfocused),new RenderObject_e(this._edgeOffsetManipulatorGeometryOutside.instantiate({material:this._edgeOffsetManipulatorHoverMaterial}),interactive_interfaces.p7.Focused)],g=new ee({view:i,renderObjects:f,elevationInfo:"on-the-ground"!==t.mode||(0,utils.$d)(this.object.graphic?.symbol)?{mode:"absolute-height",offset:0}:t,worldOriented:!1,focusMultiplier:1,radius:l,available:this.object.visible,collisionType:{type:"disc",direction:(0,vec3f64.fA)(0,0,1)},collisionPriority:1,metadata:{deleting:!1},location:Te(a)}),_=new ee({view:i,worldSized:!0,worldOriented:!1,available:this.object.visible,collisionPriority:-10,cursor:this.enableMoveObject?"move":"default",metadata:{deleting:!1},location:Te(a)}),v={manipulator:g,handle:e,locationUpdateHandle:null,type:"edge",selectedIndex:0,edgeManipulator:_,visibilityHandle:null};this._autoHideEdgeOffsetManipulator(v,o.minSquaredEdgeLength);const M=()=>this._updateEdgeOffsetManipulator(v);M(),v.locationUpdateHandle=(0,handleUtils.vE)([e.leftVertex,e.rightVertex].map((e=>{const t=this._getManipulatorInfoFromHandle(e);return t?.manipulator.events.on("location-update",M)})));const b=e=>{this._manipulatorInfos.some((e=>e.manipulator.selected))?this._clearSelection():this.events.emit("immediate-click",{...e,object:this.object}),e.stopPropagation()};return this._manipulatorHandles.add([v.locationUpdateHandle,this._watchAndUpdateGrabState(g,!0),this._watchAndUpdateGrabState(_,!0),(0,dragEventPipeline.Xt)(g,this._createEdgeOffsetPipeline(v,t,n)),(0,dragEventPipeline.Xt)(_,this._createEdgePipeline(v,t,n)),_.events.on("immediate-click",b),g.events.on("immediate-click",b),g.events.on("focus-changed",(()=>this._resetTooltip())),g.events.on("grab-changed",(({screenPoint:e,action:t})=>{v.grabMapPoint="start"===t?edgeOffsetUtils_A(e,this.view,this.object,v):null}))],g),this._manipulatorInfos.push(v),this.manipulators.addMany([g,_]),this.events.emit("manipulators-changed"),v}_autoHideEdgeOffsetManipulator(e,t){const i=e.manipulator,n=e.edgeManipulator,a=()=>{e.visibilityHandle=(0,maybe.xt)(e.visibilityHandle);const a=this._getManipulatorInfoFromHandle(e.handle.leftVertex),o=this._getManipulatorInfoFromHandle(e.handle.rightVertex),l=null!=a&&null!=o&&function edgeOffsetUtils_q(e,o,t){const n=t.projectToRenderScreen(e,(0,screenUtils.r_)()),s=t.projectToRenderScreen(o,(0,screenUtils.r_)());return null!=n&&null!=s?(0,vec32.k)((0,vec32.d)(n,n,s)):0}(a.manipulator.renderLocation,o.manipulator.renderLocation,this.view.state.camera)<t;(!i.focused&&!n.focused||l)&&(i.grabbable=!l,n.grabbable=!l,e.visibilityHandle=(0,handleUtils.vE)([i.disableDisplay(),(0,handleUtils.hA)((()=>{i.grabbable=!0,n.grabbable=this.enableMoveObject}))]))};this._manipulatorHandles.add([i.events.on("focus-changed",a),n.events.on("focus-changed",a),(0,handleUtils.hA)((()=>{(0,maybe.xt)(e.visibilityHandle),n.metadata.deleting=!0,this.manipulators.remove(n)}))],i),a()}_updateEdgeOffsetManipulator(e){if(!this._operations)return;this._updateManipulatorPosition(e);const{coordinateHelper:t}=this._operations.data,i=edgeOffsetUtils_w(this.view,e.manipulator.elevationAlignedLocation,edgeOffsetUtils_U(t,e.handle,e.manipulator.elevationInfo)),n=this._getManipulatorInfoFromHandle(e.handle.leftVertex),a=this._getManipulatorInfoFromHandle(e.handle.rightVertex);if(null==n||null==a)return;const o=n.manipulator.renderLocation,s=a.manipulator.renderLocation,r=null!=i?function edgeOffsetUtils_b(e,r,o){const t=(0,plane.Qj)(e),c=(0,vec32.o)((0,vec3f64.vt)(),r,o),l=(0,vec32.e)((0,vec3f64.vt)(),c,t),a=(0,vec32.e)((0,vec3f64.vt)(),c,l);return(0,mat4f64.fA)(c[0],c[1],c[2],0,l[0],l[1],l[2],0,a[0],a[1],a[2],0,0,0,0,1)}(i,o,s):mat4f64.zK;e.manipulator.modelTransform=r,e.edgeManipulator.elevationAlignedLocation=e.manipulator.elevationAlignedLocation,e.edgeManipulator.modelTransform=r;const l=(0,vec32.l)((0,vec32.d)(De,o,s))/2;e.edgeManipulator.collisionType={type:"line",paths:[[[-l,0,0],[l,0,0]]]}}_createEdgePipeline(e,t,i){return(n,a,o,s)=>{if("touch"===s)this._createEdgeOffsetPipeline(e,t,i)(n,a,o);else if(this.enableMoveObject){const e=this.object.graphic,s=i.data.spatialReference,{elevationAlignedLocation:r}=n;a.next((e=>this._trackNumDragging(e))).next((0,dragEventPipeline.Tp)(this.view,r)).next(dragEventPipeline3D_M(this.view,r,t,s,e)).next((0,dragEventPipeline.sO)()).next((0,dragEventPipeline.EX)()).next((e=>this._perObjectManipulatorDragAction(Ne.ALL,e))).next((e=>(this._updateTranslateObjectTooltip(MoveManipulation_c.XY,e),e))).next((e=>{"end"===e.action&&this._resetTooltip()})),o.next((()=>this._onDragCancel(!n.metadata.deleting)))}}}_createEdgeOffsetPipeline(e,t,i){return(n,a,o)=>{const s=this._pendingEdgeOffsetInfo;if(s?.manipulatorInfo===e&&"drag"!==s.mode)return void o.execute({action:"cancel"});this._clearSelection();const{initializeStep:r,cleanup:l}=this._initializeEdgeOffset(e,t,i,o),p=this._applyEdgeOffsetStep(e);a.next((e=>this._trackNumDragging(e))).next((0,dragEventPipeline.Tp)(this.view,n.elevationAlignedLocation)).next(r).next(function dragEventPipeline3D_P(e){return dragEventPipeline3D_T(e,(e=>e.plane))}(this.view)).next(dragEventPipeline3D_F(this.view,i.data.spatialReference)).next((0,dragEventPipeline.EX)()).next((e=>{const{operation:t,mapEnd:i}=e;return null==t||null==i?e:{...e,signedDistance:t.signedDistanceToPoint(i)}})).next((e=>this._pendingEdgeOffsetInfo?e:p(e))).next((e=>{"end"!==e.action||this._pendingEdgeOffsetInfo||l()})),o.next((()=>{this._exitEdgeOffsetInputMode(),n.metadata.deleting||(l(),this._onDragCancel())}))}}_initializeEdgeOffset(e,t,i,n){const{view:a,object:o}=this,r=edgeOffsetUtils_U(i.data.coordinateHelper,e.handle,t),l=i.createUndoGroup(),p=edgeOffsetUtils_w(a,e.manipulator.elevationAlignedLocation,r);let h;this._splitEdgesBeforeEdgeOffset(e,r),this._selectEdgeOffsetArrow(e,r);const u=()=>{this._cleanEdgeOffsetCollapsedEdges(e,i),h=(0,maybe.xt)(h)},c=this.events.on("undo",u);return h=(0,handleUtils.vE)([this._initializeEdgeOffsetVisualElement(e,o,t,i),l,c,this._connectEdgeOffsetTooltip(e,r,i,(()=>{n.execute({action:"cancel"})}))]),{initializeStep:e=>null==r||null==p?(u(),null):{...e,operation:r,plane:p},cleanup:u}}_initializeEdgeOffsetVisualElement(e,t,i,a){const o=()=>new Polyline.A({paths:[[e.handle.leftVertex.pos,e.handle.rightVertex.pos]],spatialReference:a.data.spatialReference}),r=new OutlineVisualElement_j({view:this.view,isDraped:t.isDraped,geometry:o(),elevationInfo:i,width:this._settings.visualElements.lineObjects.outline.width,attached:!1,isDecoration:!0}),p=(0,handleUtils.vE)([(0,reactiveUtils.watch)((()=>({color:this._accentColor,draped:t.isDraped})),(({color:e,draped:t})=>{r.color=(0,colorUtils.QP)(e),r.isDraped=t}),reactiveUtils.pc),t.on("committed",(()=>{r.geometry=o()})),(0,handleUtils.DQ)(r)]);return r.attached=!0,p}_applyEdgeOffsetStep(e){return t=>(this.destroyed||null==t.operation||!this._operations||(this._updateEventState(Ce.RESHAPING),null==t.signedDistance?this._resetTooltip():((t.mapDeltaX||t.mapDeltaY||t.mapDeltaZ)&&(this._offsetEdge(e,t.operation,t.signedDistance),this.events.emit("reshape",{type:"reshape",object:this.object})),this._updateEdgeOffsetTooltip(t))),t)}_cleanEdgeOffsetCollapsedEdges(e,t){const i=e.handle.leftVertex.leftEdge?.leftVertex,n=e.handle.leftVertex,a=e.handle.rightVertex.rightEdge?.rightVertex,o=e.handle.rightVertex,s=t.data.coordinateHelper,r=this.view.pixelSizeAt(s.vectorToDehydratedPoint(n.pos),s.spatialReference),l=[];if(i&&s.distance(i.pos,n.pos)<Pe){const e=this._getManipulatorInfoFromHandle(n);null!=e&&l.push(e)}if(s.distance(n.pos,o.pos)<r||a&&s.distance(a.pos,o.pos)<Pe){const e=this._getManipulatorInfoFromHandle(o);null!=e&&l.push(e)}l.length&&this._removeVertices(l)}_enterInputModeDuringEdgeOffset(e){const t=this._findActiveEdgeOffsetManipulatorInfo();return!(!t||!(0,tooltipCommonUtils.wG)(e,this.tooltip)||(t.manipulator.dragging?(this._pendingEdgeOffsetInfo={manipulatorInfo:t,mode:"drag"},0):(this._clearSelection(),this._pendingEdgeOffsetInfo={manipulatorInfo:t,mode:"hover"},this._connectEdgeOffsetTooltipOnHover(t),0)))}_exitEdgeOffsetInputMode(){this.tooltip&&(this._pendingEdgeOffsetInfo=null,this._resetTooltip(),this.tooltip.exitInputMode())}_findActiveEdgeOffsetManipulatorInfo(){return this._manipulatorInfos.filter(Ae).find((({manipulator:e})=>e.hovering||e.grabbing||e.dragging))}_connectEdgeOffsetTooltipOnHover(e){const{_operations:t,object:i}=this;if(!t)return;const{elevationInfo:n}=i,a=edgeOffsetUtils_U(t.data.coordinateHelper,e.handle,n);this._selectEdgeOffsetArrow(e,a),this.addHandles([this._initializeEdgeOffsetVisualElement(e,i,n,t),this._connectEdgeOffsetTooltip(e,a,t,(()=>{this.removeHandles(a),this._exitEdgeOffsetInputMode()}))],a)}_splitEdgesBeforeEdgeOffset(e,t){if(t.requiresSplitEdgeLeft){const t=this._getManipulatorInfoFromHandle(e.handle.leftVertex.leftEdge);null!=t&&this._splitEdgeManipulator(t,1)}if(t.requiresSplitEdgeRight){const t=this._getManipulatorInfoFromHandle(e.handle.rightVertex.rightEdge);null!=t&&this._splitEdgeManipulator(t,0)}}_selectEdgeOffsetArrow(e,t){const i=e.grabMapPoint??edgeOffsetUtils_A(this.view.inputManager?.latestPointerLocation,this.view,this.object,e);i&&t.selectArrowFromStartPoint(i)}_connectEdgeOffsetTooltip(e,t,i,n){const a=()=>this.tooltipInfos.edgeOffset.distance.actual,o=a=>{n(),queueMicrotask((()=>{this.view.focus();const n=i.createUndoGroup();this._tooltipCallbacks.onReshapeStart?.(),this._splitEdgesBeforeEdgeOffset(e,t),this._offsetEdge(e,t,function edgeOffsetUtils_I(r,o,n,{data:{coordinateHelper:s,spatialReference:i}}){const c=(0,quantityUtils.l3)(r,"meters"),l=(0,unitUtils.GA)(i),m=Math.sign(c*n.selectedArrow),h=(0,geodesicUtils.Xn)(i),R=(0,plane.Qj)(n.plane),v=s.pointToXYZ(o),x=(0,vec3f64.vt)();(0,vec32.b)(x,v,R,m*(edgeOffsetUtils_M/l));const C=c*n.selectedArrow/l;if(!h||!(0,projectVectorToVector.F)(v,i,v,h)||!(0,projectVectorToVector.F)(x,i,x,h))return C;const H=new geodesicUtils.Zj;if((0,geodesicUtils._3)(H,v,x,h),(0,geodesicUtils.vN)(x,v,H.azimuth,c,h),!(0,projectVectorToVector.F)(x,h,x,i))return C;const U=x[0]-o.x,w=x[1]-o.y,T=Math.sqrt(U*U+w*w)*m,[b,q]=R,A=Math.sqrt(b*b+q*q);return 0===A?0:T/A}(a,e.manipulator.location,t,i)),this._tooltipCallbacks.onReshape?.(),this._tooltipCallbacks.onReshapeStop?.(),this._cleanEdgeOffsetCollapsedEdges(e,i),n.remove()}))},r=()=>{const e=a();null!=e?o(e):n()};return(0,handleUtils.vE)([(0,reactiveUtils.when)((()=>this.tooltip&&!this.tooltip.focused),(()=>r()),reactiveUtils.OH),this.tooltip.on("discard",n),this.tooltip.on("commit",(e=>{"commit-and-exit"===e.type&&r()}))])}_createVertexOrEdgeManipulator(e,t=this.object.elevationInfo,i=!1){const n=this.view,a=this._operations,o=this._settings;if(!a)return null;const r=a.data.type,l=a.data.spatialReference;if("edge"===e.type){if(this.enableEdgeOffset)return this._createEdgeOffsetManipulator(e,t);if(!this.enableMidpoints)return null}if(null==this._vertexManipulatorGeometry||null==this._vertexManipulatorOutlineGeometry){const{size:e,outlineSize:t}=we(o.manipulators.vertex);this._vertexManipulatorGeometry=(0,GeometryUtil.CM)(this._vertexManipulatorMaterial,e,16,16),this._vertexManipulatorOutlineGeometry=(0,GeometryUtil.CM)(this._vertexManipulatorOutlineMaterial,t,16,16)}if(null==this._edgeManipulatorGeometry||null==this._edgeManipulatorOutlineGeometry){const{size:e,outlineSize:t}=we(o.manipulators.edge);this._edgeManipulatorGeometry=(0,GeometryUtil.CM)(this._edgeManipulatorMaterial,e,16,16),this._edgeManipulatorOutlineGeometry=(0,GeometryUtil.CM)(this._edgeManipulatorOutlineMaterial,t,16,16)}const p="point"===r||"mesh"===r?[]:[new RenderObject_e(this._vertexManipulatorGeometry.instantiate(),Le.Vertex|interactive_interfaces.p7.Unselected),new RenderObject_e(this._vertexManipulatorOutlineGeometry.instantiate(),Le.Vertex|interactive_interfaces.p7.Unfocused|interactive_interfaces.p7.Unselected),new RenderObject_e(this._vertexManipulatorOutlineGeometry.instantiate({material:this._vertexManipulatorHoverOutlineMaterial}),Le.Vertex|interactive_interfaces.p7.Focused|interactive_interfaces.p7.Unselected),new RenderObject_e(this._vertexManipulatorGeometry.instantiate({material:this._selectedManipulatorMaterial}),interactive_interfaces.p7.Selected),new RenderObject_e(this._vertexManipulatorOutlineGeometry.instantiate({material:this._selectedManipulatorOutlineMaterial}),interactive_interfaces.p7.Selected|interactive_interfaces.p7.Unfocused),new RenderObject_e(this._vertexManipulatorOutlineGeometry.instantiate({material:this._selectedManipulatorHoverOutlineMaterial}),interactive_interfaces.p7.Selected|interactive_interfaces.p7.Focused)];this.enableMidpoints&&p.push(new RenderObject_e(this._edgeManipulatorGeometry.instantiate({material:this._vertexManipulatorMaterial}),Le.Edge|interactive_interfaces.p7.Focused|interactive_interfaces.p7.Unselected),new RenderObject_e(this._edgeManipulatorOutlineGeometry.instantiate({material:this._vertexManipulatorHoverOutlineMaterial}),Le.Edge|interactive_interfaces.p7.Focused|interactive_interfaces.p7.Unselected),new RenderObject_e(this._edgeManipulatorGeometry.instantiate(),Le.Edge|interactive_interfaces.p7.Unfocused|interactive_interfaces.p7.Unselected),new RenderObject_e(this._edgeManipulatorOutlineGeometry.instantiate(),Le.Edge|interactive_interfaces.p7.Unfocused|interactive_interfaces.p7.Unselected));const h=new ee({view:n,renderObjects:p,elevationInfo:t,focusMultiplier:1,touchMultiplier:1,available:this.object.visible,metadata:{deleting:!1},location:Te(l)});h.selected=i,this._setTypeSpecificManipulatorSettings(h,e,t);const u="edge"===e.type?{manipulator:h,handle:e,locationUpdateHandle:null,type:"edge",selectedIndex:0}:{manipulator:h,handle:e,type:"vertex",selectedIndex:0};if(this._manipulatorInfos.push(u),this.manipulators.add(h),this._updateManipulatorPosition(u),"edge"===u.type){const e=[];for(const t of[u.handle.leftVertex,u.handle.rightVertex]){const i=this._getManipulatorInfoFromHandle(t);null!=i&&e.push(i.manipulator.events.on("location-update",(()=>this._updateManipulatorPosition(u))))}u.locationUpdateHandle=(0,handleUtils.vE)(e),this._manipulatorHandles.add(u.locationUpdateHandle,h)}this._manipulatorHandles.add(this._watchAndUpdateGrabState(h,!0),h);const c=(0,dragEventPipeline.Xt)(h,((e,i,o,s)=>{let r=null;const{snappingStep:p,cancelSnapping:h}=(0,SnappingDragPipelineStep.L)({predicate:()=>!this._isMultiVertexSelection(),snappingManager:this.tool.snappingManager,snappingContext:new SnappingContext.e({editGeometryOperations:a,elevationInfo:t,pointer:s,excludeFeature:this.object.graphic,visualizer:new SnappingVisualizer3D_R}),updatingHandles:this._updatingHandles,useZ:!1});o=o.next((t=>(this._onDragCancel(!e.metadata.deleting,(()=>r=(0,maybe.xt)(r))),t))).next(h);const{elevationAlignedLocation:c}=e,m=this.object.graphic??void 0;i.next((e=>this._trackNumDragging(e))).next((e=>{if("start"===e.action&&a&&(r=a.createUndoGroup()),"edge"===u.type){const t=this._splitEdgeManipulator(u);return{...e,info:t,snapOrigin:t.handle.pos}}return{...e,info:u,snapOrigin:u.handle.pos}})).next((0,dragEventPipeline.Tp)(n,c)).next(dragEventPipeline3D_M(n,c,t,l,m)).next((0,dragEventPipeline.pg)(n,t,m)).next(...p).next((0,dragEventPipeline.EX)()).next((e=>{this._perVertexManipulatorDragAction(e),"end"===e.action&&(r=(0,maybe.xt)(r)),this._resetTooltip()}))}));return this._manipulatorHandles.add([c,h.events.on("immediate-click",(e=>this._manipulatorClickCallback(e,u))),h.events.on("select-changed",(()=>{u.selectedIndex=++this._selectedIndex,this._updateMoveManipulationPosition(),this._resetTooltip()})),h.events.on("focus-changed",(()=>{this._resetTooltip()}))],h),this.events.emit("manipulators-changed"),u}_trackNumDragging(e){switch(e.action){case"start":this._numDragging++;break;case"end":this._numDragging--}return e}_onDragCancel(e=!0,t){switch(this._numDragging--,e&&this.undo(),this.tool.snappingManager?.doneSnapping(),this._resetTooltip(),this._reshapeEventState){case Ce.NONE:break;case Ce.MOVING:this.events.emit("move",{type:"move",dx:0,dy:0,object:this.object});break;case Ce.RESHAPING:this.events.emit("reshape",{type:"reshape",object:this.object})}t?.(),this.destroyed||this._updateEventState(Ce.NONE)}_setTypeSpecificManipulatorSettings(e,t,i){const n=this._settings;switch(t.type){case"vertex":{e.state=Le.Vertex,e.selectable=!0,e.cursor="move",e.collisionPriority=2;const{size:t,collisionPadding:a}=n.manipulators.vertex;e.radius=t/2+a,e.elevationInfo=i;const o=this._operations?.data.type;e.interactive=null!=o&&"point"!==o&&"mesh"!==o;break}case"edge":{e.state=Le.Edge,e.selectable=!1,e.cursor="copy",e.collisionPriority=-1;const{size:t,collisionPadding:a}=n.manipulators.edge;e.radius=t/2+a,e.elevationInfo="on-the-ground"!==i.mode||(0,utils.$d)(this.object.graphic?.symbol)?{mode:"absolute-height",offset:0}:i;break}}}_watchAndUpdateGrabState(e,t){return e.events.on("grab-changed",(i=>{this._onGrabStateChanged(e,t,i.action,i.pointerType)}))}_onGrabStateChanged(e,t,i,n="mouse"){if(!this._recreatingManipulators){if("start"===i)t&&this._updateSelection(e),this._numGrabbing++;else if(this._numGrabbing--,this._updateEventState(Ce.NONE),this.destroyed)return;this._moveManipulation.interactive=!this._numGrabbing,("touch"!==n||this.enableEdgeOffset)&&(this._manipulatorInfos.forEach((e=>{const{manipulator:t}=e,i=this._operations?.data.type;t.interactive=t.grabbing||!this._numGrabbing&&null!=i&&"point"!==i&&"mesh"!==i,Ae(e)&&(e.edgeManipulator.interactive=e.edgeManipulator.grabbing||!this._numGrabbing)})),this._objectMoveManipulation.forEachManipulator((e=>{e.interactive=e.grabbing||!this._numGrabbing})))}}_clearSelection(){for(const e of this._manipulatorInfos)e.manipulator.grabbing||(e.manipulator.selected=!1);this._pendingEdgeOffsetInfo=null}_updateSelection(e){e.grabbing&&!e.selected&&e.selectable&&(this._clearSelection(),e.selected=!0,this.events.emit("manipulators-changed"))}_removeManipulator(e){null!=e&&(e.manipulator.metadata.deleting=!0,this.manipulators.remove(e.manipulator),this._manipulatorHandles.remove(e.manipulator),(0,arrayUtils.Xy)(this._manipulatorInfos,e),this.events.emit("manipulators-changed"),this._resetTooltip())}_getManipulatorInfoFromHandle(e){if(e)for(const t of this._manipulatorInfos)if(e===t.handle)return t;return null}_updateManipulatorPositions(e){for(const t of e)this._updateManipulatorPosition(this._getManipulatorInfoFromHandle(t))}_updateManipulatorPosition(e){const t=this._operations;if(null!=e&&t)if("vertex"===e.type)e.manipulator.location=t.data.coordinateHelper.vectorToDehydratedPoint(e.handle.pos,Ge),e.manipulator.grabbing&&null!=this._vertexLaserLineVisualElement&&(this._vertexLaserLineVisualElement.visualElement.intersectsWorldUpAtLocation=e.manipulator.renderLocation);else if("edge"===e.type){const i=this._getManipulatorInfoFromHandle(e.handle.leftVertex),n=this._getManipulatorInfoFromHandle(e.handle.rightVertex);if(null==i||null==n)return;const a=i.manipulator,o=n.manipulator;if("on-the-ground"===e.manipulator.elevationInfo?.mode){const i=a.location,n=o.location,s=.5,r=i.x+s*(n.x-i.x),l=i.y+s*(n.y-i.y),p=i.hasZ&&n.hasZ?0:void 0;e.manipulator.location=(0,dehydratedPoint.T)(r,l,p,t.data.spatialReference)}else(0,vec32.m)(De,a.renderLocation,o.renderLocation,.5),e.manipulator.renderLocation=De}}_splitEdgeManipulator(e,t=.5){const i=this._operations,n=i.splitEdge(e.handle,t).createdVertex;e.locationUpdateHandle=(0,maybe.xt)(e.locationUpdateHandle);const a=this.object.elevationInfo;let o;this.enableEdgeOffset?(this._removeManipulator(e),o=this._createVertexOrEdgeManipulator(n)):(o=e,o.handle=n,o.type="vertex",this._setTypeSpecificManipulatorSettings(e.manipulator,e.handle,a)),n.leftEdge&&this._createVertexOrEdgeManipulator(n.leftEdge),n.rightEdge&&this._createVertexOrEdgeManipulator(n.rightEdge),this._updateManipulatorPosition(o),this.enableEdgeOffset||this._resetTooltip(),this._updateSelection(e.manipulator);const s=this._updateEventState(Ce.RESHAPING),r=i.data.coordinateHelper.vectorToArray(o.handle.pos),l=i.data.components.indexOf(n.component);return this.events.emit("vertex-add",{type:"vertex-add",object:this.object,vertices:[{coordinates:r,componentIndex:l,vertexIndex:n.index}],added:r}),s&&this._updateEventState(Ce.NONE),o}_updateMoveManipulationPosition(){const e=(0,vec32.i)(De,0,0,0);let t=0,i=!1,n=null,a=null;for(const r of this._manipulatorInfos)"vertex"===r.type&&(r.manipulator.selected?(t++,(0,vec32.g)(e,e,r.manipulator.renderLocation),null==n||r.selectedIndex>n.selectedIndex?(a=n,n=r):(null==a||r.selectedIndex>a.selectedIndex)&&(a=r)):i=!0);const o=this.object,s=this._operations?.data.geometry;if(0===t){const e=o.visible&&this.enableMoveObject;this._moveManipulation.xyManipulation.available=e,this._moveManipulation.xyAxisManipulation.available=e,this._moveManipulation.xyAxisManipulation.orthogonalAvailable=e,this._moveManipulation.zManipulation.available=e&&this.enableZShape&&manipulatorUtils_o(this._operations,o.elevationInfo),this._moveManipulation.angle=geometryUtils_r(s),this._moveManipulation.radius=MoveManipulation_u.radiusForSymbol(o.graphic?.symbol)}else{const e=o.visible;this._moveManipulation.xyManipulation.available=e,this._moveManipulation.xyAxisManipulation.available=e,this._moveManipulation.zManipulation.available=e&&this.enableZVertex&&manipulatorUtils_o(this._operations,this.object.elevationInfo),this._moveManipulation.xyAxisManipulation.orthogonalAvailable=e&&1!==t;let i=0;if(null!=n){const e=n.handle.pos,t=null!=a?a.handle.pos:n.handle.leftEdge?.leftVertex?n.handle.leftEdge.leftVertex.pos:null,o=null==a&&n.handle.rightEdge?.rightVertex?n.handle.rightEdge.rightVertex.pos:null;t&&o?this._moveManipulation.xyAxisManipulation.available=!1:t?i=Ve(t,e):o&&(i=Ve(e,o))}this._moveManipulation.angle=i,this._moveManipulation.radius=config_o}0!==t&&i?((0,vec32.h)(e,e,1/t),Ge.spatialReference=this._operations.data.spatialReference,Ge.hasZ=!0,this.view.renderCoordsHelper.fromRenderCoords(e,Ge),this._moveManipulation.elevationAlignedLocation=Ge):null==this._outlineVisualElement||this.object.isDraped||null==this._outlineVisualElement.attachmentOrigin?manipulatorUtils_F(this._moveManipulation,this.object):this._moveManipulation.elevationAlignedLocation=this._outlineVisualElement.attachmentOrigin}_removeVertices(e){const t=new Array,i=this._operations;if(i){for(const n of e){const e=n.handle.component;if("vertex"===n.type&&i.canRemoveVertex(e)){t.push(n.handle),this._removeManipulator(n),this._removeManipulator(this._getManipulatorInfoFromHandle(n.handle.leftEdge)),this._removeManipulator(this._getManipulatorInfoFromHandle(n.handle.rightEdge));const a=i.removeVertices([n.handle]),o=a.removedVertices?.[0].createdEdge;o?this._createVertexOrEdgeManipulator(o):this.enableEdgeOffset&&e.vertices.length<=2&&this._removeManipulator(this._getManipulatorInfoFromHandle(e.edges[0]))}}if(t.length>0){const e=t.map((e=>{const t=i.data.components.indexOf(e.component);return{coordinates:i.data.coordinateHelper.vectorToArray(e.pos),componentIndex:t,vertexIndex:e.index}})),n=this._updateEventState(Ce.RESHAPING);if(this.destroyed)return;if(this.events.emit("vertex-remove",{type:"vertex-remove",object:this.object,removed:e.map((e=>e.coordinates)),vertices:e}),this.destroyed)return;if(n&&(this._updateEventState(Ce.NONE),this.destroyed))return;this._updateMoveManipulationPosition()}}}_moveVertices(e,t,i=("start"===t.action?editGeometry_interfaces.Y.NEW_STEP:editGeometry_interfaces.Y.ACCUMULATE_STEPS)){const n=this._operations;if(n){e.length>0&&n.moveVertices(e.map((e=>e.handle)),t.mapDeltaX,t.mapDeltaY,t.mapDeltaZ,i);for(const t of e)this._updateManipulatorPosition(t)}}_offsetEdge(e,t,i){if(!this._operations)return;const n=t.clone();n.distance=i,this._operations.updateVertices([e.handle.leftVertex,e.handle.rightVertex],n),this._updateManipulatorPosition(this._getManipulatorInfoFromHandle(e.handle.leftVertex)),this._updateManipulatorPosition(this._getManipulatorInfoFromHandle(e.handle.rightVertex))}_manipulatorClickCallback(e,t){e.shiftKey||this._clearSelection(),"vertex"===t.type&&(t.manipulator.selected=!t.manipulator.selected,this.enableDeleteVertices&&e.button===IViewEvents.w.Right&&this._removeVertices([t])),"edge"===t.type&&e.button===IViewEvents.w.Left&&this._splitEdgeManipulator(t),e.stopPropagation()}_updateTranslateTooltip(e,t){null!=this._defaultTooltipInfo?this._resetTooltip():this._updateTranslateObjectTooltip(e,t)}_updateTranslateObjectTooltip(e,t){this._pendingEdgeOffsetInfo||(this.activeTooltipInfo=function reshapeTooltipUtils3D_P(t,e,{sketchOptions:n,tooltipInfos:i}){let a=null;switch(t){case MoveManipulation_c.XY:a=i.translate,reshapeTooltipUtils3D_R(a,e,((t,e)=>(0,automaticLengthMeasurementUtils.Kt)(t,e)));break;case MoveManipulation_c.XY_AXIS:a=i.translateXY,reshapeTooltipUtils3D_R(a,e,((t,n)=>(0,quantityUtils.hs)((0,automaticLengthMeasurementUtils.Kt)(t,n),moveUtils_a(e))));break;case MoveManipulation_c.Z:a=i.translateZ,reshapeTooltipUtils3D_R(a,e,euclideanLengthMeasurementUtils.e5)}return a.sketchOptions=n,a}(e,t,this._tooltipsContext))}_updateEdgeOffsetTooltip(e){this._pendingEdgeOffsetInfo||(this.activeTooltipInfo=reshapeTooltipUtils3D_X(this.object,e,this._tooltipsContext))}_resetTooltip(){const e=this.activeTooltipInfo;if(this._pendingEdgeOffsetInfo&&"reshape-edge-offset"===e?.type)return;let t=null;t=this._pendingEdgeOffsetInfo||null!=this._findActiveEdgeOffsetManipulatorInfo()?reshapeTooltipUtils3D_X(this.object,null,this._tooltipsContext):this._defaultTooltipInfo,t!==e&&(null!=e&&null!=t&&"input"===this.tooltip.mode||(this.activeTooltipInfo=t))}get _defaultTooltipInfo(){const e=this._operations?.data.type;switch(e){case"polyline":case"polygon":return this._selectedVertexManipulatorInfo?this.tooltipInfos.selectedVertex:null;case"point":case"mesh":return this.tooltipInfos.movePoint;default:return null}}get _selectedVertexManipulatorInfo(){const e=this._manipulatorInfos.filter((e=>"vertex"===e.type&&e.manipulator.selected));return 1===e.length?e[0]:null}get _tooltipsContext(){return{sketchOptions:this._sketchOptions,tooltipInfos:this.tooltipInfos,activeTooltipInfo:this.activeTooltipInfo,selectedVertexManipulatorInfo:this._selectedVertexManipulatorInfo,callbacks:this._tooltipCallbacks}}get test(){}};function we(e){const t=e.size/2,i=t+e.collisionPadding;return{size:t/i,outlineSize:(t+e.outlineSize)/i}}function Ve(e,t){return Math.atan2(t[1]-e[1],t[0]-e[0])+Math.PI/2}function Te(e){return new Point.default({x:0,y:0,z:0,spatialReference:e})}function Ae(e){return"edge"===e.type&&"edgeManipulator"in e}(0,tslib_es6._)([(0,property.MZ)()],Se.prototype,"_numGrabbing",void 0),(0,tslib_es6._)([(0,property.MZ)()],Se.prototype,"_numDragging",void 0),(0,tslib_es6._)([(0,property.MZ)()],Se.prototype,"_pendingEdgeOffsetInfo",void 0),(0,tslib_es6._)([(0,property.MZ)()],Se.prototype,"_operations",null),(0,tslib_es6._)([(0,property.MZ)()],Se.prototype,"_segmentLabels",void 0),(0,tslib_es6._)([(0,property.MZ)({constructOnly:!0})],Se.prototype,"tool",void 0),(0,tslib_es6._)([(0,property.MZ)()],Se.prototype,"tooltip",void 0),(0,tslib_es6._)([(0,property.MZ)()],Se.prototype,"activeTooltipInfo",void 0),(0,tslib_es6._)([(0,property.MZ)({readOnly:!0})],Se.prototype,"updating",null),(0,tslib_es6._)([(0,property.MZ)()],Se.prototype,"manipulators",null),(0,tslib_es6._)([(0,property.MZ)()],Se.prototype,"view",null),(0,tslib_es6._)([(0,property.MZ)()],Se.prototype,"object",null),(0,tslib_es6._)([(0,property.MZ)()],Se.prototype,"enableZShape",null),(0,tslib_es6._)([(0,property.MZ)()],Se.prototype,"enableDeleteVertices",null),(0,tslib_es6._)([(0,property.MZ)()],Se.prototype,"enableZVertex",null),(0,tslib_es6._)([(0,property.MZ)()],Se.prototype,"autoHideManipulators",null),(0,tslib_es6._)([(0,property.MZ)()],Se.prototype,"enableMoveObject",null),(0,tslib_es6._)([(0,property.MZ)()],Se.prototype,"enableMidpoints",null),(0,tslib_es6._)([(0,property.MZ)()],Se.prototype,"enableEdgeOffset",null),(0,tslib_es6._)([(0,property.MZ)()],Se.prototype,"_sketchOptions",null),(0,tslib_es6._)([(0,property.MZ)()],Se.prototype,"_accentColor",null),(0,tslib_es6._)([(0,property.MZ)()],Se.prototype,"_tooltipsContext",null),Se=(0,tslib_es6._)([(0,subclass.$)("esri.views.3d.interactive.editingTools.reshape.ReshapeOperation")],Se);const Ge=(0,dehydratedPoint.T)(0,0,void 0,SpatialReference.A.WGS84),De=(0,vec3f64.vt)(),Pe=1e-6;var Le,Ce,Ne;!function(e){e.Vertex=interactive_interfaces.SJ.Custom1,e.Edge=interactive_interfaces.SJ.Custom2}(Le||(Le={})),function(e){e[e.NONE=0]="NONE",e[e.MOVING=1]="MOVING",e[e.RESHAPING=2]="RESHAPING"}(Ce||(Ce={})),function(e){e[e.ALL=0]="ALL",e[e.SELECTED_OR_ALL=1]="SELECTED_OR_ALL"}(Ne||(Ne={}));let ReshapeTool3D_h=class extends InteractiveToolBase.g{constructor(e){super(e),this._reshapeOperation=null,this.events=new Evented.A,this.enableZShape=!0,this.enableZVertex=!0,this.enableMoveObject=!0,this.enableDeleteVertices=!0,this.autoHideManipulators=!1,this.enableMidpoints=!0,this.enableEdgeOffset=!1,this.type="reshape-3d",this.sketchOptions=new SketchOptions.A,this.snappingManager=null,this.automaticManipulatorSelection=!1}initialize(){const e=this._reshapeOperation=new Se({tool:this});this.addHandles([e.events.on("reshape",(e=>this.events.emit("reshape",e))),e.events.on("move",(e=>this.events.emit("move",e))),e.events.on("vertex-add",(e=>this.events.emit("vertex-add",e))),e.events.on("vertex-remove",(e=>this.events.emit("vertex-remove",e))),e.events.on("immediate-click",(e=>this.events.emit("immediate-click",{...e,object:this.object}))),this.view.on("pointer-down",["Shift"],(e=>e.stopPropagation()))]),this.finishToolCreation()}destroy(){this._reshapeOperation=(0,maybe.pR)(this._reshapeOperation)}get updating(){return((this.object.updating??!1)||this._reshapeOperation?.updating)??!1}get activeTooltipInfo(){return this._reshapeOperation?.activeTooltipInfo??null}get tooltip(){return this._reshapeOperation?.tooltip??null}onManipulatorSelectionChanged(){this._reshapeOperation?.onManipulatorSelectionChanged()}get canUndo(){return this._reshapeOperation?.canUndo??!1}undo(){this.snappingManager?.doneSnapping(),this._reshapeOperation?.undo()}get canRedo(){return this._reshapeOperation?.canRedo??!1}redo(){this.snappingManager?.doneSnapping(),this._reshapeOperation?.redo()}onInputEvent(e){const t=this._reshapeOperation;t&&!t.enterInputModeIfAvailable(e)&&this.enableDeleteVertices&&"key-down"===e.type&&keybindings.NE.delete.includes(e.key)&&t.removeSelectedVertices()>0&&e.stopPropagation()}reset(){}};(0,tslib_es6._)([(0,property.MZ)()],ReshapeTool3D_h.prototype,"_reshapeOperation",void 0),(0,tslib_es6._)([(0,property.MZ)()],ReshapeTool3D_h.prototype,"view",void 0),(0,tslib_es6._)([(0,property.MZ)({constructOnly:!0})],ReshapeTool3D_h.prototype,"object",void 0),(0,tslib_es6._)([(0,property.MZ)()],ReshapeTool3D_h.prototype,"enableZShape",void 0),(0,tslib_es6._)([(0,property.MZ)()],ReshapeTool3D_h.prototype,"enableZVertex",void 0),(0,tslib_es6._)([(0,property.MZ)()],ReshapeTool3D_h.prototype,"enableMoveObject",void 0),(0,tslib_es6._)([(0,property.MZ)()],ReshapeTool3D_h.prototype,"enableDeleteVertices",void 0),(0,tslib_es6._)([(0,property.MZ)()],ReshapeTool3D_h.prototype,"autoHideManipulators",void 0),(0,tslib_es6._)([(0,property.MZ)()],ReshapeTool3D_h.prototype,"enableMidpoints",void 0),(0,tslib_es6._)([(0,property.MZ)()],ReshapeTool3D_h.prototype,"enableEdgeOffset",void 0),(0,tslib_es6._)([(0,property.MZ)()],ReshapeTool3D_h.prototype,"type",void 0),(0,tslib_es6._)([(0,property.MZ)({type:SketchOptions.A})],ReshapeTool3D_h.prototype,"sketchOptions",void 0),(0,tslib_es6._)([(0,property.MZ)()],ReshapeTool3D_h.prototype,"snappingManager",void 0),(0,tslib_es6._)([(0,property.MZ)()],ReshapeTool3D_h.prototype,"updating",null),(0,tslib_es6._)([(0,property.MZ)()],ReshapeTool3D_h.prototype,"activeTooltipInfo",null),(0,tslib_es6._)([(0,property.MZ)()],ReshapeTool3D_h.prototype,"tooltip",null),(0,tslib_es6._)([(0,property.MZ)()],ReshapeTool3D_h.prototype,"automaticManipulatorSelection",void 0),ReshapeTool3D_h=(0,tslib_es6._)([(0,subclass.$)("esri.views.3d.interactive.editingTools.reshape.ReshapeTool3D")],ReshapeTool3D_h);var axisAngleDegrees=__webpack_require__("./node_modules/@arcgis/core/geometry/support/axisAngleDegrees.js");let ScaleRotateMeshAdapter_g=class extends Accessor.A{constructor(t){super(t),this._interactionState=null}initialize(){this.addHandles([(0,reactiveUtils.when)((()=>{const t=this._interactionState;return t&&t.angle!==t.previousAngle?{interactionState:t,angle:t.state.angle}:null}),(({interactionState:t})=>{this._updateMeshRotation(t)}),reactiveUtils.OH),(0,reactiveUtils.when)((()=>{const t=this._interactionState;return t&&t.scale!==t.previousScale?{interactionState:t,scale:t.state.scale}:null}),(({interactionState:t})=>{this._updateMeshSize(t)}),reactiveUtils.OH)])}get geometry(){const t=manipulatedObjectUtils_t(this.object);return"mesh"===t?.type?t:null}get initialAngle(){return this._interactionState?.initialAngle??0}get angle(){const t=this.geometry?.transform;if(null==t)return this._interactionState?.angle??0;const e=(0,axisAngleDegrees.yo)(t.rotation)[2];return Math.abs(e)>.999999?(0,mathUtils.kU)((0,axisAngleDegrees.g7)(t.rotation))*Math.sign(e):0}get angleClockwise(){return-this.angle}get relativeAngle(){return this.angle-this.initialAngle}get relativeAngleClockwise(){return-this.relativeAngle}get scale(){return this._interactionState?.scale??1}startInteraction(){const t=new ScaleRotateMeshAdapter_u({angle:this.angle});this._interactionState=t;const e=()=>{this._interactionState=null};return{state:t,done:e,cancel:()=>{t.cancel(),e()}}}createUndoRecord(){return this.object.createUndoRecord()}_updateMeshRotation(t){const{geometry:e}=this;if(null==e)return;const{angle:o,previousAngle:n}=t;t.previousAngle=o;const r=(0,mathUtils.KJ)(o-n);e.rotate(0,0,r)}_updateMeshSize(t){const{geometry:e}=this;if(null==e)return;const{scale:o,previousScale:i}=t;t.previousScale=o;const n=o/i;e.scale(n)}};(0,tslib_es6._)([(0,property.MZ)({constructOnly:!0})],ScaleRotateMeshAdapter_g.prototype,"object",void 0),(0,tslib_es6._)([(0,property.MZ)()],ScaleRotateMeshAdapter_g.prototype,"geometry",null),(0,tslib_es6._)([(0,property.MZ)({constructOnly:!0})],ScaleRotateMeshAdapter_g.prototype,"viewingMode",void 0),(0,tslib_es6._)([(0,property.MZ)()],ScaleRotateMeshAdapter_g.prototype,"initialAngle",null),(0,tslib_es6._)([(0,property.MZ)()],ScaleRotateMeshAdapter_g.prototype,"angle",null),(0,tslib_es6._)([(0,property.MZ)()],ScaleRotateMeshAdapter_g.prototype,"angleClockwise",null),(0,tslib_es6._)([(0,property.MZ)()],ScaleRotateMeshAdapter_g.prototype,"relativeAngle",null),(0,tslib_es6._)([(0,property.MZ)()],ScaleRotateMeshAdapter_g.prototype,"relativeAngleClockwise",null),(0,tslib_es6._)([(0,property.MZ)()],ScaleRotateMeshAdapter_g.prototype,"scale",null),(0,tslib_es6._)([(0,property.MZ)()],ScaleRotateMeshAdapter_g.prototype,"_interactionState",void 0),ScaleRotateMeshAdapter_g=(0,tslib_es6._)([(0,subclass.$)("esri.views.3d.interactive.editingTools.transform.ScaleRotateMeshAdapter")],ScaleRotateMeshAdapter_g);let ScaleRotateMeshAdapter_u=class extends Accessor.A{get state(){const{angle:t,scale:e}=this;return{angle:t,scale:e}}constructor(t){super(t),this.angle=0,this.initialAngle=0,this.previousAngle=0,this.previousScale=1,this.scale=1,this.initialAngle=t.angle,this.previousAngle=t.angle}cancel(){this.angle=this.initialAngle,this.scale=1}};(0,tslib_es6._)([(0,property.MZ)()],ScaleRotateMeshAdapter_u.prototype,"angle",void 0),(0,tslib_es6._)([(0,property.MZ)()],ScaleRotateMeshAdapter_u.prototype,"initialAngle",void 0),(0,tslib_es6._)([(0,property.MZ)()],ScaleRotateMeshAdapter_u.prototype,"previousAngle",void 0),(0,tslib_es6._)([(0,property.MZ)()],ScaleRotateMeshAdapter_u.prototype,"previousScale",void 0),(0,tslib_es6._)([(0,property.MZ)()],ScaleRotateMeshAdapter_u.prototype,"scale",void 0),(0,tslib_es6._)([(0,property.MZ)()],ScaleRotateMeshAdapter_u.prototype,"state",null),ScaleRotateMeshAdapter_u=(0,tslib_es6._)([(0,subclass.$)("esri.views.3d.interactive.editingTools.transform.ScaleRotateMeshAdapter.InteractionState")],ScaleRotateMeshAdapter_u);let ScaleRotateObjectSymbol3DAdapter_a=class extends Accessor.A{constructor(t){super(t),this.sizeAxis=null,this._interactionState=null}initialize(){this.addHandles((0,reactiveUtils.when)((()=>null!=this._interactionState?this._interactionState.state:null),(t=>{this._updateSymbol(t)}),reactiveUtils.OH))}get initialAngle(){return this._interactionState?.initialAngle??0}get angle(){return null!=this._interactionState?this._interactionState.angle:null!=this._orientationReferenceSymbolLayer?function ScaleRotateObjectSymbol3DAdapter_c(t){return-(0,mathUtils.kU)(t)}(this._orientationReferenceSymbolLayer.heading??0):0}get angleClockwise(){return-this.angle}get orientation(){return this.angle}get orientationClockwise(){return this.angleClockwise}get relativeAngle(){return this.angle-this.initialAngle}get relativeAngleClockwise(){return-this.relativeAngle}get scale(){return this._interactionState?.scale??1}get size(){const t=this._sizeReferenceSymbolLayer;if(null==t)return null;const e=this.findLayerView(),i=this._graphicSymbol;if(null==e||null==i||"point-3d"!==i.type)return null;const l=e.getSymbolLayerSize(i,t);if("size"in l&&null!=l.size)return l.size;const n=this.sizeAxis;return!("width"in l)||null==l.width||null!=n&&"width"!==n&&"all"!==n&&"width-and-depth"!==n?!("depth"in l)||null==t.depth||null!=n&&"depth"!==n&&"all"!==n&&"width-and-depth"!==n?!("height"in l)||null==t.height||null!=n&&"height"!==n&&"all"!==n?null:l.height:l.depth:l.width}get _sizeReferenceSymbolLayer(){const t=this._graphicSymbol;return null==t||0===t.symbolLayers.length?null:t.symbolLayers.find((t=>"object"===t.type))}get _orientationReferenceSymbolLayer(){const t=this._graphicSymbol;return null==t||0===t.symbolLayers.length?null:t.symbolLayers.find((t=>"object"===t.type&&null!=t.heading))}get _graphicSymbol(){return null!=this.graphic?.symbol&&"point-3d"===this.graphic.symbol.type?this.graphic.symbol:null}set _graphicSymbol(t){this.graphic.symbol=t}startInteraction(){const t=this._graphicSymbol,e=this.findLayerView();if(null!=this._interactionState||null==t||null==e)return ScaleRotateObjectSymbol3DAdapter_h;const i=t.symbolLayers.map((i=>"object"===i.type?e.getSymbolLayerSize(t,i):null)).toArray(),l=t.clone(),n=this.angle,o=new ScaleRotateObjectSymbol3DAdapter_p({originalSymbol:l,angle:n,initialSizes:i});this._interactionState=o;const r=()=>{this._interactionState=null};return{state:o,done:r,cancel:()=>{this._graphicSymbol=l,r()}}}createUndoRecord(){let t=this.graphic.symbol,e=null;return{undo:i=>{e=i.symbol,i.symbol=t},redo:i=>{t=i.symbol,i.symbol=e}}}_updateSymbol({scale:t,angle:e,originalSymbol:l,initialSizes:n}){const o=this._graphicSymbol;if(null==o||"point-3d"!==o.type)return;const r=o.clone(),s=-(0,mathUtils.KJ)(e-this.initialAngle);let a=!1;this._forEachObjectSymbolLayerPair(l,r,((e,i,l)=>{const o=(e.heading??0)+s;i.heading!==o&&(i.heading=o,a=!0);const r=n[l];if(null!=r&&"width"in r){r.width=this.sizeFilter(r.width),r.height=this.sizeFilter(r.height),r.depth=this.sizeFilter(r.depth);const e=r.width*t;i.width!==e&&(i.width=e,a=!0);const l=r.depth*t;i.depth!==l&&(i.depth=l,a=!0);const n=r.height*t;i.height!==n&&(i.height=n,a=!0)}})),a&&(this._graphicSymbol=r)}_forEachObjectSymbolLayerPair(t,e,i){t.symbolLayers.forEach(((t,l)=>{const n=e.symbolLayers.at(l);"object"===t.type&&"object"===n.type&&i(t,n,l)}))}};(0,tslib_es6._)([(0,property.MZ)()],ScaleRotateObjectSymbol3DAdapter_a.prototype,"initialAngle",null),(0,tslib_es6._)([(0,property.MZ)()],ScaleRotateObjectSymbol3DAdapter_a.prototype,"angle",null),(0,tslib_es6._)([(0,property.MZ)()],ScaleRotateObjectSymbol3DAdapter_a.prototype,"angleClockwise",null),(0,tslib_es6._)([(0,property.MZ)()],ScaleRotateObjectSymbol3DAdapter_a.prototype,"orientation",null),(0,tslib_es6._)([(0,property.MZ)()],ScaleRotateObjectSymbol3DAdapter_a.prototype,"orientationClockwise",null),(0,tslib_es6._)([(0,property.MZ)()],ScaleRotateObjectSymbol3DAdapter_a.prototype,"relativeAngle",null),(0,tslib_es6._)([(0,property.MZ)()],ScaleRotateObjectSymbol3DAdapter_a.prototype,"relativeAngleClockwise",null),(0,tslib_es6._)([(0,property.MZ)()],ScaleRotateObjectSymbol3DAdapter_a.prototype,"scale",null),(0,tslib_es6._)([(0,property.MZ)()],ScaleRotateObjectSymbol3DAdapter_a.prototype,"size",null),(0,tslib_es6._)([(0,property.MZ)()],ScaleRotateObjectSymbol3DAdapter_a.prototype,"sizeAxis",void 0),(0,tslib_es6._)([(0,property.MZ)({constructOnly:!0})],ScaleRotateObjectSymbol3DAdapter_a.prototype,"graphic",void 0),(0,tslib_es6._)([(0,property.MZ)()],ScaleRotateObjectSymbol3DAdapter_a.prototype,"_interactionState",void 0),(0,tslib_es6._)([(0,property.MZ)({constructOnly:!0})],ScaleRotateObjectSymbol3DAdapter_a.prototype,"findLayerView",void 0),(0,tslib_es6._)([(0,property.MZ)({constructOnly:!0})],ScaleRotateObjectSymbol3DAdapter_a.prototype,"sizeFilter",void 0),(0,tslib_es6._)([(0,property.MZ)()],ScaleRotateObjectSymbol3DAdapter_a.prototype,"_sizeReferenceSymbolLayer",null),(0,tslib_es6._)([(0,property.MZ)()],ScaleRotateObjectSymbol3DAdapter_a.prototype,"_orientationReferenceSymbolLayer",null),(0,tslib_es6._)([(0,property.MZ)()],ScaleRotateObjectSymbol3DAdapter_a.prototype,"_graphicSymbol",null),ScaleRotateObjectSymbol3DAdapter_a=(0,tslib_es6._)([(0,subclass.$)("esri.views.3d.interactive.editingTools.transform.ScaleRotateObjectSymbol3DAdapter")],ScaleRotateObjectSymbol3DAdapter_a);const ScaleRotateObjectSymbol3DAdapter_h={state:{angle:0,scale:0},done:()=>{},cancel:()=>{}};let ScaleRotateObjectSymbol3DAdapter_p=class extends Accessor.A{get state(){const{originalSymbol:t,angle:e,initialAngle:i,scale:l,initialSizes:n}=this;return{originalSymbol:t,angle:e,initialAngle:i,scale:l,initialSizes:n}}constructor(t){super(t),this.angle=0,this.initialAngle=0,this.scale=1,this.initialAngle=t.angle}};(0,tslib_es6._)([(0,property.MZ)()],ScaleRotateObjectSymbol3DAdapter_p.prototype,"originalSymbol",void 0),(0,tslib_es6._)([(0,property.MZ)()],ScaleRotateObjectSymbol3DAdapter_p.prototype,"angle",void 0),(0,tslib_es6._)([(0,property.MZ)()],ScaleRotateObjectSymbol3DAdapter_p.prototype,"initialAngle",void 0),(0,tslib_es6._)([(0,property.MZ)()],ScaleRotateObjectSymbol3DAdapter_p.prototype,"initialSizes",void 0),(0,tslib_es6._)([(0,property.MZ)()],ScaleRotateObjectSymbol3DAdapter_p.prototype,"scale",void 0),(0,tslib_es6._)([(0,property.MZ)()],ScaleRotateObjectSymbol3DAdapter_p.prototype,"state",null),ScaleRotateObjectSymbol3DAdapter_p=(0,tslib_es6._)([(0,subclass.$)("esri.views.3d.interactive.editingTools.transform.ScaleRotateObjectSymbol3DAdapter.InteractionState")],ScaleRotateObjectSymbol3DAdapter_p);var mt,Cyclical=__webpack_require__("./node_modules/@arcgis/core/core/Cyclical.js"),scheduling=__webpack_require__("./node_modules/@arcgis/core/core/scheduling.js");!function(t){t.ScaleIn=interactive_interfaces.SJ.Custom2,t.ScaleOut=interactive_interfaces.SJ.Custom3,t.RotateLeft=interactive_interfaces.SJ.Custom4,t.RotateRight=interactive_interfaces.SJ.Custom5,t.Unlocked=interactive_interfaces.SJ.Custom7,t.DelayedFocused=interactive_interfaces.SJ.Custom8,t.TouchInput=interactive_interfaces.SJ.Custom12}(mt||(mt={}));let gt=class extends Accessor.A{get angle(){return this.adapter.angle}get scale(){return this.adapter.scale}set location(t){this._ringManipulator.location=t}set elevationAlignedLocation(t){this._ringManipulator.elevationAlignedLocation=t}get grabbing(){return this._ringManipulator.grabbing}set interactive(t){this._ringManipulator.interactive=t}get updating(){return!!this._activeAnimation}constructor(t){super(t),this.mode=null,this._scaleRotateDragData=null,this._activeAnimation=null,this._ringIndicatorDelayMs=200,this.events=new Evented.A,this.getFocused=()=>this._ringManipulator.focused,this.getScale=()=>"scale"===this._scaleRotateDragData?.mode?this.adapter.scale:1}initialize(){this._createManipulator(),this._updateDragState(),this._updateManipulatorTransform(),this.addHandles([(0,reactiveUtils.watch)((()=>{const{adapter:t}=this;return[t.angle,t.scale]}),(()=>this._updateManipulatorTransform()))])}destroy(){this._activeAnimation?.frameTask.remove(),this._activeAnimation=null,this.tool.manipulators.remove(this._ringManipulator),this._ringManipulator=null}startAnimation(t){this.cancelActiveAnimation(),t.start();const e=(0,scheduling.mg)({update:({deltaTime:e})=>{t.update(e)&&this.cancelActiveAnimation()}});this._activeAnimation={...t,frameTask:e}}cancelActiveAnimation(){this._activeAnimation?.frameTask.remove(),this._activeAnimation=(0,maybe.pR)(this._activeAnimation)}forEachManipulator(t){t(this._ringManipulator,ManipulatorType_A.SCALE_ROTATE)}_createManipulator(){const t=this._createRingManipulator();this._ringManipulator=t,this.tool.manipulators.add(t);const e=this.tool.object,a=(0,dragEventPipeline.Xt)(t,((t,a,i)=>{this._scaleRotateDragData=null;const n=this.adapter.startInteraction(),l={mode:"none",origin:(0,vec3f64.o8)(t.renderLocation),initialAngle:this.adapter.angle,angle:0,angleDir:0,scaleDir:0};this._scaleRotateDragData=l,this._updateDragState();const c=vectorStacks.rq.get();this.tool.view.renderCoordsHelper.worldUpAtPosition(t.renderLocation,c),a.next(dragEventPipeline3D_C(this.tool.view,(0,plane.O_)(t.renderLocation,c,(0,plane.vt)()))).next((t=>{const a=(0,plane.Qj)(t.plane),i=manipulatorUtils_w(t.renderStart,t.renderEnd,l.origin,a),c=Cyclical.wf.shortestSignedDiff(l.angle,i);l.angleDir=(0,mathUtils.qE)(l.angleDir+c,-.3,.3),l.angle=i;const d=function ft(t,e){const a=(0,vec32.d)(vectorStacks.rq.get(),e.renderStart,t.origin),o=(0,vec32.d)(vectorStacks.rq.get(),e.renderEnd,t.origin),i=(0,vec32.l)(a),r=(0,vec32.l)(o);return 0===i?0:r/i}(l,t),h=d-this.adapter.scale;if(l.scaleDir=(0,mathUtils.qE)(l.scaleDir+h,-.2,.2),this._onScaleChanged(),"none"===l.mode){const a=this.mode||function _t(t,e,a,o){const{renderStart:i,renderEnd:r}=t,s=Dt(i,o,vectorStacks.rq.get()),n=Dt(r,o,vectorStacks.rq.get());if((0,vec32.s)(s,n)<100)return null;const l=(0,vec32.d)(vectorStacks.rq.get(),i,a),c=(0,vec32.e)(vectorStacks.rq.get(),l,(0,plane.Qj)(e)),d=i,h=(0,vec32.g)(vectorStacks.rq.get(),d,c),u=Dt(a,o,vectorStacks.rq.get()),p=s,m=Dt(h,o,vectorStacks.rq.get()),g=(0,vec32.d)(vectorStacks.rq.get(),m,p),f=(0,vec32.d)(vectorStacks.rq.get(),s,u),_=(0,ray.LV)(p,g),D=(0,ray.LV)(u,f);return(0,ray.kb)(_,n)<(0,ray.kb)(D,n)?"rotate":"scale"}(t,t.plane,l.origin,this.tool.view.state.camera);if(null!=a){switch(a){case"rotate":this.tool.events.emit("rotate-start",{object:e,angle:0}),this.tool.events.emit("record-undo",{updates:[this.adapter.createUndoRecord()]});break;case"scale":this.tool.events.emit("scale-start",{object:e,xScale:1,yScale:1}),this.tool.events.emit("record-undo",{updates:[this.adapter.createUndoRecord()]})}l.mode=a}}switch(l.mode){case"rotate":n.state.angle=l.initialAngle+i;break;case"scale":n.state.scale=d,this._onScaleChanged()}switch(this._updateDragState(),this._updateManipulatorTransform(),t.action){case"start":case"update":switch(l.mode){case"rotate":this.tool.events.emit("rotate",{object:e,angle:(0,mathUtils.KJ)(l.angle)});break;case"scale":this.tool.events.emit("scale",{object:e,xScale:d,yScale:d})}break;case"end":switch(l.mode){case"rotate":this.tool.events.emit("rotate-stop",{object:e,angle:(0,mathUtils.KJ)(l.angle)});break;case"scale":this.tool.events.emit("scale-stop",{object:e,xScale:d,yScale:d})}}return"end"===t.action&&(this.startAnimation(vt(this,(()=>this._onScaleChanged()))),this._scaleRotateDragData=null,this._updateDragState(),n.done()),t})),i.next((()=>{if(n.cancel(),null!=this._scaleRotateDragData){switch(this._scaleRotateDragData.mode){case"none":break;case"rotate":this.tool.events.emit("rotate-stop",{object:e,angle:0});break;case"scale":this.tool.events.emit("scale-stop",{object:e,xScale:1,yScale:1})}this.startAnimation(vt(this,(()=>this._onScaleChanged()))),this._scaleRotateDragData=null,this._updateDragState()}}))}));this.addHandles([a,t.events.on("focus-changed",(t=>{"focus"===t.action?this.startAnimation(function Mt(t,e,a){let o=0,i=null;const r=()=>!1;return{start:()=>{i=t.getFocused,t.getFocused=r,o=0,e()},update:t=>(o+=t,!i?.()||o>=a.delayMs?St.STOP:St.CONTINUE),destroy:()=>{i&&(t.getFocused=i),e()}}}(this,(()=>this._updateDelayedFocusedState()),{delayMs:this._ringIndicatorDelayMs})):this._updateDelayedFocusedState()})),t.events.on("immediate-click",(t=>{t.stopPropagation()})),(0,reactiveUtils.watch)((()=>this.tool.object.visible),(t=>this._ringManipulator.available=t),reactiveUtils.Vh)])}_onScaleChanged(){this.events.emit("scale-changed"),this._updateManipulatorTransform()}_updateDelayedFocusedState(){this._ringManipulator.updateStateEnabled(mt.DelayedFocused,this.getFocused())}_updateDragState(){if(this._ringManipulator.updateStateEnabled(mt.Unlocked,!(null!=this._scaleRotateDragData&&"none"!==this._scaleRotateDragData?.mode)),null!=this._scaleRotateDragData)switch(this._scaleRotateDragData.mode){case"rotate":this._ringManipulator.updateStateEnabled(mt.ScaleIn|mt.ScaleOut,!1),this._ringManipulator.updateStateEnabled(mt.RotateLeft,this._scaleRotateDragData.angleDir<0),this._ringManipulator.updateStateEnabled(mt.RotateRight,this._scaleRotateDragData.angleDir>=0);break;case"scale":this._ringManipulator.updateStateEnabled(mt.RotateLeft|mt.RotateRight,!1),this._ringManipulator.updateStateEnabled(mt.ScaleIn,this._scaleRotateDragData.scaleDir<0),this._ringManipulator.updateStateEnabled(mt.ScaleOut,this._scaleRotateDragData.scaleDir>=0)}else this._ringManipulator.updateStateEnabled(mt.ScaleIn|mt.ScaleOut|mt.RotateLeft|mt.RotateRight,!1)}_updateManipulatorTransform(){const t=(0,mat4.$0)(vectorStacks.Rc.get(),this.adapter.angle,(0,vec3f64.fA)(0,0,1));if(null==t)return;const e=this.getScale(),a=(0,mat4.CV)(vectorStacks.Rc.get(),(0,vec32.i)(vectorStacks.rq.get(),e,e,e));this._ringManipulator.modelTransform=(0,mat4.lw)(vectorStacks.Rc.get(),a,t)}_createRingManipulator(){const t=(t,e,a)=>{const o=[],i=Math.ceil(128*(e-t)/(2*Math.PI));for(let r=0;r<i+1;r++){const s=t+r*(e-t)/i;o.push((0,vec3f64.fA)(a*Math.cos(s),a*Math.sin(s),0))}return o},e=e=>t(0,2*Math.PI,e),o=this._createMaterial(1),i=(t,e,i=o)=>(0,GeometryUtil.Nq)(i,(t=>[[-t/2,0],[t/2,0],[t/2,.25],[-t/2,.25]])(e),t,[],[],!1),r=e(160),s=i(r,24),n={left:new Array,right:new Array},l=[];for(let w=0;w<2;w++){const e=w*Math.PI-Math.PI/4,a=Math.PI/2-config_x,r=e+a,s=e+Math.PI/2-a,c=t(r,s,190),d=i(c,9);l.push(c),l.push(t(r,s,201)),n.left.push(d),n.right.push(d.instantiate());for(let t=0;t<2;t++){const e=0===t,a=(0,mat4f64.vt)();if(e){(0,mat4.hs)(a,a,[1,-1,1]),(0,mat4.e$)(a,a,-r,[0,0,1]);const t=Math.round(.2*(c.length-1));a[12]=c[t][0],a[13]=c[t][1],a[14]=c[t][2]}else{(0,mat4.e$)(a,a,s,[0,0,1]);const t=Math.round(.8*(c.length-1));a[12]=c[t][0],a[13]=c[t][1],a[14]=c[t][2]}const i=(0,GeometryUtil._B)(o,60,0,23,.5);(0,GeometryUtil.xh)(i,a),(e?n.left:n.right).push(i)}}const c=[];for(let _=0;_<2;_++){const e=_*Math.PI-Math.PI/4,a=Math.PI/2-config_b,o=e+a,r=e+Math.PI/2-a,s=t(o,r,213);c.push(i(s,9))}const d=this._createMaterial(.66),h=this._createMaterial(.5),u=this._createMaterial(.33),p=e(190),m=e(213),g=i(p,9,d),f=i(m,9,u),v=e(130),M=e(107),b=i(v,9,d),j=i(M,9,u);let y=[new RenderObject_e(s,mt.DelayedFocused),new RenderObject_e(s.instantiate({material:h}),interactive_interfaces.p7.None)];this.mode&&"scale"!==this.mode||(y=y.concat([...c.map((t=>new RenderObject_e(t,mt.DelayedFocused|mt.Unlocked))),new RenderObject_e(g,mt.DelayedFocused|mt.ScaleIn),new RenderObject_e(f,mt.DelayedFocused|mt.ScaleIn),new RenderObject_e(b,mt.DelayedFocused|mt.ScaleOut),new RenderObject_e(j,mt.DelayedFocused|mt.ScaleOut)])),this.mode&&"rotate"!==this.mode||(y=y.concat([...n.right.map((t=>new RenderObject_e(t.instantiate(),mt.DelayedFocused|mt.Unlocked))),...n.left.map((t=>new RenderObject_e(t,mt.DelayedFocused|mt.RotateLeft))),...n.right.map((t=>new RenderObject_e(t,mt.DelayedFocused|mt.RotateRight)))]));const R=[r,...l];return new ee({view:this.tool.view,renderObjects:y,autoScaleRenderObjects:!1,worldOriented:!0,radius:24,focusMultiplier:1,touchMultiplier:1.5,elevationInfo:this.tool.object.elevationInfo,collisionType:{type:"ribbon",paths:R,direction:(0,vec3f64.fA)(0,0,1)}})}_createMaterial(t){const e=new ColorMaterial.v({cullFace:basicInterfaces.s2.Back,renderOccluded:Material.m$.Transparent,isDecoration:!0});return this.addHandles((0,reactiveUtils.watch)((()=>(0,colorUtils.f6)(this.tool.view.effectiveTheme.accentColor,t)),(t=>e.setParameters({color:t})),reactiveUtils.Vh)),e}get test(){}};function Dt(t,e,a){return e.projectToScreen(t,bt),(0,vec32.i)(a,bt[0],bt[1],0)}var St;function vt(t,e){let a=null,o=1;const i=()=>o;return{start:()=>{o=t.getScale(),a=t.getScale,t.getScale=i,e()},update:t=>(o+=((o+1)/2-o)*Math.min(3*t,1),e(),Math.abs(o-1)<.01?St.STOP:St.CONTINUE),destroy:()=>{a&&(t.getScale=a),e()}}}(0,tslib_es6._)([(0,property.MZ)({constructOnly:!0})],gt.prototype,"tool",void 0),(0,tslib_es6._)([(0,property.MZ)({constructOnly:!0})],gt.prototype,"adapter",void 0),(0,tslib_es6._)([(0,property.MZ)({constructOnly:!0})],gt.prototype,"sketchOptions",void 0),(0,tslib_es6._)([(0,property.MZ)()],gt.prototype,"mode",void 0),(0,tslib_es6._)([(0,property.MZ)()],gt.prototype,"_activeAnimation",void 0),(0,tslib_es6._)([(0,property.MZ)()],gt.prototype,"updating",null),gt=(0,tslib_es6._)([(0,subclass.$)("esri.views.3d.interactive.editingTools.transform.ScaleRotateTransform")],gt),function(t){t[t.CONTINUE=0]="CONTINUE",t[t.STOP=1]="STOP"}(St||(St={}));const bt=(0,screenUtils.gs)();var TooltipInfoWithCoordinates=__webpack_require__("./node_modules/@arcgis/core/views/interactive/tooltip/infos/TooltipInfoWithCoordinates.js");let TransformMeshTooltipInfo_l=class extends((0,TooltipInfoWithCoordinates.B)(SketchTooltipInfo.w)){constructor(t){super(t),this.type="transform-mesh",this.orientation=(0,fields.LJ)(),this.scale=(0,fields.dy)(),this.allFields.forEach((t=>{t.lockable=!1,t.setActual(null)}))}get key(){return{longitude:this.longitude.actual,latitude:this.latitude.actual,x:this.x.actual,y:this.y.actual,elevation:this.elevation.actual,geographic:this.geographic,orientation:this.orientation.actual,scale:this.scale.actual}}get allFields(){return[this.longitude,this.latitude,this.x,this.y,this.elevation,this.orientation,this.scale]}};(0,tslib_es6._)([(0,property.MZ)()],TransformMeshTooltipInfo_l.prototype,"key",null),(0,tslib_es6._)([(0,property.MZ)()],TransformMeshTooltipInfo_l.prototype,"allFields",null),TransformMeshTooltipInfo_l=(0,tslib_es6._)([(0,subclass.$)("esri.views.interactive.tooltip.infos.TransformMeshTooltipInfo")],TransformMeshTooltipInfo_l);let TransformPointTooltipInfo_a=class extends((0,TooltipInfoWithCoordinates.B)(SketchTooltipInfo.w)){constructor(o){super(o),this.type="transform-point",this.orientation=(0,fields.LJ)({readOnly:!0}),this.size=(0,fields.qP)({readOnly:!0}),this.allFields.forEach((o=>{o.lockable=!1,o.setActual(null)}))}get allFields(){return[this.longitude,this.latitude,this.x,this.y,this.elevation,this.orientation,this.size]}};(0,tslib_es6._)([(0,property.MZ)()],TransformPointTooltipInfo_a.prototype,"allFields",null),TransformPointTooltipInfo_a=(0,tslib_es6._)([(0,subclass.$)("esri.views.interactive.tooltip.infos.TransformPointTooltipInfo")],TransformPointTooltipInfo_a);let TransformTool3D_z=class extends InteractiveToolBase.g{constructor(t){super(t),this.events=new Evented.A,this.enableZ=!0,this.enableRotation=!0,this.enableScaling=!0,this.sketchOptions=new SketchOptions.A,this.type="transform-3d",this._updatingHandles=new UpdatingHandles.U,this._scaleRotate=null}initialize(){const{events:t,object:o,view:a}=this;this.tooltip=(0,tooltipCommonUtils.A)((()=>({view:a,options:this.sketchOptions.tooltips}))),this._moveManipulation=new MoveManipulation_u({tool:this,view:a,snapToScene:this.snapToScene,xyAvailable:!0,xyAxisAvailable:!0,zAvailable:this.enableZ&&manipulatorUtils_o(o.operations,o.elevationInfo),radius:MoveManipulation_u.radiusForSymbol(o.graphic?.symbol)}),this._moveManipulation.forEachManipulator((e=>this.addHandles(e.events.on("immediate-click",(e=>{t.emit("immediate-click",{...e,object:this.object}),e.stopPropagation()})))));const s=o.elevationInfo;if(this._moveManipulation.elevationInfo=s,this.addHandles(meshFastUpdateUtils_a(o)),this._moveManipulation.createManipulatedObjectDragPipeline(((t,e,i,n,r)=>{if(t===MoveManipulation_c.XY){const{snappingStep:t,cancelSnapping:e}=(0,SnappingDragPipelineStep.L)({snappingContext:new SnappingContext.e({elevationInfo:s,pointer:r,editGeometryOperations:EditGeometryOperations.p.fromGeometry(new Point.default({spatialReference:o.operations?.data.spatialReference}),a.state.viewingMode),visualizer:new SnappingVisualizer3D_R,excludeFeature:o.graphic}),snappingManager:this.snappingManager,updatingHandles:this._updatingHandles,useZ:!1});n=n.next(e),i=i.next((0,dragEventPipeline.RS)(this.view,s)).next(...t)}return{steps:i,cancel:n}}),o,(e=>{const{action:o,object:i,dxScreen:a,dyScreen:n}=e,s={object:i,dxScreen:a,dyScreen:n};switch(o){case"start":this._emitRecordUndo(),t.emit("translate-start",s);break;case"update":t.emit("translate",s);break;case"end":t.emit("translate-stop",s)}})),this._moveManipulation.angle=null!=this._scaleRotate?this._scaleRotate.angle:0,this._scaleRotateAdapter=this._createScaleRotateAdapter(),this.addHandles((0,reactiveUtils.watch)((()=>this._scaleRotateAdapter.angle),(()=>this._updateMoveAngle()))),this.enableScaling||this.enableRotation){const t=this.enableScaling&&this.enableRotation?null:this.enableScaling?"scale":"rotate";this._scaleRotate=new gt({tool:this,mode:t,adapter:this._scaleRotateAdapter,sketchOptions:this.sketchOptions}),this.addHandles(this._scaleRotate.events.on("scale-changed",(()=>this._onScaleChanged())))}this.addHandles([visualElementUtils_l({view:this.view,object:o,forEachManipulator:t=>this._forEachManipulator(t),onManipulatorsChanged:()=>(0,handleUtils.hA)()}),o.on("committed",(()=>this._onGeometryChanged())),this._hideManipulatorsForObjectState(),(0,reactiveUtils.watch)((()=>a.scale),(()=>this._updateMoveAngle()))].filter(arrayUtils.Ru)),this._onGeometryChanged(),this._updateMoveAngle(),this._forEachManipulator((t=>{t instanceof ee&&this.addHandles(t.events.on("grab-changed",(()=>this._updateManipulatorsInteractive())))}));const r=a?.type,{sketchOptions:l}=this;this._meshTooltipInfo=new TransformMeshTooltipInfo_l({viewType:r,sketchOptions:l}),this._pointTooltipInfo=new TransformPointTooltipInfo_a({viewType:r,sketchOptions:l});const c={object:o,dxScreen:0,dyScreen:0},m={onBeforeUpdate:()=>this.endDrag(),onMoveStart:()=>{this._emitRecordUndo(),t.emit("translate-start",{...c})},onMove:()=>t.emit("translate",{...c}),onMoveStop:()=>t.emit("translate-stop",{...c}),onRotateStart:e=>{this._emitRecordUndo(),t.emit("rotate-start",{object:o,angle:e})},onRotate:e=>t.emit("rotate",{object:o,angle:e}),onRotateStop:e=>t.emit("rotate-stop",{object:o,angle:e}),onScaleStart:(e,i)=>{this._emitRecordUndo(),t.emit("scale-start",{object:o,xScale:e,yScale:i})},onScale:(e,i)=>t.emit("scale",{object:o,xScale:e,yScale:i}),onScaleStop:(e,i)=>t.emit("scale-stop",{object:o,xScale:e,yScale:i})};this.addHandles(tooltipUtils3D_m(this.tooltip,this.object,(()=>({sketchOptions:this.sketchOptions,activeTooltipInfo:this.activeTooltipInfo,callbacks:m,scaleRotateTransform:this._scaleRotate})))),this.finishToolCreation()}destroy(){this.tooltip.destroy(),this._moveManipulation.destroy(),this._scaleRotate=(0,maybe.pR)(this._scaleRotate),this._scaleRotateAdapter=(0,maybe.pR)(this._scaleRotateAdapter),this._updatingHandles.destroy(),this._set("view",null),this._set("object",null)}onInputEvent(t){if(!this.destroyed&&!(0,tooltipCommonUtils.wG)(t,this.tooltip))return super.onInputEvent(t)}_updateManipulatorsInteractive(){null!=this._scaleRotate&&(this._scaleRotate.interactive=!this._moveManipulation.grabbing,this._moveManipulation.interactive=!this._scaleRotate.grabbing)}_createScaleRotateAdapter(){const t=manipulatedObjectUtils_t(this.object);return"mesh"===t?.type?new ScaleRotateMeshAdapter_g({object:this.object,viewingMode:this.view.state.viewingMode}):new ScaleRotateObjectSymbol3DAdapter_a({graphic:this.object.graphic,sizeFilter:t=>this._enforceNonZeroSize(t),findLayerView:()=>this.view.allLayerViews.find((t=>t.layer===this.object.graphic?.layer)),sizeAxis:this.sketchOptions?.tooltips?.visualVariables?.size?.axis??null})}_forEachManipulator(t){this._moveManipulation?.forEachManipulator(t),this._scaleRotate?.forEachManipulator(t)}_hideManipulatorsForObjectState(){return(0,reactiveUtils.watch)((()=>this.object.visible),(t=>{this._forEachManipulator((e=>e.available=t)),this._moveManipulation.zManipulation.available=t&&this.enableZ&&manipulatorUtils_o(this.object.operations,this.object.elevationInfo)}))}_emitRecordUndo(){this.events.emit("record-undo",{updates:[this.object.createUndoRecord()]})}set snapToScene(t){this._moveManipulation&&(this._moveManipulation.snapToScene=t),this._set("snapToScene",t)}get updating(){return this._updatingHandles.updating||!!this._scaleRotate?.updating}get activeTooltipInfo(){return"mesh"===manipulatedObjectUtils_t(this.object)?.type?this._meshTooltipInfo:this._pointTooltipInfo}set location(t){this._moveManipulation.location=t,this._scaleRotate&&(this._scaleRotate.location=t)}set elevationAlignedLocation(t){this._moveManipulation.elevationAlignedLocation=t,this._scaleRotate&&(this._scaleRotate.elevationAlignedLocation=t)}reset(){}onHide(){this._scaleRotate?.cancelActiveAnimation()}_onScaleChanged(){null!=this._scaleRotate&&(this._moveManipulation.displayScale=this._scaleRotate.getScale())}_updateMoveAngle(){const{view:t}=this,e=t.state.viewingMode===ViewingMode.RT.Local||t.scale<1e6;this._moveManipulation.angle=e?this._scaleRotateAdapter.angle:0}_onGeometryChanged(){manipulatorUtils_F(this,this.object)}_enforceNonZeroSize(t){return t||this.view.state.camera.computeRenderPixelSizeAt(this._moveManipulation.renderLocation)}get test(){}};(0,tslib_es6._)([(0,property.MZ)({constructOnly:!0,nonNullable:!0})],TransformTool3D_z.prototype,"view",void 0),(0,tslib_es6._)([(0,property.MZ)({constructOnly:!0,nonNullable:!0})],TransformTool3D_z.prototype,"object",void 0),(0,tslib_es6._)([(0,property.MZ)({constructOnly:!0,nonNullable:!0})],TransformTool3D_z.prototype,"enableZ",void 0),(0,tslib_es6._)([(0,property.MZ)()],TransformTool3D_z.prototype,"enableRotation",void 0),(0,tslib_es6._)([(0,property.MZ)()],TransformTool3D_z.prototype,"enableScaling",void 0),(0,tslib_es6._)([(0,property.MZ)({constructOnly:!0,type:SketchOptions.A})],TransformTool3D_z.prototype,"sketchOptions",void 0),(0,tslib_es6._)([(0,property.MZ)({value:!1})],TransformTool3D_z.prototype,"snapToScene",null),(0,tslib_es6._)([(0,property.MZ)({constructOnly:!0})],TransformTool3D_z.prototype,"snappingManager",void 0),(0,tslib_es6._)([(0,property.MZ)({readOnly:!0})],TransformTool3D_z.prototype,"type",void 0),(0,tslib_es6._)([(0,property.MZ)({readOnly:!0})],TransformTool3D_z.prototype,"updating",null),(0,tslib_es6._)([(0,property.MZ)()],TransformTool3D_z.prototype,"activeTooltipInfo",null),TransformTool3D_z=(0,tslib_es6._)([(0,subclass.$)("esri.views.3d.interactive.editingTools.transform.TransformTool3D")],TransformTool3D_z);var Clonable=__webpack_require__("./node_modules/@arcgis/core/core/Clonable.js"),JSONSupport=__webpack_require__("./node_modules/@arcgis/core/core/JSONSupport.js"),cast=__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/decorators/cast.js"),ensureType=__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/ensureType.js"),persistable=__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/decorators/persistable.js");let SlicePlane_c=class extends(Clonable.A.ClonableMixin(JSONSupport.A)){constructor(o){super(o),this.type="plane",this.position=null,this.heading=0,this.tilt=0,this.width=10,this.height=10}equals(o){return this.heading===o.heading&&this.tilt===o.tilt&&(0,maybe.CM)(this.position,o.position)&&this.width===o.width&&this.height===o.height}};(0,tslib_es6._)([(0,property.MZ)({readOnly:!0,json:{read:!1,write:!0}})],SlicePlane_c.prototype,"type",void 0),(0,tslib_es6._)([(0,property.MZ)({type:Point.default}),(0,persistable.P)()],SlicePlane_c.prototype,"position",void 0),(0,tslib_es6._)([(0,property.MZ)({type:Number,nonNullable:!0,range:{min:0,max:360}}),(0,persistable.P)(),(0,cast.w)((o=>Cyclical.ie.normalize((0,ensureType.GB)(o),0,!0)))],SlicePlane_c.prototype,"heading",void 0),(0,tslib_es6._)([(0,property.MZ)({type:Number,nonNullable:!0,range:{min:0,max:360}}),(0,persistable.P)(),(0,cast.w)((o=>Cyclical.ie.normalize((0,ensureType.GB)(o),0,!0)))],SlicePlane_c.prototype,"tilt",void 0),(0,tslib_es6._)([(0,property.MZ)({type:Number,nonNullable:!0}),(0,persistable.P)()],SlicePlane_c.prototype,"width",void 0),(0,tslib_es6._)([(0,property.MZ)({type:Number,nonNullable:!0}),(0,persistable.P)()],SlicePlane_c.prototype,"height",void 0),SlicePlane_c=(0,tslib_es6._)([(0,subclass.$)("esri.analysis.SlicePlane")],SlicePlane_c);__webpack_require__("./node_modules/@arcgis/core/geometry/Extent.js"),__webpack_require__("./node_modules/@arcgis/core/geometry/support/Axis.js");var boundedPlane=__webpack_require__("./node_modules/@arcgis/core/chunks/boundedPlane.js");(0,vec4f64.fA)(0,0,0,.04);(0,has.A)("mac"),Math.cos((0,mathUtils.kU)(45)),Math.cos((0,mathUtils.kU)(5));(0,mat4f64.vt)();new ShaderTechniqueConfiguration.K;var DefaultBufferWriter=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/materials/DefaultBufferWriter.js"),DefaultLayouts=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/materials/DefaultLayouts.js"),TriangleMaterial=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/materials/TriangleMaterial.js");__webpack_require__("./node_modules/@arcgis/core/chunks/SlicePlaneMaterial.glsl.js");NoParameters.Y;ShaderTechnique.w;TriangleMaterial.W;GLMaterial.A;var fi;__webpack_require__("./node_modules/@arcgis/core/views/3d/support/RenderCoordsHelper.js");function hi(i){const t=(0,vec32.l)(i.basis1),e=(0,vec32.l)(i.basis2);return.3*Math.min(t,e)}function Ii(i){return hi(i)}function Ei(i){return 0!==i.direction[0]&&0!==i.direction[1]}!function(i){i[i.POSITIVE_X=0]="POSITIVE_X",i[i.POSITIVE_Y=1]="POSITIVE_Y",i[i.NEGATIVE_X=2]="NEGATIVE_X",i[i.NEGATIVE_Y=3]="NEGATIVE_Y"}(fi||(fi={}));const Ci=interactive_interfaces.SJ.Custom1;var _i,Mi;!function(i){i[i.HEADING=1]="HEADING",i[i.TILT=2]="TILT"}(_i||(_i={})),function(i){i[i.HORIZONTAL_OR_VERTICAL=0]="HORIZONTAL_OR_VERTICAL",i[i.HORIZONTAL=1]="HORIZONTAL",i[i.VERTICAL=2]="VERTICAL",i[i.TILTED=3]="TILTED"}(Mi||(Mi={}));const Si=interactive_interfaces.SJ.Custom2,Ni=((0,ray.vt)(),Math.PI/2),Hi=interactive_interfaces.SJ.Custom1,Ui=interactive_interfaces.SJ.Custom2;var ShiftManipulator_H,quat=__webpack_require__("./node_modules/@arcgis/core/core/libs/gl-matrix-2/math/quat.js");!function(e){e[e.CENTER_ON_CALLOUT=0]="CENTER_ON_CALLOUT",e[e.CENTER_ON_ARROW=1]="CENTER_ON_ARROW"}(ShiftManipulator_H||(ShiftManipulator_H={}));class ShiftManipulator_I extends ee{constructor(a,n){const i=new RibbonLineMaterial.W({width:1,renderOccluded:Material.m$.OccludeAndTransparent,isDecoration:!0}),s=new ColorMaterial.v({cullFace:basicInterfaces.s2.Back,renderOccluded:Material.m$.Opaque,isDecoration:!0}),c=new ColorMaterial.v({cullFace:basicInterfaces.s2.Back,renderOccluded:Material.m$.Opaque,isDecoration:!0}),l=new ColorMaterial.v({cullFace:basicInterfaces.s2.Back,renderOccluded:Material.m$.Opaque,isDecoration:!0}),m=new ColorMaterial.v({writeDepth:!1,cullFace:basicInterfaces.s2.Front,renderOccluded:Material.m$.Transparent,isDecoration:!0});super({view:a,...ShiftManipulator_S({offsetMode:n,tubeMaterial:s,tipMaterial:c,capMaterial:l,outlineMaterial:m,calloutMaterial:i})}),this._themeHandle=(0,reactiveUtils.watch)((()=>a.effectiveTheme.accentColor),(r=>{const o=(0,colorUtils.bJ)(r),a=Color.A.toUnitRGBA(r),n=Color.A.toUnitRGBA(o),p=Color.A.toUnitRGBA(Color.A.blendColors(o,r,.4)),u=Color.A.toUnitRGBA(Color.A.blendColors(o,r,.14));i.setParameters({color:a}),s.setParameters({color:u}),c.setParameters({color:n}),l.setParameters({color:p}),m.setParameters({color:a})}),reactiveUtils.Vh)}destroy(){this._themeHandle.remove(),super.destroy()}}function ShiftManipulator_S({offsetMode:e,tubeMaterial:t,tipMaterial:r,capMaterial:o,outlineMaterial:a,calloutMaterial:n}){const i=e===ShiftManipulator_H.CENTER_ON_CALLOUT?40:0,s=[(0,vec3f64.fA)(i,0,-24),(0,vec3f64.fA)(i,0,24)],c=function ShiftManipulator_J(e,t){const r=(0,vec32.d)((0,vec3f64.vt)(),e[e.length-1],e[e.length-2]);(0,vec32.n)(r,r),(0,vec32.h)(r,r,22.5),(0,vec32.g)(r,r,e[e.length-1]);{const t=(0,vec32.d)((0,vec3f64.vt)(),e[0],e[1]);return(0,vec32.n)(t,t),(0,vec32.h)(t,t,22.5),(0,vec32.g)(t,t,e[0]),[t,...e,r]}}(s),l=ShiftManipulator_W({vertices:s,padding:0,materials:{tube:t,tip:r,cap:o}}),m=ShiftManipulator_W({vertices:s,padding:2.25,materials:{tube:a,tip:a,cap:a}}),p=(0,GeometryUtil.Z8)(n,[[i,0,0],[i-40,0,0]]),u=(0,GeometryUtil.Z8)(n,[[i,0,0],[i-40,0,0]]);return{renderObjects:[...l.normal.map((e=>new RenderObject_e(e,interactive_interfaces.p7.Unfocused|Ci))),...m.normal.map((e=>new RenderObject_e(e,interactive_interfaces.p7.Unfocused|Ci))),new RenderObject_e(p,interactive_interfaces.p7.Unfocused|Ci|Si),...l.focused.map((e=>new RenderObject_e(e,interactive_interfaces.p7.Focused|Ci))),...m.focused.map((e=>new RenderObject_e(e,interactive_interfaces.p7.Focused|Ci))),new RenderObject_e(u,interactive_interfaces.p7.Focused|Ci|Si)],autoScaleRenderObjects:!1,collisionType:{type:"line",paths:[c]},collisionPriority:1,radius:11,state:Ci}}function ShiftManipulator_W({vertices:e,padding:t,materials:r}){const o=o=>{const M=e.slice(),C=(0,vec32.d)(vectorStacks.rq.get(),M[0],M[1]);(0,vec32.n)(C,C);const T=(0,vec32.d)(vectorStacks.rq.get(),M[M.length-1],M[M.length-2]);if((0,vec32.n)(T,T),t>0){const e=(0,vec32.h)((0,vec3f64.vt)(),T,-t);M[M.length-1]=(0,vec32.g)(e,e,M[M.length-1]);const r=(0,vec32.h)((0,vec3f64.vt)(),C,-t);M[0]=(0,vec32.g)(r,r,M[0])}const E=o?1.15:1,N=22.5*E,F=11*E,y=(0,mat4.D_)(vectorStacks.Rc.get());if(t>0){const e=N/4,r=(0,vec32.i)(vectorStacks.rq.get(),0,e,0),o=1+t/e;(0,mat4.Tl)(y,y,r),(0,mat4.hs)(y,y,(0,vec32.i)(vectorStacks.rq.get(),o,o,o)),(0,mat4.Tl)(y,y,(0,vec32.h)(r,r,-1/o))}const B=(0,mat4.D_)((0,mat4f64.vt)()),D=(0,vec3f64.fA)(0,1,0),P=(0,mat4.I0)((0,mat4f64.vt)(),(0,quat.Yc)(vectorStacks.J8.get(),D,T));P[12]=M[M.length-1][0],P[13]=M[M.length-1][1],P[14]=M[M.length-1][2],(0,mat4.lw)(P,P,y);const x=r.tube,k=function ShiftManipulator_z(e,t,r){const o=[],a=12;for(let n=0;n<a;n++){const t=n/a*2*Math.PI;o.push([Math.cos(t)*e,Math.sin(t)*e])}return(0,GeometryUtil.Nq)(r,o,t,[],[],!1)}(3*(o?1.15:1)+t,M,x);k.transformation=B;const G=[k],q=r.tip,H=(0,GeometryUtil.EE)(q,N,F,24,!1,!1,!0);H.transformation=P,G.push(H);const I=r.cap,S=(0,GeometryUtil.EE)(I,N,F,24,!1,!0,!1);S.transformation=P,G.push(S);const W=(0,mat4.I0)((0,mat4f64.vt)(),(0,quat.Yc)(vectorStacks.J8.get(),D,C));return W[12]=M[0][0],W[13]=M[0][1],W[14]=M[0][2],(0,mat4.lw)(W,W,y),G.push(H.instantiate({transformation:W})),G.push(S.instantiate({transformation:W})),G};return{normal:o(!1),focused:o(!0)}}class ExtentMove_b{get _object(){return this._tool.object}get _operations(){return this._object.operations}constructor(t,e){this._tool=t,this._bounds=e,this._moveXYTooltipInfo=null,this._moveZTooltipInfo=null;const o=this._tool,i=o.view;this.moveXYObjectManipulation=new MoveXYObjectManipulation_l({view:i,tool:o,object:this._object}),o.addHandles(this._createMoveXYObjectDragPipeline()),this.moveZManipulator=new ShiftManipulator_I(i,ShiftManipulator_H.CENTER_ON_CALLOUT),this.moveZManipulator.state|=Si,o.manipulators.add(this.moveZManipulator),o.addHandles(this._createMoveZDragPipeline()),o.addHandles(o.events.on("translate-stop",(()=>{this._moveXYTooltipInfo=null,this._moveZTooltipInfo=null})))}destroy(){this.moveXYObjectManipulation.destroy(),this._tool.manipulators.remove(this.moveZManipulator),this.moveZManipulator.destroy()}forEachManipulator(t){this.moveXYObjectManipulation.forEachManipulator(t),t(this.moveZManipulator,ManipulatorType_A.TRANSLATE_Z)}updateManipulators(t,e){const n=this.moveZManipulator,s=(0,mat4.Qr)(vectorStacks.Rc.get(),t,Math.PI);s[12]=0,s[13]=0,s[14]=0,n.modelTransform=s,n.renderLocation=(0,vec32.d)(vectorStacks.rq.get(),e.origin,e.basis1)}getUpdatedTooltipInfo(){return this.moveXYObjectManipulation.grabbing||this.moveXYObjectManipulation.dragging?this._computeMoveXYTooltipInfo():this.moveZManipulator.focused?this._computeMoveZTooltipInfo():null}_computeMoveXYTooltipInfo(){const t=this._tool,o=this._moveXYTooltipInfo??=new TranslateTooltipInfo.M({sketchOptions:t.sketchOptions});if(this.moveXYObjectManipulation.dragging){const e=this._bounds,i=e.mapBoundsStart.origin,n=e.mapBounds.origin,{renderSpatialReference:a}=t.view;if(!a)return null;const r=(0,automaticLengthMeasurementUtils.Do)(i,n,a);if(null==r)return null;o.distance=r}else o.distance=quantityUtils.r7;return o}_computeMoveZTooltipInfo(){const t=this._tool,o=this._moveZTooltipInfo??=new TranslateZTooltipInfo_i({sketchOptions:t.sketchOptions});if(this.moveZManipulator.dragging){const e=this._bounds,i=e.mapBoundsStart.origin,n=e.mapBounds.origin,{renderSpatialReference:a}=t.view;if(!a)return null;const r=(0,euclideanLengthMeasurementUtils.cL)(i,n,a);if(null==r)return null;o.distance=r}else o.distance=quantityUtils.r7;return o}_createMoveXYObjectDragPipeline(){return this.moveXYObjectManipulation.createDragPipeline(((t,e,o)=>this._buildMoveDragPipeline(e,o)))}_createMoveZDragPipeline(){if(!this._operations)return(0,handleUtils.hA)();const e=this._operations.data.spatialReference;return(0,dragEventPipeline.Xt)(this.moveZManipulator,((t,o,i)=>{const a=(0,vec3f64.o8)(t.renderLocation),r=o.next(dragEventPipeline3D_G(this._tool.view,a,e)).next((0,dragEventPipeline.sO)());this._buildMoveDragPipeline(r,i)}))}_buildMoveDragPipeline(t,e){const{_tool:o,_object:i}=this;t.next((t=>("start"===t.action&&(o.inputState={type:"move"},this._bounds.backupMapBounds(),o.events.emit("translate-start",{object:i,dxScreen:t.screenDeltaX,dyScreen:t.screenDeltaY})),t))).next((0,dragEventPipeline.EX)()).next(this._updateGeometry()).next((t=>{const e={object:i,dxScreen:t.screenDeltaX,dyScreen:t.screenDeltaY};switch(t.action){case"start":case"update":(t.mapEnd.x-t.mapStart.x||t.mapEnd.y-t.mapStart.y||(t.mapEnd.z??0)-(t.mapStart.z??0))&&o.events.emit("translate",e);break;case"end":o.inputState=null,o.events.emit("translate-stop",e)}return t})),e.next((()=>{null!=o.inputState&&o.events.emit("translate-stop",{object:i,dxScreen:0,dyScreen:0}),o.cancel()}))}_updateGeometry(){const t=this._tool;return e=>{if(null==t.inputState||"move"!==t.inputState.type)return e;const o="start"===e.action?editGeometry_interfaces.Y.NEW_STEP:editGeometry_interfaces.Y.ACCUMULATE_STEPS;if(this._operations){const t=this._operations.move(e.mapDeltaX,e.mapDeltaY,e.mapDeltaZ,o);this._bounds.updateMapBoundsFromOperation(t)}return e}}}function generateTextures_e(t,e){return function generateTextures_a(t,e){const n=new Image(e,e);return n.src=t,n}(function generateTextures_r(t){const e=(new XMLSerializer).serializeToString(t);return`data:image/svg+xml;base64,${btoa(e)}`}(function generateTextures_n(e,{accentColor:n,contrastColor:o}){const r=n.toHex(),a=n.a,s=o.toHex(),i=o.a,c=e.getElementsByTagNameNS("http://www.w3.org/2000/svg","style").namedItem("theme-style");return c&&(c.innerHTML=`\n      .contrast-fill { fill: ${s}; fill-opacity: ${i}; }\n      .contrast-stroke { stroke: ${s}; stroke-opacity: ${i};  }\n      .accent-fill { fill: ${r}; fill-opacity: ${a}; }\n      .accent-stroke { stroke: ${r}; stroke-opacity:  ${a}; }`),e}(function generateTextures_o(t){const e=t.split(",")[1],n=atob(e);return(new DOMParser).parseFromString(n,"image/svg+xml")}(t),e)),e.size)}var Texture=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/lib/Texture.js");var GLTextureMaterial=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/lib/GLTextureMaterial.js"),StencilUtils=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/lib/StencilUtils.js"),ImageMaterial_glsl=__webpack_require__("./node_modules/@arcgis/core/chunks/ImageMaterial.glsl.js");class ImageMaterialTechnique_b extends ShaderTechnique.w{constructor(e,r){super(e,r,new ReloadableShaderModule.$(ImageMaterial_glsl.I,(()=>__webpack_require__.e(2003).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@arcgis/core/views/3d/webgl-engine/shaders/ImageMaterial.glsl.js")))),ImageMaterialTechnique_j)}_getPipelineState(t,r){const{oitPass:m,output:d,hasOccludees:b,enableOffset:j,cullFace:I}=t,S=m===OITPass.Y.NONE,O=m===OITPass.Y.FrontFace;return(0,renderState.Ey)({blending:(0,ShaderOutput.RN)(d)?S?renderState.Os:(0,OrderIndependentTransparency.ez)(m):null,culling:(0,renderState.Xt)(I),depthTest:{func:(0,OrderIndependentTransparency.K_)(m)},depthWrite:(0,OrderIndependentTransparency.z5)(t),drawBuffers:(0,OrderIndependentTransparency.m6)(m,d),colorWrite:renderState.kn,stencilWrite:b?StencilUtils.v0:null,stencilTest:b?r?StencilUtils.a9:StencilUtils.qh:null,polygonOffset:S||O?null:(0,OrderIndependentTransparency.aB)(j)})}initializePipeline(e){return this._occludeePipeline=this._getPipelineState(e,!0),this._getPipelineState(e,!1)}getPipeline(e){return e?this._occludeePipeline:super.getPipeline()}}const ImageMaterialTechnique_j=new Map([[VertexAttribute.r.POSITION,0],[VertexAttribute.r.UV0,2],[VertexAttribute.r.PERSPECTIVEDIVIDE,3]]);class ImageMaterialTechniqueConfiguration_a extends DefaultTechniqueConfiguration.E{constructor(){super(...arguments),this.cullFace=basicInterfaces.s2.None,this.enableOffset=!0,this.writeDepth=!0,this.hasOccludees=!1,this.terrainDepthTest=!1,this.cullAboveTerrain=!1,this.perspectiveInterpolation=!0,this.textureCoordinateType=TextureCoordinateAttribute_glsl.I.None,this.emissionSource=Emissions_glsl.ZX.None,this.discardInvisibleFragments=!0,this.occlusionPass=!1,this.objectAndLayerIdColorInstanced=!1}}(0,tslib_es6._)([(0,ShaderTechniqueConfiguration.W)({count:basicInterfaces.s2.COUNT})],ImageMaterialTechniqueConfiguration_a.prototype,"cullFace",void 0),(0,tslib_es6._)([(0,ShaderTechniqueConfiguration.W)()],ImageMaterialTechniqueConfiguration_a.prototype,"enableOffset",void 0),(0,tslib_es6._)([(0,ShaderTechniqueConfiguration.W)()],ImageMaterialTechniqueConfiguration_a.prototype,"writeDepth",void 0),(0,tslib_es6._)([(0,ShaderTechniqueConfiguration.W)()],ImageMaterialTechniqueConfiguration_a.prototype,"hasOccludees",void 0),(0,tslib_es6._)([(0,ShaderTechniqueConfiguration.W)()],ImageMaterialTechniqueConfiguration_a.prototype,"terrainDepthTest",void 0),(0,tslib_es6._)([(0,ShaderTechniqueConfiguration.W)()],ImageMaterialTechniqueConfiguration_a.prototype,"cullAboveTerrain",void 0),(0,tslib_es6._)([(0,ShaderTechniqueConfiguration.W)()],ImageMaterialTechniqueConfiguration_a.prototype,"perspectiveInterpolation",void 0);class ImageMaterial_I extends TriangleMaterial.W{constructor(e){super(e,ImageMaterial_b),this._configuration=new ImageMaterialTechniqueConfiguration_a,this.vertexAttributeLocations=ImageMaterialTechnique_j,this.supportsEdges=!0,this.produces=new Map([[RenderSlot.N.OPAQUE_MATERIAL,e=>(0,ShaderOutput.CL)(e)],[RenderSlot.N.TRANSPARENT_MATERIAL,e=>(0,ShaderOutput._o)(e)&&this.parameters.writeDepth],[RenderSlot.N.TRANSPARENT_MATERIAL_WITHOUT_DEPTH,e=>(0,ShaderOutput._o)(e)&&!this.parameters.writeDepth],[RenderSlot.N.DRAPED_MATERIAL,e=>(0,ShaderOutput._o)(e)||(0,ShaderOutput.CL)(e)]])}getConfiguration(e,t){return this._configuration.output=e,this._configuration.cullFace=this.parameters.cullFace,this._configuration.hasSlicePlane=this.parameters.hasSlicePlane,this._configuration.writeDepth=this.parameters.writeDepth,this._configuration.hasOccludees=t.hasOccludees,this._configuration.oitPass=t.oitPass,this._configuration.enableOffset=t.camera.relativeElevation<OrderIndependentTransparency.xt,this._configuration.terrainDepthTest=t.terrainDepthTest,this._configuration.cullAboveTerrain=t.cullAboveTerrain,this._configuration.perspectiveInterpolation=this.parameters.perspectiveInterpolation,this._configuration}get visible(){return!0}createGLMaterial(e){return new ImageMaterial_(e)}createBufferWriter(){const e=DefaultLayouts.zK.clone();return this.parameters.perspectiveInterpolation&&e.f32(VertexAttribute.r.PERSPECTIVEDIVIDE),new ImageMaterial_E(e)}}class ImageMaterial_ extends GLTextureMaterial.m8{constructor(e){super({...e,...e.material.parameters})}beginSlot(e){return this.updateTexture(this._material.parameters.textureId),this._material.setParameters(this.textureBindParameters),this.getTechnique(ImageMaterialTechnique_b,e)}}class ImageMaterial_E extends DefaultBufferWriter.Z{write(t,r,i,s,a,o){for(const n of this.vertexBufferLayout.fields.keys()){const s=i.get(n);if(s)if(n===VertexAttribute.r.PERSPECTIVEDIVIDE){(0,Util.vA)(1===s.size);const t=a.getField(n,BufferView.Y$);t&&(0,bufferWriterUtils.uO)(s,t,o)}else(0,bufferWriterUtils.zC)(n,s,t,r,a,o)}}}class ImageMaterial_b extends Material.qA{constructor(e){super(),this.textureId=e,this.writeDepth=!0,this.hasSlicePlane=!1,this.cullFace=basicInterfaces.s2.None,this.opacity=1,this.perspectiveInterpolation=!1}}class RotateManipulator_g extends ee{constructor(n,s){const a=new ImageMaterial_I({writeDepth:!1,renderOccluded:Material.m$.Opaque,isDecoration:!0}),c=manipulatorUtils_j.calloutWidth,m=new RibbonLineMaterial.W({width:c,renderOccluded:Material.m$.OccludeAndTransparent,isDecoration:!0});super({view:n,...RotateManipulator_j({imageMaterial:a,calloutMaterial:m})}),this._currentTexture=null,this._themeHandle=(0,reactiveUtils.watch)((()=>n.effectiveTheme.accentColor),(i=>{const o=(0,colorUtils._L)(i,.5),n=(0,colorUtils.bJ)(i),l=this._currentTexture,c=s(o,n);a.setParameters({textureId:c.texture.id}),m.setParameters({color:Color.A.toUnitRGBA(i)}),this._currentTexture=c,l?.release()}),reactiveUtils.Vh)}destroy(){this._themeHandle.remove(),this._currentTexture?.release(),super.destroy()}}function RotateManipulator_j({imageMaterial:e,calloutMaterial:t}){const{focusMultiplier:r,calloutLength:i,discRadius:o}=manipulatorUtils_j,s=o*r,d=(e,t)=>{const r=[0,1,2,2,3,0];return new Geometry.V(t,[[VertexAttribute.r.POSITION,new Attribute.n([i-e,-e,0,i+e,-e,0,i+e,e,0,i-e,e,0],r,3,!0)],[VertexAttribute.r.UV0,new Attribute.n([0,0,1,0,1,1,0,1],r,2,!0)]])},f=(0,GeometryUtil.Z8)(t,[[0,0,0],[i-o,0,0]]),b=(0,GeometryUtil.Z8)(t,[[0,0,0],[i-s,0,0]]),g=Ci;return{autoScaleRenderObjects:!1,collisionPriority:1,collisionType:{type:"disc",direction:[0,0,1],offset:[i,0,0]},focusMultiplier:r,radius:o,renderObjects:[new RenderObject_e(d(o,e),interactive_interfaces.p7.Unfocused|g),new RenderObject_e(f,interactive_interfaces.p7.Unfocused|g),new RenderObject_e(d(s,e),interactive_interfaces.p7.Focused|g),new RenderObject_e(b,interactive_interfaces.p7.Focused|g)],state:g}}var UpdateVertices=__webpack_require__("./node_modules/@arcgis/core/views/interactive/editGeometry/operations/UpdateVertices.js"),ExtentRotateTooltipInfo=__webpack_require__("./node_modules/@arcgis/core/views/interactive/tooltip/infos/ExtentRotateTooltipInfo.js");class ExtentRotate_M{get _object(){return this._tool.object}get _operations(){return this._object.operations}constructor(t,e,o){this._tool=t,this._bounds=e,this._snapRotation=o,this._rotateTooltipInfo=null,this._startAngle=0,this._endAngle=0;const r=this._tool,a=r.view,n=!a._stage?.renderView.renderingContext.driverTest.svgPremultipliesAlpha.result;this.rotateManipulator=new RotateManipulator_g(a,((t,e)=>function Factory_l(r,l){const{accentColor:n,contrastColor:c,preMultiplyAlpha:i}=l;return r.fromData(`heading-rotate:[accent:${n},contrast:${c},size:64]`,(()=>new Texture.g(generateTextures_e("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI1NiIgaGVpZ2h0PSI1NiIgZmlsbD0ibm9uZSIgdmVyc2lvbj0iMi4wIj48c3R5bGUgaWQ9InRoZW1lLXN0eWxlIj4uY29udHJhc3QtZmlsbHtmaWxsOiNmZmZ9LmNvbnRyYXN0LXN0cm9rZXtzdHJva2U6I2ZmZn0uYWNjZW50LWZpbGx7ZmlsbDojZmY3ZjAwO2ZpbGwtb3BhY2l0eTouNX08L3N0eWxlPjxwYXRoIGQ9Ik0yOCAwYTI4IDI4IDAgMSAxIDAgNTYgMjggMjggMCAwIDEgMC01NiIgY2xhc3M9ImFjY2VudC1maWxsIi8+PHBhdGggc3Ryb2tlLXdpZHRoPSI0Ljk5IiBkPSJNMjAuMDUgNDAuODZhMTUuMDUgMTUuMDUgMCAwIDAgMTcuMTQtMS41IDE1LjA1IDE1LjA1IDAgMCAwIDQuNDctMTYuNjUgMTUuMDUgMTUuMDUgMCAwIDAtMjIuNzItNy4xNSAxNS4wNSAxNS4wNSAwIDAgMC01LjUgNy4xNSIgY2xhc3M9ImNvbnRyYXN0LXN0cm9rZSIvPjxwYXRoIGQ9Im0xMC45NyAzNS41NyA1LjM4IDEyLjA3IDcuNzktMTMuNDd6IiBjbGFzcz0iY29udHJhc3QtZmlsbCIvPjwvc3ZnPg==",{accentColor:n,contrastColor:c,size:64}),{mipmap:!0,reloadable:!0,preMultiplyAlpha:i})))}(a.textures,{accentColor:t,contrastColor:e,preMultiplyAlpha:n}))),r.addHandles([this.rotateManipulator.events.on("grab-changed",(t=>this._onGrabChanged(t))),this._createRotateDragPipeline(this.rotateManipulator)]),r.manipulators.add(this.rotateManipulator),r.addHandles([r.events.on("rotate-start",(t=>this._startAngle=t.angle)),r.events.on("rotate",(t=>this._endAngle=t.angle)),r.events.on("rotate-stop",(()=>{this._startAngle=0,this._endAngle=0}))])}destroy(){this._tool.manipulators.remove(this.rotateManipulator),this.rotateManipulator.destroy()}forEachManipulator(t){t(this.rotateManipulator,ManipulatorType_A.ROTATE)}updateManipulators(t,r){const a=this._bounds.mapBounds.plane[2]<0?Math.PI:0,n=(0,mat4.eL)(vectorStacks.Rc.get(),t,a);n[12]=0,n[13]=0,n[14]=0,this.rotateManipulator.modelTransform=n,this.rotateManipulator.renderLocation=(0,vec32.g)(vectorStacks.rq.get(),r.origin,r.basis1)}getUpdatedTooltipInfo(){return this.rotateManipulator.focused?this._computeRotateTooltipInfo():null}_computeRotateTooltipInfo(){const t=this._rotateTooltipInfo??=new ExtentRotateTooltipInfo.d({sketchOptions:this._tool.sketchOptions});return t.angle=this._startAngle-this._endAngle,t}_onGrabChanged({action:t,screenPoint:e}){const o=this._tool,r=this._bounds;if("start"!==t||!e)return;const a=function li(i,t,e,n){const o=t.worldUpAtPosition(i.origin,vectorStacks.rq.get()),r=vectorStacks.rq.get();switch(e){case _i.HEADING:(0,vec32.c)(r,o);break;case _i.TILT:(0,vec32.c)(r,i.basis1)}return(0,plane.O_)(i.origin,r,n)}(r.displayBounds,o.view.renderCoordsHelper,_i.HEADING,(0,plane.vt)()),n=ray_m(o.view.state.camera,e);(0,plane.Ui)(a,n,vectorStacks.rq.get())&&(r.backupMapBounds(),o.inputState={type:"rotate",rotatePlane:a})}_createRotateDragPipeline(e){const{_tool:o,_object:r}=this;return(0,dragEventPipeline.Xt)(e,((e,a,n)=>{const s=o.inputState;null!=s&&(a.next((t=>("start"===t.action&&o.events.emit("rotate-start",{object:r,angle:0}),t))).next(dragEventPipeline3D_C(o.view,s.rotatePlane)).next(this._renderPlaneToAngle()).next(...this._snapRotation()).next(this._updateGeometry()).next((e=>{const a={object:r,angle:(0,mathUtils.KJ)(e.rotateAngle)};switch(e.action){case"start":case"update":o.events.emit("rotate",a);break;case"end":o.inputState=null,o.events.emit("rotate-stop",a)}return e})),n.next((()=>{null!=o.inputState&&o.events.emit("rotate-stop",{object:r,angle:0}),o.cancel()})))}))}_renderPlaneToAngle(){return t=>{const e=manipulatorUtils_w(t.renderStart,t.renderEnd,this._bounds.displayBounds.origin,(0,plane.Qj)(t.plane));return{...t,rotateAngle:e}}}_updateGeometry(){const t=this._bounds;return e=>{const o=(0,vec32.c)((0,vec3f64.vt)(),t.mapBoundsStart.origin),s="start"===e.action?editGeometry_interfaces.Y.NEW_STEP:editGeometry_interfaces.Y.ACCUMULATE_STEPS;if(this._operations){const r=this._operations.rotate(o,e.rotateAngle,s,UpdateVertices.K.REPLACE);(0,boundedPlane.a)(t.mapBoundsStart,t.mapBounds),t.updateMapBoundsFromOperation(r)}return e}}}class ResizeManipulator_v extends ee{constructor(o,i){const s=Ei(i),m=s?4:1,f=2*m,u={renderOccluded:Material.m$.OccludeAndTransparent,isDecoration:!0},j=new RibbonLineMaterial.W({...u,width:m}),h=new RibbonLineMaterial.W({...u,width:f}),v=new RibbonLineMaterial.W({...u,width:1});super({view:o,...manipulatorUtils_b,...ResizeManipulator_M({isCorner:s,unfocusedMaterial:j,focusedMaterial:h,outlineMaterial:v})}),this._themeHandle=(0,reactiveUtils.watch)((()=>o.effectiveTheme.accentColor),(r=>{const t=Color.A.toUnitRGBA(r);j.setParameters({color:t}),h.setParameters({color:t}),v.setParameters({color:t})}),reactiveUtils.Vh)}destroy(){this._themeHandle.remove(),super.destroy()}}function ResizeManipulator_M({isCorner:e,unfocusedMaterial:r,focusedMaterial:t,outlineMaterial:n}){const a=e?[(0,vec3f64.fA)(1,0,0),(0,vec3f64.fA)(0,0,0),(0,vec3f64.fA)(0,1,0)]:[(0,vec3f64.fA)(1,0,0),(0,vec3f64.fA)(-1,0,0)];return{renderObjects:[new RenderObject_e((0,GeometryUtil.Z8)(r,a),interactive_interfaces.p7.Unfocused|Hi),new RenderObject_e((0,GeometryUtil.Z8)(t,a),interactive_interfaces.p7.Focused|Hi),new RenderObject_e((0,GeometryUtil.Z8)(n,a),Ui)],collisionType:{type:"line",paths:[a]},radius:e?6:4,state:Hi}}var editPlaneUtils=__webpack_require__("./node_modules/@arcgis/core/views/interactive/editGeometry/support/editPlaneUtils.js"),extentUtils=__webpack_require__("./node_modules/@arcgis/core/views/support/extentUtils.js");class extentUtils_C{constructor(t,i){this._tool=t,this.mapBounds=(0,boundedPlane.d)(),this.mapBoundsStart=(0,boundedPlane.d)(),this.displayBounds=(0,boundedPlane.d)(),t.addHandles((0,reactiveUtils.on)((()=>t.object),"modified-externally",(()=>this._resetMapBounds()),{onListenerAdd:()=>this._resetMapBounds()})),this._onDisplayBoundsChanged=i}get displayBoundsMargin(){const{view:s,object:t}=this._tool,i=manipulatedObjectUtils_t(t),o=s.pointsOfInterest?.centerOnSurfaceFrequent.location??i?.extent?.center;return o?extentUtils_D*s.pixelSizeAt(o):0}backupMapBounds(){(0,boundedPlane.a)(this.mapBounds,this.mapBoundsStart)}updateDisplayBounds(){this._calculateDisplayBounds(),this._onDisplayBoundsChanged?.()}updateMapBoundsFromOperation(s){(0,editPlaneUtils.Bb)(s,this.mapBounds),this.updateDisplayBounds()}updateMapBoundsFromOperationInverse(s){(0,editPlaneUtils.fJ)(s,this.mapBounds),this.updateDisplayBounds()}_resetMapBounds(){this._calculateMapBounds(),this.updateDisplayBounds()}_calculateMapBounds(){const{view:s,attachmentOrigin:i,object:o}=this._tool,a=o.operations?.data;if(!a)return;const e=a.geometry;this.spatialReference=e.spatialReference;const n=function geometryUtils_n(o){const n=geometryUtils_r(o);return(0,vec2f64.fA)(Math.cos(n),Math.sin(n))}(e);(0,vec2.hs)(n,n,-1);const r=i?s.pixelSizeAt(i,e.spatialReference):0,p=extentUtils_O*r,d=a.coordinateHelper.hasZ()&&"on-the-ground"!==o.elevationInfo.mode;(0,editPlaneUtils.G3)(n,a,p,this.mapBounds,d)}_calculateDisplayBounds(){const{view:s,attachmentOrigin:t}=this._tool,i=t?.z??(0,elevationAlignmentUtils.nG)(this.mapBounds.origin,s.elevationProvider,ElevationContext.F.fromElevationInfo(this._tool.object.elevationInfo),s.renderCoordsHelper);!function extentUtils_S(s,t,c,l,m=0,B){B||(B=(0,boundedPlane.d)());const y=vectorStacks.rq.get();(0,vec32.g)(y,s.origin,s.basis1),(0,vec32.g)(y,y,s.basis2),c.toRenderCoords(y,l,y);const M=vectorStacks.rq.get();(0,vec32.g)(M,s.origin,s.basis1),(0,vec32.d)(M,M,s.basis2),c.toRenderCoords(M,l,M);const j=vectorStacks.rq.get();(0,vec32.d)(j,s.origin,s.basis1),(0,vec32.d)(j,j,s.basis2),c.toRenderCoords(j,l,j);const v=vectorStacks.rq.get();(0,vec32.d)(v,s.origin,s.basis1),(0,vec32.g)(v,v,s.basis2),c.toRenderCoords(v,l,v),(0,vec32.g)(B.origin,y,M),(0,vec32.g)(B.origin,B.origin,j),(0,vec32.g)(B.origin,B.origin,v),(0,vec32.h)(B.origin,B.origin,.25),(0,vec32.d)(y,y,B.origin),(0,vec32.d)(M,M,B.origin),(0,vec32.d)(j,j,B.origin),(0,vec32.d)(v,v,B.origin);const _=(0,vec32.m)(vectorStacks.rq.get(),y,M,.5),R=(0,vec32.m)(vectorStacks.rq.get(),j,v,.5);(0,vec32.h)(R,R,-1),(0,vec32.m)(B.basis1,_,R,.5);const x=(0,vec32.m)(vectorStacks.rq.get(),y,v,.5),C=(0,vec32.m)(vectorStacks.rq.get(),M,j,.5);(0,vec32.h)(C,C,-1),(0,vec32.m)(B.basis2,x,C,.5);const D=(0,vec32.e)(vectorStacks.rq.get(),B.basis1,B.basis2);(0,vec32.e)(B.basis2,D,B.basis1),(0,vec32.n)(B.basis1,B.basis1);const O=Math.max(Math.abs((0,vec32.f)(B.basis1,y)),Math.abs((0,vec32.f)(B.basis1,M)),Math.abs((0,vec32.f)(B.basis1,j)),Math.abs((0,vec32.f)(B.basis1,v)));(0,vec32.n)(B.basis2,B.basis2);const S=Math.max(Math.abs((0,vec32.f)(B.basis2,y)),Math.abs((0,vec32.f)(B.basis2,M)),Math.abs((0,vec32.f)(B.basis2,j)),Math.abs((0,vec32.f)(B.basis2,v)));(0,vec32.h)(B.basis1,B.basis1,O+m),(0,vec32.h)(B.basis2,B.basis2,S+m);const U=(0,vec32.c)(vectorStacks.rq.get(),s.origin);return U[2]=t,c.toRenderCoords(U,l,U),(0,plane.O_)(U,D,B.plane),(0,plane._I)(B.plane,B.origin,B.origin),(0,boundedPlane.u)(B),B}(this.mapBounds,i??0,s.renderCoordsHelper,this.spatialReference,this.displayBoundsMargin,this.displayBounds)}}const extentUtils_D=10,extentUtils_O=80;const extentUtils_I=(0,vec3f64.vt)(),extentUtils_k=(0,vec3f64.vt)(),extentUtils_A=(0,vec3f64.vt)(),extentUtils_H=(0,vec3f64.vt)();var ExtentScaleTooltipInfo=__webpack_require__("./node_modules/@arcgis/core/views/interactive/tooltip/infos/ExtentScaleTooltipInfo.js");class ExtentScale_v{get _object(){return this._tool.object}get _operations(){return this._object.operations}get zMax(){if(!this._zMaxDirty||!this._operations)return this._zMax;const t=this._operations.data;if(t.geometry.hasZ){const e=t.coordinateHelper;this._zMax=Number.NEGATIVE_INFINITY;for(const s of t.components)for(const t of s.vertices){const s=e.getZ(t.pos)??0;this._zMax=Math.max(s,this._zMax)}}else this._zMax=0;return this._zMaxDirty=!1,this._zMax}constructor(t,e,s){this._tool=t,this._bounds=e,this._preserveAspectRatioStep=s,this._resizeHandles=[{direction:[1,0]},{direction:[1,1]},{direction:[0,1]},{direction:[-1,1]},{direction:[-1,0]},{direction:[-1,-1]},{direction:[0,-1]},{direction:[1,-1]}],this._displayBoundsStart=(0,boundedPlane.d)(),this._displayBoundsMarginStart=0,this._zMax=0,this._zMaxDirty=!0;const i=this._tool,a=i.view;this.resizeManipulators=this._resizeHandles.map((t=>{const e=new ResizeManipulator_v(a,t);return i.addHandles([e.events.on("grab-changed",(t=>this._onGrabChanged(t))),this._createResizeDragPipeline(e,t)]),e})),i.manipulators.addMany(this.resizeManipulators),this._operations&&i.addHandles(this._operations.data.on("change",(()=>{"resize"!==i.inputState?.type&&(this._zMaxDirty=!0)})))}destroy(){this.forEachManipulator((t=>{this._tool.manipulators.remove(t),t.destroy()}))}forEachManipulator(t){this.resizeManipulators.forEach((e=>t(e,ManipulatorType_A.SCALE)))}updateManipulators(t,e){this.resizeManipulators.forEach(((s,i)=>{!function gi(i,t,e,n){const o=(0,vec32.l)(n.basis1),r=(0,vec32.l)(n.basis2),l=hi(n),d=Ii(n),g=(0,vec32.i)(vectorStacks.rq.get(),0,0,0);(0,vec32.g)(g,(0,vec32.h)(vectorStacks.rq.get(),n.basis1,t.direction[0]),(0,vec32.h)(vectorStacks.rq.get(),n.basis2,t.direction[1])),(0,vec32.g)(g,n.origin,g);let m=0,p=1;if(Ei(t))1===t.direction[0]&&-1===t.direction[1]?m=Ni:1===t.direction[0]&&1===t.direction[1]?m=Math.PI:-1===t.direction[0]&&1===t.direction[1]&&(m=3*Math.PI/2),p=d;else{const i=0!==t.direction[0]?1:2;m=1===i?Ni:0,p=(1===i?r:o)-l}const T=(0,mat4.N9)(vectorStacks.Rc.get(),m);(0,mat4.hs)(T,T,(0,vec32.i)(vectorStacks.rq.get(),p,p,p)),(0,mat4.lw)(T,e,T),T[12]=0,T[13]=0,T[14]=0,i.modelTransform=T,i.renderLocation=g}(s,this._resizeHandles[i],t,e)}))}getUpdatedTooltipInfo(){if(!this.resizeManipulators.some((t=>t.focused)))return null;const t=this._tooltipInfo??=new ExtentScaleTooltipInfo.c({sketchOptions:this._tool.sketchOptions}),e=function extentUtils_U(s,t,i){return(0,vec32.d)(extentUtils_H,(0,vec32.d)(extentUtils_H,s.origin,s.basis1),s.basis2),(0,vec32.b)(extentUtils_A,extentUtils_H,s.basis1,2),(0,vec32.b)(extentUtils_k,extentUtils_A,s.basis2,2),(0,vec32.b)(extentUtils_I,extentUtils_H,s.basis2,2),extentUtils_H[2]=extentUtils_A[2]=extentUtils_k[2]=extentUtils_I[2]=t,(0,extentUtils.b)({topLeft:extentUtils_I,topRight:extentUtils_k,bottomRight:extentUtils_A,bottomLeft:extentUtils_H,spatialReference:i})}(this._bounds.mapBounds,this.zMax,this._bounds.spatialReference);return e&&(t.xSize=e.xSize,t.ySize=e.ySize),this.resizeManipulators.some((t=>t.dragging))||(t.xScale=1,t.yScale=1),t}_onGrabChanged({action:t,screenPoint:e}){const s=this._tool,i=this._bounds;if("start"!==t||!e)return;const a=ray_m(s.view.state.camera,e);(0,plane.Ui)(i.displayBounds.plane,a,vectorStacks.rq.get())&&(i.backupMapBounds(),(0,boundedPlane.a)(i.displayBounds,this._displayBoundsStart),this._displayBoundsMarginStart=i.displayBoundsMargin,s.inputState={type:"resize"})}_createResizeDragPipeline(t,e){const{_tool:s,_object:i}=this;return(0,dragEventPipeline.Xt)(t,((t,a,o)=>{null!=s.inputState&&(a.next((t=>("start"===t.action&&s.events.emit("scale-start",{object:i,xScale:1,yScale:1}),{...t,handle:e}))).next(dragEventPipeline3D_C(s.view,this._displayBoundsStart.plane)).next(this._renderPlaneToFactors()).next(...this._preserveAspectRatioStep()).next(this._updateGeometry()).next((t=>{const e=this._tooltipInfo;e&&(e.xScale=t.factor1,e.yScale=t.factor2);const a={object:i,xScale:t.factor1,yScale:t.factor2};switch(t.action){case"start":case"update":s.events.emit("scale",a);break;case"end":s.inputState=null,s.events.emit("scale-stop",a)}return t})),o.next((()=>{null!=s.inputState&&s.events.emit("scale-stop",{object:i,xScale:1,yScale:1}),s.cancel()})))}))}_renderPlaneToFactors(){const t=this._bounds;return e=>{const s=this._displayBoundsStart,c=e.handle.direction,p=t.displayBoundsMargin,l=this._displayBoundsMarginStart,d=(0,vec32.c)(vectorStacks.rq.get(),s.origin);(0,vec32.b)(d,d,s.basis1,-c[0]),(0,vec32.b)(d,d,s.basis2,-c[1]);const h=(0,vec32.d)(vectorStacks.rq.get(),e.renderEnd,d),m=(0,vec32.d)(vectorStacks.rq.get(),e.renderStart,d),S=Ei(e.handle),y=Ii(s),x=Ii(t.displayBounds)/y,M=(t,e)=>{if(0===t)return 1;let s=(0,vec32.l)(e),i=.5*t*(0,vec32.f)(e,h)/s;const a=i<0?-1:1;S&&(i+=(s-.5*t*(0,vec32.f)(e,m)/s)*a*x);const o=s<1.5*l?1:ExtentScale_B;return s=Math.max(s-l,ExtentScale_B),a>0&&(i-=p),a*Math.max(a*(i/s),o)};return{...e,factor1:M(c[0],s.basis1),factor2:M(c[1],s.basis2)}}}_updateGeometry(){const o=this._bounds;return r=>{const n=(0,vec32.c)((0,vec3f64.vt)(),o.mapBoundsStart.origin);(0,vec32.b)(n,n,o.mapBoundsStart.basis1,-r.handle.direction[0]),(0,vec32.b)(n,n,o.mapBoundsStart.basis2,-r.handle.direction[1]);const p=(0,vec2.hZ)((0,vec2f64.vt)(),o.mapBoundsStart.basis1[0],o.mapBoundsStart.basis1[1]);(0,vec2.S8)(p,p);const d="start"===r.action?editGeometry_interfaces.Y.NEW_STEP:editGeometry_interfaces.Y.ACCUMULATE_STEPS;if(this._operations){const t=this._operations.scale(n,p,r.factor1,r.factor2,d,UpdateVertices.K.REPLACE);(0,boundedPlane.a)(o.mapBoundsStart,o.mapBounds),o.updateMapBoundsFromOperation(t)}return r}}}const ExtentScale_B=1e-6;class PreserveAspectRatio_a{constructor(){this._lastDragEvent=null,this._next=null,this._enabled=!1}get enabled(){return this._enabled}set enabled(t){if(this._enabled!==t&&null!=this._lastDragEvent&&null!=this._next){const e={...this._lastDragEvent,action:"update"};t&&PreserveAspectRatio_n(e),this._next.execute(e)}this._enabled=t}createDragEventPipelineStep(){this._lastDragEvent=null;const t=new dragEventPipeline.rh;return this._next=t,[t=>(this._lastDragEvent="end"!==t.action?{...t}:null,this._enabled&&PreserveAspectRatio_n(t),t),t]}get test(){}}function PreserveAspectRatio_n(e){const a=Ei(e.handle)?Math.max(Math.abs(e.factor1),Math.abs(e.factor2)):0===e.handle.direction[0]?Math.abs(e.factor2):Math.abs(e.factor1);e.factor1=e.factor1<0?-a:a,e.factor2=e.factor2<0?-a:a}class SnapRotation_n{constructor(){this._lastDragEvent=null,this._next=null,this.incrementRadians=(0,mathUtils.kU)(5),this._enabled=!1}get enabled(){return this._enabled}set enabled(t){if(this._enabled!==t&&null!=this._lastDragEvent&&null!=this._next){const e={...this._lastDragEvent,action:"update"};t&&this._adjustRotation(e),this._next.execute(e)}this._enabled=t}createDragEventPipelineStep(){this._lastDragEvent=null;const t=new dragEventPipeline.rh;return this._next=t,[t=>(this._lastDragEvent="end"!==t.action?{...t}:null,this._enabled&&this._adjustRotation(t),t),t]}_adjustRotation(t){t.rotateAngle=Math.round(t.rotateAngle/this.incrementRadians)*this.incrementRadians}}let ExtentTransformTool_S=class extends InteractiveToolBase.g{get updating(){return!!this.object.updating}constructor(t){super(t),this.events=new Evented.A,this.enableZ=!0,this.enableScaling=!0,this.enableRotation=!0,this.sketchOptions=new SketchOptions.A,this._preserveAspectRatio=new PreserveAspectRatio_a,this._snapRotation=new SnapRotation_n,this.grabbing=!1,this.inputState=null,this._attachmentOrigin=null,this.type="transform-3d",this._outlineVisualElement=null}initialize(){const{view:t,object:e}=this,s=this._bounds=new extentUtils_C(this,(()=>this._updateManipulators()));this._extentMove=new ExtentMove_b(this,s),this._extentScale=new ExtentScale_v(this,s,(()=>this._preserveAspectRatio.createDragEventPipelineStep())),this._extentRotate=new ExtentRotate_M(this,s,(()=>this._snapRotation.createDragEventPipelineStep())),this.addHandles([(0,reactiveUtils.watch)((()=>this.enableZ),(()=>this._updateManipulatorAvailability(this._extentMove.moveZManipulator,ManipulatorType_A.TRANSLATE_Z))),(0,reactiveUtils.watch)((()=>this.enableScaling),(()=>this._extentScale.forEachManipulator((t=>this._updateManipulatorAvailability(t,ManipulatorType_A.SCALE))))),(0,reactiveUtils.watch)((()=>this.enableRotation),(()=>this._updateManipulatorAvailability(this._extentRotate.rotateManipulator,ManipulatorType_A.ROTATE)))]),this._updateManipulators(),this._updateAllManipulatorAvailability();const n=visualElementUtils_l({view:t,object:e,forEachManipulator:t=>this._forEachManipulator(t),onManipulatorsChanged:()=>(0,handleUtils.hA)()});if(null!=n){const{visualElement:t}=n;t instanceof OutlineVisualElement_j&&(this._outlineVisualElement=t,this.addHandles(t.events.on("attachment-origin-changed",(()=>this._bounds.updateDisplayBounds())))),this.addHandles(n)}this.addHandles([e.on("committed",(()=>this._onGeometryChanged())),(0,reactiveUtils.watch)((()=>this.object.visible),(()=>this._updateAllManipulatorAvailability())),(0,reactiveUtils.watch)((()=>this.object.isDraped),(()=>this._graphicDrapedChanged()),reactiveUtils.Vh),(0,reactiveUtils.watch)((()=>t.pointsOfInterest?.centerOnSurfaceFrequent.location),(()=>s.updateDisplayBounds()))]);this._forEachManipulator((t=>{this.addHandles(t.events.on("grab-changed",(()=>{this.grabbing=t.grabbing,this._updateAllManipulatorAvailability()})))}));this._forEachManipulator(((t,i)=>{this.addHandles(t.events.on("immediate-click",(t=>{i===ManipulatorType_A.TRANSLATE_XY&&this.events.emit("immediate-click",{...t,object:e}),t.stopPropagation()})))})),this._initializeTooltip(),this.finishToolCreation()}destroy(){this._extentMove.destroy(),this._extentScale.destroy(),this._extentRotate.destroy(),this.tooltip.destroy(),this._set("view",null),this._set("object",null)}_initializeTooltip(){const{view:t}=this;this.tooltip=(0,tooltipCommonUtils.A)((()=>({view:t,options:this.sketchOptions.tooltips})));const e=()=>{this.tooltip.info=this._getUpdatedTooltipInfo()};this.addHandles([(0,reactiveUtils.watch)((()=>this.sketchOptions.tooltips.effectiveEnabled),e),(0,reactiveUtils.watch)((()=>this.preserveAspectRatio),e)]),this._forEachManipulator((t=>{this.addHandles([t.events.on(["focus-changed","grab-changed"],e),t.events.on("drag",(t=>{"cancel"===t.action?this.tooltip.clear():e()}))])}))}_getUpdatedTooltipInfo(){return this.sketchOptions.tooltips.effectiveEnabled?this._extentMove.getUpdatedTooltipInfo()??this._extentScale.getUpdatedTooltipInfo()??this._extentRotate.getUpdatedTooltipInfo():null}_onGeometryChanged(){this._bounds.updateDisplayBounds()}_graphicDrapedChanged(){this.removeHandles(ExtentTransformTool_T),this._bounds.updateDisplayBounds(),this.object.isDraped&&this.addHandles(this.view.elevationProvider.on("elevation-change",(t=>{null!=this._attachmentOrigin&&(0,aaBoundingRect.Rj)(t.extent,this._attachmentOrigin.x,this._attachmentOrigin.y)&&this._bounds.updateDisplayBounds()})),ExtentTransformTool_T)}_updateManipulators(){if(!this.visible)return;const t=this._bounds.displayBounds,e=function ci(i,t){return manipulatorUtils_O(i.basis1,i.basis2,i.origin,t)}(t,vectorStacks.Rc.get());this._extentMove.updateManipulators(e,t),this._extentScale.updateManipulators(e,t),this._extentRotate.updateManipulators(e,t)}_updateAllManipulatorAvailability(){this._forEachManipulator(((t,e)=>this._updateManipulatorAvailability(t,e)))}_updateManipulatorAvailability(t,e){const i=this.grabbing&&!t.grabbing;if(t.interactive=!i,t instanceof ee){const o=this.object.visible,a=this.enableZ&&manipulatorUtils_o(this.object.operations,this.object.elevationInfo);switch(e){case ManipulatorType_A.ROTATE:t.available=o&&this.enableRotation;break;case ManipulatorType_A.SCALE:t.available=o&&(this.enableScaling||this.enableRotation||a),t.interactive=!i&&this.enableScaling,t.state=this.enableScaling?Hi:Ui;break;case ManipulatorType_A.TRANSLATE_Z:t.available=o&&a;break;default:t.available=o}}}_forEachManipulator(t){this._extentMove.forEachManipulator(t),this._extentScale.forEachManipulator(t),this._extentRotate.forEachManipulator(t)}get preserveAspectRatio(){return this._preserveAspectRatio.enabled}set preserveAspectRatio(t){this._preserveAspectRatio.enabled=t,this._set("preserveAspectRatio",t)}get snapRotation(){return this._snapRotation.enabled}set snapRotation(t){this._snapRotation.enabled=t,this._set("snapRotation",t)}get attachmentOrigin(){const t=this.object.isDraped?null:this._outlineVisualElement?.attachmentOrigin;return this._attachmentOrigin=t??this.object.origin??manipulatedObjectUtils_t(this.object)?.extent?.center,this._attachmentOrigin}reset(){}cancel(){if(this.canUndo){const t=this.object.operations?.undo();t&&this._bounds.updateMapBoundsFromOperationInverse(t)}this.inputState=null}get canUndo(){return!!this.object.operations?.canUndo}undo(){if(null!=this.inputState)this.view.activeTool=null;else if(this.canUndo){const t=this.object.operations?.undo();t&&this._bounds.updateMapBoundsFromOperationInverse(t)}}get canRedo(){return!!this.object.operations?.canRedo}redo(){if(this.canRedo){const t=this.object.operations?.redo();t&&this._bounds.updateMapBoundsFromOperation(t)}}get test(){}};(0,tslib_es6._)([(0,property.MZ)()],ExtentTransformTool_S.prototype,"updating",null),(0,tslib_es6._)([(0,property.MZ)({constructOnly:!0,nonNullable:!0})],ExtentTransformTool_S.prototype,"view",void 0),(0,tslib_es6._)([(0,property.MZ)({constructOnly:!0,nonNullable:!0})],ExtentTransformTool_S.prototype,"object",void 0),(0,tslib_es6._)([(0,property.MZ)()],ExtentTransformTool_S.prototype,"enableZ",void 0),(0,tslib_es6._)([(0,property.MZ)()],ExtentTransformTool_S.prototype,"enableScaling",void 0),(0,tslib_es6._)([(0,property.MZ)()],ExtentTransformTool_S.prototype,"enableRotation",void 0),(0,tslib_es6._)([(0,property.MZ)({constructOnly:!0,type:SketchOptions.A})],ExtentTransformTool_S.prototype,"sketchOptions",void 0),(0,tslib_es6._)([(0,property.MZ)()],ExtentTransformTool_S.prototype,"preserveAspectRatio",null),(0,tslib_es6._)([(0,property.MZ)()],ExtentTransformTool_S.prototype,"snapRotation",null),(0,tslib_es6._)([(0,property.MZ)()],ExtentTransformTool_S.prototype,"grabbing",void 0),(0,tslib_es6._)([(0,property.MZ)()],ExtentTransformTool_S.prototype,"inputState",void 0),(0,tslib_es6._)([(0,property.MZ)({readOnly:!0})],ExtentTransformTool_S.prototype,"type",void 0),(0,tslib_es6._)([(0,property.MZ)()],ExtentTransformTool_S.prototype,"tooltip",void 0),ExtentTransformTool_S=(0,tslib_es6._)([(0,subclass.$)("esri.views.3d.interactive.editingTools.transform.ExtentTransformTool")],ExtentTransformTool_S);const ExtentTransformTool_T="draped-elevation-changes";var meshVertexSpaceUtils=__webpack_require__("./node_modules/@arcgis/core/geometry/support/meshVertexSpaceUtils.js");function undoRecords_r(e){return null!=e&&"mesh"===e.type?function undoRecords_o(e){return(0,meshVertexSpaceUtils.Hq)(e.vertexSpace)?function undoRecords_i(t,r,o){let n=r?.clone(),i=(0,vec3f64.o8)(o.origin),l=null,u=null;return{undo:()=>{l=t.transform?.clone(),u=(0,vec3f64.o8)(o.origin),t.transform=n,t.vertexSpace.origin=i},redo:()=>{n=t.transform?.clone(),i=(0,vec3f64.o8)(o.origin),t.transform=l,t.vertexSpace.origin=u}}}(e,e.transform,e.vertexSpace):function undoRecords_l(e){let t,r=e.vertexAttributes.clonePositional();return{undo:()=>{t=e.vertexAttributes.clonePositional(),e.vertexAttributes=r},redo:()=>{r=e.vertexAttributes.clonePositional(),e.vertexAttributes=t}}}(e)}(e):function undoRecords_n(e){let t=e,r=null;return{undo(e){r=e.geometry,e.geometry=t},redo(e){t=e.geometry,e.geometry=r}}}(e)}var GraphicManipulator=__webpack_require__("./node_modules/@arcgis/core/views/interactive/GraphicManipulator.js");const ManipulatedObject3DGraphic_l=Symbol();let ManipulatedObject3DGraphic_u=class extends Evented.A.EventedAccessor{get operations(){return this._operations}get updating(){return this._updatingHandles.updating}get elevationInfo(){return(0,elevationInfoUtils.bh)(this.graphic)}get visible(){return this._graphicState.displaying}get isDraped(){return this._graphicState.isDraped}get origin(){return function manipulatorUtils_D(e,t){const r=e.getViewForGraphic(t);return null!=r&&"computeAttachmentOrigin"in r?r.computeAttachmentOrigin(t,e.spatialReference):null}(this.view,this.graphic)}constructor(t){super(t),this._updatingHandles=new UpdatingHandles.U}destroy(){this._operations=(0,maybe.pR)(this._operations),this._updatingHandles.destroy()}initialize(){this._graphicState=new GraphicState_e({graphic:this.graphic}),this._graphicState.on("changed",(()=>this.emit("committed"))),this.addHandles(this.view.trackGraphicState(this._graphicState)),this.addHandles(this._updatingHandles.add((()=>this.graphic.geometry),(t=>{const e=this._operations?.data.geometry;if(t!==e){if(!t||"multipoint"===t?.type||"extent"===t?.type)return(0,maybe.pR)(this._operations),this.removeHandles(ManipulatedObject3DGraphic_l),void(this._operations=null);if(this._operations?.trySetGeometry(t))this.emit("modified-externally");else{(0,maybe.pR)(this._operations),this.removeHandles(ManipulatedObject3DGraphic_l);const e=EditGeometryOperations.p.fromGeometry(t,this.view.state.viewingMode);this._operations=e,this.addHandles(e.data.on("change",(()=>this.graphic.geometry=e.data.geometry)),ManipulatedObject3DGraphic_l)}}}),reactiveUtils.pc))}createManipulator(t){return new GraphicManipulator.l({view:this.view,graphic:this.graphic,...t})}maskOccludee(){return this.view.maskOccludee(this.graphic)}endInteraction(){const t=this.graphic.geometry;"mesh"===t?.type&&this.graphic.notifyMeshTransformChanged({action:sources_interfaces.$.UpdateFastLocalOrigin})}toMap(t){return this.view.toMap(t,{include:[this.graphic]})}createUndoRecord(){const{graphic:{geometry:t}}=this;return undoRecords_r(t)}};(0,tslib_es6._)([(0,property.MZ)({constructOnly:!0})],ManipulatedObject3DGraphic_u.prototype,"view",void 0),(0,tslib_es6._)([(0,property.MZ)({constructOnly:!0})],ManipulatedObject3DGraphic_u.prototype,"graphic",void 0),(0,tslib_es6._)([(0,property.MZ)()],ManipulatedObject3DGraphic_u.prototype,"_operations",void 0),(0,tslib_es6._)([(0,property.MZ)()],ManipulatedObject3DGraphic_u.prototype,"operations",null),(0,tslib_es6._)([(0,property.MZ)()],ManipulatedObject3DGraphic_u.prototype,"updating",null),ManipulatedObject3DGraphic_u=(0,tslib_es6._)([(0,subclass.$)("esri.views.3d.interactive.editingTools.ManipulatedObject3DGraphic")],ManipulatedObject3DGraphic_u)},"./node_modules/@arcgis/core/views/3d/support/RenderCoordsHelper.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{d:()=>RenderCoordsHelper_B});var mathUtils=__webpack_require__("./node_modules/@arcgis/core/core/mathUtils.js"),unitUtils=__webpack_require__("./node_modules/@arcgis/core/core/unitUtils.js"),mat4=__webpack_require__("./node_modules/@arcgis/core/core/libs/gl-matrix-2/math/mat4.js"),vec32=__webpack_require__("./node_modules/@arcgis/core/chunks/vec32.js"),ellipsoidUtils=__webpack_require__("./node_modules/@arcgis/core/geometry/ellipsoidUtils.js"),spatialReferenceEllipsoidUtils=__webpack_require__("./node_modules/@arcgis/core/geometry/spatialReferenceEllipsoidUtils.js"),projectPointToVector=__webpack_require__("./node_modules/@arcgis/core/geometry/projection/projectPointToVector.js"),projectVectorToPoint=__webpack_require__("./node_modules/@arcgis/core/geometry/projection/projectVectorToPoint.js"),projectVectorToVector=__webpack_require__("./node_modules/@arcgis/core/geometry/projection/projectVectorToVector.js"),aaBoundingRect=__webpack_require__("./node_modules/@arcgis/core/geometry/support/aaBoundingRect.js"),Axis=__webpack_require__("./node_modules/@arcgis/core/geometry/support/Axis.js"),vec3f64=__webpack_require__("./node_modules/@arcgis/core/core/libs/gl-matrix-2/factories/vec3f64.js"),boundedPlane=(__webpack_require__("./node_modules/@arcgis/core/geometry/SpatialReference.js"),__webpack_require__("./node_modules/@arcgis/core/chunks/boundedPlane.js")),sphere=__webpack_require__("./node_modules/@arcgis/core/chunks/sphere.js");function A(t,e,n=function x(t){return{operations:t,value:t.create()}}(t)){return n.operations=t,t.copy(e,n.value),n}const g=2**50;function O(t,e,n,o){return t.operations.setAltitudeAt(t.value,e,n,o)}function Z(t,e,n){return t.operations.elevate(t.value,e,n.value)}const q=(0,vec3f64.vt)();(0,vec3f64.vt)();var plane=__webpack_require__("./node_modules/@arcgis/core/geometry/support/plane.js"),vector=__webpack_require__("./node_modules/@arcgis/core/geometry/support/vector.js"),vectorStacks=__webpack_require__("./node_modules/@arcgis/core/geometry/support/vectorStacks.js"),dehydratedFeatureUtils=__webpack_require__("./node_modules/@arcgis/core/layers/graphics/dehydratedFeatureUtils.js"),ViewingMode=__webpack_require__("./node_modules/@arcgis/core/views/ViewingMode.js");class RenderCoordsHelper_B{constructor(t,e,o,r){this.viewingMode=t,this.spatialReference=e,this.unitInMeters=o,this._coordinateSystem=r,this._tmpCoordinateSystem=function h(t){const{value:e,operations:n}=t;return{operations:n,value:n.create(e)}}(r),this.referenceEllipsoid=(0,ellipsoidUtils.tO)(e),this.sphericalPCPF=(0,spatialReferenceEllipsoidUtils.lO)(e)}set extent(t){t&&function j(t,e,n){return t.operations.setExtent(t.value,e,n.value),n}(this._coordinateSystem,t,this._coordinateSystem)}get extent(){return function d(t,e){return t.operations.getExtent(t.value,e),e}(this._coordinateSystem,(0,aaBoundingRect.vt)())}getAltitude(t){return function G(t,e){return t.operations.altitudeAt(t.value,e)}(this._coordinateSystem,t)}setAltitude(t,e,o=t){return O(this._coordinateSystem,o,e,t)}setAltitudeOfTransformation(t,e){!function T(n,o,r,i){return o!==i&&(0,mat4.C)(i,o),(0,vec32.i)(q,i[12],i[13],i[14]),O(n,q,r,q),i[12]=q[0],i[13]=q[1],i[14]=q[2],i}(this._coordinateSystem,e,t,e)}worldUpAtPosition(t,e){return function R(t,e,n){return t.operations.axisAt(t.value,e,Axis._.Z,n)}(this._coordinateSystem,t,e)}worldBasisAtPosition(t,e,o){return function S(t,e,n,o){return t.operations.axisAt(t.value,e,n,o)}(this._coordinateSystem,t,e,o)}basisMatrixAtPosition(t,e){const o=this.worldBasisAtPosition(t,Axis._.X,vectorStacks.rq.get()),i=this.worldBasisAtPosition(t,Axis._.Y,vectorStacks.rq.get()),s=this.worldBasisAtPosition(t,Axis._.Z,vectorStacks.rq.get());return(0,mat4.hZ)(e,o[0],o[1],o[2],0,i[0],i[1],i[2],0,s[0],s[1],s[2],0,0,0,0,1),e}headingAtPosition(e,o){const r=this.worldUpAtPosition(e,vectorStacks.rq.get()),i=this.worldBasisAtPosition(e,Axis._.Y,vectorStacks.rq.get()),s=(0,vector.EJ)(o,i,r);return(0,mathUtils.KJ)(s)}intersectManifoldClosestSilhouette(t,e,o){return Z(this._coordinateSystem,e,this._tmpCoordinateSystem),function E(t,e,n){return t.operations.intersectRayClosestSilhouette(t.value,e,n)}(this._tmpCoordinateSystem,t,o),o}intersectManifold(t,e,o){Z(this._coordinateSystem,e,this._tmpCoordinateSystem);const r=vectorStacks.rq.get();return function k(t,e,n){return t.operations.intersectRay(t.value,e,n)}(this._tmpCoordinateSystem,t,r)?(0,vec32.c)(o,r):null}intersectInfiniteManifold(t,e,o){if(this.viewingMode===ViewingMode.RT.Global)return this.intersectManifold(t,e,o);Z(this._coordinateSystem,e,this._tmpCoordinateSystem);const r=this._tmpCoordinateSystem.value,s=vectorStacks.rq.get();return(0,plane.Ui)(r.plane,t,s)?(0,vec32.c)(o,s):null}toRenderCoords(t,e,o){return(0,dehydratedFeatureUtils.v)(t)?(0,projectPointToVector.g)(t,e,this.spatialReference):(0,projectVectorToVector.F)(t,e,o,this.spatialReference)}fromRenderCoords(t,e,o=null){return(0,dehydratedFeatureUtils.v)(e)?(null!=o&&(e.spatialReference=o),(0,projectVectorToPoint.E)(t,this.spatialReference,e)?e:null):(0,projectVectorToVector.F)(t,this.spatialReference,e,o)?e:null}static create(t,o){switch(t){case ViewingMode.RT.Local:return new RenderCoordsHelper_B(ViewingMode.RT.Local,o,(0,unitUtils.GA)(o),function P(){return A(boundedPlane.b,(0,boundedPlane.f)([0,0,0],[g,0,0],[0,g,0]))}());case ViewingMode.RT.Global:return new RenderCoordsHelper_B(ViewingMode.RT.Global,o,1,function b(t){return A(sphere.s,(0,sphere.f)(0,0,0,(0,ellipsoidUtils.tO)(t).radius))}(o))}}static renderUnitScaleFactor(t,e){return(0,unitUtils.KX)(t)/(0,unitUtils.KX)(e)}}},"./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/Laserline.glsl.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{K:()=>i});var _output_ReadDepth_glsl_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/output/ReadDepth.glsl.js"),_util_CameraSpace_glsl_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/util/CameraSpace.glsl.js"),_shaderModules_Float3PassUniform_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderModules/Float3PassUniform.js"),_shaderModules_FloatPassUniform_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderModules/FloatPassUniform.js"),_shaderModules_glsl_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderModules/glsl.js"),_shaderModules_Texture2DBindUniform_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderModules/Texture2DBindUniform.js"),_shaderModules_Texture2DPassUniform_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderModules/Texture2DPassUniform.js");function i(i,p){const d=i.fragment;d.include(_output_ReadDepth_glsl_js__WEBPACK_IMPORTED_MODULE_0__.E),i.include(_util_CameraSpace_glsl_js__WEBPACK_IMPORTED_MODULE_1__.Ir),d.uniforms.add(new _shaderModules_FloatPassUniform_js__WEBPACK_IMPORTED_MODULE_3__.m("globalAlpha",(e=>e.globalAlpha)),new _shaderModules_Float3PassUniform_js__WEBPACK_IMPORTED_MODULE_2__.t("glowColor",(e=>e.glowColor)),new _shaderModules_FloatPassUniform_js__WEBPACK_IMPORTED_MODULE_3__.m("glowWidth",((e,o)=>e.glowWidth*o.camera.pixelRatio)),new _shaderModules_FloatPassUniform_js__WEBPACK_IMPORTED_MODULE_3__.m("glowFalloff",(e=>e.glowFalloff)),new _shaderModules_Float3PassUniform_js__WEBPACK_IMPORTED_MODULE_2__.t("innerColor",(e=>e.innerColor)),new _shaderModules_FloatPassUniform_js__WEBPACK_IMPORTED_MODULE_3__.m("innerWidth",((e,o)=>e.innerWidth*o.camera.pixelRatio)),new _shaderModules_Texture2DBindUniform_js__WEBPACK_IMPORTED_MODULE_5__.x("depthMap",(e=>e.depth?.attachment)),new _shaderModules_Texture2DPassUniform_js__WEBPACK_IMPORTED_MODULE_6__.N("normalMap",(e=>e.normals))),d.code.add(_shaderModules_glsl_js__WEBPACK_IMPORTED_MODULE_4__.H`vec4 blendPremultiplied(vec4 source, vec4 dest) {
float oneMinusSourceAlpha = 1.0 - source.a;
return vec4(
source.rgb + dest.rgb * oneMinusSourceAlpha,
source.a + dest.a * oneMinusSourceAlpha
);
}`),d.code.add(_shaderModules_glsl_js__WEBPACK_IMPORTED_MODULE_4__.H`vec4 premultipliedColor(vec3 rgb, float alpha) {
return vec4(rgb * alpha, alpha);
}`),d.code.add(_shaderModules_glsl_js__WEBPACK_IMPORTED_MODULE_4__.H`vec4 laserlineProfile(float dist) {
if (dist > glowWidth) {
return vec4(0.0);
}
float innerAlpha = (1.0 - smoothstep(0.0, innerWidth, dist));
float glowAlpha = pow(max(0.0, 1.0 - dist / glowWidth), glowFalloff);
return blendPremultiplied(
premultipliedColor(innerColor, innerAlpha),
premultipliedColor(glowColor, glowAlpha)
);
}`),d.code.add(_shaderModules_glsl_js__WEBPACK_IMPORTED_MODULE_4__.H`bool laserlineReconstructFromDepth(out vec3 pos, out vec3 normal, out float angleCutoffAdjust, out float depthDiscontinuityAlpha) {
float depth = depthFromTexture(depthMap, uv);
if (depth == 1.0) {
return false;
}
float linearDepth = linearizeDepth(depth);
pos = reconstructPosition(gl_FragCoord.xy, linearDepth);
float minStep = 6e-8;
float depthStep = clamp(depth + minStep, 0.0, 1.0);
float linearDepthStep = linearizeDepth(depthStep);
float depthError = abs(linearDepthStep - linearDepth);
if (depthError > 0.2) {
normal = texture(normalMap, uv).xyz * 2.0 - 1.0;
angleCutoffAdjust = 0.004;
} else {
normal = normalize(cross(dFdx(pos), dFdy(pos)));
angleCutoffAdjust = 0.0;
}
float ddepth = fwidth(linearDepth);
depthDiscontinuityAlpha = 1.0 - smoothstep(0.0, 0.01, -ddepth / linearDepth);
return true;
}`),p.contrastControlEnabled?d.uniforms.add(new _shaderModules_Texture2DPassUniform_js__WEBPACK_IMPORTED_MODULE_6__.N("frameColor",((e,o)=>e.colors)),new _shaderModules_FloatPassUniform_js__WEBPACK_IMPORTED_MODULE_3__.m("globalAlphaContrastBoost",(e=>e.globalAlphaContrastBoost))).code.add(_shaderModules_glsl_js__WEBPACK_IMPORTED_MODULE_4__.H`float rgbToLuminance(vec3 color) {
return dot(vec3(0.2126, 0.7152, 0.0722), color);
}
vec4 laserlineOutput(vec4 color) {
float backgroundLuminance = rgbToLuminance(texture(frameColor, uv).rgb);
float alpha = clamp(globalAlpha * max(backgroundLuminance * globalAlphaContrastBoost, 1.0), 0.0, 1.0);
return color * alpha;
}`):d.code.add(_shaderModules_glsl_js__WEBPACK_IMPORTED_MODULE_4__.H`vec4 laserlineOutput(vec4 color) {
return color * globalAlpha;
}`)}},"./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/ScreenSizeScaling.glsl.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{L:()=>n});var _util_View_glsl_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/util/View.glsl.js"),_shaderModules_FloatBindUniform_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderModules/FloatBindUniform.js"),_shaderModules_FloatPassUniform_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderModules/FloatPassUniform.js"),_shaderModules_glsl_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderModules/glsl.js");function n(n,c){if(!c.screenSizeEnabled)return;const t=n.vertex;(0,_util_View_glsl_js__WEBPACK_IMPORTED_MODULE_0__.yu)(t,c),t.uniforms.add(new _shaderModules_FloatBindUniform_js__WEBPACK_IMPORTED_MODULE_1__.U("perScreenPixelRatio",(e=>e.camera.perScreenPixelRatio)),new _shaderModules_FloatPassUniform_js__WEBPACK_IMPORTED_MODULE_2__.m("screenSizeScale",(e=>e.screenSizeScale))).code.add(_shaderModules_glsl_js__WEBPACK_IMPORTED_MODULE_3__.H`float computeRenderPixelSizeAt( vec3 pWorld ){
vec3 viewForward = - vec3(view[0][2], view[1][2], view[2][2]);
float viewDirectionDistance = abs(dot(viewForward, pWorld - cameraPosition));
return viewDirectionDistance * perScreenPixelRatio;
}
vec3 screenSizeScaling(vec3 position, vec3 anchor){
return position * screenSizeScale * computeRenderPixelSizeAt(anchor) + anchor;
}`)}},"./node_modules/@arcgis/core/views/3d/webgl-engine/shaders/CompositingTechniqueConfiguration.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{N:()=>r,d:()=>i});var i,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@arcgis/core/chunks/tslib.es6.js"),_core_shaderTechnique_ShaderTechniqueConfiguration_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderTechnique/ShaderTechniqueConfiguration.js");!function(t){t[t.None=0]="None",t[t.Alpha=1]="Alpha",t[t.PremultipliedAlpha=2]="PremultipliedAlpha",t[t.Depth=3]="Depth",t[t.COUNT=4]="COUNT"}(i||(i={}));class r extends _core_shaderTechnique_ShaderTechniqueConfiguration_js__WEBPACK_IMPORTED_MODULE_1__.K{constructor(){super(...arguments),this.blitMode=i.None,this.hasOpacityFactor=!1}}(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_shaderTechnique_ShaderTechniqueConfiguration_js__WEBPACK_IMPORTED_MODULE_1__.W)({count:i.COUNT})],r.prototype,"blitMode",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_shaderTechnique_ShaderTechniqueConfiguration_js__WEBPACK_IMPORTED_MODULE_1__.W)()],r.prototype,"hasOpacityFactor",void 0)},"./node_modules/@arcgis/core/views/input/IViewEvents.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{var t;__webpack_require__.d(__webpack_exports__,{w:()=>t}),function(t){t[t.Left=0]="Left",t[t.Middle=1]="Middle",t[t.Right=2]="Right"}(t||(t={}))},"./node_modules/@arcgis/core/views/interactive/tooltip/infos/ExtentRotateTooltipInfo.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{d:()=>s});var _chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@arcgis/core/chunks/tslib.es6.js"),_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/decorators/property.js"),_core_accessorSupport_decorators_subclass_js__WEBPACK_IMPORTED_MODULE_5__=(__webpack_require__("./node_modules/@arcgis/core/core/has.js"),__webpack_require__("./node_modules/@arcgis/core/core/Logger.js"),__webpack_require__("./node_modules/@arcgis/core/core/RandomLCG.js"),__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/decorators/subclass.js")),_SketchTooltipInfo_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./node_modules/@arcgis/core/views/interactive/tooltip/infos/SketchTooltipInfo.js");let s=class extends _SketchTooltipInfo_js__WEBPACK_IMPORTED_MODULE_6__.w{constructor(o){super(o),this.type="extent-rotate",this.angle=0}};(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_1__.MZ)()],s.prototype,"type",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_1__.MZ)()],s.prototype,"angle",void 0),s=(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_subclass_js__WEBPACK_IMPORTED_MODULE_5__.$)("esri.views.interactive.tooltip.infos.ExtentRotateTooltipInfo")],s)},"./node_modules/@arcgis/core/views/interactive/tooltip/infos/ExtentScaleTooltipInfo.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{c:()=>i});var _chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@arcgis/core/chunks/tslib.es6.js"),_core_quantityUtils_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@arcgis/core/core/quantityUtils.js"),_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/decorators/property.js"),_core_accessorSupport_decorators_subclass_js__WEBPACK_IMPORTED_MODULE_6__=(__webpack_require__("./node_modules/@arcgis/core/core/has.js"),__webpack_require__("./node_modules/@arcgis/core/core/Logger.js"),__webpack_require__("./node_modules/@arcgis/core/core/RandomLCG.js"),__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/decorators/subclass.js")),_SketchTooltipInfo_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./node_modules/@arcgis/core/views/interactive/tooltip/infos/SketchTooltipInfo.js");let i=class extends _SketchTooltipInfo_js__WEBPACK_IMPORTED_MODULE_7__.w{constructor(o){super(o),this.type="extent-scale",this.xScale=0,this.yScale=0,this.xSize=_core_quantityUtils_js__WEBPACK_IMPORTED_MODULE_1__.r7,this.ySize=_core_quantityUtils_js__WEBPACK_IMPORTED_MODULE_1__.r7}};(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_2__.MZ)()],i.prototype,"type",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_2__.MZ)()],i.prototype,"xScale",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_2__.MZ)()],i.prototype,"yScale",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_2__.MZ)()],i.prototype,"xSize",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_2__.MZ)()],i.prototype,"ySize",void 0),i=(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_subclass_js__WEBPACK_IMPORTED_MODULE_6__.$)("esri.views.interactive.tooltip.infos.ExtentScaleTooltipInfo")],i)},"./node_modules/@arcgis/core/views/interactive/tooltip/infos/MovePointTooltipInfo.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{F:()=>i});var _chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@arcgis/core/chunks/tslib.es6.js"),_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/decorators/property.js"),_core_accessorSupport_decorators_subclass_js__WEBPACK_IMPORTED_MODULE_5__=(__webpack_require__("./node_modules/@arcgis/core/core/has.js"),__webpack_require__("./node_modules/@arcgis/core/core/Logger.js"),__webpack_require__("./node_modules/@arcgis/core/core/RandomLCG.js"),__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/decorators/subclass.js")),_SketchTooltipInfo_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./node_modules/@arcgis/core/views/interactive/tooltip/infos/SketchTooltipInfo.js"),_TooltipInfoWithCoordinates_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./node_modules/@arcgis/core/views/interactive/tooltip/infos/TooltipInfoWithCoordinates.js");let i=class extends((0,_TooltipInfoWithCoordinates_js__WEBPACK_IMPORTED_MODULE_7__.B)(_SketchTooltipInfo_js__WEBPACK_IMPORTED_MODULE_6__.w)){constructor(o){super(o),this.type="move-point",this.allFields.forEach((o=>{o.lockable=!1,o.setActual(null)}))}get allFields(){return[this.longitude,this.latitude,this.x,this.y,this.elevation]}};(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_1__.MZ)()],i.prototype,"allFields",null),i=(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_subclass_js__WEBPACK_IMPORTED_MODULE_5__.$)("esri.views.interactive.tooltip.infos.MovePointTooltipInfo")],i)},"./node_modules/@arcgis/core/views/interactive/tooltip/infos/SelectedVertexTooltipInfo.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{d:()=>p});var _chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@arcgis/core/chunks/tslib.es6.js"),_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/decorators/property.js"),_core_accessorSupport_decorators_subclass_js__WEBPACK_IMPORTED_MODULE_5__=(__webpack_require__("./node_modules/@arcgis/core/core/has.js"),__webpack_require__("./node_modules/@arcgis/core/core/Logger.js"),__webpack_require__("./node_modules/@arcgis/core/core/RandomLCG.js"),__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/decorators/subclass.js")),_fields_fields_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./node_modules/@arcgis/core/views/interactive/tooltip/fields/fields.js"),_SketchTooltipInfo_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./node_modules/@arcgis/core/views/interactive/tooltip/infos/SketchTooltipInfo.js"),_TooltipInfoWithCoordinates_js__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./node_modules/@arcgis/core/views/interactive/tooltip/infos/TooltipInfoWithCoordinates.js");let p=class extends((0,_TooltipInfoWithCoordinates_js__WEBPACK_IMPORTED_MODULE_8__.B)(_SketchTooltipInfo_js__WEBPACK_IMPORTED_MODULE_7__.w)){constructor(t){super(t),this.type="selected-vertex",this.area=(0,_fields_fields_js__WEBPACK_IMPORTED_MODULE_6__.Am)(),this.totalLength=(0,_fields_fields_js__WEBPACK_IMPORTED_MODULE_6__.fr)(),this.geometryType="polyline",this.allFields.forEach((t=>{t.lockable=!1,t.setActual(null)}))}get allFields(){return[this.longitude,this.latitude,this.x,this.y,this.elevation,"polygon"===this.geometryType?this.area:this.totalLength]}};(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_1__.MZ)()],p.prototype,"geometryType",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_1__.MZ)()],p.prototype,"allFields",null),p=(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_subclass_js__WEBPACK_IMPORTED_MODULE_5__.$)("esri.views.interactive.tooltip.infos.SelectedVertexTooltipInfo")],p)},"./node_modules/@arcgis/core/views/interactive/tooltip/infos/TranslateTooltipInfo.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{M:()=>i});var _chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@arcgis/core/chunks/tslib.es6.js"),_core_quantityUtils_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@arcgis/core/core/quantityUtils.js"),_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/decorators/property.js"),_core_accessorSupport_decorators_subclass_js__WEBPACK_IMPORTED_MODULE_6__=(__webpack_require__("./node_modules/@arcgis/core/core/has.js"),__webpack_require__("./node_modules/@arcgis/core/core/Logger.js"),__webpack_require__("./node_modules/@arcgis/core/core/RandomLCG.js"),__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/decorators/subclass.js")),_SketchTooltipInfo_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./node_modules/@arcgis/core/views/interactive/tooltip/infos/SketchTooltipInfo.js");let i=class extends _SketchTooltipInfo_js__WEBPACK_IMPORTED_MODULE_7__.w{constructor(o){super(o),this.type="translate",this.distance=_core_quantityUtils_js__WEBPACK_IMPORTED_MODULE_1__.r7}clear(){this.distance=_core_quantityUtils_js__WEBPACK_IMPORTED_MODULE_1__.r7}};(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_2__.MZ)()],i.prototype,"type",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_2__.MZ)()],i.prototype,"distance",void 0),i=(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_subclass_js__WEBPACK_IMPORTED_MODULE_6__.$)("esri.views.interactive.tooltip.infos.TranslateTooltipInfo")],i)},"./node_modules/@arcgis/core/views/support/extentUtils.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{b:()=>o});var _core_quantityUtils_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@arcgis/core/core/quantityUtils.js"),_automaticLengthMeasurementUtils_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@arcgis/core/views/support/automaticLengthMeasurementUtils.js");function o({topLeft:o,topRight:n,bottomRight:i,bottomLeft:r,spatialReference:l}){const u=(0,_core_quantityUtils_js__WEBPACK_IMPORTED_MODULE_0__.T9)((0,_automaticLengthMeasurementUtils_js__WEBPACK_IMPORTED_MODULE_1__.Do)(r,i,l),(0,_automaticLengthMeasurementUtils_js__WEBPACK_IMPORTED_MODULE_1__.Do)(o,n,l));if(null==u)return null;const m=(0,_core_quantityUtils_js__WEBPACK_IMPORTED_MODULE_0__.T9)((0,_automaticLengthMeasurementUtils_js__WEBPACK_IMPORTED_MODULE_1__.Do)(i,n,l),(0,_automaticLengthMeasurementUtils_js__WEBPACK_IMPORTED_MODULE_1__.Do)(r,o,l));return null==m?null:{xSize:u,ySize:m}}}}]);
//# sourceMappingURL=4993.e3c86cf4.iframe.bundle.js.map