"use strict";(self.webpackChunk_defra_flood_map=self.webpackChunk_defra_flood_map||[]).push([[2109],{"./node_modules/@arcgis/core/core/ReactiveSet.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>t});var _accessorSupport_tracking_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/tracking.js"),_accessorSupport_tracking_SimpleObservable_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/tracking/SimpleObservable.js");class t{constructor(e){this._observable=new _accessorSupport_tracking_SimpleObservable_js__WEBPACK_IMPORTED_MODULE_1__.I,this._set=new Set(e)}get size(){return(0,_accessorSupport_tracking_js__WEBPACK_IMPORTED_MODULE_0__.gc)(this._observable),this._set.size}add(e){const s=this._set.size;return this._set.add(e),this._set.size!==s&&this._observable.notify(),this}clear(){this._set.size>0&&(this._set.clear(),this._observable.notify())}delete(e){const s=this._set.delete(e);return s&&this._observable.notify(),s}entries(){return(0,_accessorSupport_tracking_js__WEBPACK_IMPORTED_MODULE_0__.gc)(this._observable),this._set.entries()}forEach(s,t){(0,_accessorSupport_tracking_js__WEBPACK_IMPORTED_MODULE_0__.gc)(this._observable),this._set.forEach(((e,r)=>s.call(t,e,r,this)),t)}has(s){return(0,_accessorSupport_tracking_js__WEBPACK_IMPORTED_MODULE_0__.gc)(this._observable),this._set.has(s)}keys(){return(0,_accessorSupport_tracking_js__WEBPACK_IMPORTED_MODULE_0__.gc)(this._observable),this._set.keys()}values(){return(0,_accessorSupport_tracking_js__WEBPACK_IMPORTED_MODULE_0__.gc)(this._observable),this._set.values()}[Symbol.iterator](){return(0,_accessorSupport_tracking_js__WEBPACK_IMPORTED_MODULE_0__.gc)(this._observable),this._set[Symbol.iterator]()}[Symbol.dispose](){this._observable.destroy()}get[Symbol.toStringTag](){return this._set[Symbol.toStringTag]}}},"./node_modules/@arcgis/core/geometry/Circle.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>b});var f,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@arcgis/core/chunks/tslib.es6.js"),_core_unitUtils_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@arcgis/core/core/unitUtils.js"),_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/decorators/property.js"),_core_accessorSupport_decorators_subclass_js__WEBPACK_IMPORTED_MODULE_6__=(__webpack_require__("./node_modules/@arcgis/core/core/has.js"),__webpack_require__("./node_modules/@arcgis/core/core/Logger.js"),__webpack_require__("./node_modules/@arcgis/core/core/RandomLCG.js"),__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/decorators/subclass.js")),_ellipsoidUtils_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./node_modules/@arcgis/core/geometry/ellipsoidUtils.js"),_Point_js__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./node_modules/@arcgis/core/geometry/Point.js"),_Polygon_js__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./node_modules/@arcgis/core/geometry/Polygon.js"),_SpatialReference_js__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("./node_modules/@arcgis/core/geometry/SpatialReference.js"),_support_geodesicUtils_js__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__("./node_modules/@arcgis/core/geometry/support/geodesicUtils.js"),_support_webMercatorUtils_js__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__("./node_modules/@arcgis/core/geometry/support/webMercatorUtils.js"),_support_WKIDUnitConversion_js__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__("./node_modules/@arcgis/core/geometry/support/WKIDUnitConversion.js");let g=f=class extends _Polygon_js__WEBPACK_IMPORTED_MODULE_9__.A{constructor(e){super(e),this.center=null,this.geodesic=!1,this.numberOfPoints=60,this.radius=1e3,this.radiusUnit="meters"}initialize(){const e=this.center,o=this.numberOfPoints;if(this.hasZ=e?.hasZ??!1,0!==this.rings.length||!e)return;const c=(0,_core_unitUtils_js__WEBPACK_IMPORTED_MODULE_1__.oU)(this.radius,this.radiusUnit,"meters"),n=e.spatialReference;let p,l="geographic";if(n.isWebMercator?l="webMercator":(null!=(n.wkid&&_support_WKIDUnitConversion_js__WEBPACK_IMPORTED_MODULE_13__.A[n.wkid])||(n.wkt2||n.wkt)&&(0,_core_unitUtils_js__WEBPACK_IMPORTED_MODULE_1__.x1)(n.wkt2||n.wkt))&&(l="projected"),this.geodesic){let r;switch(l){case"webMercator":r=(0,_support_webMercatorUtils_js__WEBPACK_IMPORTED_MODULE_12__.ci)(e);break;case"projected":console.error("Creating a geodesic circle requires the center to be specified in web mercator or geographic coordinate system");break;case"geographic":r=e}p=this._createGeodesicCircle(r,c,o),"webMercator"===l&&(p=(0,_support_webMercatorUtils_js__WEBPACK_IMPORTED_MODULE_12__.Gh)(p))}else{let r;"webMercator"===l||"projected"===l?r=c/(0,_core_unitUtils_js__WEBPACK_IMPORTED_MODULE_1__.Ao)(e.spatialReference):"geographic"===l&&(r=(0,_core_unitUtils_js__WEBPACK_IMPORTED_MODULE_1__.vl)(c,"meters",(0,_ellipsoidUtils_js__WEBPACK_IMPORTED_MODULE_7__.tO)(e.spatialReference).radius)),p=this._createPlanarCircle(e,r,o)}this.spatialReference=p.spatialReference,this.addRing(p.rings[0])}clone(){const{center:e,numberOfPoints:r,radius:t,radiusUnit:s,geodesic:i}=this;return new f({center:e?.clone(),numberOfPoints:r,radius:t,radiusUnit:s,geodesic:i})}_createGeodesicCircle(e,r,t){const s=[],i=[e.x,e.y];for(let o=0;o<360;o+=360/t){const t=this.hasZ?[0,0,e.z??0]:[0,0];(0,_support_geodesicUtils_js__WEBPACK_IMPORTED_MODULE_11__.vN)(t,i,o,r,_SpatialReference_js__WEBPACK_IMPORTED_MODULE_10__.A.WGS84),s.push(t)}return s.push(s[0]),new _Polygon_js__WEBPACK_IMPORTED_MODULE_9__.A({rings:[s]})}_createPlanarCircle(e,r,t){const s=[],i=2*Math.PI/t;for(let o=0;o<t;++o){const t=i*o,c=[e.x+Math.cos(-t)*r,e.y+Math.sin(-t)*r];this.hasZ&&c.push(e.z??0),s.push(c)}return s.push(s[0]),new _Polygon_js__WEBPACK_IMPORTED_MODULE_9__.A({spatialReference:e.spatialReference,rings:[s]})}};(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_2__.MZ)({type:_Point_js__WEBPACK_IMPORTED_MODULE_8__.default})],g.prototype,"center",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_2__.MZ)()],g.prototype,"geodesic",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_2__.MZ)()],g.prototype,"numberOfPoints",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_2__.MZ)()],g.prototype,"radius",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_2__.MZ)()],g.prototype,"radiusUnit",void 0),g=f=(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_subclass_js__WEBPACK_IMPORTED_MODULE_6__.$)("esri.geometry.Circle")],g);const b=g},"./node_modules/@arcgis/core/layers/graphics/hydratedFeatures.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{EL:()=>x,RS:()=>k,gr:()=>o,wP:()=>c,wZ:()=>u});var _Graphic_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@arcgis/core/Graphic.js"),_core_lang_js__WEBPACK_IMPORTED_MODULE_2__=(__webpack_require__("./node_modules/@arcgis/core/core/has.js"),__webpack_require__("./node_modules/@arcgis/core/core/lang.js")),_core_typedArrayUtil_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@arcgis/core/core/typedArrayUtil.js"),_geometry_SpatialReference_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/@arcgis/core/geometry/SpatialReference.js"),_geometry_support_jsonUtils_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/@arcgis/core/geometry/support/jsonUtils.js"),_dehydratedPoint_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./node_modules/@arcgis/core/layers/graphics/dehydratedPoint.js");function o(e){return"declaredClass"in e}function m(e){return"declaredClass"in e}function c(n,r){return n?function l(e){return"declaredClass"in e}(n)?n:new _Graphic_js__WEBPACK_IMPORTED_MODULE_0__.default({layer:r,sourceLayer:r,visible:n.visible,symbol:(0,_core_lang_js__WEBPACK_IMPORTED_MODULE_2__.o8)(n.symbol),attributes:(0,_core_lang_js__WEBPACK_IMPORTED_MODULE_2__.o8)(n.attributes),geometry:u(n.geometry)}):null}function u(e){return null==e?null:o(e)?e:(0,_geometry_support_jsonUtils_js__WEBPACK_IMPORTED_MODULE_5__.rS)(function f(e){const{wkid:t,wkt:n,wkt2:r,latestWkid:a}=e.spatialReference,s={wkid:t,wkt:n,wkt2:r,latestWkid:a};switch(e.type){case"point":{const{x:t,y:n,z:r,m:a}=e;return{x:t,y:n,z:r,m:a,spatialReference:s}}case"polygon":{const{rings:t,hasZ:n,hasM:r}=e;return{rings:p(t),hasZ:n,hasM:r,spatialReference:s}}case"polyline":{const{paths:t,hasZ:n,hasM:r}=e;return{paths:p(t),hasZ:n,hasM:r,spatialReference:s}}case"extent":{const{xmin:t,xmax:n,ymin:r,ymax:a,zmin:i,zmax:o,mmin:m,mmax:l,hasZ:c,hasM:u}=e;return{xmin:t,xmax:n,ymin:r,ymax:a,zmin:i,zmax:o,mmin:m,mmax:l,hasZ:c,hasM:u,spatialReference:s}}case"multipoint":{const{points:t,hasZ:n,hasM:r}=e;return{points:d(t)?h(t):t,hasZ:n,hasM:r,spatialReference:s}}default:return}}(e))}function p(e){return function y(e){for(const t of e)if(0!==t.length)return d(t);return!1}(e)?e.map((e=>h(e))):e}function h(e){return e.map((e=>Array.from(e)))}function d(e){return e.length>0&&((0,_core_typedArrayUtil_js__WEBPACK_IMPORTED_MODULE_3__.vZ)(e[0])||(0,_core_typedArrayUtil_js__WEBPACK_IMPORTED_MODULE_3__.aI)(e[0]))}function x(e,t){if(!e)return null;let n;if(m(e)){if(null==t)return e.clone();if(m(t))return t.copy(e)}return null!=t?(n=t,n.x=e.x,n.y=e.y,n.spatialReference=e.spatialReference,e.hasZ?(n.z=e.z,n.hasZ=e.hasZ):(n.z=void 0,n.hasZ=!1),e.hasM?(n.m=e.m,n.hasM=!0):(n.m=void 0,n.hasM=!1)):(n=(0,_dehydratedPoint_js__WEBPACK_IMPORTED_MODULE_6__.T)(e.x,e.y,e.z,e.spatialReference),e.hasM&&(n.m=e.m,n.hasM=!0)),n}function k(e){const{wkid:t,wkt:n,wkt2:r,latestWkid:s}=e,i={wkid:t,wkt:n,wkt2:r,latestWkid:s};return _geometry_SpatialReference_js__WEBPACK_IMPORTED_MODULE_4__.A.fromJSON(i)}},"./node_modules/@arcgis/core/symbols/support/cimSymbolUtils.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Fe:()=>I,Km:()=>l,Nk:()=>C});var _Color_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@arcgis/core/Color.js"),_cim_utils_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@arcgis/core/symbols/cim/utils.js");function l(e,t,o,r){if(e)if("CIMTextSymbol"!==e.type){if(o&&e.effects)for(const o of e.effects)y(o,t);if(e.symbolLayers)for(const o of e.symbolLayers){switch(o.type){case"CIMPictureMarker":case"CIMVectorMarker":m(o,t,r);break;case"CIMPictureStroke":case"CIMSolidStroke":case"CIMGradientStroke":!r?.preserveOutlineWidth&&o.width&&(o.width*=t);break;case"CIMPictureFill":o.height&&(o.height*=t),o.offsetX&&(o.offsetX*=t),o.offsetY&&(o.offsetY*=t);break;case"CIMHatchFill":l(o.lineSymbol,t,!0,{...r,preserveOutlineWidth:!1}),o.offsetX&&(o.offsetX*=t),o.offsetY&&(o.offsetY*=t),o.separation&&(o.separation*=t)}if(o.effects)for(const e of o.effects)y(e,t)}}else null!=e.height&&(e.height*=t)}function m(e,t,o){if(e&&(e.markerPlacement&&function M(e,t){switch((0,_cim_utils_js__WEBPACK_IMPORTED_MODULE_1__.zr)(e)&&e.offset&&(e.offset*=t),e.type){case"CIMMarkerPlacementAlongLineRandomSize":case"CIMMarkerPlacementAlongLineSameSize":if(e.customEndingOffset&&(e.customEndingOffset*=t),e.offsetAlongLine&&(e.offsetAlongLine*=t),e.placementTemplate&&e.placementTemplate.length){const o=e.placementTemplate.map((e=>e*t));e.placementTemplate=o}break;case"CIMMarkerPlacementAlongLineVariableSize":if(e.maxRandomOffset&&(e.maxRandomOffset*=t),e.placementTemplate&&e.placementTemplate.length){const o=e.placementTemplate.map((e=>e*t));e.placementTemplate=o}break;case"CIMMarkerPlacementOnLine":e.startPointOffset&&(e.startPointOffset*=t);break;case"CIMMarkerPlacementAtExtremities":e.offsetAlongLine&&(e.offsetAlongLine*=t);break;case"CIMMarkerPlacementAtMeasuredUnits":case"CIMMarkerPlacementOnVertices":break;case"CIMMarkerPlacementAtRatioPositions":e.beginPosition&&(e.beginPosition*=t),e.endPosition&&(e.endPosition*=t);break;case"CIMMarkerPlacementPolygonCenter":e.offsetX&&(e.offsetX*=t),e.offsetY&&(e.offsetY*=t);break;case"CIMMarkerPlacementInsidePolygon":e.offsetX&&(e.offsetX*=t),e.offsetY&&(e.offsetY*=t),e.stepX&&(e.stepX*=t),e.stepY&&(e.stepY*=t)}}(e.markerPlacement,t),e.offsetX&&(e.offsetX*=t),e.offsetY&&(e.offsetY*=t),e.anchorPoint&&"Absolute"===e.anchorPointUnits&&(e.anchorPoint={x:e.anchorPoint.x*t,y:e.anchorPoint.y*t}),e.size=null!=e.size?e.size*t:0,"CIMVectorMarker"===e.type&&e.markerGraphics))for(const r of e.markerGraphics)e.scaleSymbolsProportionally||l(r.symbol,t,!0,o)}function y(e,t){switch(e.type){case"CIMGeometricEffectArrow":case"CIMGeometricEffectDonut":e.width&&(e.width*=t);break;case"CIMGeometricEffectBuffer":e.size&&(e.size*=t);break;case"CIMGeometricEffectCut":e.beginCut&&(e.beginCut*=t),e.endCut&&(e.endCut*=t),e.middleCut&&(e.middleCut*=t);break;case"CIMGeometricEffectDashes":if(e.customEndingOffset&&(e.customEndingOffset*=t),e.offsetAlongLine&&(e.offsetAlongLine*=t),e.dashTemplate&&e.dashTemplate.length){const o=e.dashTemplate.map((e=>e*t));e.dashTemplate=o}break;case"CIMGeometricEffectExtension":case"CIMGeometricEffectJog":case"CIMGeometricEffectRadial":e.length&&(e.length*=t);break;case"CIMGeometricEffectMove":e.offsetX&&(e.offsetX*=t),e.offsetY&&(e.offsetY*=t);break;case"CIMGeometricEffectOffset":case"CIMGeometricEffectOffsetTangent":e.offset&&(e.offset*=t);break;case"CIMGeometricEffectRegularPolygon":e.radius&&(e.radius*=t);break;case"CIMGeometricEffectTaperedPolygon":e.fromWidth&&(e.fromWidth*=t),e.length&&(e.length*=t),e.toWidth&&(e.toWidth*=t);break;case"CIMGeometricEffectWave":e.amplitude&&(e.amplitude*=t),e.period&&(e.period*=t)}}function C(o){const r=[];return u((0,_cim_utils_js__WEBPACK_IMPORTED_MODULE_1__.lW)(o),r),r.length?new _Color_js__WEBPACK_IMPORTED_MODULE_0__.A((0,_cim_utils_js__WEBPACK_IMPORTED_MODULE_1__.e6)(r[0])):null}function u(e,t){if(!e)return;let s;s="CIMTextSymbol"===e.type?e.symbol:e;const a="CIMPolygonSymbol"===e.type;if(s?.symbolLayers)for(const i of s.symbolLayers)if(!(i.colorLocked||a&&((0,_cim_utils_js__WEBPACK_IMPORTED_MODULE_1__.mA)(i)||(0,_cim_utils_js__WEBPACK_IMPORTED_MODULE_1__.MM)(i)&&i.markerPlacement&&(0,_cim_utils_js__WEBPACK_IMPORTED_MODULE_1__.zr)(i.markerPlacement))))switch(i.type){case"CIMPictureMarker":case"CIMPictureStroke":case"CIMPictureFill":i.tintColor&&b(t,i.tintColor);break;case"CIMVectorMarker":i.markerGraphics?.forEach((e=>{u(e.symbol,t)}));break;case"CIMSolidStroke":case"CIMSolidFill":b(t,i.color);break;case"CIMHatchFill":u(i.lineSymbol,t)}}function b(e,t){for(const o of e)if(o.join(".")===t.join("."))return;e.push(t)}function I(o,r,s){r instanceof _Color_js__WEBPACK_IMPORTED_MODULE_0__.A||(r=new _Color_js__WEBPACK_IMPORTED_MODULE_0__.A(r));const n=(0,_cim_utils_js__WEBPACK_IMPORTED_MODULE_1__.lW)(o);n&&k(n,r,s)}function k(e,t,a){if(!e)return;let i;i="CIMTextSymbol"===e.type?e.symbol:e;const c="CIMPolygonSymbol"===i?.type;if(i?.symbolLayers)for(const f of i.symbolLayers){if(f.colorLocked)continue;if(c)if(a){const{layersToColor:e}=a;if(((0,_cim_utils_js__WEBPACK_IMPORTED_MODULE_1__.mA)(f)||(0,_cim_utils_js__WEBPACK_IMPORTED_MODULE_1__.MM)(f)&&f.markerPlacement&&(0,_cim_utils_js__WEBPACK_IMPORTED_MODULE_1__.zr)(f.markerPlacement))&&"fill"===e||(0,_cim_utils_js__WEBPACK_IMPORTED_MODULE_1__.jn)(f)&&"outline"===e)continue}else if((0,_cim_utils_js__WEBPACK_IMPORTED_MODULE_1__.mA)(f)||(0,_cim_utils_js__WEBPACK_IMPORTED_MODULE_1__.MM)(f)&&f.markerPlacement&&(0,_cim_utils_js__WEBPACK_IMPORTED_MODULE_1__.zr)(f.markerPlacement))continue;const e=t.toArray();switch(f.type){case"CIMPictureMarker":case"CIMPictureStroke":case"CIMPictureFill":f.tintColor=e;break;case"CIMVectorMarker":f.markerGraphics?.forEach((e=>{k(e.symbol,t,a)}));break;case"CIMSolidStroke":case"CIMSolidFill":f.color=e;break;case"CIMHatchFill":k(f.lineSymbol,t,a)}}}},"./node_modules/@arcgis/core/views/draw/DrawGraphicTool.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{N:()=>DrawGraphicTool_I,l:()=>M});var e,r,tslib_es6=__webpack_require__("./node_modules/@arcgis/core/chunks/tslib.es6.js"),Graphic=__webpack_require__("./node_modules/@arcgis/core/Graphic.js"),Accessor=__webpack_require__("./node_modules/@arcgis/core/core/Accessor.js"),Collection=__webpack_require__("./node_modules/@arcgis/core/core/Collection.js"),reactiveUtils=__webpack_require__("./node_modules/@arcgis/core/core/reactiveUtils.js"),property=__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/decorators/property.js"),subclass=(__webpack_require__("./node_modules/@arcgis/core/core/has.js"),__webpack_require__("./node_modules/@arcgis/core/core/Logger.js"),__webpack_require__("./node_modules/@arcgis/core/core/RandomLCG.js"),__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/decorators/subclass.js")),UpdatingHandles=__webpack_require__("./node_modules/@arcgis/core/core/support/UpdatingHandles.js");!function(e){e[e.NeverApplied=0]="NeverApplied",e[e.Applied=1]="Applied",e[e.Undone=2]="Undone"}(e||(e={})),function(r){r.UndoRedoUpdating="UndoRedoUpdating",r.UndoInvalidError="UndoInvalidError",r.RedoInvalidError="RedoInvalidError",r.ApplyInvalidError="ApplyInvalidError"}(r||(r={}));const o={[r.UndoRedoUpdating]:"Cannot perform operation whilst undo redo is updating",[r.UndoInvalidError]:"There are no items to Undo",[r.RedoInvalidError]:"There are no items to Redo",[r.ApplyInvalidError]:"Cannot apply an item that is already applied"};class d extends Error{constructor(){super(o[r.UndoRedoUpdating]),this.type="undo-redo-updating-error"}}class n extends Error{constructor(){super(o[r.UndoInvalidError]),this.type="undo-redo-undo-error"}}class UndoRedoError_e extends Error{constructor(){super(o[r.RedoInvalidError]),this.type="undo-redo-redo-error"}}class UndoRedoError_t extends Error{constructor(){super(o[r.ApplyInvalidError]),this.type="undo-redo-apply-error"}}var a;!function(t){t[t.Apply=0]="Apply",t[t.Undo=1]="Undo",t[t.Redo=2]="Redo"}(a||(a={}));let UndoableOperation_n=class extends Accessor.A{constructor(){super(...arguments),this.name="",this.tag=Symbol(),this.status=e.NeverApplied}get canUndo(){return this.status===e.Applied}get canRedo(){return this.status===e.Undone}async executeUndoRedoOperation(t){switch(t){case a.Apply:if(this.status!==e.NeverApplied)throw new UndoRedoError_t;return await this.apply(),void(this.status=e.Applied);case a.Undo:if(this.status!==e.Applied)throw new n;return await this.undo(),void(this.status=e.Undone);case a.Redo:if(this.status!==e.Undone)throw new n;return await this.redo(),void(this.status=e.Applied)}}};(0,tslib_es6._)([(0,property.MZ)()],UndoableOperation_n.prototype,"name",void 0),(0,tslib_es6._)([(0,property.MZ)()],UndoableOperation_n.prototype,"tag",void 0),UndoableOperation_n=(0,tslib_es6._)([(0,subclass.$)("esri.undoredo.UndoableOperation")],UndoableOperation_n);let u=class extends Accessor.A{constructor(){super(...arguments),this._stack=new Collection.A,this._stackPosition=-1,this._updatingHandles=new UpdatingHandles.U}get updating(){return this._updatingHandles.updating}get canUndo(){return this.hasUndo&&!this.updating}get hasUndo(){return this._stackPosition>=0}get canRedo(){return this.hasRedo&&!this.updating}get hasRedo(){return this._stackPosition<this._stack.length-1}_truncateForwardStack(){this._stack.splice(this._stackPosition+1,this._stack.length-this._stackPosition).forEach((t=>t.destroy()))}_drainStack(){this._stack.drain((t=>t.destroy())),this._stackPosition=-1}async undo(){if(!this.hasUndo)throw new n;if(this.updating)throw new d;const t=this._stack.getItemAt(this._stackPosition);t&&await this._updatingHandles.addPromise((async()=>{await t.executeUndoRedoOperation(a.Undo),--this._stackPosition,t.canRedo||this._truncateForwardStack()})())}async redo(){if(!this.hasRedo)throw new UndoRedoError_e;if(this.updating)throw new d;const t=this._stack.getItemAt(this._stackPosition+1);if(!t)throw new UndoRedoError_e;await this._updatingHandles.addPromise((async()=>{await t.executeUndoRedoOperation(a.Redo),++this._stackPosition})())}peekUndo(){if(this.canUndo)return this._stack.getItemAt(this._stackPosition)}peekRedo(){if(this.canRedo)return this._stack.getItemAt(this._stackPosition+1)}async inject(t){if(this.updating)throw new d;await this._updatingHandles.addPromise((async()=>{t.status===e.NeverApplied&&await t.executeUndoRedoOperation(a.Apply),t.canUndo?(this._stack.splice(this._stackPosition+1,0,t),this._stackPosition++):this._stackPosition>-1&&(this._stack.splice(0,this._stackPosition+1).forEach((t=>t.destroy())),this._stackPosition=-1)})())}async add(t){if(this.updating)throw new d;await this._updatingHandles.addPromise((async()=>{t.status===e.NeverApplied&&await t.executeUndoRedoOperation(a.Apply),this._stackPosition>=-1&&this._truncateForwardStack(),t.canUndo?(this._stack.push(t),this._stackPosition=this._stack.length-1):this._drainStack()})())}async removeTagged(t,s=!1){if(this.updating&&!s)return;await(0,reactiveUtils.C_)((()=>!this.updating));const a=new Collection.A;for(let i=0;i<this._stack.length;i++){const s=this._stack.getItemAt(i);s&&(s.tag===t?(s.destroy(),i===this._stackPosition&&(this._stackPosition=a.length-1)):a.push(s))}this._stack=a,this._stackPosition>a.length-1&&(this._stackPosition=a.length-1)}async clear(t=!1){if(this.updating&&!t)throw new d;await(0,reactiveUtils.C_)((()=>!this.updating)),this._drainStack()}};(0,tslib_es6._)([(0,property.MZ)()],u.prototype,"_stack",void 0),(0,tslib_es6._)([(0,property.MZ)()],u.prototype,"_stackPosition",void 0),(0,tslib_es6._)([(0,property.MZ)()],u.prototype,"updating",null),(0,tslib_es6._)([(0,property.MZ)({readOnly:!0})],u.prototype,"canUndo",null),(0,tslib_es6._)([(0,property.MZ)({readOnly:!0})],u.prototype,"hasUndo",null),(0,tslib_es6._)([(0,property.MZ)({readOnly:!0})],u.prototype,"canRedo",null),(0,tslib_es6._)([(0,property.MZ)({readOnly:!0})],u.prototype,"hasRedo",null),u=(0,tslib_es6._)([(0,subclass.$)("esri.UndoRedo")],u);var asyncUtils=__webpack_require__("./node_modules/@arcgis/core/core/asyncUtils.js"),Evented=__webpack_require__("./node_modules/@arcgis/core/core/Evented.js"),handleUtils=__webpack_require__("./node_modules/@arcgis/core/core/handleUtils.js"),maybe=__webpack_require__("./node_modules/@arcgis/core/core/maybe.js"),coordinateFormatter=__webpack_require__("./node_modules/@arcgis/core/geometry/coordinateFormatter.js"),GraphicsLayer=__webpack_require__("./node_modules/@arcgis/core/layers/GraphicsLayer.js"),dehydratedFeatureComparison=__webpack_require__("./node_modules/@arcgis/core/layers/graphics/dehydratedFeatureComparison.js");class CreateOperationGeometry_l{constructor(){this.committedVertices=null,this.cursorVertex=null,this.full=null,this.outline=null,this.cursorEdge=null,this.circle=null,this.rectangle=null}}var arrayUtils=__webpack_require__("./node_modules/@arcgis/core/core/arrayUtils.js"),lang=__webpack_require__("./node_modules/@arcgis/core/core/lang.js"),unitUtils=__webpack_require__("./node_modules/@arcgis/core/core/unitUtils.js"),vec32=__webpack_require__("./node_modules/@arcgis/core/chunks/vec32.js"),vec3f64=__webpack_require__("./node_modules/@arcgis/core/core/libs/gl-matrix-2/factories/vec3f64.js"),Circle=__webpack_require__("./node_modules/@arcgis/core/geometry/Circle.js"),geometryEngine=__webpack_require__("./node_modules/@arcgis/core/geometry/geometryEngine.js"),Multipoint=__webpack_require__("./node_modules/@arcgis/core/geometry/Multipoint.js"),Point=__webpack_require__("./node_modules/@arcgis/core/geometry/Point.js"),Polygon=__webpack_require__("./node_modules/@arcgis/core/geometry/Polygon.js"),Polyline=__webpack_require__("./node_modules/@arcgis/core/geometry/Polyline.js"),coordsUtils=__webpack_require__("./node_modules/@arcgis/core/geometry/support/coordsUtils.js"),spatialReferenceUtils=__webpack_require__("./node_modules/@arcgis/core/geometry/support/spatialReferenceUtils.js"),mat2d=__webpack_require__("./node_modules/@arcgis/core/core/libs/gl-matrix-2/math/mat2d.js"),mat2df64=__webpack_require__("./node_modules/@arcgis/core/core/libs/gl-matrix-2/factories/mat2df64.js"),quat=__webpack_require__("./node_modules/@arcgis/core/core/libs/gl-matrix-2/math/quat.js"),quatf64=__webpack_require__("./node_modules/@arcgis/core/core/libs/gl-matrix-2/factories/quatf64.js"),Axis=__webpack_require__("./node_modules/@arcgis/core/geometry/support/Axis.js");function w(t,r,e=null){return null!=e?[t,r,e]:[t,r]}function g(t,r,e=null){return null!=e?{x:t,y:r,z:e}:{x:t,y:r}}class R{constructor(t){this.spatialReference=t}mapToLocalMultiple(r){return r.map((t=>this.mapToLocal(t))).filter(arrayUtils.Ru)}get doUnnormalization(){return!1}}class W extends R{constructor(t,a,o=null){super(a),this._defaultZ=o,this.transform=(0,mat2df64.vt)(),this.transformInv=(0,mat2df64.vt)(),this.transform=(0,mat2df64.o8)(t),(0,mat2d.B8)(this.transformInv,this.transform)}makeMapPoint(t,r){return w(t,r,this._defaultZ)}mapToLocal(t){return g(this.transform[0]*t[0]+this.transform[2]*t[1]+this.transform[4],this.transform[1]*t[0]+this.transform[3]*t[1]+this.transform[5])}localToMap(t){return w(this.transformInv[0]*t.x+this.transformInv[2]*t.y+this.transformInv[4],this.transformInv[1]*t.x+this.transformInv[3]*t.y+this.transformInv[5],this._defaultZ)}}class v extends R{constructor(t,r){super(t.spatialReference),this.view=t,this.defaultZ=null,this.pWS=(0,vec3f64.vt)(),this.tangentFrameUpWS=(0,vec3f64.vt)(),this.tangentFrameRightWS=(0,vec3f64.vt)(),this.tangentFrameForwardWS=(0,vec3f64.vt)(),this.localFrameRightWS=(0,vec3f64.vt)(),this.localFrameUpWS=(0,vec3f64.vt)(),this.worldToLocalTransform=(0,quatf64.vt)(),this.localToWorldTransform=(0,quatf64.vt)(),this.scale=1,this.scale=t.resolution,this.referenceMapPoint=r,this.defaultZ=r.hasZ?r.z:null;const e=t.state.camera.viewRight;this.view.renderCoordsHelper.toRenderCoords(this.referenceMapPoint,this.pWS),this.view.renderCoordsHelper.worldBasisAtPosition(this.pWS,Axis._.X,this.tangentFrameRightWS),this.view.renderCoordsHelper.worldBasisAtPosition(this.pWS,Axis._.Y,this.tangentFrameUpWS),this.view.renderCoordsHelper.worldBasisAtPosition(this.pWS,Axis._.Z,this.tangentFrameForwardWS);const s=(0,vec3f64.vt)();(0,vec32.h)(s,this.tangentFrameForwardWS,(0,vec32.f)(e,this.tangentFrameForwardWS)),(0,vec32.d)(this.localFrameRightWS,e,s),(0,vec32.n)(this.localFrameRightWS,this.localFrameRightWS),(0,vec32.e)(this.localFrameUpWS,this.tangentFrameForwardWS,this.localFrameRightWS),(0,quat.Yc)(this.worldToLocalTransform,this.localFrameRightWS,this.tangentFrameRightWS),(0,quat.B8)(this.localToWorldTransform,this.worldToLocalTransform)}get doUnnormalization(){return"global"===this.view.viewingMode}makeMapPoint(t,r){return w(t,r,this.defaultZ)}mapToLocal(t){const r=(0,vec3f64.vt)();this.view.renderCoordsHelper.toRenderCoords(new Point.default({x:t[0],y:t[1],spatialReference:this.spatialReference}),r),(0,vec32.w)(r,r,this.worldToLocalTransform);const e=this.view.renderCoordsHelper.fromRenderCoords(r,new Point.default({spatialReference:this.view.spatialReference}));return null!=e?g(e.x/this.scale,e.y/this.scale):null}localToMap(t){const r=(0,vec3f64.vt)();this.view.renderCoordsHelper.toRenderCoords(new Point.default({x:t.x*this.scale,y:t.y*this.scale,spatialReference:this.spatialReference}),r),(0,vec32.w)(r,r,this.localToWorldTransform);const e=this.view.renderCoordsHelper.fromRenderCoords(r,new Point.default({spatialReference:this.view.spatialReference}));return null!=e?w(e.x,e.y,this.defaultZ):null}}function createUtils_g(t,e){const o=new Point.default({x:t[0],y:t[1],spatialReference:e});return t.length>2&&(o.z=t[2]),o}function createUtils_R(t,e,o){const n=new Polyline.A({paths:t,spatialReference:e});return o&&(0,coordsUtils._7)(n),n}function j(e,n,r,a=!0){const l=(0,lang.o8)(e);l.forEach((e=>{const o=e[0],n=e[e.length-1];(0,arrayUtils.aI)(o,n)&&1!==e.length||e.push(e[0])}));let i=new Polygon.A({rings:l,spatialReference:n});return i.rings.forEach((t=>{(0,coordsUtils.$3)(t)||t.reverse()})),r&&(0,coordsUtils._7)(i),a&&i.isSelfIntersecting&&(0,spatialReferenceUtils.fn)(n)&&(i=(0,geometryEngine.simplify)(i)),i}function T(t,o,n){const r=o.mapToLocalMultiple(t),a=[],l={x:r[0].x,y:r[0].y},s_x=r[1].x,s_y=r[1].y,i=Math.round(s_x-l.x),c=Math.round(s_y-l.y),y=Math.max(Math.abs(i),Math.abs(c));if(n){const t={x:l.x+y,y:l.y+y},e={x:l.x-y,y:l.y-y};a.push(g(t.x,e.y),g(e.x,e.y),g(e.x,t.y),g(t.x,t.y))}else{const t={x:i>0?l.x+y:l.x-y,y:c>0?l.y+y:l.y-y};a.push(g(l.x,l.y),g(t.x,l.y),g(t.x,t.y),g(l.x,t.y))}return U(j([a.map((t=>o.localToMap(t))).filter(arrayUtils.Ru)],o.spatialReference,o.doUnnormalization,!0),a,o)}function U(t,e,o){const n=P(e[3],e[2],o),r=P(e[1],e[2],o),a=P(e[0],e[1],o),l=P(e[0],e[3],o);return{geometry:t,midpoints:null!=n&&null!=r&&null!=a&&null!=l?{top:n,right:r,bottom:a,left:l}:null}}function P(t,e,o){createUtils_w[0]=t.x,createUtils_w[1]=t.y,createUtils_w[2]=0,I[0]=e.x,I[1]=e.y,I[2]=0,(0,vec32.m)(createUtils_w,createUtils_w,I,.5),z.x=createUtils_w[0],z.y=I[1],z.z=I[2];const n=o.localToMap(z);return null!=n?createUtils_g(n,o.spatialReference):null}const z=g(0,0,0),createUtils_w=(0,vec3f64.vt)(),I=(0,vec3f64.vt)();function L(t,e,o,r){const a=e.mapToLocalMultiple(t);let s=null,c=null;if(o)s=a[0],c=a[1];else{const t=a[0],e=a[1],o=Math.round(e.x-t.x),n=Math.round(e.y-t.y),r=Math.max(Math.abs(o),Math.abs(n));s=g(o>0?t.x+r/2:t.x-r/2,n>0?t.y+r/2:t.y-r/2),c=g(Math.abs(o)>Math.abs(n)?s.x-r/2:s.x,Math.abs(o)>Math.abs(n)?s.y:s.y-r/2)}const y=e.localToMap(s),p=e.localToMap(c);if(null==y||null==p)return null;e.doUnnormalization&&(0,coordsUtils.JM)([[y,p]],e.spatialReference);const u=createUtils_g(y,e.spatialReference),m=createUtils_g(p,e.spatialReference),f=(0,unitUtils.GA)(e.spatialReference);let d=0;if((0,spatialReferenceUtils.fn)(e.spatialReference))d=f*(0,geometryEngine.distance)(u,m,null);else{const t=s.x-c.x,e=s.y-c.y;d=f*Math.sqrt(t*t+e*e)*(r||1)}const R=new Circle.A({center:u,radius:d,radiusUnit:"meters",spatialReference:e.spatialReference});return{geometry:j(R.rings,R.spatialReference,!1),center:u,edge:m}}var quantityUtils=__webpack_require__("./node_modules/@arcgis/core/core/quantityUtils.js"),elevationInfoUtils=__webpack_require__("./node_modules/@arcgis/core/support/elevationInfoUtils.js");function helpMessageUtils_e(e,i,a){if(null==e)return"noTool";switch(e){case"point":return"point";case"multipoint":return"multipoint";case"polyline":return function helpMessageUtils_r(e,n){const r=null!=e&&"polyline"===e.type&&e.paths.length?e.paths[0].length:0;return"freehand"===n?r<2?"freehandStart":"freehandEnd":r<2?"polylineZeroVertices":"polylineOneVertex"}(i,a);case"polygon":return function t(e,n){const r=null!=e&&"polygon"===e.type&&e.rings.length?e.rings[0].length:0;if(r<3)switch(n){case"freehand":return"freehandStart";case"hybrid":return"polygonZeroVerticesHybrid";default:return"polygonZeroVertices"}else if(r<4)return"freehand"===n?"freehandEnd":"polygonOneVertex";return"polygonTwoVertices"}(i,a);case"rectangle":case"circle":return function l(e,n){if((null!=e&&"polygon"===e.type&&e.rings.length?e.rings[0].length:0)<3)switch(n){case"freehand":return"freehandStart";case"click":return"shapeStartClick";default:return"shapeStartHybrid"}switch(n){case"freehand":return"freehandEnd";case"click":return"shapeEndClick";default:return"shapeEndHybrid"}}(i,a);default:return}}const m=20,helpMessageUtils3d_a=1,c=.1,f=(0,vec3f64.vt)();var constraintUtils=__webpack_require__("./node_modules/@arcgis/core/views/interactive/sketch/constraintUtils.js"),tooltipCommonUtils=__webpack_require__("./node_modules/@arcgis/core/views/interactive/tooltip/tooltipCommonUtils.js"),SketchTooltipInfo=__webpack_require__("./node_modules/@arcgis/core/views/interactive/tooltip/infos/SketchTooltipInfo.js");let i=class extends SketchTooltipInfo.w{constructor(o){super(o),this.type="draw-circle",this.radius=null,this.xSize=null,this.ySize=null,this.area=quantityUtils.iT}get allFields(){return[]}};(0,tslib_es6._)([(0,property.MZ)()],i.prototype,"type",void 0),(0,tslib_es6._)([(0,property.MZ)()],i.prototype,"radius",void 0),(0,tslib_es6._)([(0,property.MZ)()],i.prototype,"xSize",void 0),(0,tslib_es6._)([(0,property.MZ)()],i.prototype,"ySize",void 0),(0,tslib_es6._)([(0,property.MZ)()],i.prototype,"area",void 0),(0,tslib_es6._)([(0,property.MZ)()],i.prototype,"helpMessage",void 0),(0,tslib_es6._)([(0,property.MZ)()],i.prototype,"allFields",null),i=(0,tslib_es6._)([(0,subclass.$)("esri.views.interactive.tooltip.infos.DrawCircleTooltipInfo")],i);var fields=__webpack_require__("./node_modules/@arcgis/core/views/interactive/tooltip/fields/fields.js"),TooltipInfoWithCoordinates=__webpack_require__("./node_modules/@arcgis/core/views/interactive/tooltip/infos/TooltipInfoWithCoordinates.js");let p=class extends((0,TooltipInfoWithCoordinates.B)(SketchTooltipInfo.w)){constructor(o){super(o),this.type="draw-mesh",this.orientation=(0,fields.LJ)({lockable:!1}),this.scale=(0,fields.dy)({lockable:!1})}get allFields(){return[this.longitude,this.latitude,this.x,this.y,this.elevation,this.orientation,this.scale]}};(0,tslib_es6._)([(0,property.MZ)()],p.prototype,"helpMessage",void 0),(0,tslib_es6._)([(0,property.MZ)()],p.prototype,"allFields",null),p=(0,tslib_es6._)([(0,subclass.$)("esri.views.interactive.tooltip.infos.DrawMeshTooltipInfo")],p);let DrawMultipointTooltipInfo_i=class extends((0,TooltipInfoWithCoordinates.B)(SketchTooltipInfo.w)){constructor(o){super(o),this.type="draw-multipoint"}get allFields(){return[this.longitude,this.latitude,this.x,this.y,this.elevation]}};(0,tslib_es6._)([(0,property.MZ)()],DrawMultipointTooltipInfo_i.prototype,"helpMessage",void 0),(0,tslib_es6._)([(0,property.MZ)()],DrawMultipointTooltipInfo_i.prototype,"allFields",null),DrawMultipointTooltipInfo_i=(0,tslib_es6._)([(0,subclass.$)("esri.views.interactive.tooltip.infos.DrawMultipointTooltipInfo")],DrawMultipointTooltipInfo_i);let DrawPointTooltipInfo_i=class extends((0,TooltipInfoWithCoordinates.B)(SketchTooltipInfo.w)){constructor(o){super(o),this.type="draw-point"}get allFields(){return[this.longitude,this.latitude,this.x,this.y,this.elevation]}};(0,tslib_es6._)([(0,property.MZ)()],DrawPointTooltipInfo_i.prototype,"helpMessage",void 0),(0,tslib_es6._)([(0,property.MZ)()],DrawPointTooltipInfo_i.prototype,"allFields",null),DrawPointTooltipInfo_i=(0,tslib_es6._)([(0,subclass.$)("esri.views.interactive.tooltip.infos.DrawPointTooltipInfo")],DrawPointTooltipInfo_i);let DrawPolygonTooltipInfo_c=class extends((0,TooltipInfoWithCoordinates.B)(SketchTooltipInfo.w)){constructor(o){super(o),this.type="draw-polygon",this.direction=(0,fields.Gk)(),this.distance=(0,fields.Ku)(),this.area=(0,fields.Am)(),this.xyMode="direction-distance"}get allFields(){return[this.direction,this.distance,this.longitude,this.latitude,this.x,this.y,this.elevation,this.area]}};(0,tslib_es6._)([(0,property.MZ)()],DrawPolygonTooltipInfo_c.prototype,"xyMode",void 0),(0,tslib_es6._)([(0,property.MZ)()],DrawPolygonTooltipInfo_c.prototype,"helpMessage",void 0),(0,tslib_es6._)([(0,property.MZ)()],DrawPolygonTooltipInfo_c.prototype,"allFields",null),DrawPolygonTooltipInfo_c=(0,tslib_es6._)([(0,subclass.$)("esri.views.interactive.tooltip.infos.DrawPolygonTooltipInfo")],DrawPolygonTooltipInfo_c);let DrawPolylineTooltipInfo_c=class extends((0,TooltipInfoWithCoordinates.B)(SketchTooltipInfo.w)){constructor(t){super(t),this.type="draw-polyline",this.direction=(0,fields.Gk)(),this.distance=(0,fields.Ku)(),this.totalLength=(0,fields.fr)(),this.xyMode="direction-distance"}get allFields(){return[this.direction,this.distance,this.longitude,this.latitude,this.x,this.y,this.elevation,this.totalLength]}};(0,tslib_es6._)([(0,property.MZ)()],DrawPolylineTooltipInfo_c.prototype,"helpMessage",void 0),(0,tslib_es6._)([(0,property.MZ)()],DrawPolylineTooltipInfo_c.prototype,"xyMode",void 0),(0,tslib_es6._)([(0,property.MZ)()],DrawPolylineTooltipInfo_c.prototype,"allFields",null),DrawPolylineTooltipInfo_c=(0,tslib_es6._)([(0,subclass.$)("esri.views.interactive.tooltip.infos.DrawPolylineTooltipInfo")],DrawPolylineTooltipInfo_c);let DrawRectangleTooltipInfo_p=class extends SketchTooltipInfo.w{constructor(o){super(o),this.type="draw-rectangle",this.xSize=quantityUtils.r7,this.ySize=quantityUtils.r7,this.area=quantityUtils.iT}get allFields(){return[]}};(0,tslib_es6._)([(0,property.MZ)()],DrawRectangleTooltipInfo_p.prototype,"type",void 0),(0,tslib_es6._)([(0,property.MZ)()],DrawRectangleTooltipInfo_p.prototype,"xSize",void 0),(0,tslib_es6._)([(0,property.MZ)()],DrawRectangleTooltipInfo_p.prototype,"ySize",void 0),(0,tslib_es6._)([(0,property.MZ)()],DrawRectangleTooltipInfo_p.prototype,"area",void 0),(0,tslib_es6._)([(0,property.MZ)()],DrawRectangleTooltipInfo_p.prototype,"helpMessage",void 0),(0,tslib_es6._)([(0,property.MZ)()],DrawRectangleTooltipInfo_p.prototype,"allFields",null),DrawRectangleTooltipInfo_p=(0,tslib_es6._)([(0,subclass.$)("esri.views.interactive.tooltip.infos.DrawRectangleTooltipInfo")],DrawRectangleTooltipInfo_p);var angularMeasurementUtils=__webpack_require__("./node_modules/@arcgis/core/views/support/angularMeasurementUtils.js"),automaticAreaMeasurementUtils=__webpack_require__("./node_modules/@arcgis/core/views/support/automaticAreaMeasurementUtils.js"),automaticLengthMeasurementUtils=__webpack_require__("./node_modules/@arcgis/core/views/support/automaticLengthMeasurementUtils.js"),euclideanLengthMeasurementUtils=__webpack_require__("./node_modules/@arcgis/core/views/support/euclideanLengthMeasurementUtils.js");function tooltipUtils_b(e){const{directionOptions:t,geometryType:o,sketchOptions:n,tooltipInfos:i}=e,r=t=>{const o=N(e).mode,n=i[t].elevation;"relative-to-ground"===o||"relative-to-scene"===o||"on-the-ground"===o?n.lock(tooltipUtils_W(e)):n.unlock()};switch(o){case"polygon":case"polyline":r(o),(e=>{if(t){const o=i[e].direction;o.committed=t.angle,o.unlockOnVertexPlacement=!1,n.values.directionMode=t.mode}})(o);break;case"point":case"mesh":r(o)}}function tooltipUtils_I(e,t){const{drawOperation:o,view:n}=t,i=V(t),r=N(t);if("2d"===n.type||!e||"absolute-height"!==r.mode||1!==o?.numCommittedVertices||!i||"draw-polyline"!==i.type&&"draw-polygon"!==i.type||i.elevation.locked)return;const[l,c,a]=e,s=function K(e,t,o,n,i){const{view:r,drawOperation:c}=i;if("3d"!==r.type||!c)return;o??=0;const a=Q(i),s=N(i),p=(0,elevationInfoUtils.Fo)(r,e,t,o,a,s,n);return(0,euclideanLengthMeasurementUtils.Qc)(p,a)??tooltipUtils_W(i)}(l,c,a,r,t);null!=s&&i.elevation.lock(s)}function tooltipUtils_U(e){V(e)?.allFields.forEach((e=>{e.unlockOnVertexPlacement&&e.unlock()}))}function V({geometryType:e,graphic:t,tooltipInfos:o}){return t?.geometry?.type!==tooltipUtils_P[e]?"circle"===e||"rectangle"===e?o[e]:null:o[e]}const tooltipUtils_P={point:"point",multipoint:"multipoint",mesh:"mesh",polyline:"polyline",polygon:"polygon",circle:"polygon",rectangle:"polygon",freehandPolygon:"polygon",freehandPolyline:"polyline"};function D(e,t){switch(e?.type){case"draw-point":!function G(e,t){const o=t.graphic?.geometry;"point"===o?.type&&(S(e,o,t),e.helpMessage=helpMessageUtils_e("point",o,t.drawOperation.drawingMode))}(e,t);break;case"draw-multipoint":!function tooltipUtils_L(e,t){const o=t.graphic?.geometry;"multipoint"===o?.type&&(S(e,o,t),e.helpMessage=helpMessageUtils_e("multipoint",o,t.drawOperation.drawingMode))}(e,t);break;case"draw-polyline":!function Z(t,o){const{createOperationGeometry:n,drawOperation:i}=o,r=null!=n?n.full:null;r&&"polyline"!==r.type||(tooltipUtils_F(t,o),t.totalLength.actual=i.lastVertex?(r?(0,automaticLengthMeasurementUtils.ob)(r):null)??quantityUtils.r7:null,t.helpMessage=helpMessageUtils_e("polyline",r,o.drawOperation.drawingMode))}(e,t);break;case"draw-polygon":!function C(e,o){const{createOperationGeometry:n,drawOperation:i}=o,r=null!=n?n.full:null;r&&"polygon"!==r.type||(tooltipUtils_F(e,o),e.area.actual=i.lastVertex?(r?(0,automaticAreaMeasurementUtils.n)(r):null)??quantityUtils.iT:null,e.helpMessage=helpMessageUtils_e("polygon",r,o.drawOperation.drawingMode))}(e,t);break;case"draw-rectangle":!function H(e,t){e.sketchOptions=t.sketchOptions,e.xSize=X(t),e.ySize=Y(t),e.area=E(t),e.helpMessage=helpMessageUtils_e("rectangle",t.graphic?.geometry,t.drawOperation.drawingMode)}(e,t);break;case"draw-circle":!function tooltipUtils_R(e,t){const{forceUniformSize:o,sketchOptions:n}=t;e.sketchOptions=n,e.radius=o?function B({createOperationGeometry:t}){return(null!=t?.circle?.center&&null!=t.circle.edge?(0,automaticLengthMeasurementUtils.Kt)(t.circle.center,t.circle.edge):null)??quantityUtils.r7}(t):null,e.xSize=o?null:X(t),e.ySize=o?null:Y(t),e.area=E(t),e.helpMessage=helpMessageUtils_e("circle",t.graphic?.geometry,t.drawOperation.drawingMode)}(e,t);break;case"draw-mesh":!function tooltipUtils_z(e,t){const{graphic:o,view:n}=t,i=o?.geometry;"3d"!==n.type||i&&"mesh"!==i.type||(S(e,i?.origin,t),i&&(0,tooltipCommonUtils.Ue)(e,i),e.helpMessage=function helpMessageUtils3d_i(o,i){const l=o?.geometry;if(!o||"mesh"!==l?.type||!i)return;const{renderCoordsHelper:p,elevationProvider:u}=i,{camera:h}=i.state,{extent:d}=l,{center:x,spatialReference:g}=d,v=(0,unitUtils.GA)(g),j=(0,unitUtils.G9)(g),z=(0,unitUtils.GA)(p.spatialReference),y=d.width*v,C=d.height*j,R=(d.zmax??0)*j,U=R-(d.zmin??0)*j,b=Math.max(y,C,U)/z,{x:w,y:P}=x,S=x.z??0;(0,vec32.i)(f,w,P,S),p.toRenderCoords(f,g,f);const T=b/h.computeScreenPixelSizeAt(f);if(T>h.width*helpMessageUtils3d_a)return"meshTooClose";if(T<m)return"meshTooFar";const k=(0,elevationInfoUtils.bh)(o),{absoluteZ:A}=(0,elevationInfoUtils.Q5)(w,P,R,g,i,k);return A<(u.getElevation(w,P,S,g,"ground")??0)*j+U*c?"meshUnderground":"mesh"}(o,n))}(e,t)}}function S(e,t,o){const{drawOperation:n,view:i,sketchOptions:r}=o,{cursorVertex:l}=n;e.sketchOptions=r,e.viewType=i.type;const c="multipoint"===t?.type?t.getPoint(t.points.length-1):t;if(e.setLocationFromPoint(c,Q(o)),q(e.elevation,o),!l)return void(n.constraints=void 0);const a=l;n.constraints={context:$(a,o),x:e.x.committed,y:e.y.committed,longitude:e.longitude.committed,latitude:e.latitude.committed,elevation:e.elevation.committed,distance:null,direction:null}}function tooltipUtils_F(t,n){const{drawOperation:i,sketchOptions:r,view:l}=n,{cursorVertex:c,lastVertex:a,secondToLastVertex:s}=i,p=r.values.effectiveDirectionMode;t.sketchOptions=r,t.viewType=l.type;const u=a&&c?(0,automaticLengthMeasurementUtils.Kt)(a,c)??quantityUtils.r7:null;if(t.distance.actual=u,t.distance.readOnly=null==a,t.direction.actual=null,t.direction.readOnly=!0,a&&c&&("absolute"===p||s)){const e=(0,angularMeasurementUtils.uR)(s,a,c,p);t.direction.actual=e??quantityUtils.n0,t.direction.readOnly=!1}t.setLocationFromPoint(c,Q(n)),q(t.elevation,n);const d=function A(e,{sketchOptions:t}){const o=t.tooltips.xyMode;return"auto"===o?e?"direction-distance":"coordinates":o}(a,n);t.xyMode=d,t.direction.visible="direction-distance"===d,t.distance.visible="direction-distance"===d,t.effectiveX.visible="coordinates"===d,t.effectiveY.visible="coordinates"===d;const m=c??a;i.constraints=m?{context:$(m,n),x:t.x.committed,y:t.y.committed,longitude:t.longitude.committed,latitude:t.latitude.committed,elevation:t.elevation.committed,distance:t.distance.committed,direction:t.direction.committed}:void 0}function q(e,t){const{drawOperation:o}=t,n=o?.cursorVertex??o?.lastVertex;e.actual=(0,euclideanLengthMeasurementUtils.Of)(n)??tooltipUtils_W(t),e.visible=o.hasZ,e.readOnly=!1,e.showAsZ=!0}function E(e){const o=e.createOperationGeometry?.full;return"polygon"!==o?.type?quantityUtils.iT:(0,automaticAreaMeasurementUtils.n)(o)??quantityUtils.iT}function X(t){const o=t.createOperationGeometry?.rectangle?.midpoints;return(null!=o?(0,automaticLengthMeasurementUtils.Kt)(o.left,o.right):null)??quantityUtils.r7}function Y(t){const o=t.createOperationGeometry?.rectangle?.midpoints;return(null!=o?(0,automaticLengthMeasurementUtils.Kt)(o.top,o.bottom):null)??quantityUtils.r7}function N(e){return e.drawOperation.elevationInfo??elevationInfoUtils.qt}function Q(e){return e.drawOperation.coordinateHelper.spatialReference}function tooltipUtils_W(e){const t=(0,unitUtils.G9)(Q(e));return(0,quantityUtils.d_)(e.defaultZ*t,"meters")}function $(e,t){return(0,constraintUtils.hj)(e,t.view,Q(t),N(t),t.drawOperation.coordinateHelper.hasZ(),t.sketchOptions.values.effectiveDirectionMode)}var InteractiveToolBase=__webpack_require__("./node_modules/@arcgis/core/views/interactive/InteractiveToolBase.js"),SketchOptions=__webpack_require__("./node_modules/@arcgis/core/views/interactive/sketch/SketchOptions.js"),trackingUtils=__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/trackingUtils.js");let DrawGraphicTool_I=class extends(Evented.A.EventedMixin(InteractiveToolBase.g)){constructor(t){super(t),this._graphic=null,this._coordinateFormatterLoadTask=null,this._createOperationGeometry=null,this.defaultZ=0,this.directionOptions=null,this.elevationLockOnVertexAddDisabled=!1,this.geometryType=null,this.hasZ=!0,this.geometryToPlace=null,this.snappingManager=null,this.snapToScene=!1,this.sketchOptions=new SketchOptions.A}initialize(){const{view:t}=this;this.internalGraphicsLayer=new GraphicsLayer.default({listMode:"hide",internal:!0}),this.view.map.layers.add(this.internalGraphicsLayer);const e=this.drawOperation=this.makeDrawOperation();this.tooltipInfos=function tooltipUtils_T(e,t){return{point:new DrawPointTooltipInfo_i({sketchOptions:t,viewType:e}),multipoint:new DrawMultipointTooltipInfo_i({sketchOptions:t,viewType:e}),polyline:new DrawPolylineTooltipInfo_c({sketchOptions:t,viewType:e}),polygon:new DrawPolygonTooltipInfo_c({sketchOptions:t,viewType:e}),mesh:new p({sketchOptions:t,viewType:e}),rectangle:new DrawRectangleTooltipInfo_p({sketchOptions:t}),circle:new i({sketchOptions:t})}}(t.type,this.sketchOptions);const o=(0,tooltipCommonUtils.A)((()=>({view:t,options:this.sketchOptions.tooltips})));this.tooltip=o,tooltipUtils_b(this._tooltipsContext),this._coordinateFormatterLoadTask=(0,asyncUtils.UT)((()=>(0,coordinateFormatter.Hh)())),this.addHandles([e.on("vertex-add",(t=>this.onVertexAdd(t))),e.on("vertex-remove",(t=>this.onVertexRemove(t))),e.on("vertex-update",(t=>this.onVertexUpdate(t))),e.on("cursor-update",(t=>this.onCursorUpdate(t))),e.on("cursor-remove",(()=>this._updateGraphic())),e.on("complete",(t=>this.onComplete(t))),this._coordinateFormatterLoadTask,o.on("paste",(t=>(0,tooltipCommonUtils.HA)(t,this.activeTooltipInfo))),(0,reactiveUtils.watch)((()=>this.cursor),(t=>{e.cursor=t}),reactiveUtils.pc),(0,trackingUtils.fm)((()=>{const{activeTooltipInfo:t,sketchOptions:e}=this;D(t,this._tooltipsContext),o.info=e.tooltips.effectiveEnabled?t:null})),(0,trackingUtils.fm)((()=>{e.constraintZ=function J(e){const{geometryType:t,tooltipInfos:o}=e;switch(t){case"point":case"multipoint":case"mesh":case"polyline":case"polygon":{const i=o[t].elevation.committed;if(!i)return;return(0,quantityUtils.l3)(i,"meters")/(0,unitUtils.G9)(Q(e))}default:return}}(this._tooltipsContext)}),reactiveUtils.OH)]),this.finishToolCreation()}destroy(){this.drawOperation=(0,maybe.pR)(this.drawOperation),this.tooltip=(0,maybe.pR)(this.tooltip),this._destroyAllVisualizations(),this.view.map.remove(this.internalGraphicsLayer),this.internalGraphicsLayer=(0,maybe.pR)(this.internalGraphicsLayer),this._set("view",null)}get _drawSpatialReference(){return this.drawOperation.coordinateHelper.spatialReference}get _tooltipsContext(){return{createOperationGeometry:this._createOperationGeometry,defaultZ:this.defaultZ,directionOptions:this.directionOptions,drawOperation:this.drawOperation,forceUniformSize:this.forceUniformSize,geometryType:this.geometryType,graphic:this.graphic,sketchOptions:this.sketchOptions,tooltipInfos:this.tooltipInfos,view:this.view}}get canRedo(){return this.drawOperation.canRedo}get canUndo(){return this.drawOperation.canUndo}set centered(t){this._set("centered",t),this._updateGraphic()}get cursor(){return this._get("cursor")}set cursor(t){this._set("cursor",t)}set enabled(t){this.drawOperation.interactive=t,this._set("enabled",t)}set forceUniformSize(t){this._set("forceUniformSize",t),this._updateGraphic()}get graphic(){return this._graphic}set graphicSymbol(t){this._set("graphicSymbol",t),null!=this._graphic&&(this._graphic.symbol=t)}set mode(t){const e=this.drawOperation;e&&(e.drawingMode=t),this._set("mode",t)}get updating(){return this.drawOperation?.updating??!1}get undoRedo(){const{view:{type:t,map:e}}=this;return"2d"===t&&e&&"undoRedo"in e&&e.undoRedo instanceof u?e.undoRedo:null}set undoRedo(t){this._override("undoRedo",t)}completeCreateOperation(){this.drawOperation.complete()}onInputEvent(t){this.destroyed||(0,tooltipCommonUtils.wG)(t,this.tooltip)||this.drawOperation.onInputEvent(t)}redo(){this.drawOperation.redo()}reset(){}undo(){this.drawOperation.undo(),0===this.drawOperation.numCommittedVertices&&tooltipUtils_b(this._tooltipsContext)}_destroyAllVisualizations(){this.removeHandles(DrawGraphicTool_F.outline),this.removeHandles(DrawGraphicTool_F.regularVertices),this.removeHandles(DrawGraphicTool_F.activeVertex),this.removeHandles(DrawGraphicTool_F.activeEdge),this.removeHandles(DrawGraphicTool_A)}_createOrUpdateGraphic(t){if(null!=this._graphic)return this.updateGraphicGeometry(t),this._graphic;const o=new Graphic.default({...this.graphicProperties,symbol:this.graphicSymbol});return this._graphic=o,this.updateGraphicGeometry(t),this.internalGraphicsLayer.add(o),this.addHandles(this.initializeGraphic(o)),this.notifyChange("graphic"),this.addHandles((0,handleUtils.hA)((()=>{this.internalGraphicsLayer.remove(o),this._graphic===o&&(this._graphic=null)})),DrawGraphicTool_A),o}updateGraphicGeometry(t){this._graphic.geometry=t}_getCreateOperationGeometry(t={operationComplete:!1}){if(null==this.drawOperation)return;const{coordinateHelper:e,view:o,visualizationCursorVertex:r,lastVertex:i,committedVertices:s,geometryIncludingUncommittedVertices:n,numCommittedVertices:a}=this.drawOperation;if(!(a>0||null!=r))return;const l=t.operationComplete?s:n,p=l.length,c=null!=r?e.pointToArray(r):null,h=this._drawSpatialReference,d="3d"===o.type&&"global"===o.viewingMode,u=new CreateOperationGeometry_l;u.committedVertices=s,u.cursorVertex=c;const{geometryType:x}=this;switch(x){case"point":case"mesh":u.full=e.arrayToPoint(l[0]);break;case"multipoint":u.full=p>0?function createUtils_d(t,e){return new Multipoint.A({points:t,spatialReference:e})}(l,h):null;break;case"polyline":case"polygon":p>0&&(u.full="polygon"===x?j([l],h,d,!0):createUtils_R([l],h,d),u.cursorEdge=null!=c&&i&&!(0,dehydratedFeatureComparison.CI)(r,i)?createUtils_R([[c,e.pointToArray(i)]],h,d):null,u.outline=p>1?u.full:null);break;case"circle":case"rectangle":{if(u.committedVertices=u.cursorVertex=null,!p)break;const e=function F(t,r){if("2d"===t.type)return new W(t.state.transform,t.spatialReference,r.length>2?r[2]:null);if("3d"===t.type){const e=r.length>2?new Point.default({x:r[0],y:r[1],z:r[2],spatialReference:t.spatialReference}):new Point.default({x:r[0],y:r[1],spatialReference:t.spatialReference});return new v(t,e)}return null}(o,l[0]),r=l[0],i=e.makeMapPoint(r[0]+DrawGraphicTool_Z*o.resolution,r[1]);"circle"===x?1===p&&t.operationComplete?u.circle=L([r,i],e,!0):2===p&&(this.forceUniformSize?u.circle=L(l,e,this.centered):u.rectangle=function createUtils_v(t,o,n){const r=o.mapToLocalMultiple(t),a=r[0],l=r[1],s=Math.round(l.x-a.x),i=Math.round(l.y-a.y),c=g(n?a.x:a.x+s/2,n?a.y:a.y+i/2),y=n?s:s/2,p=n?i:i/2,m=[],f=2*Math.PI/60;function x(t){const e=Math.cos(t),o=Math.sin(t);return g(y*e+c.x,p*o+c.y)}for(let e=0;e<60;e++)m.push(x(e*f));m.push(m[0]);const{spatialReference:h,doUnnormalization:d}=o,R=j([m.map((t=>o.localToMap(t))).filter(arrayUtils.Ru)],h,d,!1),T=o.localToMap(x(Math.PI/2)),b=o.localToMap(x(0)),U=o.localToMap(x(-Math.PI/2)),P=o.localToMap(x(Math.PI));return{geometry:R,midpoints:null!=T&&null!=b&&null!=U&&null!=P?{top:createUtils_g(T,h),right:createUtils_g(b,h),bottom:createUtils_g(U,h),left:createUtils_g(P,h)}:null}}(l,e,this.centered)):1===p&&t.operationComplete?u.rectangle=T([r,i],e,!0):2===p&&(u.rectangle=this.forceUniformSize?T(l,e,this.centered):function b(t,o,n){let r=o.mapToLocalMultiple(t);if(1===r.length){const t=48,e=r[0];r=[g(e.x-t,e.y+t),g(e.x+t,e.y-t),g(e.x+t,e.y-t),g(e.x-t,e.y+t)]}const a=[],l={x:r[0].x,y:r[0].y},s={x:r[1].x,y:r[1].y};if(n){const t=Math.round(s.x-l.x),e=Math.round(s.y-l.y);a.push(g(l.x-t,l.y-e),g(s.x,l.y-e),g(s.x,s.y),g(l.x-t,s.y))}else a.push(g(l.x,l.y),g(s.x,l.y),g(s.x,s.y),g(l.x,s.y));return U(j([a.map((t=>o.localToMap(t))).filter(arrayUtils.Ru)],o.spatialReference,o.doUnnormalization,!0),a,o)}(l,e,this.centered)),u.full=null!=u.circle?u.circle.geometry:u.rectangle?.geometry,u.outline="polygon"===u.full?.type?u.full:null;break}default:return null}return u}initializeGraphic(t){return(0,handleUtils.hA)()}onComplete(t){if(!this.drawOperation)return;this._updateGraphic();let e=null;if(this.drawOperation.isCompleted){const t=this._getCreateOperationGeometry({operationComplete:!0});null!=t&&(e=this._createOrUpdateGraphic(t.full))}this._createOperationGeometry=null,this.emit("complete",{graphic:e,...t})}onCursorUpdate(t){this._updateGraphic(),this.emit("cursor-update",t)}onDeactivate(){const{drawOperation:t}=this;t&&(t.isCompleted||t.cancel())}onOutlineChanged(t){return(0,handleUtils.hA)()}onCursorEdgeChanged(t){return(0,handleUtils.hA)()}onVertexAdd(t){tooltipUtils_U(this._tooltipsContext),this._updateGraphic(),this.elevationLockOnVertexAddDisabled||tooltipUtils_I(t.vertices.at(0)?.coordinates,this._tooltipsContext),this.emit("vertex-add",t)}onVertexRemove(t){tooltipUtils_U(this._tooltipsContext),this._updateGraphic(),this.emit("vertex-remove",t)}onVertexUpdate(t){this._updateGraphic(),this.emit("vertex-update",t)}_updateGraphic(){const t=this._getCreateOperationGeometry();this._createOperationGeometry=t,null!=t?(null!=t.cursorEdge?this.addHandles(this.onCursorEdgeChanged(t.cursorEdge),DrawGraphicTool_F.activeEdge):this.removeHandles(DrawGraphicTool_F.activeEdge),null!=t.outline?this.addHandles(this.onOutlineChanged(t.outline),DrawGraphicTool_F.outline):this.removeHandles(DrawGraphicTool_F.outline),null!=t.committedVertices?this.addHandles(this.onRegularVerticesChanged(t.committedVertices),DrawGraphicTool_F.regularVertices):this.removeHandles(DrawGraphicTool_F.regularVertices),null!=t.cursorVertex?this.addHandles(this.onActiveVertexChanged(t.cursorVertex),DrawGraphicTool_F.activeVertex):this.removeHandles(DrawGraphicTool_F.activeVertex),null!=t.full?this._createOrUpdateGraphic(t.full):this.removeHandles(DrawGraphicTool_A)):this._destroyAllVisualizations()}get activeTooltipInfo(){return this._coordinateFormatterLoadTask?.finished?V(this._tooltipsContext):null}};(0,tslib_es6._)([(0,property.MZ)()],DrawGraphicTool_I.prototype,"_coordinateFormatterLoadTask",void 0),(0,tslib_es6._)([(0,property.MZ)()],DrawGraphicTool_I.prototype,"_createOperationGeometry",void 0),(0,tslib_es6._)([(0,property.MZ)()],DrawGraphicTool_I.prototype,"_tooltipsContext",null),(0,tslib_es6._)([(0,property.MZ)({value:!0})],DrawGraphicTool_I.prototype,"centered",null),(0,tslib_es6._)([(0,property.MZ)()],DrawGraphicTool_I.prototype,"cursor",null),(0,tslib_es6._)([(0,property.MZ)({nonNullable:!0})],DrawGraphicTool_I.prototype,"defaultZ",void 0),(0,tslib_es6._)([(0,property.MZ)({constructOnly:!0})],DrawGraphicTool_I.prototype,"directionOptions",void 0),(0,tslib_es6._)([(0,property.MZ)()],DrawGraphicTool_I.prototype,"drawOperation",void 0),(0,tslib_es6._)([(0,property.MZ)()],DrawGraphicTool_I.prototype,"elevationLockOnVertexAddDisabled",void 0),(0,tslib_es6._)([(0,property.MZ)({value:!0})],DrawGraphicTool_I.prototype,"enabled",null),(0,tslib_es6._)([(0,property.MZ)({value:!0})],DrawGraphicTool_I.prototype,"forceUniformSize",null),(0,tslib_es6._)([(0,property.MZ)({constructOnly:!0})],DrawGraphicTool_I.prototype,"geometryType",void 0),(0,tslib_es6._)([(0,property.MZ)()],DrawGraphicTool_I.prototype,"graphic",null),(0,tslib_es6._)([(0,property.MZ)({constructOnly:!0})],DrawGraphicTool_I.prototype,"graphicProperties",void 0),(0,tslib_es6._)([(0,property.MZ)()],DrawGraphicTool_I.prototype,"graphicSymbol",null),(0,tslib_es6._)([(0,property.MZ)({constructOnly:!0})],DrawGraphicTool_I.prototype,"hasZ",void 0),(0,tslib_es6._)([(0,property.MZ)({constructOnly:!0})],DrawGraphicTool_I.prototype,"geometryToPlace",void 0),(0,tslib_es6._)([(0,property.MZ)()],DrawGraphicTool_I.prototype,"mode",null),(0,tslib_es6._)([(0,property.MZ)()],DrawGraphicTool_I.prototype,"snappingManager",void 0),(0,tslib_es6._)([(0,property.MZ)()],DrawGraphicTool_I.prototype,"snapToScene",void 0),(0,tslib_es6._)([(0,property.MZ)()],DrawGraphicTool_I.prototype,"tooltip",void 0),(0,tslib_es6._)([(0,property.MZ)()],DrawGraphicTool_I.prototype,"tooltipInfos",void 0),(0,tslib_es6._)([(0,property.MZ)({constructOnly:!0,type:SketchOptions.A})],DrawGraphicTool_I.prototype,"sketchOptions",void 0),(0,tslib_es6._)([(0,property.MZ)()],DrawGraphicTool_I.prototype,"updating",null),(0,tslib_es6._)([(0,property.MZ)({constructOnly:!0,nonNullable:!0})],DrawGraphicTool_I.prototype,"view",void 0),(0,tslib_es6._)([(0,property.MZ)({constructOnly:!0})],DrawGraphicTool_I.prototype,"undoRedo",null),(0,tslib_es6._)([(0,property.MZ)()],DrawGraphicTool_I.prototype,"activeTooltipInfo",null),DrawGraphicTool_I=(0,tslib_es6._)([(0,subclass.$)("esri.views.draw.DrawGraphicTool")],DrawGraphicTool_I);const DrawGraphicTool_A=Symbol("create-operation-graphic"),DrawGraphicTool_F={outline:Symbol("outline-visual"),regularVertices:Symbol("regular-vertices-visual"),activeVertex:Symbol("active-vertex-visual"),activeEdge:Symbol("active-edge-visual")};function M(t){switch(t){case"point":case"polyline":case"polygon":case"multipoint":return t;case"circle":case"rectangle":return"segment";case"mesh":return"point"}}const DrawGraphicTool_Z=48},"./node_modules/@arcgis/core/views/draw/DrawOperation.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{O0:()=>F});var tslib_es6=__webpack_require__("./node_modules/@arcgis/core/chunks/tslib.es6.js"),Accessor=__webpack_require__("./node_modules/@arcgis/core/core/Accessor.js"),Evented=__webpack_require__("./node_modules/@arcgis/core/core/Evented.js"),lang=__webpack_require__("./node_modules/@arcgis/core/core/lang.js"),maybe=__webpack_require__("./node_modules/@arcgis/core/core/maybe.js"),memoize=__webpack_require__("./node_modules/@arcgis/core/core/memoize.js"),promiseUtils=__webpack_require__("./node_modules/@arcgis/core/core/promiseUtils.js"),ReactiveSet=__webpack_require__("./node_modules/@arcgis/core/core/ReactiveSet.js"),reactiveUtils=__webpack_require__("./node_modules/@arcgis/core/core/reactiveUtils.js"),screenUtils=__webpack_require__("./node_modules/@arcgis/core/core/screenUtils.js"),property=__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/decorators/property.js"),subclass=(__webpack_require__("./node_modules/@arcgis/core/core/has.js"),__webpack_require__("./node_modules/@arcgis/core/core/Logger.js"),__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/decorators/subclass.js")),diffUtils=__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/diffUtils.js"),UpdatingHandles=__webpack_require__("./node_modules/@arcgis/core/core/support/UpdatingHandles.js"),dehydratedFeatureComparison=__webpack_require__("./node_modules/@arcgis/core/layers/graphics/dehydratedFeatureComparison.js"),elevationInfoUtils=__webpack_require__("./node_modules/@arcgis/core/support/elevationInfoUtils.js"),ViewingMode=__webpack_require__("./node_modules/@arcgis/core/views/ViewingMode.js");const e="click";class DrawManipulator_t{constructor({consumesClicks:t,grabbableForEvent:s}){this.events=new Evented.A,this.interactive=!0,this.selectable=!1,this.cursor=null,this.grabbable=!0,this.consumesClicks=t,this.grabbableForEvent=s}destroy(){}intersectionDistance(e,t){return 0}attach(){}detach(){}onElevationChange(){}onViewChange(){}}var coordinateHelper=__webpack_require__("./node_modules/@arcgis/core/views/interactive/coordinateHelper.js"),dragEventPipeline=__webpack_require__("./node_modules/@arcgis/core/views/interactive/dragEventPipeline.js"),EditGeometry=__webpack_require__("./node_modules/@arcgis/core/views/interactive/editGeometry/EditGeometry.js"),EditGeometryOperations=__webpack_require__("./node_modules/@arcgis/core/views/interactive/editGeometry/EditGeometryOperations.js"),constraints=__webpack_require__("./node_modules/@arcgis/core/views/interactive/sketch/constraints.js"),constraintUtils=__webpack_require__("./node_modules/@arcgis/core/views/interactive/sketch/constraintUtils.js"),SketchLabelOptions=__webpack_require__("./node_modules/@arcgis/core/views/interactive/sketch/SketchLabelOptions.js"),SnappingContext=__webpack_require__("./node_modules/@arcgis/core/views/interactive/snapping/SnappingContext.js"),SnappingDragPipelineStep=__webpack_require__("./node_modules/@arcgis/core/views/interactive/snapping/SnappingDragPipelineStep.js"),Scheduler=(__webpack_require__("./node_modules/@arcgis/core/core/RandomLCG.js"),__webpack_require__("./node_modules/@arcgis/core/views/support/Scheduler.js"));let SnappingOperation_p=class extends Accessor.A{constructor(t){super(t),this.constrainResult=t=>t,this._snapPoints=null,this._frameTask=null,this._abortController=null,this._stagedPoint=null,this._snap=(0,promiseUtils.sg)((async(t,s,o,n)=>{const i=this._frameTask;if(null==i)return;const r=await i.schedule((()=>s.snap({...t,context:o,signal:n})),n);r.valid&&await i.schedule((()=>{this.stagedPoint=r.apply(),t!==this._snapPoints&&null!=this._snapPoints&&(this.stagedPoint=s.update({...this._snapPoints,context:o}))}),n)}))}get stagedPoint(){return this._stagedPoint}set stagedPoint(t){this._stagedPoint=this.constrainResult(t)}initialize(){const t="3d"===this.view.type?this.view?.resourceController?.scheduler:null;this._frameTask=null!=t?t.registerTask(Scheduler.W6.SNAPPING):Scheduler.nu}destroy(){this._abortController=(0,maybe.DC)(this._abortController),this._frameTask=(0,maybe.xt)(this._frameTask)}update(t,s,o){this._snapPoints=t;const{point:n,scenePoint:i}=t,r=s.update({point:n,scenePoint:i,context:o});return this.stagedPoint=r,r}async snap(t,s,o){const{point:n,scenePoint:i}=t;return this.stagedPoint=s.update({point:n,scenePoint:i,context:o}),this._snapPoints=t,null==this._abortController&&(this._abortController=new AbortController),this._snap(t,s,o,this._abortController.signal)}async snapAgainNearPreviousMapPoint(t,s){null!=this._snapPoints&&await this.snap(this._snapPoints,t,s)}abort(){this._abortController=(0,maybe.DC)(this._abortController),this._snapPoints=null}};(0,tslib_es6._)([(0,property.MZ)({constructOnly:!0})],SnappingOperation_p.prototype,"view",void 0),(0,tslib_es6._)([(0,property.MZ)()],SnappingOperation_p.prototype,"stagedPoint",null),(0,tslib_es6._)([(0,property.MZ)()],SnappingOperation_p.prototype,"constrainResult",void 0),(0,tslib_es6._)([(0,property.MZ)()],SnappingOperation_p.prototype,"_stagedPoint",void 0),SnappingOperation_p=(0,tslib_es6._)([(0,subclass.$)("esri.views.interactive.snapping.SnappingOperation")],SnappingOperation_p);var snappingUtils=__webpack_require__("./node_modules/@arcgis/core/views/interactive/snapping/snappingUtils.js");const U=Symbol(),z=Symbol();let F=class extends(Evented.A.EventedMixin(Accessor.A)){constructor(t){super(t),this._createOperationCompleted=!1,this._hideDefaultCursor=!1,this._pointerDownStates=new ReactiveSet.A,this._stagedScreenPoint=null,this._stagedPointerType=null,this._updatingHandles=new UpdatingHandles.U,this._stagedPointerId=null,this.constraintsEnabled=!1,this.constraints=void 0,this._getPointConstraint=(0,memoize.B)(constraintUtils.cx),this._getPolylineOrPolygonConstraint=(0,memoize.B)(constraintUtils.lJ),this.constraintZ=null,this.defaultZ=null,this.isDraped=!0,this.labelOptions=new SketchLabelOptions.A,this.cursor=null,this.loading=!1,this.snapToSceneEnabled=null,this.firstVertex=null,this.lastVertex=null,this.secondToLastVertex=null,null==t.elevationInfo&&(this.elevationInfo=(0,elevationInfoUtils.bK)(!!t.hasZ))}initialize(){const{geometryType:t,view:e}=this,i=e.spatialReference,n="viewingMode"in e.state?e.state.viewingMode:ViewingMode.RT.Local,o="segment"===t||"multipoint"===t?"polyline":t;this.coordinateHelper=(0,coordinateHelper.BV)(this.hasZ,this.hasM,i),this._editGeometryOperations=new EditGeometryOperations.p(new EditGeometry.ZE(o,this.coordinateHelper),n),this._snappingOperation=new SnappingOperation_p({view:e}),this.addHandles([(0,reactiveUtils.watch)((()=>({stagedPoint:this._snappingOperation.stagedPoint,constraint:this._constraint})),(({stagedPoint:t,constraint:e},i)=>{const{snappingOptions:n}=this;if(n&&(n.forceDisabled=null!=e&&(0,constraints.fT)(e)),null!=i&&t===i.stagedPoint&&e!==i.constraint)return this._onKeyboardBasedChange();this._processCursor(t??this._screenToMap(this._stagedScreenPoint))}),{equals:(t,e)=>t.stagedPoint===e.stagedPoint&&(0,maybe.CM)(t.constraint,e.constraint)}),(0,reactiveUtils.watch)((()=>this.view.viewpoint),((t,e)=>{t&&e&&(0,diffUtils.Ui)(t,e)&&this._onKeyboardBasedChange()}))]),this._activeComponent=new EditGeometry.uA(i,n),this._editGeometryOperations.data.components.push(this._activeComponent);const s=this.segmentLabels;null!=s&&(s.context={view:e,editGeometryOperations:this._editGeometryOperations,elevationInfo:this.elevationInfo,labelOptions:this.labelOptions},this.addHandles((0,reactiveUtils.watch)((()=>this.labelOptions.enabled),(t=>{s.visible=t}),reactiveUtils.pc))),this.addHandles(this._editGeometryOperations.on(["vertex-add","vertex-update","vertex-remove"],(t=>{const e=t.vertices.map((t=>({componentIndex:0,vertexIndex:t.index,coordinates:this.coordinateHelper.vectorToArray(t.pos)}))),i=e.map((t=>t.coordinates)),n=this.coordinateHelper.vectorToDehydratedPoint(this._activeComponent.getFirstVertex()?.pos)??null;(0,dehydratedFeatureComparison.CI)(n,this.firstVertex)||(this.firstVertex=n);const o=this.coordinateHelper.vectorToDehydratedPoint(this._activeComponent.getLastVertex()?.pos)??null;(0,dehydratedFeatureComparison.CI)(o,this.lastVertex)||(this.lastVertex=o);const r=this.coordinateHelper.vectorToDehydratedPoint(this._activeComponent.edges.at(-1)?.leftVertex?.pos)??null;switch((0,dehydratedFeatureComparison.CI)(r,this.secondToLastVertex)||(this.secondToLastVertex=r),this._processCursor(this.cursorVertex),t.type){case"vertex-add":this.emit(t.type,{...t,added:i,vertices:e});break;case"vertex-update":this.emit(t.type,{...t,updated:i,vertices:e});break;case"vertex-remove":this.emit(t.type,{...t,removed:i,vertices:e})}})));const p=this._manipulator=new DrawManipulator_t({consumesClicks:!1,grabbableForEvent:t=>"click"!==this.drawingMode||"touch"===t.pointerType&&this._snappingEnabled&&1===this._pointerDownStates.size});this.manipulators.add(p),p.grabbable="point"!==t&&"multipoint"!==t,this.addHandles([p.events.on("immediate-click",(t=>this._onImmediateClick(t))),p.events.on("immediate-double-click",(t=>this._onImmediateDoubleClick(t))),(0,reactiveUtils.watch)((()=>this.drawingMode),(()=>{this.removeHandles(U),this.addHandles(this._createManipulatorDragPipeline(p),U)}),reactiveUtils.pc),(0,reactiveUtils.watch)((()=>({effectiveCursor:this.effectiveCursor})),(({effectiveCursor:t})=>{p.cursor=t}),reactiveUtils.pc)]),(0,snappingUtils.BY)(this,(()=>{const t=this.view.inputManager.latestPointerType??"mouse",e=this._getSnappingContext(t);if(null!=this.snappingManager){const t=this._snappingOperation.snapAgainNearPreviousMapPoint(this.snappingManager,e);this._updatingHandles.addPromise((0,promiseUtils.QZ)(t))}}))}destroy(){(0,maybe.pR)(this.segmentLabels),(0,maybe.pR)(this._snappingOperation),this._editGeometryOperations=(0,maybe.pR)(this._editGeometryOperations),this._updatingHandles.destroy()}get _isDragging(){const{_stagedPointerId:t,_manipulator:e}=this;return null!=t&&this._pointerDownStates.has(t)||e.grabbing||!e.interactive}get _snappingEnabled(){return null!=this.snappingManager&&this.snappingManager.options.effectiveEnabled}get _requiresScenePoint(){const t=this._updateAndGetEffectiveDrawSurface();return"3d"===this.view.type&&this.drawSurface!==t}get canRedo(){return this._editGeometryOperations.canRedo}get canUndo(){return this._editGeometryOperations.canUndo}get committedVertices(){return this._activeComponent.vertices.map((t=>this.coordinateHelper.vectorToArray(t.pos)))}get _constraint(){const{constraints:t,constraintsEnabled:e}=this;if(t&&e)switch(this.geometryType){case"point":case"multipoint":return this._getPointConstraint(t);case"polygon":case"polyline":return this._getPolylineOrPolygonConstraint(this.lastVertex,this.secondToLastVertex,t)}}set drawingMode(t){this._set("drawingMode",t??e)}get effectiveCursor(){return this.loading?"progress":this._hideDefaultCursor?null:this.cursor||"crosshair"}get interactive(){return this._manipulator.interactive}set interactive(t){this._manipulator.interactive=t}get isCompleted(){return this._createOperationCompleted}get numCommittedVertices(){return this._activeComponent.vertices.length}get snappingOptions(){return null!=this.snappingManager?this.snappingManager.options:null}get cursorVertex(){return this._get("cursorVertex")}get visualizationCursorVertex(){return"mouse"===this._stagedPointerType?this.cursorVertex:null}get committableVertex(){const{cursorVertex:t,lastVertex:e,firstVertex:i,geometryType:n}=this;return"polygon"===n&&(0,dehydratedFeatureComparison.fk)(t,i)||(0,dehydratedFeatureComparison.fk)(t,e)?null:t}get updating(){return this._updatingHandles.updating}get geometryIncludingUncommittedVertices(){const{committedVertices:t,committableVertex:e,coordinateHelper:i}=this,n=t.slice();return null!=e&&n.push(i.pointToArray(e)),n}cancel(){this.complete({aborted:!0})}commitStagedVertex(){this._snappingOperation.abort();const{committableVertex:t}=this;null!=t&&this._editGeometryOperations.appendVertex(this.coordinateHelper.pointToVector(t))}complete(t){const e=t?.aborted||!1;this._snappingOperation.abort(),this.snappingManager?.doneSnapping();const{geometryType:i,numCommittedVertices:n}=this,o="multipoint"===i&&0===n||"polyline"===i&&n<2||"polygon"===i&&n<3;"segment"!==i&&"point"!==i||this.commitStagedVertex(),this._createOperationCompleted=!o,(this.isCompleted||e)&&(this._stagedScreenPoint=null,this._stagedPointerId=null,this._stagedPointerType=null,this._processCursor(null),this.emit("complete",{vertices:this.committedVertices.map(((t,e)=>({componentIndex:0,vertexIndex:e,coordinates:t}))),aborted:e,type:"complete"}))}onInputEvent(t){switch(t.type){case"pointer-down":this._pointerDownStates.add(t.pointerId);break;case"pointer-up":this._pointerDownStates.delete(t.pointerId)}switch(t.type){case"pointer-move":return this._onPointerMove(t);case"hold":return this._onHold(t)}}redo(){this._editGeometryOperations.redo()}undo(){null!=this.snappingManager&&this.snappingManager.doneSnapping(),this._editGeometryOperations.undo()}_processCursor(t){const e=(0,lang.o8)(this.cursorVertex),i=(0,lang.o8)(t),o=i&&(this._updateAndGetEffectiveDrawSurface()?.constrainZ(i)??i),r=this._snapToClosingVertex(o),s=this._applyConstraints(r);(0,dehydratedFeatureComparison.fk)(e,s)||(this._set("cursorVertex",s),this.segmentLabels?.set("stagedVertex",null!=s?this.coordinateHelper.pointToVector(s):null),null==s||"mouse"!==this._stagedPointerType?this.emit("cursor-remove"):this.emit("cursor-update",{updated:null,vertices:[{componentIndex:0,vertexIndex:this._activeComponent.vertices.length,coordinates:this.coordinateHelper.pointToArray(s)}],operation:"apply",type:"vertex-update"}))}_snapToClosingVertex(t){if(null==t||this._isDragging||"polygon"!==this.geometryType||this.numCommittedVertices<=2)return t;const e=this._mapToScreen(t);if(!e)return t;const i=this._activeComponent;return this._vertexWithinPointerDistance(i.vertices[0].pos,e)?this.firstVertex:this._vertexWithinPointerDistance(i.vertices.at(-1).pos,e)?this.lastVertex:t}_createManipulatorDragPipeline(t){switch(this.drawingMode){case"click":return this._createManipulatorDragPipelineClick(t);case"freehand":return this._createManipulatorDragPipelineFreehand(t);case"hybrid":return this._createManipulatorDragPipelineHybrid(t)}}_createManipulatorDragPipelineClick(t){return(0,dragEventPipeline.Xt)(t,((t,e,i,n)=>{const o="touch"===n&&this._snappingEnabled;if(this.isCompleted||!o)return;const{snappingStep:r,cancelSnapping:s}=(0,SnappingDragPipelineStep.L)({predicate:()=>o,snappingManager:this.snappingManager,snappingContext:new SnappingContext.e({editGeometryOperations:this._editGeometryOperations,elevationInfo:this.elevationInfo,feature:this.graphic,pointer:n,visualizer:this.snappingVisualizer,drawConstraints:this.constraints}),updatingHandles:this._updatingHandles,useZ:!this._requiresScenePoint});i=i.next((t=>(o&&null!=this.snappingManager&&this.snappingManager.doneSnapping(),t))).next(s),e.next(this._screenToMapDragEventStep()).next((t=>("start"===t.action&&(this._processCursor(t.mapStart),("segment"===this.geometryType||o&&!this.numCommittedVertices)&&this.commitStagedVertex()),t))).next((0,dragEventPipeline.pg)(this.view,this.elevationInfo)).next(...r).next((t=>(o&&(this._processCursor(t.mapEnd),"end"===t.action&&this.commitStagedVertex()),t))).next((t=>("end"===t.action&&("mouse"!==this._stagedPointerType&&this._snappingOperation.abort(),"segment"!==this.geometryType&&"point"!==this.geometryType||this.complete()),t)))}))}_createManipulatorDragPipelineFreehand(t){return(0,dragEventPipeline.Xt)(t,((t,e)=>{this.isCompleted||e.next(this._screenToMapDragEventStep()).next((t=>("start"===t.action&&(this._snappingOperation.abort(),null==this.committableVertex&&this._processCursor(t.mapStart),"segment"===this.geometryType&&this.commitStagedVertex()),t))).next((t=>{switch(t.action){case"start":case"update":this._processCursor(t.mapEnd),"polygon"!==this.geometryType&&"polyline"!==this.geometryType||this.commitStagedVertex();break;case"end":this.complete()}return t}))}))}_createManipulatorDragPipelineHybrid(t){return(0,dragEventPipeline.Xt)(t,((t,e)=>{this.isCompleted||e.next(this._screenToMapDragEventStep()).next((t=>("start"===t.action&&(this._snappingOperation.abort(),this.addHandles(this._editGeometryOperations.createUndoGroup(),z),this._processCursor(t.mapStart),this.commitStagedVertex()),t))).next((t=>{switch(t.action){case"start":case"update":this._processCursor(t.mapEnd),"polygon"!==this.geometryType&&"polyline"!==this.geometryType||this.commitStagedVertex();break;case"end":"mouse"!==this._stagedPointerType&&this._snappingOperation.abort(),this.removeHandles(z),"segment"!==this.geometryType&&"point"!==this.geometryType||this.complete()}return t}))}))}get _drawAtFixedElevation(){const{constraintsEnabled:t,constraintZ:e,geometryType:i,numCommittedVertices:n}=this;return t?null!=e||"segment"===i&&n>0:("segment"===i||"polygon"===i)&&n>0}_updateAndGetEffectiveDrawSurface(){const{constraintsEnabled:t,coordinateHelper:e,drawSurface:i,elevationDrawSurface:n,snapToSceneEnabled:o}=this;if(null==n)return i;if(!this.hasZ)return n.defaultZ=null,n;const r=this.elevationInfo?.mode;let s=this.defaultZ,a=t||"absolute-height"===r;return null!=o&&(a=o),"on-the-ground"===r&&(a=!1),this._drawAtFixedElevation&&(s=(t?this.constraintZ:null)??e.getZ(this._activeComponent.vertices[0].pos),a=!1),a?i:(n.defaultZ=s,n)}_mapToScreen(t){return this._updateAndGetEffectiveDrawSurface()?.mapToScreen(t)}_onHold(t){this._snappingOperation.abort(),"click"===this.drawingMode&&"touch"===t.pointerType&&this._snappingEnabled&&this._processCursor(t.mapPoint),t.stopPropagation()}_onImmediateClick(t){if(!("mouse"===t.pointerType&&2===t.button||this._manipulator.dragging))try{const{drawingMode:e,geometryType:i}=this;this._stagedPointerType=t.pointerType,this._stagedScreenPoint=t.screenPoint;const n=this._screenToMap(t.screenPoint);if(null==n)return;if(null==n||"freehand"===e&&"point"!==i&&"multipoint"!==i)return;if(this._snappingEnabled&&null!=this.cursorVertex||this._processCursor(n),null==this.committableVertex)return void this.complete();this.commitStagedVertex(),"mouse"!==t.pointerType&&this._processCursor(null),("freehand"===e&&"multipoint"!==this.geometryType||"point"===i||"segment"===i&&2===this.numCommittedVertices||"segment"===i&&"hybrid"===e&&1===this.numCommittedVertices)&&this.complete()}finally{t.stopPropagation()}}_onImmediateDoubleClick(t){this._manipulator.dragging||"point"===this.geometryType||(this.complete(),t.stopPropagation())}_onPointerMove(t){const e=(0,screenUtils.tc)(t.x,t.y);this._stagedScreenPoint=e,this._stagedPointerType=t.pointerType,this._stagedPointerId=t.pointerId,this._isDragging?this._snappingOperation.abort():(t.stopPropagation(),this._processCursorMovementRelativeToSurface(e,t.pointerType))}_onKeyboardBasedChange(){"mouse"===this._stagedPointerType&&this._stagedScreenPoint&&null!=this._stagedPointerId&&!this._isDragging?this._processCursorMovementRelativeToSurface(this._stagedScreenPoint,this._stagedPointerType):this._snappingOperation.abort()}_processCursorMovementRelativeToSurface(t,e){const i=this._snappingOperation,n=this._screenToMap(t),o=this._requiresScenePoint?this.drawSurface?.screenToMap(t):null;if(null==n)return this._hideDefaultCursor=!0,this._processCursor(null),void i.abort();this._hideDefaultCursor=!1;const r=this.snappingManager;if(null==r)return this._processCursor(n),void i.abort();const s=this._getSnappingContext(e);this._updatingHandles.addPromise((0,promiseUtils.QZ)(i.snap({point:n,scenePoint:o},r,s)))}_applyConstraints(t){const{_constraint:e,constraints:i}=this;if(!t||!i||!e)return t;const{context:n}=i,o=(0,constraintUtils.dz)(t,n),r=o?e.closestTo(o):void 0;if(!r)return t;const s=(0,constraintUtils.tC)(r,t,n),a="2d"===this.view.type||"absolute-height"!==n.elevationInfo.mode;return null!=s&&a&&null!=this.constraintZ&&this.hasZ&&(s.z=this.constraintZ),s}_screenToMap(t){return t?this._updateAndGetEffectiveDrawSurface()?.screenToMap(t):null}_screenToMapDragEventStep(){let t=null;return e=>{if("start"===e.action&&(t=this._screenToMap(e.screenStart)),null==t)return null;const i=this._screenToMap(e.screenEnd);return null!=i?{...e,mapStart:t,mapEnd:i}:null}}_vertexWithinPointerDistance(t,e){const n=this._mapToScreen(this.coordinateHelper.vectorToDehydratedPoint(t));return null!=n&&function R(t,e,i){const n=t.x-e.x,o=t.y-e.y;return n*n+o*o<=i}(n,e,25)}_getSnappingContext(t){const e=this._drawAtFixedElevation?this.elevationDrawSurface?.defaultZ:null;return new SnappingContext.e({editGeometryOperations:this._editGeometryOperations,elevationInfo:this.elevationInfo,pointer:t,feature:this.graphic,visualizer:this.snappingVisualizer,selfSnappingZ:null!=e?{value:e,elevationInfo:this.elevationInfo}:null,drawConstraints:this.constraints})}};(0,tslib_es6._)([(0,property.MZ)()],F.prototype,"_hideDefaultCursor",void 0),(0,tslib_es6._)([(0,property.MZ)()],F.prototype,"_stagedPointerId",void 0),(0,tslib_es6._)([(0,property.MZ)()],F.prototype,"_isDragging",null),(0,tslib_es6._)([(0,property.MZ)()],F.prototype,"_snappingOperation",void 0),(0,tslib_es6._)([(0,property.MZ)()],F.prototype,"_snappingEnabled",null),(0,tslib_es6._)([(0,property.MZ)({constructOnly:!0})],F.prototype,"graphic",void 0),(0,tslib_es6._)([(0,property.MZ)()],F.prototype,"constraintsEnabled",void 0),(0,tslib_es6._)([(0,property.MZ)()],F.prototype,"constraints",void 0),(0,tslib_es6._)([(0,property.MZ)()],F.prototype,"_constraint",null),(0,tslib_es6._)([(0,property.MZ)()],F.prototype,"constraintZ",void 0),(0,tslib_es6._)([(0,property.MZ)()],F.prototype,"defaultZ",void 0),(0,tslib_es6._)([(0,property.MZ)()],F.prototype,"isDraped",void 0),(0,tslib_es6._)([(0,property.MZ)({value:e})],F.prototype,"drawingMode",null),(0,tslib_es6._)([(0,property.MZ)({constructOnly:!0})],F.prototype,"elevationDrawSurface",void 0),(0,tslib_es6._)([(0,property.MZ)({constructOnly:!0})],F.prototype,"elevationInfo",void 0),(0,tslib_es6._)([(0,property.MZ)({constructOnly:!0,type:SketchLabelOptions.A})],F.prototype,"labelOptions",void 0),(0,tslib_es6._)([(0,property.MZ)({constructOnly:!0})],F.prototype,"geometryType",void 0),(0,tslib_es6._)([(0,property.MZ)({constructOnly:!0})],F.prototype,"hasM",void 0),(0,tslib_es6._)([(0,property.MZ)({constructOnly:!0})],F.prototype,"hasZ",void 0),(0,tslib_es6._)([(0,property.MZ)()],F.prototype,"cursor",void 0),(0,tslib_es6._)([(0,property.MZ)()],F.prototype,"effectiveCursor",null),(0,tslib_es6._)([(0,property.MZ)()],F.prototype,"loading",void 0),(0,tslib_es6._)([(0,property.MZ)({constructOnly:!0})],F.prototype,"manipulators",void 0),(0,tslib_es6._)([(0,property.MZ)({constructOnly:!0})],F.prototype,"drawSurface",void 0),(0,tslib_es6._)([(0,property.MZ)({constructOnly:!0})],F.prototype,"segmentLabels",void 0),(0,tslib_es6._)([(0,property.MZ)({constructOnly:!0})],F.prototype,"snappingManager",void 0),(0,tslib_es6._)([(0,property.MZ)({constructOnly:!0})],F.prototype,"snappingVisualizer",void 0),(0,tslib_es6._)([(0,property.MZ)()],F.prototype,"snapToSceneEnabled",void 0),(0,tslib_es6._)([(0,property.MZ)({readOnly:!0})],F.prototype,"cursorVertex",null),(0,tslib_es6._)([(0,property.MZ)({readOnly:!0})],F.prototype,"visualizationCursorVertex",null),(0,tslib_es6._)([(0,property.MZ)()],F.prototype,"committableVertex",null),(0,tslib_es6._)([(0,property.MZ)()],F.prototype,"firstVertex",void 0),(0,tslib_es6._)([(0,property.MZ)()],F.prototype,"lastVertex",void 0),(0,tslib_es6._)([(0,property.MZ)()],F.prototype,"secondToLastVertex",void 0),(0,tslib_es6._)([(0,property.MZ)()],F.prototype,"updating",null),(0,tslib_es6._)([(0,property.MZ)({constructOnly:!0})],F.prototype,"view",void 0),F=(0,tslib_es6._)([(0,subclass.$)("esri.views.draw.DrawOperation")],F)},"./node_modules/@arcgis/core/views/draw/drawSurfaces.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{IX:()=>l,rT:()=>c,uF:()=>h});var _core_screenUtils_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/@arcgis/core/core/screenUtils.js"),_geometry_Point_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@arcgis/core/geometry/Point.js"),_geometry_SpatialReference_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@arcgis/core/geometry/SpatialReference.js"),_layers_graphics_dehydratedPoint_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/@arcgis/core/layers/graphics/dehydratedPoint.js"),_layers_graphics_hydratedFeatures_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@arcgis/core/layers/graphics/hydratedFeatures.js"),_support_elevationInfoUtils_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@arcgis/core/support/elevationInfoUtils.js");class c{constructor(e,t,s,r=null){this._elevationInfo=e,this.defaultZ=t,this._view=s,this._excludeGraphics=r}screenToMap(t){const{defaultZ:s,_view:r}=this,n=r.sceneIntersectionHelper.intersectElevationFromScreen((0,_core_screenUtils_js__WEBPACK_IMPORTED_MODULE_4__.gs)(t.x,t.y),this._elevationInfo,s??0,this._excludeGraphics);return null==s&&null!=n&&(n.z=void 0),n}mapToScreen(e){const t=(0,_layers_graphics_dehydratedPoint_js__WEBPACK_IMPORTED_MODULE_5__.T)(e.x,e.y,(0,_support_elevationInfoUtils_js__WEBPACK_IMPORTED_MODULE_3__.wS)(this._view,e,this._elevationInfo),e.spatialReference);return this._view.toScreen(t)}constrainZ(e){const{defaultZ:t}=this;return null!=t&&e.z!==t&&((e=(0,_layers_graphics_hydratedFeatures_js__WEBPACK_IMPORTED_MODULE_2__.EL)(e)).z=t),e}}class l{constructor(e,t,s=[]){this.view=e,this.elevationInfo=t,this.exclude=s}screenToMap(e){const t=this.view.toMap(e,{exclude:this.exclude,excludeLabels:!0});return null!=t&&(t.z=(0,_support_elevationInfoUtils_js__WEBPACK_IMPORTED_MODULE_3__.id)(t,this.view,this.elevationInfo)),t}mapToScreen(e){let t=e;return null!=this.elevationInfo&&(t=(0,_layers_graphics_dehydratedPoint_js__WEBPACK_IMPORTED_MODULE_5__.T)(e.x,e.y,(0,_support_elevationInfoUtils_js__WEBPACK_IMPORTED_MODULE_3__.wS)(this.view,e,this.elevationInfo),e.spatialReference)),this.view.toScreen(t)}constrainZ(e){return e}}class h{constructor(e,t=!1,s=0){this.view=e,this.hasZ=t,this.defaultZ=s,this.mapToScreen=t=>e.toScreen(t),this.screenToMap=t?t=>{const r=e.toMap(t);return r.z=s,r}:t=>e.toMap(t)}constrainZ(e){const{defaultZ:t}=this;return this.hasZ&&e.z!==t&&((e=(0,_layers_graphics_hydratedFeatures_js__WEBPACK_IMPORTED_MODULE_2__.EL)(e)).z=t),e}}class u{screenToMap(e){const{x:t,y:r}=e;return new _geometry_Point_js__WEBPACK_IMPORTED_MODULE_0__.default({x:t,y:r,spatialReference:u.spatialReference})}mapToScreen(e){return(0,_core_screenUtils_js__WEBPACK_IMPORTED_MODULE_4__.tc)(e.x,e.y)}constrainZ(e){return e}}u.spatialReference=new _geometry_SpatialReference_js__WEBPACK_IMPORTED_MODULE_1__.A},"./node_modules/@arcgis/core/views/interactive/InteractiveToolBase.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{g:()=>n});var a,tslib_es6=__webpack_require__("./node_modules/@arcgis/core/chunks/tslib.es6.js"),Accessor=__webpack_require__("./node_modules/@arcgis/core/core/Accessor.js"),promiseUtils=(__webpack_require__("./node_modules/@arcgis/core/core/has.js"),__webpack_require__("./node_modules/@arcgis/core/core/Logger.js"),__webpack_require__("./node_modules/@arcgis/core/core/promiseUtils.js")),property=__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/decorators/property.js"),subclass=(__webpack_require__("./node_modules/@arcgis/core/core/RandomLCG.js"),__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/decorators/subclass.js")),interfaces=__webpack_require__("./node_modules/@arcgis/core/views/interactive/interfaces.js"),Collection=__webpack_require__("./node_modules/@arcgis/core/core/Collection.js");!function(t){t[t.WhenToolEditable=0]="WhenToolEditable",t[t.WhenToolNotEditable=1]="WhenToolNotEditable",t[t.Always=2]="Always"}(a||(a={}));class i{constructor(){this._isToolEditable=!0,this._manipulators=new Collection.A,this._resourceContexts={manipulator3D:{}},this._attached=!1}set isToolEditable(t){this._isToolEditable=t}get length(){return this._manipulators.length}add(t,i=a.WhenToolEditable){this.addMany([t],i)}addMany(t,i=a.WhenToolEditable){for(const a of t){const t={manipulator:a,visibilityPredicate:i,attached:!1};this._manipulators.add(t),this._attached&&this._updateManipulatorAttachment(t)}}remove(t){for(let a=0;a<this._manipulators.length;a++)if(this._manipulators.at(a).manipulator===t){const t=this._manipulators.splice(a,1)[0];this._detachManipulator(t);break}}removeAll(){this._manipulators.forEach((t=>{this._detachManipulator(t)})),this._manipulators.removeAll()}attach(){this._manipulators.forEach((t=>{this._updateManipulatorAttachment(t)})),this._attached=!0}detach(){this._manipulators.forEach((t=>{this._detachManipulator(t)})),this._attached=!1}destroy(){this.detach(),this._manipulators.forEach((({manipulator:t})=>t.destroy())),this._manipulators.destroy(),this._resourceContexts=null}on(t,a){return this._manipulators.on(t,(t=>{a(t)}))}forEach(t){for(const a of this._manipulators.items)t(a)}some(t){return this._manipulators.items.some(t)}toArray(){const t=[];return this.forEach((a=>t.push(a.manipulator))),t}intersect(t,a){let i=null,e=Number.MAX_VALUE;return this._manipulators.forEach((({manipulator:o,attached:s})=>{if(!s||!o.interactive)return;const r=o.intersectionDistance(t,a);null!=r&&r<e&&(e=r,i=o)})),i}_updateManipulatorAttachment(t){this._isManipulatorItemVisible(t)?this._attachManipulator(t):this._detachManipulator(t)}_attachManipulator(t){t.attached||(t.manipulator.attach&&t.manipulator.attach(this._resourceContexts),t.attached=!0)}_detachManipulator(t){if(!t.attached)return;const a=t.manipulator;a.grabbing=!1,a.dragging=!1,a.hovering=!1,a.selected=!1,a.detach&&a.detach(this._resourceContexts),t.attached=!1}_isManipulatorItemVisible(t){return t.visibilityPredicate===a.Always||(this._isToolEditable?t.visibilityPredicate===a.WhenToolEditable:t.visibilityPredicate===a.WhenToolNotEditable)}}let n=class extends Accessor.A{constructor(t){super(t),this.manipulators=new i,this.automaticManipulatorSelection=!0,this.hasGrabbedManipulators=!1,this.hasHoveredManipulators=!1,this.firstGrabbedManipulator=null,this.created=!1,this.removeIncompleteOnCancel=!0,this._editableFlags=new Map([[interfaces.PK.MANAGER,!0],[interfaces.PK.USER,!0]]),this._creationFinishedResolver=(0,promiseUtils.Tw)()}get active(){return null!=this.view&&this.view.activeTool===this}set visible(t){this._get("visible")!==t&&(this._set("visible",t),this._syncVisible())}get editable(){return this.getEditableFlag(interfaces.PK.USER)}set editable(t){this.setEditableFlag(interfaces.PK.USER,t)}get updating(){return!1}get cursor(){return null}get hasFocusedManipulators(){return this.hasGrabbedManipulators||this.hasHoveredManipulators}destroy(){this.manipulators.destroy(),this._set("view",null)}onAdd(){this._syncVisible()}activate(){null!=this.view&&(this.view.focus(),this.onActivate())}deactivate(){this.onDeactivate()}handleInputEvent(t){this.onInputEvent(t)}handleInputEventAfter(t){this.onInputEventAfter(t)}setEditableFlag(t,e){this._editableFlags.set(t,e),this.manipulators.isToolEditable=this.internallyEditable,this._updateManipulatorAttachment(),t===interfaces.PK.USER&&this.notifyChange("editable"),this.onEditableChange(),this.onManipulatorSelectionChanged()}getEditableFlag(t){return this._editableFlags.get(t)??!1}endDrag(){const t=this.view.inputManager.latestPointerLocation;if(!t)return;let e=!1;this.manipulators.forEach((({manipulator:i})=>{i.dragging&&(e=!0,i.events.emit("drag",{action:"end",start:t,screenPoint:t}))})),e&&(this.view.toolViewManager.activeTool=null)}whenCreated(){return this._creationFinishedResolver.promise}onManipulatorSelectionChanged(){}onActivate(){}onDeactivate(){}onShow(){}onHide(){}onEditableChange(){}onInputEvent(t){}onInputEventAfter(t){}get internallyEditable(){return this.getEditableFlag(interfaces.PK.USER)&&this.getEditableFlag(interfaces.PK.MANAGER)}finishToolCreation(){this.created||this._creationFinishedResolver.resolve(this),this._set("created",!0)}_syncVisible(){if(this.initialized)if(this.visible)this._show();else if(this._hide(),this.active)return void(this.view.activeTool=null)}_show(){this._updateManipulatorAttachment(),this.onShow()}_hide(){this._updateManipulatorAttachment(),this.onHide()}_updateManipulatorAttachment(){this.visible?this.manipulators.attach():this.manipulators.detach()}};(0,tslib_es6._)([(0,property.MZ)({constructOnly:!0})],n.prototype,"view",void 0),(0,tslib_es6._)([(0,property.MZ)({readOnly:!0})],n.prototype,"active",null),(0,tslib_es6._)([(0,property.MZ)({value:!0})],n.prototype,"visible",null),(0,tslib_es6._)([(0,property.MZ)({value:!0})],n.prototype,"editable",null),(0,tslib_es6._)([(0,property.MZ)({readOnly:!0})],n.prototype,"manipulators",void 0),(0,tslib_es6._)([(0,property.MZ)({readOnly:!0})],n.prototype,"updating",null),(0,tslib_es6._)([(0,property.MZ)()],n.prototype,"cursor",null),(0,tslib_es6._)([(0,property.MZ)({readOnly:!0})],n.prototype,"automaticManipulatorSelection",void 0),(0,tslib_es6._)([(0,property.MZ)()],n.prototype,"hasFocusedManipulators",null),(0,tslib_es6._)([(0,property.MZ)()],n.prototype,"hasGrabbedManipulators",void 0),(0,tslib_es6._)([(0,property.MZ)()],n.prototype,"hasHoveredManipulators",void 0),(0,tslib_es6._)([(0,property.MZ)()],n.prototype,"firstGrabbedManipulator",void 0),(0,tslib_es6._)([(0,property.MZ)({readOnly:!0})],n.prototype,"created",void 0),(0,tslib_es6._)([(0,property.MZ)({readOnly:!0})],n.prototype,"removeIncompleteOnCancel",void 0),n=(0,tslib_es6._)([(0,subclass.$)("esri.views.interactive.InteractiveToolBase")],n)},"./node_modules/@arcgis/core/views/interactive/dragEventPipeline.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{EX:()=>v,RS:()=>U,Tp:()=>M,Wp:()=>f,Xt:()=>p,an:()=>m,bl:()=>S,dp:()=>g,mc:()=>z,pg:()=>D,rh:()=>w,sO:()=>j,y$:()=>E});var _core_arrayUtils_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@arcgis/core/core/arrayUtils.js"),_core_mathUtils_js__WEBPACK_IMPORTED_MODULE_3__=(__webpack_require__("./node_modules/@arcgis/core/core/has.js"),__webpack_require__("./node_modules/@arcgis/core/core/lang.js"),__webpack_require__("./node_modules/@arcgis/core/core/mathUtils.js")),_core_screenUtils_js__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./node_modules/@arcgis/core/core/screenUtils.js"),_geometry_projection_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/@arcgis/core/geometry/projection.js"),_geometry_support_meshVertexSpaceUtils_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/@arcgis/core/geometry/support/meshVertexSpaceUtils.js"),_layers_graphics_hydratedFeatures_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./node_modules/@arcgis/core/layers/graphics/hydratedFeatures.js"),_support_elevationInfoUtils_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./node_modules/@arcgis/core/support/elevationInfoUtils.js"),_editGeometry_EditGeometryOperations_js__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./node_modules/@arcgis/core/views/interactive/editGeometry/EditGeometryOperations.js");function p(t,n){return t.events.on("drag",function i(t,n){let e=null,r=null;return a=>{if("cancel"===a.action)return void(null!=r&&(r.execute({action:"cancel"}),e=null,r=null));const o={action:a.action,screenStart:a.start,screenEnd:a.screenPoint};"start"===a.action&&null==e&&(e=new w,r=new w,n(t,e,r,a.pointerType,o)),null!=e&&e.execute(o),"end"===a.action&&null!=e&&(e=null,r=null)}}(t,n))}function m(t,n){const e=[t.x,t.y,t.z??0],r=n,a=[Math.cos(r),Math.sin(r)],o=Math.sqrt(a[0]*a[0]+a[1]*a[1]);if(0===o)return null;a[0]/=o,a[1]/=o;const l=t=>{const n=(t.x-e[0])*a[0]+(t.y-e[1])*a[1];t.x=e[0]+n*a[0],t.y=e[1]+n*a[1]};return t=>(l(t.mapStart),l(t.mapEnd),{...t,axis:a})}function f(t){let n=null;return e=>{if("start"===e.action&&(n=function y(t,n){const e=t.operations;if(!e)return null;const r=e.data.geometry,c=(0,_layers_graphics_hydratedFeatures_js__WEBPACK_IMPORTED_MODULE_6__.RS)(n);if(r.spatialReference.equals(c))return x(t,e,(()=>{}));if("mesh"!==r.type){const n=d(r,c);if(null==n)return null;const o=r.spatialReference;return x(t,_editGeometry_EditGeometryOperations_js__WEBPACK_IMPORTED_MODULE_8__.p.fromGeometry(n,e.viewingMode),(()=>{const t=(0,_geometry_projection_js__WEBPACK_IMPORTED_MODULE_4__.project)(r,o);e.trySetGeometry(t)}))}if((0,_geometry_support_meshVertexSpaceUtils_js__WEBPACK_IMPORTED_MODULE_5__.CK)(r)){const n=d(r.origin,c);if(!n)return null;const o=r.spatialReference,l=_editGeometry_EditGeometryOperations_js__WEBPACK_IMPORTED_MODULE_8__.p.fromGeometry(n,e.viewingMode);return x(t,e,(()=>{const t=(0,_geometry_projection_js__WEBPACK_IMPORTED_MODULE_4__.project)(l.data.geometry,o),n=t.x-r.origin.x,c=t.y-r.origin.y,s=(t.z??0)-(r.origin.z??0);e.move(n,c,s)}))}return null}(t,e.mapStart.spatialReference)),null==n)return null;const r=e.mapEnd.x-e.mapStart.x,a=e.mapEnd.y-e.mapStart.y,o=(e.mapEnd.z??0)-(e.mapStart.z??0);return n.move(r,a,o,e.action),{...e,translationX:r,translationY:a,translationZ:o}}}function d(t,n){return null==t?null:t.spatialReference.equals(n)?t.clone():(0,_geometry_projection_js__WEBPACK_IMPORTED_MODULE_4__.project)(t,n)}function x(t,n,e){let r=0,a=0,o=0;return{move:(l,c,s,u)=>{"start"===u&&(r=0,a=0,o=0);const i=l-r,p=c-a,m=s-o;n.move(i,p,m),r+=i,a+=p,o+=m,e(),"end"===u&&t.endInteraction?.()}}}function E(t,n=null,e){let r=null;const o=null==n||t.spatialReference?.equals(n)?t=>t:t=>null!=t?(0,_geometry_projection_js__WEBPACK_IMPORTED_MODULE_4__.project)(t,n):t,l={exclude:[],...e};return n=>{if("start"===n.action&&(r=o(t.toMap(n.screenStart,l))),null==r)return null;const e=o(t.toMap(n.screenEnd,l));return null!=e?{...n,mapStart:r,mapEnd:e}:null}}function S(n){const e=n.map((t=>f(t))).filter(_core_arrayUtils_js__WEBPACK_IMPORTED_MODULE_0__.Ru);return t=>{const n=t.mapEnd.x-t.mapStart.x,r=t.mapEnd.y-t.mapStart.y,a=t.mapEnd.z-t.mapStart.z;return e.forEach((n=>n(t))),{...t,translationX:n,translationY:r,translationZ:a}}}function g(t){const n=t.operations?.createResetState();return t=>(n?.remove(),t)}function z(t){const n=t.map((t=>g(t))).filter((t=>null!=t));return t=>(n.forEach((n=>n(t))),t)}function v(){let t=0,n=0,e=0;return r=>{"start"===r.action&&(t=r.mapStart.x,n=r.mapStart.y,e=r.mapStart.z);const a=r.mapEnd.x-t,o=r.mapEnd.y-n,l=r.mapEnd.z-e;return t=r.mapEnd.x,n=r.mapEnd.y,e=r.mapEnd.z,{...r,mapDeltaX:a,mapDeltaY:o,mapDeltaZ:l,mapDeltaSpatialReference:r.mapStart.spatialReference}}}function j(){let t=0,n=0;return e=>{"start"===e.action&&(t=e.screenStart.x,n=e.screenStart.y);const r=e.screenEnd.x-t,a=e.screenEnd.y-n;return t=e.screenEnd.x,n=e.screenEnd.y,{...e,screenDeltaX:r,screenDeltaY:a}}}function M(t,n){let a=null,o=0,l=0;return c=>{if("start"===c.action&&(a=t.toScreen?.(n),null!=a&&(a.x<0||a.x>t.width||a.y<0||a.y>t.height?a=null:(o=c.screenStart.x-a.x,l=c.screenStart.y-a.y))),null==a)return null;const s=(0,_core_mathUtils_js__WEBPACK_IMPORTED_MODULE_3__.qE)(c.screenEnd.x-o,0,t.width),u=(0,_core_mathUtils_js__WEBPACK_IMPORTED_MODULE_3__.qE)(c.screenEnd.y-l,0,t.height),i=(0,_core_screenUtils_js__WEBPACK_IMPORTED_MODULE_9__.tc)(s,u);return c.screenStart=a,c.screenEnd=i,c}}const R=()=>{};class w{constructor(){this.execute=R}next(t,n=new w){return null!=t&&(this.execute=e=>{const r=t(e);null!=r&&n.execute(r)}),n}}function D(t,n,e=[]){if("2d"===t.type)return t=>t;let r=null;return a=>{"start"===a.action&&(r=t.toMap(a.screenStart,{exclude:e}),null!=r&&(r.z=(0,_support_elevationInfoUtils_js__WEBPACK_IMPORTED_MODULE_7__.id)(r,t,n)));const o=t.toMap(a.screenEnd,{exclude:e});null!=o&&(o.z=(0,_support_elevationInfoUtils_js__WEBPACK_IMPORTED_MODULE_7__.id)(o,t,n));const l=null!=r&&null!=o?{sceneStart:r,sceneEnd:o}:null;return{...a,scenePoints:l}}}function G(t,n,e){const r=n.elevationProvider.getElevation(t.x,t.y,t.z??0,t.spatialReference,"scene")??0,a=(0,_layers_graphics_hydratedFeatures_js__WEBPACK_IMPORTED_MODULE_6__.EL)(t);return a.z=r,a.hasZ=!0,a.z=(0,_support_elevationInfoUtils_js__WEBPACK_IMPORTED_MODULE_7__.id)(a,n,e),a}function U(t,n){if("2d"===t.type)return t=>t;let e=null;return r=>{"start"===r.action&&(e=G(r.mapStart,t,n));const a=G(r.mapEnd,t,n),o=null!=e&&null!=a?{sceneStart:e,sceneEnd:a}:null;return{...r,scenePoints:o}}}},"./node_modules/@arcgis/core/views/interactive/editGeometry/support/editPlaneUtils.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Bb:()=>V,G3:()=>S,fJ:()=>T});var _core_libs_gl_matrix_2_math_vec2_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@arcgis/core/core/libs/gl-matrix-2/math/vec2.js"),_chunks_vec32_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@arcgis/core/chunks/vec32.js"),_core_libs_gl_matrix_2_factories_vec3f64_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@arcgis/core/core/libs/gl-matrix-2/factories/vec3f64.js"),_chunks_boundedPlane_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@arcgis/core/chunks/boundedPlane.js"),_geometry_support_vectorStacks_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/@arcgis/core/geometry/support/vectorStacks.js"),_operations_MoveVertex_js__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./node_modules/@arcgis/core/views/interactive/editGeometry/operations/MoveVertex.js"),_operations_RotateVertex_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/@arcgis/core/views/interactive/editGeometry/operations/RotateVertex.js"),_operations_ScaleVertex_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./node_modules/@arcgis/core/views/interactive/editGeometry/operations/ScaleVertex.js"),_operations_UpdateVertices_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./node_modules/@arcgis/core/views/interactive/editGeometry/operations/UpdateVertices.js");function V(o,i){return E(o,i,!1)}function T(o,i){return E(o,i,!0)}function E(o,i,r){if(o instanceof _operations_UpdateVertices_js__WEBPACK_IMPORTED_MODULE_7__.D){if(o.operation instanceof _operations_MoveVertex_js__WEBPACK_IMPORTED_MODULE_8__.a)return function h(o,i,r=!1){const t=r?-1:1,s=(0,_core_libs_gl_matrix_2_factories_vec3f64_js__WEBPACK_IMPORTED_MODULE_2__.fA)(t*o.dx,t*o.dy,t*o.dz);(0,_chunks_vec32_js__WEBPACK_IMPORTED_MODULE_1__.g)(i.origin,i.origin,s),(0,_chunks_boundedPlane_js__WEBPACK_IMPORTED_MODULE_3__.u)(i)}(o.operation,i,r),!0;if(o.operation instanceof _operations_RotateVertex_js__WEBPACK_IMPORTED_MODULE_5__.m)return function v(o,i,r=!1){const t=r?-o.angle:o.angle;(0,_chunks_vec32_js__WEBPACK_IMPORTED_MODULE_1__.L)(i.basis1,i.basis1,_core_libs_gl_matrix_2_factories_vec3f64_js__WEBPACK_IMPORTED_MODULE_2__.uY,t),(0,_chunks_vec32_js__WEBPACK_IMPORTED_MODULE_1__.L)(i.basis2,i.basis2,_core_libs_gl_matrix_2_factories_vec3f64_js__WEBPACK_IMPORTED_MODULE_2__.uY,t),(0,_chunks_boundedPlane_js__WEBPACK_IMPORTED_MODULE_3__.u)(i)}(o.operation,i,r),!0;if(o.operation instanceof _operations_ScaleVertex_js__WEBPACK_IMPORTED_MODULE_6__.j)return function F(i,r,t=!1){const s=t?1/i.factor1:i.factor1,n=t?1/i.factor2:i.factor2;(0,_chunks_vec32_js__WEBPACK_IMPORTED_MODULE_1__.h)(r.basis1,r.basis1,s),(0,_chunks_vec32_js__WEBPACK_IMPORTED_MODULE_1__.h)(r.basis2,r.basis2,n),(0,_core_libs_gl_matrix_2_math_vec2_js__WEBPACK_IMPORTED_MODULE_0__.Vj)(r.origin,r.origin,i.origin,i.axis1,s),(0,_core_libs_gl_matrix_2_math_vec2_js__WEBPACK_IMPORTED_MODULE_0__.Vj)(r.origin,r.origin,i.origin,i.axis2,n),(0,_chunks_boundedPlane_js__WEBPACK_IMPORTED_MODULE_3__.u)(r)}(o.operation,i,r),!0}return!1}function S(o,f,m,p,u=!1){p||(p=(0,_chunks_boundedPlane_js__WEBPACK_IMPORTED_MODULE_3__.d)());const l=(0,_core_libs_gl_matrix_2_math_vec2_js__WEBPACK_IMPORTED_MODULE_0__.hZ)(_geometry_support_vectorStacks_js__WEBPACK_IMPORTED_MODULE_4__.oG.get(),o[1],-o[0]),d=(0,_core_libs_gl_matrix_2_math_vec2_js__WEBPACK_IMPORTED_MODULE_0__.hZ)(_geometry_support_vectorStacks_js__WEBPACK_IMPORTED_MODULE_4__.oG.get(),Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY),j=(0,_core_libs_gl_matrix_2_math_vec2_js__WEBPACK_IMPORTED_MODULE_0__.hZ)(_geometry_support_vectorStacks_js__WEBPACK_IMPORTED_MODULE_4__.oG.get(),Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY),x=_geometry_support_vectorStacks_js__WEBPACK_IMPORTED_MODULE_4__.oG.get(),V=f.allVertices;V.forEach((({pos:n})=>{(0,_core_libs_gl_matrix_2_math_vec2_js__WEBPACK_IMPORTED_MODULE_0__.hZ)(x,(0,_core_libs_gl_matrix_2_math_vec2_js__WEBPACK_IMPORTED_MODULE_0__.Om)(o,n),(0,_core_libs_gl_matrix_2_math_vec2_js__WEBPACK_IMPORTED_MODULE_0__.Om)(l,n)),(0,_core_libs_gl_matrix_2_math_vec2_js__WEBPACK_IMPORTED_MODULE_0__.jk)(d,d,x),(0,_core_libs_gl_matrix_2_math_vec2_js__WEBPACK_IMPORTED_MODULE_0__.T9)(j,j,x)}));const T=1e-6,E=(0,_core_libs_gl_matrix_2_math_vec2_js__WEBPACK_IMPORTED_MODULE_0__.hZ)(_geometry_support_vectorStacks_js__WEBPACK_IMPORTED_MODULE_4__.oG.get(),j[0]-d[0]<T?m/2:0,j[1]-d[1]<T?m/2:0);(0,_core_libs_gl_matrix_2_math_vec2_js__WEBPACK_IMPORTED_MODULE_0__.Re)(d,d,E),(0,_core_libs_gl_matrix_2_math_vec2_js__WEBPACK_IMPORTED_MODULE_0__.WQ)(j,j,E);const h=u?V.reduce(((o,i)=>o+(i.pos[2]??0)),0)/V.length:0;return(0,_core_libs_gl_matrix_2_math_vec2_js__WEBPACK_IMPORTED_MODULE_0__.hs)(p.basis1,o,(j[0]-d[0])/2),(0,_core_libs_gl_matrix_2_math_vec2_js__WEBPACK_IMPORTED_MODULE_0__.hs)(p.basis2,l,(j[1]-d[1])/2),(0,_chunks_vec32_js__WEBPACK_IMPORTED_MODULE_1__.i)(p.origin,d[0]*o[0]+d[1]*l[0],d[0]*o[1]+d[1]*l[1],h),(0,_chunks_vec32_js__WEBPACK_IMPORTED_MODULE_1__.g)(p.origin,p.origin,p.basis1),(0,_chunks_vec32_js__WEBPACK_IMPORTED_MODULE_1__.g)(p.origin,p.origin,p.basis2),(0,_chunks_boundedPlane_js__WEBPACK_IMPORTED_MODULE_3__.u)(p),p}},"./node_modules/@arcgis/core/views/interactive/sketch/constraintUtils.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{cx:()=>V,dz:()=>G,hj:()=>Z,lJ:()=>k,tC:()=>W});var _core_quantityUtils_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@arcgis/core/core/quantityUtils.js"),_core_unitUtils_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@arcgis/core/core/unitUtils.js"),_chunks_vec32_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@arcgis/core/chunks/vec32.js"),_geometry_SpatialReference_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@arcgis/core/geometry/SpatialReference.js"),_geometry_projection_projectVectorToVector_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/@arcgis/core/geometry/projection/projectVectorToVector.js"),_geometry_support_geodesicUtils_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/@arcgis/core/geometry/support/geodesicUtils.js"),_layers_graphics_dehydratedPoint_js__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("./node_modules/@arcgis/core/layers/graphics/dehydratedPoint.js"),_support_elevationInfoUtils_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./node_modules/@arcgis/core/support/elevationInfoUtils.js"),_constraints_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./node_modules/@arcgis/core/views/interactive/sketch/constraints.js"),_normalizedPoint_js__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./node_modules/@arcgis/core/views/interactive/sketch/normalizedPoint.js"),_support_angularMeasurementUtils_js__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./node_modules/@arcgis/core/views/support/angularMeasurementUtils.js");function Z(e,n,t,r,o,i){let l="geodesic",u=(0,_geometry_support_geodesicUtils_js__WEBPACK_IMPORTED_MODULE_5__.Xn)(t);const s=(0,_normalizedPoint_js__WEBPACK_IMPORTED_MODULE_8__.Hh)();return(0,_normalizedPoint_js__WEBPACK_IMPORTED_MODULE_8__.vf)(e,n,r,s),s[2]=0,u&&(0,_geometry_projection_projectVectorToVector_js__WEBPACK_IMPORTED_MODULE_4__.F)(s,t,s,u)||(l="euclidean",u=t),{mode:l,view:n,elevationInfo:r,hasZ:o,directionMode:i,spatialReference:e.spatialReference,measurementSR:u,origin:s}}function b(n,t,r){if(null==t||null==n)return;const i=(0,_core_unitUtils_js__WEBPACK_IMPORTED_MODULE_1__._H)(r.measurementSR);if(null==i)return;const l=G(n,r);if(null==l)return;const u=(0,_core_quantityUtils_js__WEBPACK_IMPORTED_MODULE_0__.l3)(t,i);return new _constraints_js__WEBPACK_IMPORTED_MODULE_7__.ej(l,u)}function A(e,n,r,o){if(null==r||null==e)return;const i=G(e,o);if(null==i)return;const l=(0,_support_angularMeasurementUtils_js__WEBPACK_IMPORTED_MODULE_9__.hF)(r),s=e=>{if(null==e)return;const n=(0,_normalizedPoint_js__WEBPACK_IMPORTED_MODULE_8__.Hh)(),r=(0,_core_quantityUtils_js__WEBPACK_IMPORTED_MODULE_0__.Wq)(e,"degrees","geographic");return(0,_support_angularMeasurementUtils_js__WEBPACK_IMPORTED_MODULE_9__.rT)(n,i,o.measurementSR,10,r,o.mode)?new _constraints_js__WEBPACK_IMPORTED_MODULE_7__.FX(i,n):void 0},c=()=>{if(null!=n&&null!=e)return(0,_support_angularMeasurementUtils_js__WEBPACK_IMPORTED_MODULE_9__.hF)((0,_support_angularMeasurementUtils_js__WEBPACK_IMPORTED_MODULE_9__.$h)(n,e))};switch(o.directionMode){case _support_angularMeasurementUtils_js__WEBPACK_IMPORTED_MODULE_9__.rZ.Absolute:return s(l);case _support_angularMeasurementUtils_js__WEBPACK_IMPORTED_MODULE_9__.rZ.Relative:{const e=c();if(null==e)return;return s(e+l)}case _support_angularMeasurementUtils_js__WEBPACK_IMPORTED_MODULE_9__.rZ.RelativeBilateral:{const e=c();if(null==e)return;return(0,_constraints_js__WEBPACK_IMPORTED_MODULE_7__.xW)([s(e+l),s(e-l)])}}}function B(e,n){const t=C(e,n);return null!=t?new _constraints_js__WEBPACK_IMPORTED_MODULE_7__.qR(t):void 0}function P(e,n,t){const{context:r,longitude:o,latitude:i,direction:l,distance:u,elevation:s}=t;if(null!=o||null!=i||null!=u||null!=s||null!=l){if(null!=o||null!=i){const e=(0,_support_angularMeasurementUtils_js__WEBPACK_IMPORTED_MODULE_9__.hF)(o),n=(0,_support_angularMeasurementUtils_js__WEBPACK_IMPORTED_MODULE_9__.hF)(i),t=C(s,r);return new _constraints_js__WEBPACK_IMPORTED_MODULE_7__.QT(e,n,t)}return function T(n,t,{context:r,direction:o,distance:i,elevation:l}){if(null==t)return B(l,r);const{view:u,elevationInfo:s,measurementSR:a}=r,f=(0,_normalizedPoint_js__WEBPACK_IMPORTED_MODULE_8__.vf)(t,u,s);if(!a||!(0,_geometry_projection_projectVectorToVector_js__WEBPACK_IMPORTED_MODULE_4__.F)(f,t.spatialReference,E,a))return;const[m,d]=E,v=null!=i?(0,_core_quantityUtils_js__WEBPACK_IMPORTED_MODULE_0__.l3)(i,"meters"):void 0,g=(0,_support_angularMeasurementUtils_js__WEBPACK_IMPORTED_MODULE_9__.hF)(o),j=C(l,r),h=e=>{const n=new _constraints_js__WEBPACK_IMPORTED_MODULE_7__.jf([m,d],a,v,j,e);return null==v||null==e||null==j&&r.hasZ?n:new _constraints_js__WEBPACK_IMPORTED_MODULE_7__.i7(n.closestTo(f))};if(null==g)return h(void 0);const x=()=>{if(null!=n&&null!=t)return(0,_support_angularMeasurementUtils_js__WEBPACK_IMPORTED_MODULE_9__.hF)((0,_support_angularMeasurementUtils_js__WEBPACK_IMPORTED_MODULE_9__.$h)(n,t))};switch(r.directionMode){case _support_angularMeasurementUtils_js__WEBPACK_IMPORTED_MODULE_9__.rZ.Absolute:return h(g);case _support_angularMeasurementUtils_js__WEBPACK_IMPORTED_MODULE_9__.rZ.Relative:{const e=x();if(null==e)return;return h(e+g)}case _support_angularMeasurementUtils_js__WEBPACK_IMPORTED_MODULE_9__.rZ.RelativeBilateral:{const e=x();if(null==e)return;return(0,_constraints_js__WEBPACK_IMPORTED_MODULE_7__.xW)([h(e+g),h(e-g)])}}}(e,n,t)}}function V(e){return"geodesic"===e.context.mode?P(null,null,e):q(e)}function k(e,n,t){const{context:r,x:o,y:i,distance:l,direction:u,elevation:s}=t;return"geodesic"===r.mode?P(n,e,t):null!=o||null!=i?q(t):function z(e){let n;for(const t of e)t&&(n=n?.intersect(t)??t);return n}([b(e,l,r),A(e,n,u,r),B(s,r)])}function q({x:e,y:n,elevation:t,context:r}){J.x=e?.value??0,J.y=n?.value??0,J.spatialReference=r.spatialReference;const o=G(J,r,F);return new _constraints_js__WEBPACK_IMPORTED_MODULE_7__.QT(null!=e&&null!=o?o[0]:void 0,null!=n&&null!=o?o[1]:void 0,C(t,r))}function G(e,n,t=(0,_normalizedPoint_js__WEBPACK_IMPORTED_MODULE_8__.Hh)()){const{view:r,elevationInfo:o,measurementSR:l,origin:u,mode:s}=n;if((0,_normalizedPoint_js__WEBPACK_IMPORTED_MODULE_8__.vf)(e,r,o,t),(0,_geometry_projection_projectVectorToVector_js__WEBPACK_IMPORTED_MODULE_4__.F)(t,e.spatialReference,t,l))return"geodesic"!==s&&(0,_chunks_vec32_js__WEBPACK_IMPORTED_MODULE_2__.d)(t,t,u),t}function W(e,n,t,r){const{view:o,measurementSR:i,spatialReference:s,origin:a,mode:f}=t;if("geodesic"===f?(0,_chunks_vec32_js__WEBPACK_IMPORTED_MODULE_2__.c)(H,e):(0,_chunks_vec32_js__WEBPACK_IMPORTED_MODULE_2__.g)(H,e,a),(0,_geometry_projection_projectVectorToVector_js__WEBPACK_IMPORTED_MODULE_4__.F)(H,i,H,s))return(0,_normalizedPoint_js__WEBPACK_IMPORTED_MODULE_8__.xF)(H,o,n,t,r)}function C(e,n){return function D(t,{view:o,origin:i,elevationInfo:l,hasZ:u,measurementSR:s}){if(null==t||!u)return;const c=(0,_core_unitUtils_js__WEBPACK_IMPORTED_MODULE_1__.mq)(s);if(null==c)return;const[a,f]=i,d=(0,_core_quantityUtils_js__WEBPACK_IMPORTED_MODULE_0__.l3)(t,c),p="3d"===o?.type?(0,_support_elevationInfoUtils_js__WEBPACK_IMPORTED_MODULE_6__.Fo)(o,a,f,d,s,l):d;return null!=p?(0,_core_quantityUtils_js__WEBPACK_IMPORTED_MODULE_0__.d_)(p,c):void 0}(e,n)?.value??void 0}const E=(0,_normalizedPoint_js__WEBPACK_IMPORTED_MODULE_8__.Hh)(),F=(0,_normalizedPoint_js__WEBPACK_IMPORTED_MODULE_8__.Hh)(),H=(0,_normalizedPoint_js__WEBPACK_IMPORTED_MODULE_8__.Hh)(),J=(0,_layers_graphics_dehydratedPoint_js__WEBPACK_IMPORTED_MODULE_10__.T)(0,0,0,_geometry_SpatialReference_js__WEBPACK_IMPORTED_MODULE_3__.A.WGS84)},"./node_modules/@arcgis/core/views/interactive/snapping/SnappingDragPipelineStep.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{L:()=>f});var _core_maybe_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./node_modules/@arcgis/core/core/maybe.js"),_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@arcgis/core/core/promiseUtils.js"),_core_reactiveUtils_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@arcgis/core/core/reactiveUtils.js"),_layers_graphics_dehydratedFeatureComparison_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@arcgis/core/layers/graphics/dehydratedFeatureComparison.js"),_layers_graphics_hydratedFeatures_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@arcgis/core/layers/graphics/hydratedFeatures.js"),_support_elevationInfoUtils_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/@arcgis/core/support/elevationInfoUtils.js"),_dragEventPipeline_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/@arcgis/core/views/interactive/dragEventPipeline.js"),_SnappingContext_js__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./node_modules/@arcgis/core/views/interactive/snapping/SnappingContext.js"),_support_Scheduler_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./node_modules/@arcgis/core/views/support/Scheduler.js");function f({predicate:o=()=>!0,snappingManager:i,snappingContext:l,updatingHandles:u,useZ:c=!0}){const p=new _dragEventPipeline_js__WEBPACK_IMPORTED_MODULE_5__.rh;if(null==i)return{snappingStep:[y,p],cancelSnapping:y};let f,Z=null,j=null,z=null;const T=()=>{Z=(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_7__.DC)(Z),i.doneSnapping(),j?.frameTask.remove(),j=null,f=(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_7__.xt)(f),z=null},k=function d(n,e,t){return(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_0__.sg)((async({frameTask:o,point:r,scenePoint:l,context:a,event:s,delta:u,getLastState:c},p)=>{const f=await o.schedule((()=>n.snap({point:r,scenePoint:l,context:a,signal:p})),p);if(f.valid){let l=await o.schedule((()=>f.apply()),p);const d=c();null!=d.point&&r!==d.point&&(l=n.update({point:d.point,scenePoint:d.scenePoint,context:a})),null!=d.updatePoint&&(0,_layers_graphics_dehydratedFeatureComparison_js__WEBPACK_IMPORTED_MODULE_2__.CI)(l,d.updatePoint)||(h(s.mapEnd,l,u,e),t.execute(s))}}))}(i,c,p);let w=null,I=null,U=null;return{snappingStep:[n=>{if(!o(n))return n;const{action:e}=n;if("start"===e){const{info:e}=n,t=function m(n){return"3d"===n.type?n.resourceController.scheduler.registerTask(_support_Scheduler_js__WEBPACK_IMPORTED_MODULE_6__.W6.SNAPPING):_support_Scheduler_js__WEBPACK_IMPORTED_MODULE_6__.nu}(i.view);if(j=function g(n,e,t){return{context:new _SnappingContext_js__WEBPACK_IMPORTED_MODULE_8__.e({editGeometryOperations:n.editGeometryOperations,elevationInfo:n.elevationInfo,pointer:n.pointer,vertexHandle:null!=e.info?e.info.handle:null,excludeFeature:n.excludeFeature,feature:n.feature,visualizer:n.visualizer}),originalPos:null!=e.snapOrigin?n.coordinateHelper.vectorToDehydratedPoint(e.snapOrigin):e.mapStart,originalScenePos:null!=e.scenePoints?e.scenePoints.sceneStart:null,frameTask:t}}(l,n,t),j.context.selfSnappingZ=null,!c&&null!=e){const n=function S(n,e){if(!n.hasZ())return null;const t=e.vertices;let o=null;for(const r of t){const e=n.getZ(r.pos);if(null!=o&&null!=e&&Math.abs(e-o)>1e-6)return null;null==o&&(o=e)}return o}(l.coordinateHelper,e.handle.component);null!=n&&(j.context.selfSnappingZ={value:n,elevationInfo:l.elevationInfo??_support_elevationInfoUtils_js__WEBPACK_IMPORTED_MODULE_4__.qt})}}if(null!=j){const{context:o,originalScenePos:l,originalPos:a}=j,{mapEnd:s,mapStart:p,scenePoints:d}=n,m=x(a,v(s,p)),g=v(p,a),S={...n,action:"update"},y=j.context,T=function P(n,e){return null==n||null==e?null:x(n,v(e.sceneEnd,e.sceneStart))}(l,d),C=i.update({point:m,scenePoint:T,context:o});if(U=C,h(s,C,g,c),w=m,I=T,"end"!==e){const{frameTask:n}=j;null==Z&&(Z=new AbortController),z=e=>{u.addPromise((0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_0__.QZ)(k({frameTask:n,event:S,context:y,point:m,scenePoint:T,delta:g,getLastState:()=>({point:w,scenePoint:I,updatePoint:e.forceUpdate?null:U})},Z.signal)))},z({forceUpdate:!1}),null==f&&(f=(0,_core_reactiveUtils_js__WEBPACK_IMPORTED_MODULE_1__.watch)((()=>i.options.effectiveEnabled),(()=>z?.({forceUpdate:!0}))))}}return"end"===e&&T(),n},p],cancelSnapping:n=>(T(),n)}}function x(n,[e,t,o]){const r=(0,_layers_graphics_hydratedFeatures_js__WEBPACK_IMPORTED_MODULE_3__.EL)(n);return r.x+=e,r.y+=t,r.hasZ&&(r.z+=o),r}function v(n,e){const t=n.hasZ&&e.hasZ?n.z-e.z:0;return[n.x-e.x,n.y-e.y,t]}function h(n,e,[t,o,r],i){n.x=e.x+t,n.y=e.y+o,i&&n.hasZ&&e.hasZ&&(n.z=e.z+r)}function y(n){return n}}}]);