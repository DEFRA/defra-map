"use strict";(self.webpackChunk_defra_flood_map=self.webpackChunk_defra_flood_map||[]).push([[8822],{"./node_modules/@arcgis/core/chunks/boundedPlane.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{a:()=>Z,b:()=>ks,d:()=>W,f:()=>J,g:()=>ts,h:()=>gs,u:()=>K});__webpack_require__("./node_modules/@arcgis/core/core/has.js");var _core_Logger_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@arcgis/core/core/Logger.js"),_core_mathUtils_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@arcgis/core/core/mathUtils.js"),_core_ObjectStack_js__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__("./node_modules/@arcgis/core/core/ObjectStack.js"),_core_libs_gl_matrix_2_math_mat4_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@arcgis/core/core/libs/gl-matrix-2/math/mat4.js"),_core_libs_gl_matrix_2_factories_mat4f64_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/@arcgis/core/core/libs/gl-matrix-2/factories/mat4f64.js"),_vec32_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/@arcgis/core/chunks/vec32.js"),_core_libs_gl_matrix_2_factories_vec3f64_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./node_modules/@arcgis/core/core/libs/gl-matrix-2/factories/vec3f64.js"),_geometry_support_aaBoundingRect_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./node_modules/@arcgis/core/geometry/support/aaBoundingRect.js"),_geometry_support_Axis_js__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./node_modules/@arcgis/core/geometry/support/Axis.js"),_geometry_support_lineSegment_js__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./node_modules/@arcgis/core/geometry/support/lineSegment.js"),_geometry_support_plane_js__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("./node_modules/@arcgis/core/geometry/support/plane.js"),_geometry_support_ray_js__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__("./node_modules/@arcgis/core/geometry/support/ray.js"),_geometry_support_vector_js__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__("./node_modules/@arcgis/core/geometry/support/vector.js"),_geometry_support_vectorStacks_js__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__("./node_modules/@arcgis/core/geometry/support/vectorStacks.js");const z=()=>_core_Logger_js__WEBPACK_IMPORTED_MODULE_1__.A.getLogger("esri.views.3d.support.geometryUtils.boundedPlane");const G=class D{constructor(){this.plane=(0,_geometry_support_plane_js__WEBPACK_IMPORTED_MODULE_10__.vt)(),this.origin=(0,_core_libs_gl_matrix_2_factories_vec3f64_js__WEBPACK_IMPORTED_MODULE_6__.vt)(),this.basis1=(0,_core_libs_gl_matrix_2_factories_vec3f64_js__WEBPACK_IMPORTED_MODULE_6__.vt)(),this.basis2=(0,_core_libs_gl_matrix_2_factories_vec3f64_js__WEBPACK_IMPORTED_MODULE_6__.vt)()}};function W(s=Ms){return{plane:(0,_geometry_support_plane_js__WEBPACK_IMPORTED_MODULE_10__.vt)(s.plane),origin:(0,_core_libs_gl_matrix_2_factories_vec3f64_js__WEBPACK_IMPORTED_MODULE_6__.o8)(s.origin),basis1:(0,_core_libs_gl_matrix_2_factories_vec3f64_js__WEBPACK_IMPORTED_MODULE_6__.o8)(s.basis1),basis2:(0,_core_libs_gl_matrix_2_factories_vec3f64_js__WEBPACK_IMPORTED_MODULE_6__.o8)(s.basis2)}}function Z(s,t=W()){return J(s.origin,s.basis1,s.basis2,t)}function J(s,t,i,n=W()){return(0,_vec32_js__WEBPACK_IMPORTED_MODULE_5__.c)(n.origin,s),(0,_vec32_js__WEBPACK_IMPORTED_MODULE_5__.c)(n.basis1,t),(0,_vec32_js__WEBPACK_IMPORTED_MODULE_5__.c)(n.basis2,i),K(n),function ws(s,t){Math.abs((0,_vec32_js__WEBPACK_IMPORTED_MODULE_5__.f)(s.basis1,s.basis2)/((0,_vec32_js__WEBPACK_IMPORTED_MODULE_5__.l)(s.basis1)*(0,_vec32_js__WEBPACK_IMPORTED_MODULE_5__.l)(s.basis2)))>1e-6&&z().warn(t,"Provided basis vectors are not perpendicular"),Math.abs((0,_vec32_js__WEBPACK_IMPORTED_MODULE_5__.f)(s.basis1,ys(s)))>1e-6&&z().warn(t,"Basis vectors and plane normal are not perpendicular"),Math.abs(-(0,_vec32_js__WEBPACK_IMPORTED_MODULE_5__.f)(ys(s),s.origin)-s.plane[3])>1e-6&&z().warn(t,"Plane offset is not consistent with plane origin")}(n,"fromValues()"),n}function K(s){(0,_geometry_support_plane_js__WEBPACK_IMPORTED_MODULE_10__.mR)(s.basis2,s.basis1,s.origin,s.plane)}function Q(s,t,i){s!==i&&Z(s,i);const n=(0,_vec32_js__WEBPACK_IMPORTED_MODULE_5__.h)(_geometry_support_vectorStacks_js__WEBPACK_IMPORTED_MODULE_13__.rq.get(),ys(s),t);return(0,_vec32_js__WEBPACK_IMPORTED_MODULE_5__.g)(i.origin,i.origin,n),i.plane[3]-=t,i}function ts(s,t=W()){const i=(s[2]-s[0])/2,n=(s[3]-s[1])/2;return(0,_vec32_js__WEBPACK_IMPORTED_MODULE_5__.i)(t.origin,s[0]+i,s[1]+n,0),(0,_vec32_js__WEBPACK_IMPORTED_MODULE_5__.i)(t.basis1,i,0,0),(0,_vec32_js__WEBPACK_IMPORTED_MODULE_5__.i)(t.basis2,0,n,0),(0,_geometry_support_plane_js__WEBPACK_IMPORTED_MODULE_10__.fA)(0,0,1,0,t.plane),t}function is(s,t,i){return!!(0,_geometry_support_plane_js__WEBPACK_IMPORTED_MODULE_10__.Ui)(s.plane,t,i)&&Ps(s,i)}function rs(s,i,n){const r=Ss.get();xs(s,i,r,Ss.get());let o=Number.POSITIVE_INFINITY;for(const e of Es){const c=Ns(s,e,Ts.get()),u=_geometry_support_vectorStacks_js__WEBPACK_IMPORTED_MODULE_13__.rq.get();if((0,_geometry_support_plane_js__WEBPACK_IMPORTED_MODULE_10__.T7)(r,c,u)){const s=(0,_vec32_js__WEBPACK_IMPORTED_MODULE_5__.o)(_geometry_support_vectorStacks_js__WEBPACK_IMPORTED_MODULE_13__.rq.get(),i.origin,u),r=Math.abs((0,_core_mathUtils_js__WEBPACK_IMPORTED_MODULE_2__.XM)((0,_vec32_js__WEBPACK_IMPORTED_MODULE_5__.f)(i.direction,s)));r<o&&(o=r,(0,_vec32_js__WEBPACK_IMPORTED_MODULE_5__.c)(n,u))}}return o===Number.POSITIVE_INFINITY?es(s,i,n):n}function es(s,t,i){if(is(s,t,i))return i;const n=Ss.get(),r=Ss.get();xs(s,t,n,r);let o=Number.POSITIVE_INFINITY;for(const e of Es){const c=Ns(s,e,Ts.get()),u=_geometry_support_vectorStacks_js__WEBPACK_IMPORTED_MODULE_13__.rq.get();if((0,_geometry_support_plane_js__WEBPACK_IMPORTED_MODULE_10__.gv)(n,c,u)){const s=(0,_geometry_support_ray_js__WEBPACK_IMPORTED_MODULE_11__.kb)(t,u);if(!(0,_geometry_support_plane_js__WEBPACK_IMPORTED_MODULE_10__.Tj)(r,u))continue;s<o&&(o=s,(0,_vec32_js__WEBPACK_IMPORTED_MODULE_5__.c)(i,u))}}return us(s,t.origin)<o&&as(s,t.origin,i),i}function as(s,t,i){const n=(0,_geometry_support_plane_js__WEBPACK_IMPORTED_MODULE_10__._I)(s.plane,t,_geometry_support_vectorStacks_js__WEBPACK_IMPORTED_MODULE_13__.rq.get()),r=(0,_geometry_support_lineSegment_js__WEBPACK_IMPORTED_MODULE_9__.H6)(vs(s,s.basis1),n,-1,1,_geometry_support_vectorStacks_js__WEBPACK_IMPORTED_MODULE_13__.rq.get()),o=(0,_geometry_support_lineSegment_js__WEBPACK_IMPORTED_MODULE_9__.H6)(vs(s,s.basis2),n,-1,1,_geometry_support_vectorStacks_js__WEBPACK_IMPORTED_MODULE_13__.rq.get());return(0,_vec32_js__WEBPACK_IMPORTED_MODULE_5__.d)(i,(0,_vec32_js__WEBPACK_IMPORTED_MODULE_5__.g)(_geometry_support_vectorStacks_js__WEBPACK_IMPORTED_MODULE_13__.rq.get(),r,o),s.origin),i}function cs(s,t,i){const{origin:n,basis1:r,basis2:o}=s,e=(0,_vec32_js__WEBPACK_IMPORTED_MODULE_5__.d)(_geometry_support_vectorStacks_js__WEBPACK_IMPORTED_MODULE_13__.rq.get(),t,n),a=(0,_geometry_support_vector_js__WEBPACK_IMPORTED_MODULE_12__.gr)(r,e),c=(0,_geometry_support_vector_js__WEBPACK_IMPORTED_MODULE_12__.gr)(o,e),u=(0,_geometry_support_vector_js__WEBPACK_IMPORTED_MODULE_12__.gr)(ys(s),e);return(0,_vec32_js__WEBPACK_IMPORTED_MODULE_5__.i)(i,a,c,u)}function us(s,t){const i=cs(s,t,_geometry_support_vectorStacks_js__WEBPACK_IMPORTED_MODULE_13__.rq.get()),{basis1:n,basis2:r}=s,o=(0,_vec32_js__WEBPACK_IMPORTED_MODULE_5__.l)(n),e=(0,_vec32_js__WEBPACK_IMPORTED_MODULE_5__.l)(r),a=Math.max(Math.abs(i[0])-o,0),c=Math.max(Math.abs(i[1])-e,0),u=i[2];return a*a+c*c+u*u}function gs(s,t){return Math.sqrt(us(s,t))}function ls(s,t){const i=-s.plane[3];return(0,_geometry_support_vector_js__WEBPACK_IMPORTED_MODULE_12__.gr)(ys(s),t)-i}function ys(s){return(0,_geometry_support_plane_js__WEBPACK_IMPORTED_MODULE_10__.Qj)(s.plane)}function Ps(s,t){const i=(0,_vec32_js__WEBPACK_IMPORTED_MODULE_5__.d)(_geometry_support_vectorStacks_js__WEBPACK_IMPORTED_MODULE_13__.rq.get(),t,s.origin),n=(0,_vec32_js__WEBPACK_IMPORTED_MODULE_5__.k)(s.basis1),r=(0,_vec32_js__WEBPACK_IMPORTED_MODULE_5__.k)(s.basis2),o=(0,_vec32_js__WEBPACK_IMPORTED_MODULE_5__.f)(s.basis1,i),e=(0,_vec32_js__WEBPACK_IMPORTED_MODULE_5__.f)(s.basis2,i);return-o-n<0&&o-n<0&&-e-r<0&&e-r<0}function vs(s,t){const i=Ts.get();return(0,_vec32_js__WEBPACK_IMPORTED_MODULE_5__.c)(i.origin,s.origin),(0,_vec32_js__WEBPACK_IMPORTED_MODULE_5__.c)(i.vector,t),i}function Ns(s,t,i){const{basis1:n,basis2:r,origin:o}=s,e=(0,_vec32_js__WEBPACK_IMPORTED_MODULE_5__.h)(_geometry_support_vectorStacks_js__WEBPACK_IMPORTED_MODULE_13__.rq.get(),n,t.origin[0]),a=(0,_vec32_js__WEBPACK_IMPORTED_MODULE_5__.h)(_geometry_support_vectorStacks_js__WEBPACK_IMPORTED_MODULE_13__.rq.get(),r,t.origin[1]);(0,_vec32_js__WEBPACK_IMPORTED_MODULE_5__.g)(i.origin,e,a),(0,_vec32_js__WEBPACK_IMPORTED_MODULE_5__.g)(i.origin,i.origin,o);const g=(0,_vec32_js__WEBPACK_IMPORTED_MODULE_5__.h)(_geometry_support_vectorStacks_js__WEBPACK_IMPORTED_MODULE_13__.rq.get(),n,t.direction[0]),b=(0,_vec32_js__WEBPACK_IMPORTED_MODULE_5__.h)(_geometry_support_vectorStacks_js__WEBPACK_IMPORTED_MODULE_13__.rq.get(),r,t.direction[1]);return(0,_vec32_js__WEBPACK_IMPORTED_MODULE_5__.h)(i.vector,(0,_vec32_js__WEBPACK_IMPORTED_MODULE_5__.g)(g,g,b),2),i}function xs(s,t,i,n){const r=ys(s);(0,_geometry_support_plane_js__WEBPACK_IMPORTED_MODULE_10__.mR)(r,t.direction,t.origin,i),(0,_geometry_support_plane_js__WEBPACK_IMPORTED_MODULE_10__.mR)((0,_geometry_support_plane_js__WEBPACK_IMPORTED_MODULE_10__.Qj)(i),r,t.origin,n)}const Ms={plane:(0,_geometry_support_plane_js__WEBPACK_IMPORTED_MODULE_10__.vt)(),origin:(0,_core_libs_gl_matrix_2_factories_vec3f64_js__WEBPACK_IMPORTED_MODULE_6__.fA)(0,0,0),basis1:(0,_core_libs_gl_matrix_2_factories_vec3f64_js__WEBPACK_IMPORTED_MODULE_6__.fA)(1,0,0),basis2:(0,_core_libs_gl_matrix_2_factories_vec3f64_js__WEBPACK_IMPORTED_MODULE_6__.fA)(0,1,0)},Ss=new _core_ObjectStack_js__WEBPACK_IMPORTED_MODULE_14__.I(_geometry_support_plane_js__WEBPACK_IMPORTED_MODULE_10__.vt),Ts=new _core_ObjectStack_js__WEBPACK_IMPORTED_MODULE_14__.I(_geometry_support_lineSegment_js__WEBPACK_IMPORTED_MODULE_9__.vt),Vs=(0,_core_libs_gl_matrix_2_factories_vec3f64_js__WEBPACK_IMPORTED_MODULE_6__.vt)(),As=new _core_ObjectStack_js__WEBPACK_IMPORTED_MODULE_14__.I((()=>W())),Es=[{origin:[-1,-1],direction:[1,0]},{origin:[1,-1],direction:[0,1]},{origin:[1,1],direction:[-1,0]},{origin:[-1,1],direction:[0,-1]}],_s=(0,_core_libs_gl_matrix_2_factories_mat4f64_js__WEBPACK_IMPORTED_MODULE_4__.vt)(),Os=(0,_core_libs_gl_matrix_2_factories_mat4f64_js__WEBPACK_IMPORTED_MODULE_4__.vt)(),ks=Object.freeze(Object.defineProperty({__proto__:null,BoundedPlaneClass:G,altitudeAt:ls,axisAt:function ps(s,t,i,n){return function Is(s,t,i){switch(t){case _geometry_support_Axis_js__WEBPACK_IMPORTED_MODULE_8__._.X:(0,_vec32_js__WEBPACK_IMPORTED_MODULE_5__.c)(i,s.basis1),(0,_vec32_js__WEBPACK_IMPORTED_MODULE_5__.n)(i,i);break;case _geometry_support_Axis_js__WEBPACK_IMPORTED_MODULE_8__._.Y:(0,_vec32_js__WEBPACK_IMPORTED_MODULE_5__.c)(i,s.basis2),(0,_vec32_js__WEBPACK_IMPORTED_MODULE_5__.n)(i,i);break;case _geometry_support_Axis_js__WEBPACK_IMPORTED_MODULE_8__._.Z:(0,_vec32_js__WEBPACK_IMPORTED_MODULE_5__.c)(i,ys(s))}return i}(s,i,n)},cameraFrustumCoverage:function os(s,t){return(t-s)/t},closestPoint:es,closestPointOnSilhouette:rs,copy:Z,copyWithoutVerify:function H(s,t){(0,_vec32_js__WEBPACK_IMPORTED_MODULE_5__.c)(t.origin,s.origin),(0,_vec32_js__WEBPACK_IMPORTED_MODULE_5__.c)(t.basis1,s.basis1),(0,_vec32_js__WEBPACK_IMPORTED_MODULE_5__.c)(t.basis2,s.basis2),(0,_geometry_support_plane_js__WEBPACK_IMPORTED_MODULE_10__.C)(t.plane,s.plane)},create:W,distance:gs,distance2:us,distanceToSilhouette:function bs(s,t){let i=Number.NEGATIVE_INFINITY;for(const n of Es){const r=Ns(s,n,Ts.get()),o=(0,_geometry_support_lineSegment_js__WEBPACK_IMPORTED_MODULE_9__.kb)(r,t);o>i&&(i=o)}return Math.sqrt(i)},elevate:Q,equals:function ds(s,t){return(0,_vec32_js__WEBPACK_IMPORTED_MODULE_5__.p)(s.basis1,t.basis1)&&(0,_vec32_js__WEBPACK_IMPORTED_MODULE_5__.p)(s.basis2,t.basis2)&&(0,_vec32_js__WEBPACK_IMPORTED_MODULE_5__.p)(s.origin,t.origin)},extrusionContainsPoint:function fs(s,t){return(0,_geometry_support_plane_js__WEBPACK_IMPORTED_MODULE_10__.Tj)(s.plane,t)&&Ps(s,t)},fromAABoundingRect:ts,fromValues:J,getExtent:function ss(s,t){const i=s.basis1[0],n=s.basis2[1],[r,o]=s.origin;return(0,_geometry_support_aaBoundingRect_js__WEBPACK_IMPORTED_MODULE_7__.fA)(r-i,o-n,r+i,o+n,t)},intersectRay:is,intersectRayClosestSilhouette:function ns(s,t,i){if(is(s,t,i))return i;const n=rs(s,t,_geometry_support_vectorStacks_js__WEBPACK_IMPORTED_MODULE_13__.rq.get());return(0,_vec32_js__WEBPACK_IMPORTED_MODULE_5__.g)(i,t.origin,(0,_vec32_js__WEBPACK_IMPORTED_MODULE_5__.h)(_geometry_support_vectorStacks_js__WEBPACK_IMPORTED_MODULE_13__.rq.get(),t.direction,(0,_vec32_js__WEBPACK_IMPORTED_MODULE_5__.j)(t.origin,n)/(0,_vec32_js__WEBPACK_IMPORTED_MODULE_5__.l)(t.direction))),i},normal:ys,projectPoint:as,projectPointLocal:cs,rotate:function js(s,t,i,n){return s!==n&&Z(s,n),(0,_core_libs_gl_matrix_2_math_mat4_js__WEBPACK_IMPORTED_MODULE_3__.$0)(Os,t,i),(0,_vec32_js__WEBPACK_IMPORTED_MODULE_5__.t)(n.basis1,s.basis1,Os),(0,_vec32_js__WEBPACK_IMPORTED_MODULE_5__.t)(n.basis2,s.basis2,Os),K(n),n},setAltitudeAt:function ms(s,t,i,n){const r=ls(s,t),o=(0,_vec32_js__WEBPACK_IMPORTED_MODULE_5__.h)(Vs,ys(s),i-r);return(0,_vec32_js__WEBPACK_IMPORTED_MODULE_5__.g)(n,t,o),n},setExtent:function $(s,t,i){return ts(t,i),Q(i,ls(s,s.origin),i),i},transform:function hs(s,t,i){return s!==i&&Z(s,i),(0,_core_libs_gl_matrix_2_math_mat4_js__WEBPACK_IMPORTED_MODULE_3__.B8)(_s,t),(0,_core_libs_gl_matrix_2_math_mat4_js__WEBPACK_IMPORTED_MODULE_3__.mg)(_s,_s),(0,_vec32_js__WEBPACK_IMPORTED_MODULE_5__.t)(i.basis1,s.basis1,_s),(0,_vec32_js__WEBPACK_IMPORTED_MODULE_5__.t)(i.basis2,s.basis2,_s),(0,_vec32_js__WEBPACK_IMPORTED_MODULE_5__.t)((0,_geometry_support_plane_js__WEBPACK_IMPORTED_MODULE_10__.Qj)(i.plane),(0,_geometry_support_plane_js__WEBPACK_IMPORTED_MODULE_10__.Qj)(s.plane),_s),(0,_vec32_js__WEBPACK_IMPORTED_MODULE_5__.t)(i.origin,s.origin,t),(0,_geometry_support_plane_js__WEBPACK_IMPORTED_MODULE_10__.mP)(i.plane,i.plane,i.origin),i},up:Ms,updateUnboundedPlane:K,wrap:function X(s,t,i){const n=As.get();return n.origin=s,n.basis1=t,n.basis2=i,n.plane=(0,_geometry_support_plane_js__WEBPACK_IMPORTED_MODULE_10__.LV)(0,0,0,0),K(n),n}},Symbol.toStringTag,{value:"Module"}))},"./node_modules/@arcgis/core/core/memoize.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{function t(t){let r,e,i=[],u=!1;return function f(...f){return u&&r===this&&function n(t,n){if(t.length!==n.length)return!1;for(let r=0;r<t.length;++r)if(t[r]!==n[r])return!1;return!0}(f,i)||(e=t.apply(this,f),r=this,i=f,u=!0),e}}__webpack_require__.d(__webpack_exports__,{B:()=>t})},"./node_modules/@arcgis/core/core/workers/WorkerHandle.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{B:()=>h});var _arrayUtils_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@arcgis/core/core/arrayUtils.js"),_handleUtils_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@arcgis/core/core/handleUtils.js"),_Logger_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@arcgis/core/core/Logger.js"),_promiseUtils_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@arcgis/core/core/promiseUtils.js"),_workers_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/@arcgis/core/core/workers/workers.js");class h{constructor(e,t,r,h,o={}){this._mainMethod=t,this._transferLists=r,this._listeners=[],this._promise=(0,_workers_js__WEBPACK_IMPORTED_MODULE_4__.ho)(e,{...o,schedule:h}).then((e=>{if(void 0===this._thread){this._thread=e,this._promise=null,o.hasInitialize&&this.broadcast({},"initialize");for(const e of this._listeners)this._connectListener(e)}else e.close()})),this._promise.catch((t=>_Logger_js__WEBPACK_IMPORTED_MODULE_2__.A.getLogger("esri.core.workers.WorkerHandle").error(`Failed to initialize ${e} worker: ${t}`)))}on(s,r){const i={removed:!1,eventName:s,callback:r,threadHandle:null};return this._listeners.push(i),this._connectListener(i),(0,_handleUtils_js__WEBPACK_IMPORTED_MODULE_1__.hA)((()=>{i.removed=!0,(0,_arrayUtils_js__WEBPACK_IMPORTED_MODULE_0__.TF)(this._listeners,i),this._thread&&null!=i.threadHandle&&i.threadHandle.remove()}))}destroy(){this._thread&&(this._thread.close(),this._thread=null),this._promise=null,this._listeners.length=0,this._transferLists={}}invoke(e,t){return this.invokeMethod(this._mainMethod,e,t)}invokeMethod(e,t,s){if(this._thread){const r=this._transferLists[e],i=r?r(t):[];return this._thread.invoke(e,t,{transferList:i,signal:s})}return this._promise?this._promise.then((()=>((0,_promiseUtils_js__WEBPACK_IMPORTED_MODULE_3__.Te)(s),this.invokeMethod(e,t,s)))):Promise.reject(null)}broadcast(e,t){return this._thread?Promise.all(this._thread.broadcast(t,e)).then((()=>{})):this._promise?this._promise.then((()=>this.broadcast(e,t))):Promise.reject()}get promise(){return this._promise}_connectListener(e){this._thread&&this._thread.on(e.eventName,e.callback).then((t=>{e.removed||(e.threadHandle=t)}))}}},"./node_modules/@arcgis/core/geometry/support/lineSegment.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{C:()=>p,Cr:()=>b,H6:()=>A,_I:()=>j,dz:()=>d,fA:()=>h,kb:()=>M,ld:()=>B,sd:()=>l,vt:()=>v});var _core_mathUtils_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@arcgis/core/core/mathUtils.js"),_core_ObjectStack_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/@arcgis/core/core/ObjectStack.js"),_chunks_vec32_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@arcgis/core/chunks/vec32.js"),_core_libs_gl_matrix_2_factories_vec3f64_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@arcgis/core/core/libs/gl-matrix-2/factories/vec3f64.js"),_vectorStacks_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@arcgis/core/geometry/support/vectorStacks.js");function v(t){return t?{origin:(0,_core_libs_gl_matrix_2_factories_vec3f64_js__WEBPACK_IMPORTED_MODULE_2__.o8)(t.origin),vector:(0,_core_libs_gl_matrix_2_factories_vec3f64_js__WEBPACK_IMPORTED_MODULE_2__.o8)(t.vector)}:{origin:(0,_core_libs_gl_matrix_2_factories_vec3f64_js__WEBPACK_IMPORTED_MODULE_2__.vt)(),vector:(0,_core_libs_gl_matrix_2_factories_vec3f64_js__WEBPACK_IMPORTED_MODULE_2__.vt)()}}function p(t,r=v()){return h(t.origin,t.vector,r)}function h(t,r,o=v()){return(0,_chunks_vec32_js__WEBPACK_IMPORTED_MODULE_1__.c)(o.origin,t),(0,_chunks_vec32_js__WEBPACK_IMPORTED_MODULE_1__.c)(o.vector,r),o}function b(t,r,e=v()){return(0,_chunks_vec32_js__WEBPACK_IMPORTED_MODULE_1__.c)(e.origin,t),(0,_chunks_vec32_js__WEBPACK_IMPORTED_MODULE_1__.d)(e.vector,r,t),e}function M(r,n){const c=(0,_chunks_vec32_js__WEBPACK_IMPORTED_MODULE_1__.d)(_vectorStacks_js__WEBPACK_IMPORTED_MODULE_3__.rq.get(),n,r.origin),s=(0,_chunks_vec32_js__WEBPACK_IMPORTED_MODULE_1__.f)(r.vector,c),u=(0,_chunks_vec32_js__WEBPACK_IMPORTED_MODULE_1__.f)(r.vector,r.vector),a=(0,_core_mathUtils_js__WEBPACK_IMPORTED_MODULE_0__.qE)(s/u,0,1),g=(0,_chunks_vec32_js__WEBPACK_IMPORTED_MODULE_1__.d)(_vectorStacks_js__WEBPACK_IMPORTED_MODULE_3__.rq.get(),(0,_chunks_vec32_js__WEBPACK_IMPORTED_MODULE_1__.h)(_vectorStacks_js__WEBPACK_IMPORTED_MODULE_3__.rq.get(),r.vector,a),c);return(0,_chunks_vec32_js__WEBPACK_IMPORTED_MODULE_1__.f)(g,g)}function j(t,r,n){return A(t,r,0,1,n)}function l(t,r,n){return(0,_chunks_vec32_js__WEBPACK_IMPORTED_MODULE_1__.g)(n,t.origin,(0,_chunks_vec32_js__WEBPACK_IMPORTED_MODULE_1__.h)(n,t.vector,r))}function A(r,n,u,a,g){const{vector:v,origin:m}=r,p=(0,_chunks_vec32_js__WEBPACK_IMPORTED_MODULE_1__.d)(_vectorStacks_js__WEBPACK_IMPORTED_MODULE_3__.rq.get(),n,m),h=(0,_chunks_vec32_js__WEBPACK_IMPORTED_MODULE_1__.f)(v,p)/(0,_chunks_vec32_js__WEBPACK_IMPORTED_MODULE_1__.k)(v);return(0,_chunks_vec32_js__WEBPACK_IMPORTED_MODULE_1__.h)(g,v,(0,_core_mathUtils_js__WEBPACK_IMPORTED_MODULE_0__.qE)(h,u,a)),(0,_chunks_vec32_js__WEBPACK_IMPORTED_MODULE_1__.g)(g,g,r.origin)}function d(t,r){if(k(t,function m(t,r){const n=S.get();return n.origin=t,n.vector=r,n}(r.origin,r.direction),!1,x)){const{tA:r,pB:n,distance2:o}=x;if(r>=0&&r<=1)return o;if(r<0)return(0,_chunks_vec32_js__WEBPACK_IMPORTED_MODULE_1__.s)(t.origin,n);if(r>1)return(0,_chunks_vec32_js__WEBPACK_IMPORTED_MODULE_1__.s)((0,_chunks_vec32_js__WEBPACK_IMPORTED_MODULE_1__.g)(_vectorStacks_js__WEBPACK_IMPORTED_MODULE_3__.rq.get(),t.origin,t.vector),n)}return null}function B(t,r,o){return!!k(t,r,!0,x)&&((0,_chunks_vec32_js__WEBPACK_IMPORTED_MODULE_1__.c)(o,x.pA),!0)}function k(r,n,o,e){const i=1e-6,s=r.origin,a=(0,_chunks_vec32_js__WEBPACK_IMPORTED_MODULE_1__.g)(_vectorStacks_js__WEBPACK_IMPORTED_MODULE_3__.rq.get(),s,r.vector),g=n.origin,v=(0,_chunks_vec32_js__WEBPACK_IMPORTED_MODULE_1__.g)(_vectorStacks_js__WEBPACK_IMPORTED_MODULE_3__.rq.get(),g,n.vector),m=_vectorStacks_js__WEBPACK_IMPORTED_MODULE_3__.rq.get(),p=_vectorStacks_js__WEBPACK_IMPORTED_MODULE_3__.rq.get();if(m[0]=s[0]-g[0],m[1]=s[1]-g[1],m[2]=s[2]-g[2],p[0]=v[0]-g[0],p[1]=v[1]-g[1],p[2]=v[2]-g[2],Math.abs(p[0])<i&&Math.abs(p[1])<i&&Math.abs(p[2])<i)return!1;const h=_vectorStacks_js__WEBPACK_IMPORTED_MODULE_3__.rq.get();if(h[0]=a[0]-s[0],h[1]=a[1]-s[1],h[2]=a[2]-s[2],Math.abs(h[0])<i&&Math.abs(h[1])<i&&Math.abs(h[2])<i)return!1;const b=m[0]*p[0]+m[1]*p[1]+m[2]*p[2],M=p[0]*h[0]+p[1]*h[1]+p[2]*h[2],j=m[0]*h[0]+m[1]*h[1]+m[2]*h[2],l=p[0]*p[0]+p[1]*p[1]+p[2]*p[2],A=(h[0]*h[0]+h[1]*h[1]+h[2]*h[2])*l-M*M;if(Math.abs(A)<i)return!1;let d=(b*M-j*l)/A,B=(b+M*d)/l;o&&(d=(0,_core_mathUtils_js__WEBPACK_IMPORTED_MODULE_0__.qE)(d,0,1),B=(0,_core_mathUtils_js__WEBPACK_IMPORTED_MODULE_0__.qE)(B,0,1));const k=_vectorStacks_js__WEBPACK_IMPORTED_MODULE_3__.rq.get(),x=_vectorStacks_js__WEBPACK_IMPORTED_MODULE_3__.rq.get();return k[0]=s[0]+d*h[0],k[1]=s[1]+d*h[1],k[2]=s[2]+d*h[2],x[0]=g[0]+B*p[0],x[1]=g[1]+B*p[1],x[2]=g[2]+B*p[2],e.tA=d,e.tB=B,e.pA=k,e.pB=x,e.distance2=(0,_chunks_vec32_js__WEBPACK_IMPORTED_MODULE_1__.s)(k,x),!0}const x={tA:0,tB:0,pA:(0,_core_libs_gl_matrix_2_factories_vec3f64_js__WEBPACK_IMPORTED_MODULE_2__.vt)(),pB:(0,_core_libs_gl_matrix_2_factories_vec3f64_js__WEBPACK_IMPORTED_MODULE_2__.vt)(),distance2:0},S=new _core_ObjectStack_js__WEBPACK_IMPORTED_MODULE_4__.I((()=>v()))},"./node_modules/@arcgis/core/layers/support/LOD.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>p});var i,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@arcgis/core/chunks/tslib.es6.js"),_core_JSONSupport_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@arcgis/core/core/JSONSupport.js"),_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/decorators/property.js"),_core_accessorSupport_ensureType_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/ensureType.js"),_core_accessorSupport_decorators_subclass_js__WEBPACK_IMPORTED_MODULE_6__=(__webpack_require__("./node_modules/@arcgis/core/core/has.js"),__webpack_require__("./node_modules/@arcgis/core/core/RandomLCG.js"),__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/decorators/subclass.js"));let l=i=class extends _core_JSONSupport_js__WEBPACK_IMPORTED_MODULE_1__.A{constructor(e){super(e),this.cols=null,this.level=0,this.levelValue=null,this.origin=null,this.resolution=0,this.rows=null,this.scale=0}clone(){return new i({cols:this.cols,level:this.level,levelValue:this.levelValue,resolution:this.resolution,rows:this.rows,scale:this.scale})}};(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_2__.MZ)({json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],l.prototype,"cols",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_2__.MZ)({type:_core_accessorSupport_ensureType_js__WEBPACK_IMPORTED_MODULE_3__.jz,json:{write:!0}})],l.prototype,"level",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_2__.MZ)({type:String,json:{write:!0}})],l.prototype,"levelValue",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_2__.MZ)({json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],l.prototype,"origin",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_2__.MZ)({type:Number,json:{write:!0}})],l.prototype,"resolution",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_2__.MZ)({json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],l.prototype,"rows",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_2__.MZ)({type:Number,json:{write:!0}})],l.prototype,"scale",void 0),l=i=(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_subclass_js__WEBPACK_IMPORTED_MODULE_6__.$)("esri.layers.support.LOD")],l);const p=l},"./node_modules/@arcgis/core/layers/support/TileInfo.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>z});var w,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@arcgis/core/chunks/tslib.es6.js"),_core_jsonMap_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@arcgis/core/core/jsonMap.js"),_core_JSONSupport_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@arcgis/core/core/JSONSupport.js"),_core_unitUtils_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@arcgis/core/core/unitUtils.js"),_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/decorators/property.js"),_core_accessorSupport_ensureType_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/ensureType.js"),_core_accessorSupport_decorators_reader_js__WEBPACK_IMPORTED_MODULE_8__=(__webpack_require__("./node_modules/@arcgis/core/core/has.js"),__webpack_require__("./node_modules/@arcgis/core/core/RandomLCG.js"),__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/decorators/reader.js")),_core_accessorSupport_decorators_subclass_js__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/decorators/subclass.js"),_core_accessorSupport_decorators_writer_js__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/decorators/writer.js"),_geometry_Point_js__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__("./node_modules/@arcgis/core/geometry/Point.js"),_geometry_SpatialReference_js__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__("./node_modules/@arcgis/core/geometry/SpatialReference.js"),_geometry_support_aaBoundingRect_js__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__("./node_modules/@arcgis/core/geometry/support/aaBoundingRect.js"),_geometry_support_spatialReferenceUtils_js__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__("./node_modules/@arcgis/core/geometry/support/spatialReferenceUtils.js"),_geometry_support_webMercatorUtils_js__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__("./node_modules/@arcgis/core/geometry/support/webMercatorUtils.js"),_LOD_js__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__("./node_modules/@arcgis/core/layers/support/LOD.js"),_TileKey_js__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__("./node_modules/@arcgis/core/layers/support/TileKey.js");const x=new _core_jsonMap_js__WEBPACK_IMPORTED_MODULE_1__.J({PNG:"png",PNG8:"png8",PNG24:"png24",PNG32:"png32",JPEG:"jpg",JPG:"jpg",DIB:"dib",TIFF:"tiff",EMF:"emf",PS:"ps",PDF:"pdf",GIF:"gif",SVG:"svg",SVGZ:"svgz",Mixed:"mixed",MIXED:"mixed",LERC:"lerc",LERC2D:"lerc2d",RAW:"raw",pbf:"pbf"});let j=w=class extends _core_JSONSupport_js__WEBPACK_IMPORTED_MODULE_2__.A{static create(e={}){const{resolutionFactor:t=1,scales:o,size:r=256,spatialReference:i=_geometry_SpatialReference_js__WEBPACK_IMPORTED_MODULE_12__.A.WebMercator,numLODs:l=24}=e;if(!(0,_geometry_support_spatialReferenceUtils_js__WEBPACK_IMPORTED_MODULE_14__.fn)(i)){const e=[];if(o)for(let t=0;t<o.length;t++){const s=o[t];e.push(new _LOD_js__WEBPACK_IMPORTED_MODULE_16__.A({level:t,scale:s,resolution:s}))}else{let t=5e-4;for(let o=l-1;o>=0;o--)e.unshift(new _LOD_js__WEBPACK_IMPORTED_MODULE_16__.A({level:o,scale:t,resolution:t})),t*=2}return new w({dpi:96,lods:e,origin:new _geometry_Point_js__WEBPACK_IMPORTED_MODULE_11__.default(0,0,i),size:[r,r],spatialReference:i})}const n=(0,_geometry_support_spatialReferenceUtils_js__WEBPACK_IMPORTED_MODULE_14__.Vp)(i),p=e.origin?new _geometry_Point_js__WEBPACK_IMPORTED_MODULE_11__.default({x:e.origin.x,y:e.origin.y,spatialReference:i}):new _geometry_Point_js__WEBPACK_IMPORTED_MODULE_11__.default(n?{x:n.origin[0],y:n.origin[1],spatialReference:i}:{x:0,y:0,spatialReference:i}),d=1/(39.37*(0,_core_unitUtils_js__WEBPACK_IMPORTED_MODULE_3__.GA)(i)*96),g=[];if(o)for(let s=0;s<o.length;s++){const e=o[s],t=e*d;g.push(new _LOD_js__WEBPACK_IMPORTED_MODULE_16__.A({level:s,scale:e,resolution:t}))}else{let e=(0,_geometry_support_spatialReferenceUtils_js__WEBPACK_IMPORTED_MODULE_14__.EA)(i)?512/r*591657527.5917094:256/r*591657527.591555;const o=Math.ceil(l/t);g.push(new _LOD_js__WEBPACK_IMPORTED_MODULE_16__.A({level:0,scale:e,resolution:e*d}));for(let s=1;s<o;s++){const o=e/2**t,r=o*d;g.push(new _LOD_js__WEBPACK_IMPORTED_MODULE_16__.A({level:s,scale:o,resolution:r})),e=o}}return new w({dpi:96,lods:g,origin:p,size:[r,r],spatialReference:i})}constructor(e){super(e),this.dpi=96,this.format=null,this.origin=null,this.size=null,this.spatialReference=null}get isWrappable(){const{spatialReference:e,origin:t}=this;if(e&&t){const o=(0,_geometry_support_spatialReferenceUtils_js__WEBPACK_IMPORTED_MODULE_14__.Vp)(e);return e.isWrappable&&!!o&&Math.abs(o.origin[0]-t.x)<=o.dx}return!1}readOrigin(e,t){return _geometry_Point_js__WEBPACK_IMPORTED_MODULE_11__.default.fromJSON({spatialReference:t.spatialReference,...e})}set lods(e){let t=0,o=0;const s=[],r=this._levelToLOD={};e&&(t=-1/0,o=1/0,e.forEach((e=>{s.push(e.scale),t=e.scale>t?e.scale:t,o=e.scale<o?e.scale:o,r[e.level]=e}))),this._set("scales",s),this._set("lods",e),this._initializeUpsampleLevels()}readSize(e,t){return[t.cols,t.rows]}writeSize(e,t){t.cols=e[0],t.rows=e[1]}zoomToScale(e){const t=this.scales;if(e<=0)return t[0];if(e>=t.length-1)return t[t.length-1];const o=Math.floor(e),s=o+1;return t[o]/(t[o]/t[s])**(e-o)}scaleToZoom(e){const t=this.scales,o=t.length-1;let s=0;for(;s<o;s++){const o=t[s],r=t[s+1];if(o<=e)return s;if(r===e)return s+1;if(o>e&&r<e)return s+Math.log(o/e)/Math.log(o/r)}return s}tileAt(e,t,o,s){const r=this.lodAt(e);if(!r)return null;let i,l;if("number"==typeof t)i=t,l=o;else if((0,_geometry_support_spatialReferenceUtils_js__WEBPACK_IMPORTED_MODULE_14__.aI)(t.spatialReference,this.spatialReference))i=t.x,l=t.y,s=o;else{const e=(0,_geometry_support_webMercatorUtils_js__WEBPACK_IMPORTED_MODULE_15__.Cv)(t,this.spatialReference);if(null==e)return null;i=e.x,l=e.y,s=o}const n=r.resolution*this.size[0],p=r.resolution*this.size[1];return s||(s=new _TileKey_js__WEBPACK_IMPORTED_MODULE_17__.U(null,0,0,0,(0,_geometry_support_aaBoundingRect_js__WEBPACK_IMPORTED_MODULE_13__.vt)())),s.level=e,s.row=Math.floor((this.origin.y-l)/p+.001),s.col=Math.floor((i-this.origin.x)/n+.001),this.updateTileInfo(s),s}updateTileInfo(e,t=w.ExtrapolateOptions.NONE){let o=this.lodAt(e.level);if(!o&&t===w.ExtrapolateOptions.POWER_OF_TWO){const t=this.lods[this.lods.length-1];t.level<e.level&&(o=t)}if(!o)return;const s=e.level-o.level,r=o.resolution*this.size[0]/2**s,i=o.resolution*this.size[1]/2**s;e.id=`${e.level}/${e.row}/${e.col}`,e.extent||(e.extent=(0,_geometry_support_aaBoundingRect_js__WEBPACK_IMPORTED_MODULE_13__.vt)()),e.extent[0]=this.origin.x+e.col*r,e.extent[1]=this.origin.y-(e.row+1)*i,e.extent[2]=e.extent[0]+r,e.extent[3]=e.extent[1]+i}upsampleTile(e){const t=this._upsampleLevels[e.level];return!(!t||-1===t.parentLevel||(e.level=t.parentLevel,e.row=Math.floor(e.row/t.factor+.001),e.col=Math.floor(e.col/t.factor+.001),this.updateTileInfo(e),0))}getTileBounds(e,t){const o=this.lodAt(t.level);if(null==o)return null;const{resolution:s}=o,r=s*this.size[0],i=s*this.size[1];return e[0]=this.origin.x+t.col*r,e[1]=this.origin.y-(t.row+1)*i,e[2]=e[0]+r,e[3]=e[1]+i,e}lodAt(e){return this._levelToLOD?.[e]??null}clone(){return w.fromJSON(this.write({}))}getCompatibleForVTL(e){if(this.size[0]!==this.size[1]||256===this.size[0]&&512===e)return null;const t=(512===this.size[0]&&256===e?-1:0)+(this.spatialReference.isGeographic?1:0);if(this.size[0]===e&&0===t)return this;const o=[],s=this.lods.length-t;for(let r=0;r<s;r++){const e=r+t,{scale:s,resolution:i}=e>=0?this.lods[e]:{scale:2*this.lods[0].scale,resolution:2*this.lods[0].resolution};o.push(new _LOD_js__WEBPACK_IMPORTED_MODULE_16__.A({level:r,scale:s,resolution:i}))}return new w({size:[e,e],dpi:this.dpi,format:this.format,compressionQuality:this.compressionQuality,origin:this.origin,spatialReference:this.spatialReference,lods:o})}_initializeUpsampleLevels(){const e=this.lods;this._upsampleLevels=[];let t=null;for(let o=0;o<e.length;o++){const s=e[o];this._upsampleLevels[s.level]={parentLevel:t?t.level:-1,factor:t?t.resolution/s.resolution:0},t=s}}};var e,t;(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_4__.MZ)({type:Number,json:{write:!0}})],j.prototype,"compressionQuality",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_4__.MZ)({type:Number,json:{write:!0}})],j.prototype,"dpi",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_4__.MZ)({type:String,json:{read:x.read,write:x.write,origins:{"web-scene":{read:!1,write:!1}}}})],j.prototype,"format",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_4__.MZ)({readOnly:!0})],j.prototype,"isWrappable",null),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_4__.MZ)({type:_geometry_Point_js__WEBPACK_IMPORTED_MODULE_11__.default,json:{write:!0}})],j.prototype,"origin",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_reader_js__WEBPACK_IMPORTED_MODULE_8__.w)("origin")],j.prototype,"readOrigin",null),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_4__.MZ)({type:[_LOD_js__WEBPACK_IMPORTED_MODULE_16__.A],value:null,json:{write:!0}})],j.prototype,"lods",null),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_4__.MZ)({readOnly:!0})],j.prototype,"scales",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_4__.MZ)({cast:e=>Array.isArray(e)?e:"number"==typeof e?[e,e]:[256,256]})],j.prototype,"size",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_reader_js__WEBPACK_IMPORTED_MODULE_8__.w)("size",["rows","cols"])],j.prototype,"readSize",null),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_writer_js__WEBPACK_IMPORTED_MODULE_10__.K)("size",{cols:{type:_core_accessorSupport_ensureType_js__WEBPACK_IMPORTED_MODULE_5__.jz},rows:{type:_core_accessorSupport_ensureType_js__WEBPACK_IMPORTED_MODULE_5__.jz}})],j.prototype,"writeSize",null),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_4__.MZ)({type:_geometry_SpatialReference_js__WEBPACK_IMPORTED_MODULE_12__.A,json:{write:!0}})],j.prototype,"spatialReference",void 0),j=w=(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_subclass_js__WEBPACK_IMPORTED_MODULE_9__.$)("esri.layers.support.TileInfo")],j),e=j||(j={}),(t=e.ExtrapolateOptions||(e.ExtrapolateOptions={}))[t.NONE=0]="NONE",t[t.POWER_OF_TWO=1]="POWER_OF_TWO";const z=j},"./node_modules/@arcgis/core/layers/support/TileKey.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{U:()=>t});class t{constructor(t,s,i,o,e=void 0){this.id=t,this.level=s,this.row=i,this.col=o,this.extent=e}}},"./node_modules/@arcgis/core/views/interactive/snapping/candidates/VertexSnappingCandidate.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{C:()=>r});var _sketch_constraints_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@arcgis/core/views/interactive/sketch/constraints.js"),_FeatureSnappingCandidate_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@arcgis/core/views/interactive/snapping/candidates/FeatureSnappingCandidate.js"),_hints_PointSnappingHint_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@arcgis/core/views/interactive/snapping/hints/PointSnappingHint.js");class r extends _FeatureSnappingCandidate_js__WEBPACK_IMPORTED_MODULE_1__.w{constructor(n){super({...n,constraint:new _sketch_constraints_js__WEBPACK_IMPORTED_MODULE_0__.i7(n.targetPoint)})}get hints(){return[new _hints_PointSnappingHint_js__WEBPACK_IMPORTED_MODULE_2__._(this.targetPoint,this.isDraped,this.domain)]}}},"./node_modules/@arcgis/core/views/interactive/snapping/featureSources/FeatureServiceSnappingSource.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{FeatureServiceSnappingSource:()=>O});var tslib_es6=__webpack_require__("./node_modules/@arcgis/core/chunks/tslib.es6.js"),Accessor=__webpack_require__("./node_modules/@arcgis/core/core/Accessor.js"),asyncUtils=__webpack_require__("./node_modules/@arcgis/core/core/asyncUtils.js"),handleUtils=__webpack_require__("./node_modules/@arcgis/core/core/handleUtils.js"),memoize=__webpack_require__("./node_modules/@arcgis/core/core/memoize.js"),promiseUtils=__webpack_require__("./node_modules/@arcgis/core/core/promiseUtils.js"),reactiveUtils=__webpack_require__("./node_modules/@arcgis/core/core/reactiveUtils.js"),sql=__webpack_require__("./node_modules/@arcgis/core/core/sql.js"),property=__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/decorators/property.js"),subclass=(__webpack_require__("./node_modules/@arcgis/core/core/has.js"),__webpack_require__("./node_modules/@arcgis/core/core/Logger.js"),__webpack_require__("./node_modules/@arcgis/core/core/RandomLCG.js"),__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/decorators/subclass.js")),UpdatingHandles=__webpack_require__("./node_modules/@arcgis/core/core/support/UpdatingHandles.js"),layerUtils=__webpack_require__("./node_modules/@arcgis/core/layers/support/layerUtils.js"),elevationInfoUtils=__webpack_require__("./node_modules/@arcgis/core/support/elevationInfoUtils.js"),TileKey=__webpack_require__("./node_modules/@arcgis/core/layers/support/TileKey.js"),vec32=__webpack_require__("./node_modules/@arcgis/core/chunks/vec32.js"),vec3f64=__webpack_require__("./node_modules/@arcgis/core/core/libs/gl-matrix-2/factories/vec3f64.js"),boundedPlane=__webpack_require__("./node_modules/@arcgis/core/chunks/boundedPlane.js");function a(s,e){return(0,boundedPlane.g)(e.extent,c),(0,boundedPlane.h)(c,(0,vec32.i)(n,s.x,s.y,0))}const c=(0,boundedPlane.d)(),n=(0,vec3f64.vt)();var layerViewUtils=__webpack_require__("./node_modules/@arcgis/core/views/support/layerViewUtils.js");let p=class extends Accessor.A{get tiles(){const e=this.tilesCoveringView,t=null!=this.pointOfInterest?this.pointOfInterest:this.view.center;return e.sort(((e,i)=>a(t,e)-a(t,i))),e}_scaleEnabled(){return(0,layerViewUtils.JU)(this.view.scale,this.layer.minScale||0,this.layer.maxScale||0)}get tilesCoveringView(){if(!this.view.ready||!this.view.featuresTilingScheme||!this.view.state||null==this.tileInfo)return[];if(!this._scaleEnabled)return[];const{spans:e,lodInfo:t}=this.view.featuresTilingScheme.getTileCoverage(this.view.state,0),{level:i}=t,r=[];for(const{row:o,colFrom:s,colTo:n}of e)for(let e=s;e<=n;e++){const s=t.normalizeCol(e),n=new TileKey.U(null,i,o,s);this.tileInfo.updateTileInfo(n),r.push(n)}return r}get tileInfo(){return this.view.featuresTilingScheme?.tileInfo??null}get tileSize(){return null!=this.tileInfo?this.tileInfo.size[0]:256}constructor(e){super(e),this.pointOfInterest=null}initialize(){this.addHandles((0,reactiveUtils.watch)((()=>this.view?.state?.viewpoint),(()=>this.notifyChange("tilesCoveringView")),reactiveUtils.OH))}};(0,tslib_es6._)([(0,property.MZ)({readOnly:!0})],p.prototype,"tiles",null),(0,tslib_es6._)([(0,property.MZ)({readOnly:!0})],p.prototype,"_scaleEnabled",null),(0,tslib_es6._)([(0,property.MZ)({readOnly:!0})],p.prototype,"tilesCoveringView",null),(0,tslib_es6._)([(0,property.MZ)({readOnly:!0})],p.prototype,"tileInfo",null),(0,tslib_es6._)([(0,property.MZ)({readOnly:!0})],p.prototype,"tileSize",null),(0,tslib_es6._)([(0,property.MZ)({constructOnly:!0})],p.prototype,"view",void 0),(0,tslib_es6._)([(0,property.MZ)({constructOnly:!0})],p.prototype,"layer",void 0),(0,tslib_es6._)([(0,property.MZ)()],p.prototype,"pointOfInterest",void 0),p=(0,tslib_es6._)([(0,subclass.$)("esri.views.2d.interactive.snapping.featureSources.featureServiceSource.FeatureServiceTiles2D")],p);var arrayUtils=__webpack_require__("./node_modules/@arcgis/core/core/arrayUtils.js");let FeatureServiceTiles3D_a=class extends Accessor.A{get _sortedTilesCoveringView(){const e=(this.view.featureTiles?.tiles?.toArray()??[]).map(FeatureServiceTiles3D_c),t=this._effectivePointOfInterest;return null!=t&&e.sort(((e,r)=>a(t,e)-a(t,r))),e}get tileInfo(){return this.view.featureTiles?.tilingScheme?.toTileInfo()??null}get tileSize(){return this.view.featureTiles?.tileSize??256}get _effectivePointOfInterest(){const e=this.pointOfInterest;return null!=e?e:this.view.pointsOfInterest?.focus.location}constructor(e){super(e),this.tiles=[],this.pointOfInterest=null}initialize(){this.addHandles([(0,reactiveUtils.watch)((()=>this.view.featureTiles),(e=>{this.removeHandles(u),e&&this.addHandles(e.addClient(),u)}),reactiveUtils.Vh),(0,reactiveUtils.watch)((()=>this._sortedTilesCoveringView),(e=>this._set("tiles",e)),{initial:!0,equals:(e,t)=>(0,arrayUtils.aI)(e,t,((e,t)=>e.id===t.id))})])}};function FeatureServiceTiles3D_c({lij:[e,t,r],extent:i}){return new TileKey.U(`${e}/${t}/${r}`,e,t,r,i)}(0,tslib_es6._)([(0,property.MZ)({readOnly:!0})],FeatureServiceTiles3D_a.prototype,"tiles",void 0),(0,tslib_es6._)([(0,property.MZ)({readOnly:!0})],FeatureServiceTiles3D_a.prototype,"_sortedTilesCoveringView",null),(0,tslib_es6._)([(0,property.MZ)({readOnly:!0})],FeatureServiceTiles3D_a.prototype,"tileInfo",null),(0,tslib_es6._)([(0,property.MZ)({readOnly:!0})],FeatureServiceTiles3D_a.prototype,"tileSize",null),(0,tslib_es6._)([(0,property.MZ)({constructOnly:!0})],FeatureServiceTiles3D_a.prototype,"view",void 0),(0,tslib_es6._)([(0,property.MZ)()],FeatureServiceTiles3D_a.prototype,"pointOfInterest",void 0),(0,tslib_es6._)([(0,property.MZ)()],FeatureServiceTiles3D_a.prototype,"_effectivePointOfInterest",null),FeatureServiceTiles3D_a=(0,tslib_es6._)([(0,subclass.$)("esri.views.3d.interactive.snapping.featureSources.featureServiceSource.FeatureServiceTiles3D")],FeatureServiceTiles3D_a);const u="feature-tiles";var snappingUtils=__webpack_require__("./node_modules/@arcgis/core/views/interactive/snapping/snappingUtils.js"),queryEngineUtils=__webpack_require__("./node_modules/@arcgis/core/views/interactive/snapping/featureSources/queryEngineUtils.js"),Polygon=__webpack_require__("./node_modules/@arcgis/core/geometry/Polygon.js"),aaBoundingRect=__webpack_require__("./node_modules/@arcgis/core/geometry/support/aaBoundingRect.js"),Color=__webpack_require__("./node_modules/@arcgis/core/Color.js"),Graphic=__webpack_require__("./node_modules/@arcgis/core/Graphic.js"),Collection=__webpack_require__("./node_modules/@arcgis/core/core/Collection.js"),mathUtils=__webpack_require__("./node_modules/@arcgis/core/core/mathUtils.js"),PointSymbol3D=__webpack_require__("./node_modules/@arcgis/core/symbols/PointSymbol3D.js"),SimpleFillSymbol=__webpack_require__("./node_modules/@arcgis/core/symbols/SimpleFillSymbol.js"),TextSymbol=__webpack_require__("./node_modules/@arcgis/core/symbols/TextSymbol.js"),TextSymbol3DLayer=__webpack_require__("./node_modules/@arcgis/core/symbols/TextSymbol3DLayer.js"),LineCallout3D=__webpack_require__("./node_modules/@arcgis/core/symbols/callouts/LineCallout3D.js"),LineCallout3DBorder=__webpack_require__("./node_modules/@arcgis/core/symbols/callouts/LineCallout3DBorder.js"),Symbol3DVerticalOffset=__webpack_require__("./node_modules/@arcgis/core/symbols/support/Symbol3DVerticalOffset.js");const TileTreeDebugger_u=[[0,179,255],[117,62,128],[0,104,255],[215,189,166],[32,0,193],[98,162,206],[102,112,129],[52,125,0],[142,118,246],[138,83,0],[92,122,255],[122,55,83],[0,142,255],[81,40,179],[0,200,244],[13,24,127],[0,170,147],[19,58,241],[22,44,35]];let d=class extends Accessor.A{constructor(e){super(e),this.updating=!1,this.enablePolygons=!0,this.enableLabels=!0,this._polygons=new Map,this._labels=new Map,this._enabled=!0}initialize(){this._symbols=TileTreeDebugger_u.map((e=>new SimpleFillSymbol.A({color:[e[0],e[1],e[2],.6],outline:{color:"black",width:1}}))),this.update()}destroy(){this._enabled=!1,this.clear()}get enabled(){return this._enabled}set enabled(e){this._enabled!==e&&(this._enabled=e,this.update())}update(){if(!this._enabled)return void this.clear();const t=this.getTiles(),i=new Array,a=new Set((this._labels.size,this._labels.keys()));t.forEach(((m,u)=>{const d=m.lij.toString();a.delete(d);const g=m.measures?.lodLevel??m.level,f=m.geometry;if(this.enablePolygons&&!this._polygons.has(d)){const e=new Graphic.default({geometry:f,symbol:this._symbols[g%this._symbols.length]});this._polygons.set(d,e),i.push(e)}if(this.enableLabels){const a=(e=>{if(null!=e.label)return e.label;let s=e.lij.toString();return null!=e.loadPriority&&(s+=` (${e.loadPriority})`),e.measures&&(s+=`[${e.measures.lodLevel}]`),s})(m),g=u/(t.length-1),w=(0,mathUtils.Cc)(0,200,g),_=(0,mathUtils.Cc)(20,6,g)/.75,j=null!=m.loadPriority&&m.loadPriority>=t.length,v=new Color.A([w,j?0:w,j?0:w]),S="3d"===this.view.type?()=>new PointSymbol3D.A({verticalOffset:new Symbol3DVerticalOffset.A({screenLength:40/.75}),callout:new LineCallout3D.A({color:new Color.A("white"),border:new LineCallout3DBorder.A({color:new Color.A("black")})}),symbolLayers:new Collection.A([new TextSymbol3DLayer.A({text:a,halo:{color:"white",size:1/.75},material:{color:v},size:_})])}):()=>new TextSymbol.A({text:a,haloColor:"white",haloSize:1/.75,color:v,size:_}),L=this._labels.get(d);if(L){const e=S();null!=L.symbol&&JSON.stringify(e)===JSON.stringify(L.symbol)||(L.symbol=e)}else{const e=new Graphic.default({geometry:f.extent.center,symbol:S()});this._labels.set(d,e),i.push(e)}}}));const m=new Array;a.forEach((e=>{const s=this._polygons.get(e);null!=s&&(m.push(s),this._polygons.delete(e));const o=this._labels.get(e);null!=o&&(m.push(o),this._labels.delete(e))})),this.view.graphics.removeMany(m),this.view.graphics.addMany(i)}clear(){this.view.graphics.removeMany(Array.from(this._polygons.values())),this.view.graphics.removeMany(Array.from(this._labels.values())),this._polygons.clear(),this._labels.clear()}};(0,tslib_es6._)([(0,property.MZ)({constructOnly:!0})],d.prototype,"view",void 0),(0,tslib_es6._)([(0,property.MZ)({readOnly:!0})],d.prototype,"updating",void 0),(0,tslib_es6._)([(0,property.MZ)()],d.prototype,"enabled",null),d=(0,tslib_es6._)([(0,subclass.$)("esri.views.support.TileTreeDebugger")],d);let WorkerTileTreeDebugger_n=class extends d{constructor(e){super(e)}initialize(){const e=setInterval((()=>this._fetchDebugInfo()),2e3);this.addHandles((0,handleUtils.hA)((()=>clearInterval(e))))}getTiles(){if(!this._debugInfo)return[];const e=new Map,t=new Map;this._debugInfo.storedTiles.forEach((t=>{e.set(t.data.id,t.featureCount)})),this._debugInfo.pendingTiles.forEach((r=>{e.set(r.data.id,r.featureCount),t.set(r.data.id,r.state)}));const r=r=>{const o=t.get(r),s=e.get(r)??"?";return o?`${o}:${s}\n${r}`:`store:${s}\n${r}`},o=new Map;return this._debugInfo.storedTiles.forEach((e=>{o.set(e.data.id,e.data)})),this._debugInfo.pendingTiles.forEach((e=>{o.set(e.data.id,e.data)})),Array.from(o.values()).map((e=>({lij:[e.level,e.row,e.col],level:e.level,geometry:Polygon.A.fromExtent((0,aaBoundingRect.w1)(e.extent,this.view.spatialReference)),label:r(e.id)})))}_fetchDebugInfo(){this.handle.getDebugInfo(null).then((e=>{this._debugInfo=e,this.update()}))}};(0,tslib_es6._)([(0,property.MZ)({constructOnly:!0})],WorkerTileTreeDebugger_n.prototype,"handle",void 0),WorkerTileTreeDebugger_n=(0,tslib_es6._)([(0,subclass.$)("esri.views.interactive.snapping.featureSources.WorkerTileTreeDebugger")],WorkerTileTreeDebugger_n);var maybe=__webpack_require__("./node_modules/@arcgis/core/core/maybe.js"),WorkerHandle=__webpack_require__("./node_modules/@arcgis/core/core/workers/WorkerHandle.js"),typeUtils=__webpack_require__("./node_modules/@arcgis/core/geometry/support/typeUtils.js"),dehydratedPoint=__webpack_require__("./node_modules/@arcgis/core/layers/graphics/dehydratedPoint.js");let FeatureServiceSnappingSourceWorkerHandle_u=class extends Accessor.A{get updating(){return this._updatingHandles.updating||this._workerHandleUpdating}constructor(e){super(e),this._updatingHandles=new UpdatingHandles.U,this._suspendController=null,this.schedule=null,this.hasZ=!1,this.elevationAlignPointsInFeatures=async e=>{const t=[];for(const{points:o}of e.pointsInFeatures)for(const{z:e}of o)t.push(e);return{elevations:t,drapedObjectIds:new Set,failedObjectIds:new Set}},this.queryForSymbologySnapping=async()=>({candidates:[],sourceCandidateIndices:[]}),this.availability=0,this._workerHandleUpdating=!0,this.updateOutFields=(0,promiseUtils.sg)((async(e,t)=>{await this._updatingHandles.addPromise(this._workerHandle.invokeMethod("updateOutFields",[...e],t)),this._updatingHandles.addPromise(this._workerHandle.invokeMethod("whenNotUpdating",{},t))}))}destroy(){this._suspendController=(0,maybe.DC)(this._suspendController),this._workerHandle.destroy(),this._updatingHandles.destroy()}initialize(){this._workerHandle=new y(this.schedule,{alignElevation:async(e,{signal:t})=>({result:await this.elevationAlignPointsInFeatures(e.query,t)}),getSymbologyCandidates:async(e,{signal:t})=>({result:await this.queryForSymbologySnapping(e,t)})}),this.addHandles([this._workerHandle.on("notify-updating",(({updating:e})=>this._workerHandleUpdating=e)),this._workerHandle.on("notify-availability",(({availability:e})=>this._set("availability",e)))])}async setup(e,t){const o=function FeatureServiceSnappingSourceWorkerHandle_c(e){return"multipatch"===e.geometryType||"mesh"===e.geometryType?null:{url:e.parsedUrl?.path??"",fieldsIndex:e.fieldsIndex.toJSON(),geometryType:typeUtils.gy.toJSON(e.geometryType),capabilities:e.capabilities,objectIdField:e.objectIdField,globalIdField:e.globalIdField,spatialReference:e.spatialReference.toJSON(),timeInfo:e.timeInfo?.toJSON()}}(e.layer);if(null==o)return;const i={configuration:h(e.configuration),serviceInfo:o,spatialReference:e.spatialReference.toJSON(),hasZ:this.hasZ,elevationInfo:e.layer.elevationInfo?.toJSON()};await this._updatingHandles.addPromise(this._workerHandle.invokeMethod("setup",i,t)),this._updatingHandles.addPromise(this._workerHandle.invokeMethod("whenNotUpdating",{},t))}async configure(e,t){const o=h(e);await this._updatingHandles.addPromise(this._workerHandle.invokeMethod("configure",o,t)),this._updatingHandles.addPromise(this._workerHandle.invokeMethod("whenNotUpdating",{},t))}async refresh(e){await this._updatingHandles.addPromise(this._workerHandle.invokeMethod("refresh",{},e)),this._updatingHandles.addPromise(this._workerHandle.invokeMethod("whenNotUpdating",{},e))}async fetchCandidates(e,t){const{point:o,filter:i,coordinateHelper:n}=e,a={...e,point:(0,dehydratedPoint.T)(o[0],o[1],o[2],n.spatialReference.toJSON()),filter:i?.toJSON()};return this._workerHandle.invoke(a,t)}async updateTiles(e,t){const o={tiles:e.tiles,tileInfo:null!=e.tileInfo?e.tileInfo.toJSON():null,tileSize:e.tileSize};await this._updatingHandles.addPromise(this._workerHandle.invokeMethod("updateTiles",o,t)),this._updatingHandles.addPromise(this._workerHandle.invokeMethod("whenNotUpdating",{},t))}async handleEdits({historicMoment:e,addedFeatures:t,deletedFeatures:i,updatedFeatures:n},a){const s={historicMoment:e,addedFeatures:t?.map((({objectId:e})=>e)).filter(arrayUtils.Ru)??[],deletedFeatures:i?.map((({objectId:e,globalId:t})=>({objectId:e,globalId:t})))??[],updatedFeatures:n?.map((({objectId:e})=>e)).filter(arrayUtils.Ru)??[]};await this._updatingHandles.addPromise(this._workerHandle.invokeMethod("handleEdits",s,a)),this._updatingHandles.addPromise(this._workerHandle.invokeMethod("whenNotUpdating",{},a))}async setHistoricMoment(e,t){await this._updatingHandles.addPromise(this._workerHandle.invokeMethod("setHistoricMoment",{moment:e},t))}getDebugInfo(e){return this._workerHandle.invokeMethod("getDebugInfo",{},e)}async notifyElevationSourceChange(){await this._workerHandle.invokeMethod("notifyElevationSourceChange",{})}async notifySymbologyChange(){await this._workerHandle.invokeMethod("notifySymbologyChange",{})}async setSymbologySnappingSupported(e){await this._workerHandle.invokeMethod("setSymbologySnappingSupported",e)}async setSuspended(e){this._suspendController?.abort(),this._suspendController=new AbortController,await this._workerHandle.invokeMethod("setSuspended",e,this._suspendController.signal)}};function h(e){return{filter:null!=e.filter?e.filter.toJSON():null,customParameters:e.customParameters,viewType:e.viewType}}(0,tslib_es6._)([(0,property.MZ)({constructOnly:!0})],FeatureServiceSnappingSourceWorkerHandle_u.prototype,"schedule",void 0),(0,tslib_es6._)([(0,property.MZ)({constructOnly:!0})],FeatureServiceSnappingSourceWorkerHandle_u.prototype,"hasZ",void 0),(0,tslib_es6._)([(0,property.MZ)({constructOnly:!0})],FeatureServiceSnappingSourceWorkerHandle_u.prototype,"elevationAlignPointsInFeatures",void 0),(0,tslib_es6._)([(0,property.MZ)({constructOnly:!0})],FeatureServiceSnappingSourceWorkerHandle_u.prototype,"queryForSymbologySnapping",void 0),(0,tslib_es6._)([(0,property.MZ)({readOnly:!0})],FeatureServiceSnappingSourceWorkerHandle_u.prototype,"updating",null),(0,tslib_es6._)([(0,property.MZ)({readOnly:!0})],FeatureServiceSnappingSourceWorkerHandle_u.prototype,"availability",void 0),(0,tslib_es6._)([(0,property.MZ)()],FeatureServiceSnappingSourceWorkerHandle_u.prototype,"_workerHandleUpdating",void 0),FeatureServiceSnappingSourceWorkerHandle_u=(0,tslib_es6._)([(0,subclass.$)("esri.views.interactive.snapping.featureSources.featureServiceSource.FeatureServiceSnappingSourceWorkerHandle")],FeatureServiceSnappingSourceWorkerHandle_u);class y extends WorkerHandle.B{constructor(e,t){super("FeatureServiceSnappingSourceWorker","fetchCandidates",{},e,{strategy:"dedicated",client:t})}}var Point=__webpack_require__("./node_modules/@arcgis/core/geometry/Point.js"),LOD=__webpack_require__("./node_modules/@arcgis/core/layers/support/LOD.js"),TileInfo=__webpack_require__("./node_modules/@arcgis/core/layers/support/TileInfo.js");let FeatureServiceTilesSimple_a=class extends Accessor.A{get tiles(){return[new TileKey.U("0/0/0",0,0,0,(0,aaBoundingRect.fA)(-1e8,-1e8,1e8,1e8))]}get tileInfo(){return new TileInfo.default({origin:new Point.default({x:-1e8,y:1e8,spatialReference:this.layer.spatialReference}),size:[512,512],lods:[new LOD.A({level:0,scale:1,resolution:390625})],spatialReference:this.layer.spatialReference})}get tileSize(){return this.tileInfo.size[0]}constructor(e){super(e),this.pointOfInterest=null}};(0,tslib_es6._)([(0,property.MZ)({readOnly:!0})],FeatureServiceTilesSimple_a.prototype,"tiles",null),(0,tslib_es6._)([(0,property.MZ)({readOnly:!0})],FeatureServiceTilesSimple_a.prototype,"tileInfo",null),(0,tslib_es6._)([(0,property.MZ)({readOnly:!0})],FeatureServiceTilesSimple_a.prototype,"tileSize",null),(0,tslib_es6._)([(0,property.MZ)({constructOnly:!0})],FeatureServiceTilesSimple_a.prototype,"layer",void 0),(0,tslib_es6._)([(0,property.MZ)()],FeatureServiceTilesSimple_a.prototype,"pointOfInterest",void 0),FeatureServiceTilesSimple_a=(0,tslib_es6._)([(0,subclass.$)("esri.views.interactive.snapping.featureSources.featureServiceSource.FeatureServiceTilesSimple")],FeatureServiceTilesSimple_a);var debugFlags=__webpack_require__("./node_modules/@arcgis/core/views/support/debugFlags.js");let O=class extends Accessor.A{get _updateTilesParameters(){return{tiles:this._tilesOfInterest.tiles,tileInfo:this._tilesOfInterest.tileInfo,tileSize:this._tilesOfInterest.tileSize}}get _layerView(){return this.view?.allLayerViews.find((e=>e.layer===this._layer))}get _isSuspended(){return!(!(0,layerUtils.F2)(this._layer)||this.layerSource.sublayerSources.some((e=>e.enabled&&e.layer.visible)))||!(!this.view||!1===this._layerView?.suspended&&this.layerSource.enabled)}get updating(){return this._workerHandle?.updating||this._updatingHandles.updating}get _outFields(){const{view:e,_layerView:t,layerSource:r}=this,{layer:i}=r,{fieldsIndex:s,timeInfo:o,floorInfo:a,subtypeField:n}=i,l=t&&"filter"in t?t.filter:null,d=l?.where&&"1=1"!==l.where?this._getOrLoadWhereFields(l.where,s):[];if(l?.timeExtent&&o){const{startField:e,endField:t}=o,r=s.get(e)?.name??e,i=s.get(t)?.name??t;r&&d.push(r),i&&d.push(i)}if(e?.map&&(0,snappingUtils.Tu)(e.map)&&e.map.utilityNetworks?.find((e=>e.isUtilityLayer(i)))){const e=i.fieldsIndex.get("assetGroup")?.name,t=i.fieldsIndex.get("assetType")?.name;e&&t&&(d.push(e),d.push(t))}if(i&&a?.floorField&&e?.floors?.length){const e=s.get(a.floorField)?.name??a.floorField;e&&d.push(e)}if(n){const e=s.get(n)?.name??n;e&&d.push(e)}return new Set(d)}get configuration(){const{view:e}=this,{apiKey:t,customParameters:r}=this._layer,i=null!=e?e.type:"2d",s=this._layer.createQuery();return this._layerView&&"effectiveDisplayFilter"in this._layerView&&(s.where=(0,sql.mA)(s.where,this._layerView.effectiveDisplayFilter?.where)),{filter:s,customParameters:t?{...r,token:t}:r,viewType:i}}get availability(){return this._workerHandle?.availability??0}get _layer(){return this.layerSource.layer}constructor(e){super(e),this._updatingHandles=new UpdatingHandles.U,this._workerHandle=null,this._debug=null,this._memoizedMakeGetGroundElevation=(0,memoize.B)(queryEngineUtils.p)}initialize(){let e;const t=this.view;if(null==t||t.destroyed)this._tilesOfInterest=new FeatureServiceTilesSimple_a({layer:this._layer}),e=this._workerHandle=new FeatureServiceSnappingSourceWorkerHandle_u;else switch(t.type){case"2d":this._tilesOfInterest=new p({view:t,layer:this._layer}),e=this._workerHandle=new FeatureServiceSnappingSourceWorkerHandle_u;break;case"3d":{const{resourceController:r}=t,i=this._layer;this._tilesOfInterest=new FeatureServiceTiles3D_a({view:t}),e=this._workerHandle=new FeatureServiceSnappingSourceWorkerHandle_u({schedule:e=>r.immediate.schedule(e),hasZ:this._layer.hasZ&&(this._layer.returnZ??!0),elevationAlignPointsInFeatures:async(e,r)=>{const s=await t.whenLayerView(i);return(0,promiseUtils.Te)(r),s.elevationAlignPointsInFeatures(e,r)},queryForSymbologySnapping:async(e,r)=>{const s=await t.whenLayerView(i);return(0,promiseUtils.Te)(r),s.queryForSymbologySnapping(e,r)}}),this.addHandles([t.elevationProvider.on("elevation-change",(({context:t})=>{const{elevationInfo:r}=i;(0,elevationInfoUtils.Up)(t,r)&&(0,promiseUtils.QZ)(e.notifyElevationSourceChange())})),(0,reactiveUtils.watch)((()=>i.elevationInfo),(()=>(0,promiseUtils.QZ)(e.notifyElevationSourceChange())),reactiveUtils.Vh),(0,reactiveUtils.watch)((()=>this._layerView?.layer?.renderer),(()=>(0,promiseUtils.QZ)(e.notifySymbologyChange())),reactiveUtils.Vh),(0,reactiveUtils.watch)((()=>this._layerView?.symbologySnappingSupported??!1),(t=>(0,promiseUtils.QZ)(e.setSymbologySnappingSupported(t))),reactiveUtils.Vh),(0,reactiveUtils.on)((()=>this._layerView?.layer),["edits","apply-edits","graphic-update"],(()=>e.notifySymbologyChange()))]);break}}this.addHandles([(0,handleUtils.DQ)(e)]),(0,promiseUtils.QZ)(e.setup({layer:this._layer,spatialReference:this.spatialReference,configuration:this.configuration},null)),this._updatingHandles.add((()=>this._updateTilesParameters),(()=>(0,promiseUtils.QZ)(e.updateTiles(this._updateTilesParameters,null))),reactiveUtils.Vh),this.addHandles([(0,reactiveUtils.watch)((()=>this.configuration),(t=>(0,promiseUtils.QZ)(e.configure(t,null))),reactiveUtils.OH),(0,reactiveUtils.watch)((()=>this._layer.historicMoment),(t=>(0,promiseUtils.QZ)(e.setHistoricMoment(t))),reactiveUtils.pc),(0,reactiveUtils.watch)((()=>this._outFields),(t=>(0,promiseUtils.QZ)(e.updateOutFields(t))),reactiveUtils.Vh),(0,reactiveUtils.watch)((()=>this._isSuspended),(t=>(0,promiseUtils.QZ)(e.setSuspended(t))),reactiveUtils.pc)]),null!=t&&this.addHandles((0,reactiveUtils.watch)((()=>debugFlags.A.FEATURE_SERVICE_SNAPPING_SOURCE_TILE_TREE_SHOW_TILES),(r=>{r&&!this._debug?(this._debug=new WorkerTileTreeDebugger_n({view:t,handle:e}),this.addHandles((0,handleUtils.DQ)(this._debug),"debug")):!r&&this._debug&&this.removeHandles("debug")}),reactiveUtils.Vh)),this.addHandles([this.layerSource.layer.on("edits",(t=>(0,promiseUtils.QZ)(e.handleEdits(t,null)))),this.layerSource.layer.on("apply-edits",(e=>this._updatingHandles.addPromise(e.result)))])}destroy(){this._updatingHandles.destroy(),this._tilesOfInterest.destroy()}refresh(){this._workerHandle?.refresh(null)}async fetchCandidates(e,t){const{coordinateHelper:r,point:i}=e;this._tilesOfInterest.pointOfInterest=r.arrayToPoint(i);const s=this._memoizedMakeGetGroundElevation(this.view,r.spatialReference);return(await this._workerHandle.fetchCandidates({...e},t)).candidates.map((e=>(0,queryEngineUtils.$)(e,s)))}getDebugInfo(e){return this._workerHandle.getDebugInfo(e)}_getOrLoadWhereFields(e,t){const{_whereModule:i}=this;if(!this._loadWhereModuleTask&&!i){const e=(0,asyncUtils.UT)((async()=>{const e=await Promise.all([__webpack_require__.e(8921),__webpack_require__.e(624)]).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@arcgis/core/core/sql/WhereClause.js"));return this._whereModule=e.default,this._whereModule}));return this._loadWhereModuleTask=e,this._updatingHandles.addPromise(e.promise),[]}if(!i)return[];try{return i.create(e,{fieldsIndex:t}).fieldNames}catch(s){return[]}}};(0,tslib_es6._)([(0,property.MZ)({constructOnly:!0})],O.prototype,"spatialReference",void 0),(0,tslib_es6._)([(0,property.MZ)({constructOnly:!0})],O.prototype,"layerSource",void 0),(0,tslib_es6._)([(0,property.MZ)({constructOnly:!0})],O.prototype,"view",void 0),(0,tslib_es6._)([(0,property.MZ)()],O.prototype,"_tilesOfInterest",void 0),(0,tslib_es6._)([(0,property.MZ)({readOnly:!0})],O.prototype,"_updateTilesParameters",null),(0,tslib_es6._)([(0,property.MZ)()],O.prototype,"_layerView",null),(0,tslib_es6._)([(0,property.MZ)()],O.prototype,"_isSuspended",null),(0,tslib_es6._)([(0,property.MZ)({readOnly:!0})],O.prototype,"updating",null),(0,tslib_es6._)([(0,property.MZ)()],O.prototype,"_outFields",null),(0,tslib_es6._)([(0,property.MZ)({readOnly:!0})],O.prototype,"configuration",null),(0,tslib_es6._)([(0,property.MZ)({readOnly:!0})],O.prototype,"availability",null),(0,tslib_es6._)([(0,property.MZ)()],O.prototype,"_loadWhereModuleTask",void 0),(0,tslib_es6._)([(0,property.MZ)()],O.prototype,"_whereModule",void 0),O=(0,tslib_es6._)([(0,subclass.$)("esri.views.interactive.snapping.featureSources.FeatureServiceSnappingSource")],O)},"./node_modules/@arcgis/core/views/interactive/snapping/featureSources/queryEngineUtils.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{$:()=>o,p:()=>i});var _sketch_normalizedPoint_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@arcgis/core/views/interactive/sketch/normalizedPoint.js"),_candidates_DrapedEdgeSnappingCandidate_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@arcgis/core/views/interactive/snapping/candidates/DrapedEdgeSnappingCandidate.js"),_candidates_EdgeSnappingCandidate_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@arcgis/core/views/interactive/snapping/candidates/EdgeSnappingCandidate.js"),_candidates_VertexSnappingCandidate_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@arcgis/core/views/interactive/snapping/candidates/VertexSnappingCandidate.js");function a({x:e,y:n,z:d}){return(0,_sketch_normalizedPoint_js__WEBPACK_IMPORTED_MODULE_0__.fA)(e,n,d??0)}function o(t,o){switch(t.type){case"edge":return t.draped?new _candidates_DrapedEdgeSnappingCandidate_js__WEBPACK_IMPORTED_MODULE_1__.X({edgeStart:a(t.start),edgeEnd:a(t.end),targetPoint:(0,_sketch_normalizedPoint_js__WEBPACK_IMPORTED_MODULE_0__.de)(a(t.target)),objectId:t.objectId,getGroundElevation:o}):new _candidates_EdgeSnappingCandidate_js__WEBPACK_IMPORTED_MODULE_2__.z({edgeStart:a(t.start),edgeEnd:a(t.end),targetPoint:(0,_sketch_normalizedPoint_js__WEBPACK_IMPORTED_MODULE_0__.de)(a(t.target)),objectId:t.objectId,isDraped:!1});case"vertex":return new _candidates_VertexSnappingCandidate_js__WEBPACK_IMPORTED_MODULE_3__.C({targetPoint:(0,_sketch_normalizedPoint_js__WEBPACK_IMPORTED_MODULE_0__.de)(a(t.target)),objectId:t.objectId,isDraped:!1})}}function i(e,t){return null!=e&&"3d"===e.type?(n,d)=>e.elevationProvider.getElevation(n,d,0,t,"ground"):()=>null}},"./node_modules/@arcgis/core/views/interactive/snapping/hints/PointSnappingHint.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{_:()=>n});var _chunks_vec32_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@arcgis/core/chunks/vec32.js"),_SnappingHint_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@arcgis/core/views/interactive/snapping/hints/SnappingHint.js");class n extends _SnappingHint_js__WEBPACK_IMPORTED_MODULE_1__.m{constructor(t,s,n){super(s,n),this.point=t}equals(s){return s instanceof n&&(0,_chunks_vec32_js__WEBPACK_IMPORTED_MODULE_0__.p)(this.point,s.point)}}},"./node_modules/@arcgis/core/views/support/debugFlags.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>E});var _chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@arcgis/core/chunks/tslib.es6.js"),_core_Accessor_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@arcgis/core/core/Accessor.js"),_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/decorators/property.js"),_core_accessorSupport_decorators_subclass_js__WEBPACK_IMPORTED_MODULE_6__=(__webpack_require__("./node_modules/@arcgis/core/core/has.js"),__webpack_require__("./node_modules/@arcgis/core/core/Logger.js"),__webpack_require__("./node_modules/@arcgis/core/core/RandomLCG.js"),__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/decorators/subclass.js"));let e=class extends _core_Accessor_js__WEBPACK_IMPORTED_MODULE_1__.A{constructor(){super(...arguments),this.SCHEDULER_LOG_SLOW_TASKS=!1,this.FEATURE_SERVICE_SNAPPING_SOURCE_TILE_TREE_SHOW_TILES=!1}};(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_2__.MZ)()],e.prototype,"SCHEDULER_LOG_SLOW_TASKS",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_2__.MZ)()],e.prototype,"FEATURE_SERVICE_SNAPPING_SOURCE_TILE_TREE_SHOW_TILES",void 0),e=(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_subclass_js__WEBPACK_IMPORTED_MODULE_6__.$)("esri.views.support.debugFlags")],e);const E=new e}}]);