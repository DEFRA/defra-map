"use strict";(this.webpackChunkdefra_DefraMap=this.webpackChunkdefra_DefraMap||[]).push([[5],{914:(e,t,r)=>{function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}function n(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,o)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?n(Object(r),!0).forEach(function(t){a(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function a(e,t,r){return(t=function(e){var t=function(e){if("object"!=o(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=o(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==o(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}r.r(t),r.d(t,{manifest:()=>v});var l={SET_DATA_LAYERS_PROP:function(e,t){return i(i({},e),{},{dataLayersProp:t})}},s=r(738);function c(e){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c(e)}var u=function(e,t){if(!e)return null;if("string"==typeof e)return e.trim();if("object"===c(e)){if(t&&e[t])return e[t];var r=Object.values(e)[0];return null!=r?r:null}return null};function d(e){return d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},d(e)}function f(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,o)}return r}function y(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?f(Object(r),!0).forEach(function(t){p(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):f(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function p(e,t,r){return(t=function(e){var t=function(e){if("object"!=d(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=d(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==d(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var m=function(e,t,r){var o="".concat(r.id,"-source");e.getSource(o)||e.addSource(o,{type:"vector",tiles:r.tiles,minzoom:r.minZoom||0,maxzoom:r.maxZoom||22});var n=!!r.fill,i=!!r.stroke,a=n?r.id:null,l=i?n?"".concat(r.id,"-stroke"):r.id:null;if(n&&!e.getLayer(a)){var s=u(r.fill,t);e.addLayer(y({id:a,type:"fill",source:o,"source-layer":r.sourceLayer,paint:{"fill-color":s,"fill-opacity":r.opacity||1}},r.filter?{filter:r.filter}:{}))}if(i&&!e.getLayer(l)){var c=u(r.stroke,t);e.addLayer(y({id:l,type:"line",source:o,"source-layer":r.sourceLayer,paint:y({"line-color":c,"line-width":r.strokeWidth||1,"line-opacity":r.opacity||1},r.strokeDashArray?{"line-dasharray":r.strokeDashArray}:{})},r.filter?{filter:r.filter}:{}))}},b=r(287),v={InitComponent:function(e){var t,r=e.pluginConfig,o=e.appState,n=e.mapState,i=e.mapProvider,a=e.services,l=a.events,c=a.eventBus,u=!(null===(t=i.map)||void 0===t||!t.getStyle());return(0,s.useEffect)(function(){var e,t,a,s,d=null===(e=null===(t=r.includeModes)||void 0===t?void 0:t.includes(o.mode))||void 0===e||e,f=null!==(a=null===(s=r.excludeModes)||void 0===s?void 0:s.includes(o.mode))&&void 0!==a&&a;if(u&&d&&!f){var y=function(e){var t=e.layersConfig,r=e.mapStyleId,o=e.mapProvider,n=e.events,i=e.eventBus,a=o.map,l=t.layers;l.forEach(function(e){m(a,r,e)});var s=function(e){var t=e.map,r=e.events,o=e.layers,n=function(e){t.once("idle",function(){var r=e.id;o.forEach(function(e){m(t,r,e)})})};return e.eventBus.on(r.MAP_SET_STYLE,n),n}({map:a,events:n,eventBus:i,layers:l,mapStyleId:r});return{remove:function(){i.off(n.MAP_SET_STYLE,s),l.forEach(function(e){var t="".concat(e.id,"-source"),r=e.fill?e.id:null,o=e.stroke?e.fill?"".concat(e.id,"-stroke"):e.id:null;o&&a.getLayer(o)&&a.removeLayer(o),r&&a.getLayer(r)&&a.removeLayer(r),a.getSource(t)&&a.removeSource(t)})}}}({mapStyleId:n.mapStyle.id,layersConfig:r,mapSize:n.mapSize,mapProvider:i,events:l,eventBus:c});return function(){y.remove()}}},[u,o.mode]),null},reducer:{initialState:{dataLayersProp:!1},actions:l},panels:[{id:"dataSetsLayers",label:"Layers",mobile:{slot:"bottom",modal:!0,dismissable:!0},tablet:{slot:"inset",dismissable:!0,width:"300px"},desktop:{slot:"inset",modal:!1,dismissable:!0,width:"320px"},render:function(e){var t=e.pluginConfig;return(0,b.jsx)("div",{className:"dm-c-data-sets-layers",children:(0,b.jsx)("div",{className:"govuk-form-group",children:(0,b.jsxs)("fieldset",{className:"govuk-fieldset",children:[(0,b.jsx)("legend",{className:"govuk-visually-hidden",children:"Layers"}),(0,b.jsx)("div",{className:"govuk-checkboxes govuk-checkboxes--small","data-module":"govuk-checkboxes",children:t.layers.map(function(e){return(0,b.jsx)("div",{className:"dm-c-data-stes-layers__item",children:e.toggleVisibility?(0,b.jsxs)("div",{className:"govuk-checkboxes__item",children:[(0,b.jsx)("input",{className:"govuk-checkboxes__input",id:e.id,name:"layers",type:"checkbox",value:e.id}),(0,b.jsx)("label",{className:"dm-c-data-sets-layers__item-label govuk-label govuk-checkboxes__label",htmlFor:e.id,children:e.label})]}):(0,b.jsx)("div",{className:"dm-c-data-sets-layers__item-label",children:e.label})},e.id)})})]})})})}},{id:"dataSetsKey",label:"Key",mobile:{slot:"bottom",modal:!0},tablet:{slot:"inset",width:"300px"},desktop:{slot:"inset",width:"320px"},render:function(e){var t=e.mapState,r=e.pluginConfig,o=t.mapStyle,n=function(e){return(0,b.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24","aria-hidden":"true",focusable:"false",children:(0,b.jsx)("rect",{width:"24",height:"24",fill:u(e.fill,o.id),stroke:u(e.stroke,o.id),strokeWidth:"4",strokeLinejoin:"round"})})};return(0,b.jsx)("div",{className:"dm-c-data-sets-key",children:r.layers.map(function(e){return(0,b.jsx)("div",{className:"dm-c-data-sets-key__item",children:e.showInKey&&(0,b.jsxs)("div",{className:"dm-c-data-sets-key__item-label",children:[n(e),e.label,e.symbolDescription&&(0,b.jsxs)("span",{className:"govuk-visually-hidden",children:["(",u(e.symbolDescription,o.id),")"]})]})},e.id)})})}}],buttons:[{id:"dataSetsLayers",label:"Layers",panelId:"dataSetsLayers",iconId:"layers",excludeWhen:function(e){return!e.pluginConfig.layers.find(function(e){return e.toggleVisibility})},mobile:{slot:"top-left",showLabel:!0},tablet:{slot:"top-left",showLabel:!0},desktop:{slot:"top-left",showLabel:!0}},{id:"dataSetsKey",label:"Key",panelId:"dataSetsKey",iconId:"key",excludeWhen:function(e){return!e.pluginConfig.layers.find(function(e){return e.showInKey})},mobile:{slot:"top-left",showLabel:!0},tablet:{slot:"top-left",showLabel:!0},desktop:{slot:"top-left",showLabel:!0}}],icons:[{id:"layers",svgContent:'<path d="M13 13.74a2 2 0 0 1-2 0L2.5 8.87a1 1 0 0 1 0-1.74L11 2.26a2 2 0 0 1 2 0l8.5 4.87a1 1 0 0 1 0 1.74z"></path><path d="m20 14.285 1.5.845a1 1 0 0 1 0 1.74L13 21.74a2 2 0 0 1-2 0l-8.5-4.87a1 1 0 0 1 0-1.74l1.5-.845"></path>'},{id:"key",svgContent:'<path d="M3 5h.01"/><path d="M3 12h.01"/><path d="M3 19h.01"/><path d="M8 5h13"/><path d="M8 12h13"/><path d="M8 19h13"/>'}],api:{showLayer:function(e,t){e.pluginConfig,e.pluginState,console.log("showLayer:",t)},hideLayer:function(e,t){e.mapProvider,e.services,console.log("hideLayer:",t)}}}}}]);