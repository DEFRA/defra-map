"use strict";(self.webpackChunk_defra_flood_map=self.webpackChunk_defra_flood_map||[]).push([[4247],{"./node_modules/@arcgis/core/layers/support/ExportWMSImageParameters.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{r:()=>a});var _chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@arcgis/core/chunks/tslib.es6.js"),_core_Accessor_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@arcgis/core/core/Accessor.js"),_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/decorators/property.js"),_core_accessorSupport_decorators_subclass_js__WEBPACK_IMPORTED_MODULE_6__=(__webpack_require__("./node_modules/@arcgis/core/core/has.js"),__webpack_require__("./node_modules/@arcgis/core/core/Logger.js"),__webpack_require__("./node_modules/@arcgis/core/core/RandomLCG.js"),__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/decorators/subclass.js"));const o={visible:"visibleSublayers"};let a=class extends _core_Accessor_js__WEBPACK_IMPORTED_MODULE_1__.A{constructor(e){super(e),this.scale=0}set layer(e){this._get("layer")!==e&&(this._set("layer",e),this.removeHandles("layer"),e&&this.addHandles([e.sublayers.on("change",(()=>this.notifyChange("visibleSublayers"))),e.on("wms-sublayer-update",(e=>this.notifyChange(o[e.propertyName])))],"layer"))}get layers(){return this.visibleSublayers.filter((({name:e})=>e)).map((({name:e})=>e)).join()}get version(){this.commitProperty("layers");const e=this.layer;return e&&e.commitProperty("imageTransparency"),(this._get("version")||0)+1}get visibleSublayers(){const{layer:e,scale:r}=this,s=e?.sublayers,t=[],o=e=>{const{minScale:s,maxScale:a,sublayers:l,visible:i}=e;i&&(0===r||(0===s||r<=s)&&(0===a||r>=a))&&(l?l.forEach(o):t.push(e))};return s?.forEach(o),t}toJSON(){const{layer:e,layers:r}=this,{imageFormat:s,imageTransparency:t,version:o}=e;return{format:s,request:"GetMap",service:"WMS",styles:"",transparent:t?"TRUE":"FALSE",version:o,layers:r}}};(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_2__.MZ)()],a.prototype,"layer",null),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_2__.MZ)({readOnly:!0})],a.prototype,"layers",null),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_2__.MZ)({type:Number})],a.prototype,"scale",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_2__.MZ)({readOnly:!0})],a.prototype,"version",null),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_2__.MZ)({readOnly:!0})],a.prototype,"visibleSublayers",null),a=(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_subclass_js__WEBPACK_IMPORTED_MODULE_6__.$)("esri.layers.support.ExportWMSImageParameters")],a)},"./node_modules/@arcgis/core/layers/support/timeSupport.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{F:()=>timeSupport_i});__webpack_require__("./node_modules/@arcgis/core/core/arrayUtils.js"),__webpack_require__("./node_modules/@arcgis/core/core/lang.js");var timeUtils=__webpack_require__("./node_modules/@arcgis/core/core/timeUtils.js"),TimeExtent=__webpack_require__("./node_modules/@arcgis/core/time/TimeExtent.js");__webpack_require__("./node_modules/@arcgis/core/webmap/utils.js"),__webpack_require__("./node_modules/@arcgis/core/support/tagSymbols.js");function timeSupport_i(i,n,s){if(null==i?.timeInfo)return null;const{datesInUnknownTimezone:l=!1,timeOffset:o,useViewTime:m}=i;let u=i.timeExtent;l&&(u=function p(t){if(!t)return t;const{start:e,end:r}=t;return new TimeExtent.A({start:null!=e?(0,timeUtils.S1)(e,e.getTimezoneOffset(),"minutes"):e,end:null!=r?(0,timeUtils.S1)(r,r.getTimezoneOffset(),"minutes"):r})}(u));let r=m?n&&u?n.intersection(u):n||u:u;return!r||r.isEmpty||r.isAllTime?r:(o&&(r=r.offset(-o.value,o.unit)),l&&(r=function d(t){if(!t)return t;const{start:e,end:r}=t;return new TimeExtent.A({start:null!=e?(0,timeUtils.S1)(e,-e.getTimezoneOffset(),"minutes"):e,end:null!=r?(0,timeUtils.S1)(r,-r.getTimezoneOffset(),"minutes"):r})}(r)),r.equals(s)?s:r)}},"./node_modules/@arcgis/core/support/tagSymbols.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{X:()=>e});const e=Symbol("WebScene")},"./node_modules/@arcgis/core/views/2d/engine/Bitmap.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{LG:()=>g,mb:()=>S,yr:()=>f});var _core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@arcgis/core/core/promiseUtils.js"),_core_libs_gl_matrix_2_math_mat3_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@arcgis/core/core/libs/gl-matrix-2/math/mat3.js"),_core_libs_gl_matrix_2_factories_mat3f32_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@arcgis/core/core/libs/gl-matrix-2/factories/mat3f32.js"),_core_libs_gl_matrix_2_factories_vec2f32_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@arcgis/core/core/libs/gl-matrix-2/factories/vec2f32.js"),_DisplayObject_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/@arcgis/core/views/2d/engine/DisplayObject.js"),_ImageryBitmapSource_js__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./node_modules/@arcgis/core/views/2d/engine/ImageryBitmapSource.js"),_webgl_enums_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/@arcgis/core/views/webgl/enums.js"),_webgl_Texture_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./node_modules/@arcgis/core/views/webgl/Texture.js"),_webgl_TextureDescriptor_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./node_modules/@arcgis/core/views/webgl/TextureDescriptor.js");function g(t){return t&&"render"in t}function f(t){const e=document.createElement("canvas");return e.width=t.width,e.height=t.height,t.render(e.getContext("2d")),e}class S extends _DisplayObject_js__WEBPACK_IMPORTED_MODULE_4__.q{constructor(t=null,e=!1){super(),this.blendFunction="standard",this._sourceWidth=0,this._sourceHeight=0,this._textureInvalidated=!1,this.stencilRef=0,this.coordScale=[1,1],this._height=void 0,this.pixelRatio=1,this.resolution=0,this.rotation=0,this._source=null,this._texture=null,this._width=void 0,this.x=0,this.y=0,this.immutable=e,this.source=t,this.requestRender=this.requestRender.bind(this)}destroy(){this._texture&&(this._texture.dispose(),this._texture=null),null!=this._uploadStatus&&(this._uploadStatus.controller.abort(),this._uploadStatus=null)}get isSourceScaled(){return this.width!==this._sourceWidth||this.height!==this._sourceHeight}get height(){return void 0!==this._height?this._height:this._sourceHeight}set height(t){this._height=t}get source(){return this._source}set source(t){null==t&&null==this._source||(this._source=t,this.invalidateTexture(),this.requestRender())}get texture(){return this._texture}get width(){return void 0!==this._width?this._width:this._sourceWidth}set width(t){this._width=t}beforeRender(t){super.beforeRender(t),this.updateTexture(t)}async setSourceAsync(i,s){null!=this._uploadStatus&&this._uploadStatus.controller.abort();const r=new AbortController,h=(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_0__.Tw)();return(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_0__.NY)(s,(()=>r.abort())),(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_0__.NY)(r,(t=>h.reject(t))),this._uploadStatus={controller:r,resolver:h},this.source=i,h.promise}invalidateTexture(){this._textureInvalidated||(this._textureInvalidated=!0,this._source instanceof HTMLImageElement?(this._sourceHeight=this._source.naturalHeight,this._sourceWidth=this._source.naturalWidth):this._source&&(this._sourceHeight=this._source.height,this._sourceWidth=this._source.width))}transitionStep(t,e){t>=64&&(this.fadeTransitionEnabled=!1),super.transitionStep(t,e)}setTransform(t){const e=(0,_core_libs_gl_matrix_2_math_mat3_js__WEBPACK_IMPORTED_MODULE_1__.D_)(this.transforms.displayViewScreenMat3),[i,a]=t.toScreenNoRotation([0,0],[this.x,this.y]),l=this.resolution/this.pixelRatio/t.resolution,d=l*this.width,c=l*this.height,_=Math.PI*this.rotation/180;(0,_core_libs_gl_matrix_2_math_mat3_js__WEBPACK_IMPORTED_MODULE_1__.Tl)(e,e,(0,_core_libs_gl_matrix_2_factories_vec2f32_js__WEBPACK_IMPORTED_MODULE_3__.fA)(i,a)),(0,_core_libs_gl_matrix_2_math_mat3_js__WEBPACK_IMPORTED_MODULE_1__.Tl)(e,e,(0,_core_libs_gl_matrix_2_factories_vec2f32_js__WEBPACK_IMPORTED_MODULE_3__.fA)(d/2,c/2)),(0,_core_libs_gl_matrix_2_math_mat3_js__WEBPACK_IMPORTED_MODULE_1__.e$)(e,e,-_),(0,_core_libs_gl_matrix_2_math_mat3_js__WEBPACK_IMPORTED_MODULE_1__.Tl)(e,e,(0,_core_libs_gl_matrix_2_factories_vec2f32_js__WEBPACK_IMPORTED_MODULE_3__.fA)(-d/2,-c/2)),(0,_core_libs_gl_matrix_2_math_mat3_js__WEBPACK_IMPORTED_MODULE_1__.Oe)(e,e,(0,_core_libs_gl_matrix_2_factories_vec2f32_js__WEBPACK_IMPORTED_MODULE_3__.fA)(d,c)),(0,_core_libs_gl_matrix_2_math_mat3_js__WEBPACK_IMPORTED_MODULE_1__.lw)(this.transforms.displayViewScreenMat3,t.displayViewMat3,e)}setSamplingProfile(t){this._texture&&(t.mips&&!this._texture.descriptor.hasMipmap&&this._texture.generateMipmap(),this._texture.setSamplingMode(t.samplingMode))}bind(t,e){this._texture&&t.bindTexture(this._texture,e)}async updateTexture({context:t,painter:e}){if(!this._textureInvalidated)return;if(this._textureInvalidated=!1,this._texture||(this._texture=this._createTexture(t)),!this.source)return void this._texture.setData(null);this._texture.resize(this._sourceWidth,this._sourceHeight);const s=function w(t){return g(t)?t instanceof _ImageryBitmapSource_js__WEBPACK_IMPORTED_MODULE_8__.A?t.getRenderedRasterPixels()?.renderedRasterPixels:f(t):t}(this.source);try{if(null!=this._uploadStatus){const{controller:t,resolver:i}=this._uploadStatus,r={signal:t.signal},{width:h,height:o}=this,u=this._texture,a=e.textureUploadManager;await a.enqueueTextureUpdate({data:s,texture:u,width:h,height:o},r),i.resolve(),this._uploadStatus=null}else this._texture.setData(s);this.ready()}catch(r){(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_0__.jH)(r)}}onDetach(){this.destroy()}_createTransforms(){return{displayViewScreenMat3:(0,_core_libs_gl_matrix_2_factories_mat3f32_js__WEBPACK_IMPORTED_MODULE_2__.vt)()}}_createTexture(t){const e=this.immutable,i=new _webgl_TextureDescriptor_js__WEBPACK_IMPORTED_MODULE_7__.R;return i.internalFormat=e?_webgl_enums_js__WEBPACK_IMPORTED_MODULE_5__.H0.RGBA8:_webgl_enums_js__WEBPACK_IMPORTED_MODULE_5__.Ab.RGBA,i.wrapMode=_webgl_enums_js__WEBPACK_IMPORTED_MODULE_5__.pF.CLAMP_TO_EDGE,i.isImmutable=e,i.width=this._sourceWidth,i.height=this._sourceHeight,new _webgl_Texture_js__WEBPACK_IMPORTED_MODULE_6__.g(t,i)}}},"./node_modules/@arcgis/core/views/2d/engine/BitmapContainer.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{l:()=>r});var _webgl_enums_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@arcgis/core/views/2d/engine/webgl/enums.js"),_webgl_WGLContainer_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@arcgis/core/views/2d/engine/webgl/WGLContainer.js"),_webgl_shaderGraph_techniques_bitmap_BitmapTechnique_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@arcgis/core/views/2d/engine/webgl/shaderGraph/techniques/bitmap/BitmapTechnique.js");class r extends _webgl_WGLContainer_js__WEBPACK_IMPORTED_MODULE_1__.A{constructor(){super(...arguments),this._hasCrossfade=!1,this._bitmapTechnique=null}get requiresDedicatedFBO(){return super.requiresDedicatedFBO||this._hasCrossfade}beforeRender(e){super.beforeRender(e),this._manageFade()}onAttach(){super.onAttach(),this._bitmapTechnique=new _webgl_shaderGraph_techniques_bitmap_BitmapTechnique_js__WEBPACK_IMPORTED_MODULE_2__.C}onDetach(){super.onDetach(),this._bitmapTechnique?.shutdown(),this._bitmapTechnique=null}renderChildren(i){super.renderChildren(i),this.visible&&i.drawPhase===_webgl_enums_js__WEBPACK_IMPORTED_MODULE_0__.S5.MAP&&null!=this._bitmapTechnique&&this._bitmapTechnique.render(i,{bitmaps:this.children})}_manageFade(){this.children.reduce(((e,i)=>e+(i.inFadeTransition?1:0)),0)>=2?(this.children.forEach((e=>e.blendFunction="additive")),this._hasCrossfade=!0):(this.children.forEach((e=>e.blendFunction="standard")),this._hasCrossfade=!1)}}},"./node_modules/@arcgis/core/views/2d/engine/ImageryBitmapSource.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>l});class l{constructor(l,e,t){this.pixelBlock=l,this.extent=e,this.originalPixelBlock=t}get width(){return null!=this.pixelBlock?this.pixelBlock.width:0}get height(){return null!=this.pixelBlock?this.pixelBlock.height:0}render(l){const e=this.pixelBlock;if(null==e)return;const t=this.filter({extent:this.extent,pixelBlock:this.originalPixelBlock??e});if(null==t.pixelBlock)return;t.pixelBlock.maskIsAlpha&&(t.pixelBlock.premultiplyAlpha=!0);const i=t.pixelBlock.getAsRGBA(),h=l.createImageData(t.pixelBlock.width,t.pixelBlock.height);h.data.set(i),l.putImageData(h,0,0)}getRenderedRasterPixels(){const l=this.filter({extent:this.extent,pixelBlock:this.pixelBlock});return null==l.pixelBlock?null:(l.pixelBlock.maskIsAlpha&&(l.pixelBlock.premultiplyAlpha=!0),{width:l.pixelBlock.width,height:l.pixelBlock.height,renderedRasterPixels:new Uint8Array(l.pixelBlock.getAsRGBA().buffer)})}}},"./node_modules/@arcgis/core/views/2d/engine/webgl/shaderGraph/techniques/bitmap/BitmapTechnique.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{C:()=>BitmapTechnique_p});var definitions=__webpack_require__("./node_modules/@arcgis/core/views/2d/engine/webgl/definitions.js"),Technique=__webpack_require__("./node_modules/@arcgis/core/views/2d/engine/webgl/shaderGraph/techniques/Technique.js"),TechniqueType=__webpack_require__("./node_modules/@arcgis/core/views/2d/engine/webgl/shaderGraph/techniques/TechniqueType.js"),tslib_es6=__webpack_require__("./node_modules/@arcgis/core/chunks/tslib.es6.js"),GraphShaderModule=__webpack_require__("./node_modules/@arcgis/core/views/2d/engine/webgl/shaderGraph/GraphShaderModule.js"),glsl=__webpack_require__("./node_modules/@arcgis/core/views/2d/engine/webgl/shaderGraph/graph/glsl.js");function p(t){const u=function n(t){const u=new glsl.nt(1/6),d=t.multiply(t),i=d.multiply(t),n=u.multiply(i.multiply(-1).add(new glsl.nt(3).multiply(d)).subtract(new glsl.nt(3).multiply(t)).add(1)),p=u.multiply(i.multiply(3).subtract(d.multiply(6)).add(4)),m=u.multiply(i.multiply(-3).add(d.multiply(3)).add(t.multiply(3)).add(1)),a=u.multiply(i);return new glsl.Zb(n,p,m,a)}(t),d=u.x.add(u.y),i=u.z.add(u.w),p=new glsl.nt(1).subtract(u.y.divide(d)).add(t),m=new glsl.nt(1).add(u.w.divide(i)).subtract(t);return new glsl.Zb(p,m,d,i)}class v extends GraphShaderModule.ZA{}(0,tslib_es6._)([(0,GraphShaderModule.C5)(0,glsl.ZY)],v.prototype,"position",void 0);class b extends GraphShaderModule.HS{}class S extends GraphShaderModule.k2{}(0,tslib_es6._)([(0,GraphShaderModule.Pi)(glsl.z7)],S.prototype,"texture",void 0),(0,tslib_es6._)([(0,GraphShaderModule.Pi)(glsl.U)],S.prototype,"dvsMat3",void 0),(0,tslib_es6._)([(0,GraphShaderModule.Pi)(glsl.ZY)],S.prototype,"coordScale",void 0),(0,tslib_es6._)([(0,GraphShaderModule.Pi)(glsl.nt)],S.prototype,"opacity",void 0);class j extends GraphShaderModule.A{constructor(){super(...arguments),this.type="BitmapShader"}vertex(t){const o=this.config.dvsMat3.multiply(new glsl.eB(t.position.multiply(this.config.coordScale),1));return{glPosition:new glsl.Zb(o,1),texcoord:t.position}}fragment(t){const o=new GraphShaderModule.mm;let i;return i=this.bicubic?function m(y,n,m){const a=new glsl.ZY(new glsl.nt(1).divide(m.x),0),e=new glsl.ZY(0,new glsl.nt(1).divide(m.y)),r=n.multiply(m).subtract(.5),c=p((0,glsl.jc)(r).x).xyz,s=p((0,glsl.jc)(r).y).xyz;let w=n.add(c.x.multiply(a)),o=n.subtract(c.y.multiply(a));const x=w.add(s.x.multiply(e)),b=o.add(s.x.multiply(e));w=w.subtract(s.y.multiply(e)),o=o.subtract(s.y.multiply(e));let z=(0,glsl.US)(y,o),f=(0,glsl.US)(y,w);const v=(0,glsl.US)(y,b),g=(0,glsl.US)(y,x);return z=(0,glsl.jh)(z,v,s.z),f=(0,glsl.jh)(f,g,s.z),z=(0,glsl.jh)(z,f,c.z),z}(this.config.texture,t.texcoord,this.config.coordScale):(0,glsl.US)(this.config.texture,t.texcoord),o.fragColor=new glsl.Zb(i.rgb.multiply(this.config.opacity),i.a.multiply(this.config.opacity)),o}}(0,tslib_es6._)([(0,GraphShaderModule.Pi)(S)],j.prototype,"config",void 0),(0,tslib_es6._)([GraphShaderModule.E8],j.prototype,"bicubic",void 0),(0,tslib_es6._)([(0,tslib_es6.a)(0,(0,GraphShaderModule.hF)(v))],j.prototype,"vertex",null),(0,tslib_es6._)([(0,tslib_es6.a)(0,(0,GraphShaderModule.hF)(b))],j.prototype,"fragment",null);var enums=__webpack_require__("./node_modules/@arcgis/core/views/webgl/enums.js");const a={nearest:{samplingMode:enums.Cj.NEAREST,mips:!1},bilinear:{samplingMode:enums.Cj.LINEAR,mips:!1},bicubic:{samplingMode:enums.Cj.LINEAR,mips:!1},trilinear:{samplingMode:enums.Cj.LINEAR_MIPMAP_LINEAR,mips:!0}},BitmapTechnique_m=(e,i,t)=>{if("dynamic"===t.samplingMode){const{state:t}=e,s=i.resolution/i.pixelRatio/t.resolution,o=Math.round(e.pixelRatio)!==e.pixelRatio,n=s>1.05||s<.95;return t.rotation||n||o||i.isSourceScaled||i.rotation?a.bilinear:a.nearest}return a[t.samplingMode]};class BitmapTechnique_p extends Technique.j{constructor(){super(...arguments),this.name="BrushBitmap",this.type=TechniqueType.N.Bitmap,this.shaders={bitmap:new j}}render(i,t){const{context:s,renderingOptions:o,painter:p}=i;for(const c of t.bitmaps){const t=c.texture;if(!c.source||!c.isReady||null==t)continue;const l=BitmapTechnique_m(i,c,o);i.timeline.begin(this.name),p.setPipelineState({depth:!1,stencil:{test:{mask:255,ref:c.stencilRef,compare:enums.MT.EQUAL,op:{fail:enums.eA.KEEP,zFail:enums.eA.KEEP,zPass:enums.eA.KEEP}},write:!1},color:{write:[!0,!0,!0,!0],blendMode:"additive"===c.blendFunction?"additive":"composite"}}),c.setSamplingProfile(l);const{coordScale:d,computedOpacity:u,transforms:f}=c,h={texture:{texture:t,unit:definitions.YS},dvsMat3:f.displayViewScreenMat3,coordScale:d,opacity:u};p.submitDrawMesh(s,{shader:this.shaders.bitmap,uniforms:{config:h},defines:{bicubic:l===a.bicubic},optionalAttributes:null,useComputeBuffer:!1},p.quadMesh),i.timeline.end(this.name)}}}},"./node_modules/@arcgis/core/views/2d/layers/WMSLayerView2D.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>y});var tslib_es6=__webpack_require__("./node_modules/@arcgis/core/chunks/tslib.es6.js"),Logger=__webpack_require__("./node_modules/@arcgis/core/core/Logger.js"),maybe=__webpack_require__("./node_modules/@arcgis/core/core/maybe.js"),promiseUtils=__webpack_require__("./node_modules/@arcgis/core/core/promiseUtils.js"),reactiveUtils=__webpack_require__("./node_modules/@arcgis/core/core/reactiveUtils.js"),property=__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/decorators/property.js"),subclass=(__webpack_require__("./node_modules/@arcgis/core/core/has.js"),__webpack_require__("./node_modules/@arcgis/core/core/RandomLCG.js"),__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/decorators/subclass.js")),Extent=__webpack_require__("./node_modules/@arcgis/core/geometry/Extent.js"),BitmapContainer=__webpack_require__("./node_modules/@arcgis/core/views/2d/engine/BitmapContainer.js"),LayerView2D=__webpack_require__("./node_modules/@arcgis/core/views/2d/layers/LayerView2D.js"),ExportStrategy=__webpack_require__("./node_modules/@arcgis/core/views/2d/layers/support/ExportStrategy.js"),LayerView=__webpack_require__("./node_modules/@arcgis/core/views/layers/LayerView.js"),RefreshableLayerView=__webpack_require__("./node_modules/@arcgis/core/views/layers/RefreshableLayerView.js"),Error=__webpack_require__("./node_modules/@arcgis/core/core/Error.js"),ExportWMSImageParameters=__webpack_require__("./node_modules/@arcgis/core/layers/support/ExportWMSImageParameters.js"),timeSupport=__webpack_require__("./node_modules/@arcgis/core/layers/support/timeSupport.js");const m=m=>{let n=class extends m{initialize(){this.exportImageParameters=new ExportWMSImageParameters.r({layer:this.layer})}destroy(){this.exportImageParameters=(0,maybe.pR)(this.exportImageParameters)}get exportImageVersion(){return this.exportImageParameters?.commitProperty("version"),this.commitProperty("timeExtent"),(this._get("exportImageVersion")||0)+1}get timeExtent(){return(0,timeSupport.F)(this.layer,this.view?.timeExtent,this._get("timeExtent"))}async fetchPopupFeaturesAtLocation(e,r){const{layer:s}=this;if(!e)throw new Error.A("wmslayerview:fetchPopupFeatures","Nothing to fetch without area",{layer:s});const{popupEnabled:a}=s;if(!a)throw new Error.A("wmslayerview:fetchPopupFeatures","popupEnabled should be true",{popupEnabled:a});const p=this.createFetchPopupFeaturesQuery(e);if(!p)return[];const{extent:i,width:m,height:n,x:c,y:u}=p;if(!(i&&m&&n))throw new Error.A("wmslayerview:fetchPopupFeatures","WMSLayer does not support fetching features.",{extent:i,width:m,height:n});const h=await s.fetchFeatureInfo(i,m,n,c,u);return(0,promiseUtils.Te)(r),h}};return(0,tslib_es6._)([(0,property.MZ)()],n.prototype,"exportImageParameters",void 0),(0,tslib_es6._)([(0,property.MZ)({readOnly:!0})],n.prototype,"exportImageVersion",null),(0,tslib_es6._)([(0,property.MZ)()],n.prototype,"layer",void 0),(0,tslib_es6._)([(0,property.MZ)({readOnly:!0})],n.prototype,"timeExtent",null),n=(0,tslib_es6._)([(0,subclass.$)("esri.views.layers.WMSLayerView")],n),n};let g=class extends(m((0,RefreshableLayerView.A)((0,LayerView2D.e)(LayerView.A)))){constructor(){super(...arguments),this.bitmapContainer=new BitmapContainer.l}supportsSpatialReference(e){return this.layer.serviceSupportsSpatialReference(e)}update(e){this.strategy.update(e).catch((e=>{(0,promiseUtils.zf)(e)||Logger.A.getLogger(this).error(e)}))}attach(){const{layer:e}=this,{imageMaxHeight:t,imageMaxWidth:r}=e;this.bitmapContainer=new BitmapContainer.l,this.container.addChild(this.bitmapContainer),this.strategy=new ExportStrategy.A({container:this.bitmapContainer,fetchSource:this.fetchImage.bind(this),requestUpdate:this.requestUpdate.bind(this),imageMaxHeight:t,imageMaxWidth:r,imageRotationSupported:!1,imageNormalizationSupported:!1,hidpi:!1}),this.addAttachHandles((0,reactiveUtils.watch)((()=>this.exportImageVersion),(()=>this.requestUpdate())))}detach(){this.strategy=(0,maybe.pR)(this.strategy),this.container.removeAllChildren()}viewChange(){}moveEnd(){this.requestUpdate()}createFetchPopupFeaturesQuery(e){const{view:t,bitmapContainer:r}=this,{x:i,y:s}=e,{spatialReference:a}=t;let o,p=0,m=0;if(r.children.some((e=>{const{width:t,height:r,resolution:h,x:c,y:d}=e,u=c+h*t,g=d-h*r;return i>=c&&i<=u&&s<=d&&s>=g&&(o=new Extent.default({xmin:c,ymin:g,xmax:u,ymax:d,spatialReference:a}),p=t,m=r,!0)})),!o)return null;const h=o.width/p,c=Math.round((i-o.xmin)/h),d=Math.round((o.ymax-s)/h);return{extent:o,width:p,height:m,x:c,y:d}}async doRefresh(){this.requestUpdate()}isUpdating(){return this.strategy.updating||this.updateRequested}fetchImage(e,t,r,i){return this.layer.fetchImageBitmap(e,t,r,{timeExtent:this.timeExtent,...i})}};(0,tslib_es6._)([(0,property.MZ)()],g.prototype,"strategy",void 0),(0,tslib_es6._)([(0,property.MZ)()],g.prototype,"updating",void 0),g=(0,tslib_es6._)([(0,subclass.$)("esri.views.2d.layers.WMSLayerView2D")],g);const y=g},"./node_modules/@arcgis/core/views/2d/layers/support/ExportStrategy.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>_});var tslib_es6=__webpack_require__("./node_modules/@arcgis/core/chunks/tslib.es6.js"),Accessor=__webpack_require__("./node_modules/@arcgis/core/core/Accessor.js"),promiseUtils=(__webpack_require__("./node_modules/@arcgis/core/core/has.js"),__webpack_require__("./node_modules/@arcgis/core/core/promiseUtils.js")),property=__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/decorators/property.js"),subclass=(__webpack_require__("./node_modules/@arcgis/core/core/Logger.js"),__webpack_require__("./node_modules/@arcgis/core/core/RandomLCG.js"),__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/decorators/subclass.js")),aaBoundingRect=__webpack_require__("./node_modules/@arcgis/core/geometry/support/aaBoundingRect.js"),spatialReferenceUtils=__webpack_require__("./node_modules/@arcgis/core/geometry/support/spatialReferenceUtils.js"),TileInfo=__webpack_require__("./node_modules/@arcgis/core/layers/support/TileInfo.js");const t=Math.PI/180;function n(n){return n*t}function o(t,o){const a=n(o.rotation),r=Math.abs(Math.cos(a)),s=Math.abs(Math.sin(a)),[u,c]=o.size;return t[0]=Math.round(c*s+u*r),t[1]=Math.round(c*r+u*s),t}var Bitmap=__webpack_require__("./node_modules/@arcgis/core/views/2d/engine/Bitmap.js"),TileInfoView=__webpack_require__("./node_modules/@arcgis/core/views/2d/tiling/TileInfoView.js"),TileKey=__webpack_require__("./node_modules/@arcgis/core/views/2d/tiling/TileKey.js");const y=(0,aaBoundingRect.vt)(),x=[0,0],S=new TileKey.A(0,0,0,0),w_imageMaxWidth=2048,w_imageMaxHeight=2048,w_imageRotationSupported=!1,w_imageNormalizationSupported=!1,w_hidpi=!1;let M=class extends Accessor.A{constructor(t){super(t),this._imagePromise=null,this.bitmaps=[],this.hidpi=w_hidpi,this.imageMaxWidth=w_imageMaxWidth,this.imageMaxHeight=w_imageMaxHeight,this.imageRotationSupported=w_imageRotationSupported,this.imageNormalizationSupported=w_imageNormalizationSupported,this.update=(0,promiseUtils.sg)((async(t,e)=>{if((0,promiseUtils.Te)(e),!t.stationary||this.destroyed)return;const i=t.state,s=(0,spatialReferenceUtils.Vp)(i.spatialReference),a=this.hidpi?t.pixelRatio:1,n=i.worldScreenWidth>0,p=n&&this.imageNormalizationSupported&&i.worldScreenWidth<i.size[0],m=Math.round((this.imageMaxWidth??0)/a),l=Math.round((this.imageMaxHeight??0)/a);p?(x[0]=i.worldScreenWidth,x[1]=i.size[1]):this.imageRotationSupported?(x[0]=i.size[0],x[1]=i.size[1]):o(x,i);const c=Math.floor(x[0])>m||Math.floor(x[1])>l,u=s&&(i.extent.xmin<s.valid[0]||i.extent.xmax>s.valid[1]),g=!this.imageNormalizationSupported&&u,f=!c&&!g,y=this.imageRotationSupported?i.rotation:0,S=this.container.children.slice();if(f){const t=p?i.paddedViewState.center:i.center;this._imagePromise=this._singleExport(i,x,t,i.resolution,y,a,e)}else{let t=Math.min(m,l);n&&(t=Math.min(i.worldScreenWidth,t),t=Math.round(i.worldScreenWidth/Math.ceil(i.worldScreenWidth/t))),this._imagePromise=this._tiledExport(i,t,a,e)}try{const t=await this._imagePromise??[];(0,promiseUtils.Te)(e);const i=[];if(this._imagePromise=null,this.destroyed)return;this.bitmaps=t;for(const e of S)t.includes(e)||i.push(e.fadeOut().then((()=>{e.remove(),e.destroy()})));for(const e of t)i.push(e.fadeIn());await Promise.all(i)}catch(w){this._imagePromise=null,(0,promiseUtils.QP)(w)}}),5e3),this.updateExports=(0,promiseUtils.sg)((async t=>{const e=[];for(const i of this.container.children){if(!i.visible||!i.stage)return;e.push(t(i).then((()=>{i.invalidateTexture(),i.requestRender()})))}this._imagePromise=(0,promiseUtils.Lx)(e).then((()=>this._imagePromise=null)),await this._imagePromise}))}destroy(){this.bitmaps.forEach((t=>t.destroy())),this.bitmaps=[]}get updating(){return!this.destroyed&&null!==this._imagePromise}async _export(t,e,i,r,s,a){const n=await this.fetchSource(t,Math.floor(e*s),Math.floor(i*s),{rotation:r,pixelRatio:s,signal:a});(0,promiseUtils.Te)(a);const p=new Bitmap.mb(null,!0);return p.x=t.xmin,p.y=t.ymax,p.resolution=t.width/e,p.rotation=r,p.pixelRatio=s,p.opacity=0,this.container.addChild(p),await p.setSourceAsync(n,a),(0,promiseUtils.Te)(a),p}async _singleExport(t,e,i,o,r,s,a){!function viewStateUtils_a(t,n,o,a){const[r,s]=n,[u,c]=a,h=.5*o;return t[0]=r-h*u,t[1]=s-h*c,t[2]=r+h*u,t[3]=s+h*c,t}(y,i,o,e);const n=(0,aaBoundingRect.w1)(y,t.spatialReference);return[await this._export(n,e[0],e[1],r,s,a)]}_tiledExport(t,e,i,o){const r=TileInfo.default.create({size:e,spatialReference:t.spatialReference,scales:[t.scale]}),s=new TileInfoView.A(r),a=s.getTileCoverage(t);if(!a)return null;const n=[];return a.forEach(((r,a,p,h)=>{S.set(r,a,p,0),s.getTileBounds(y,S);const l=(0,aaBoundingRect.w1)(y,t.spatialReference);n.push(this._export(l,e,e,0,i,o).then((t=>(0!==h&&(S.set(r,a,p,h),s.getTileBounds(y,S),t.x=y[0],t.y=y[3]),t))))})),Promise.all(n)}};(0,tslib_es6._)([(0,property.MZ)()],M.prototype,"_imagePromise",void 0),(0,tslib_es6._)([(0,property.MZ)()],M.prototype,"bitmaps",void 0),(0,tslib_es6._)([(0,property.MZ)()],M.prototype,"container",void 0),(0,tslib_es6._)([(0,property.MZ)()],M.prototype,"fetchSource",void 0),(0,tslib_es6._)([(0,property.MZ)()],M.prototype,"hidpi",void 0),(0,tslib_es6._)([(0,property.MZ)()],M.prototype,"imageMaxWidth",void 0),(0,tslib_es6._)([(0,property.MZ)()],M.prototype,"imageMaxHeight",void 0),(0,tslib_es6._)([(0,property.MZ)()],M.prototype,"imageRotationSupported",void 0),(0,tslib_es6._)([(0,property.MZ)()],M.prototype,"imageNormalizationSupported",void 0),(0,tslib_es6._)([(0,property.MZ)()],M.prototype,"requestUpdate",void 0),(0,tslib_es6._)([(0,property.MZ)()],M.prototype,"updating",null),M=(0,tslib_es6._)([(0,subclass.$)("esri.views.2d.layers.support.ExportStrategy")],M);const _=M},"./node_modules/@arcgis/core/views/layers/RefreshableLayerView.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>i});var _chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@arcgis/core/chunks/tslib.es6.js"),_core_Logger_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@arcgis/core/core/Logger.js"),_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@arcgis/core/core/promiseUtils.js"),_core_reactiveUtils_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@arcgis/core/core/reactiveUtils.js"),_core_accessorSupport_decorators_subclass_js__WEBPACK_IMPORTED_MODULE_7__=(__webpack_require__("./node_modules/@arcgis/core/core/has.js"),__webpack_require__("./node_modules/@arcgis/core/core/RandomLCG.js"),__webpack_require__("./node_modules/@arcgis/core/core/Error.js"),__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/decorators/subclass.js"));const i=i=>{let a=class extends i{initialize(){this.addHandles((0,_core_reactiveUtils_js__WEBPACK_IMPORTED_MODULE_3__.on)((()=>this.layer),"refresh",(r=>{this.doRefresh(r.dataChanged).catch((r=>{(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_2__.zf)(r)||_core_Logger_js__WEBPACK_IMPORTED_MODULE_1__.A.getLogger(this).error(r)}))})),"RefreshableLayerView")}};return a=(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_subclass_js__WEBPACK_IMPORTED_MODULE_7__.$)("esri.views.layers.RefreshableLayerView")],a),a}}}]);