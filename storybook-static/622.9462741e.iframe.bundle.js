"use strict";(self.webpackChunk_defra_flood_map=self.webpackChunk_defra_flood_map||[]).push([[622,3521,8283],{"./node_modules/@arcgis/core/chunks/quickselect.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{function t(t,r,f,n,h){o(t,r,f||0,n||t.length-1,h||a)}function o(t,a,f,n,h){for(;n>f;){if(n-f>600){var M=n-f+1,i=a-f+1,u=Math.log(M),c=.5*Math.exp(2*u/3),e=.5*Math.sqrt(u*c*(M-c)/M)*(i-M/2<0?-1:1);o(t,a,Math.max(f,Math.floor(a-i*c/M+e)),Math.min(n,Math.floor(a+(M-i)*c/M+e)),h)}var l=t[a],v=f,x=n;for(r(t,f,a),h(t[n],l)>0&&r(t,f,n);v<x;){for(r(t,v,x),v++,x--;h(t[v],l)<0;)v++;for(;h(t[x],l)>0;)x--}0===h(t[f],l)?r(t,f,x):r(t,++x,n),x<=a&&(f=x+1),a<=x&&(n=x-1)}}function r(t,o,r){var a=t[o];t[o]=t[r],t[r]=a}function a(t,o){return t<o?-1:t>o?1:0}__webpack_require__.d(__webpack_exports__,{q:()=>t})},"./node_modules/@arcgis/core/core/LRUCache.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{q:()=>e});var _MemCache_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@arcgis/core/core/MemCache.js");class e{constructor(e,s){this._storage=new _MemCache_js__WEBPACK_IMPORTED_MODULE_0__.F,this.id="",this.name="",this.size=0,this._storage.maxSize=e,this._storage.register(this),s&&this._storage.registerRemoveFunc("",s)}destroy(){this._storage.deregister(this),this._storage.destroy()}put(t,e,s=1){this._storage.put(this,t,e,s,1)}pop(t){return this._storage.pop(this,t)}get(t){return this._storage.get(this,t)}clear(){this._storage.clearAll()}get maxSize(){return this._storage.maxSize}set maxSize(t){this._storage.maxSize=t}resetHitRate(){}}},"./node_modules/@arcgis/core/core/MemCache.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{F:()=>h,Ti:()=>e});var _PooledArray_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@arcgis/core/core/PooledArray.js");const e=-3,i=e-1;var s;!function(t){t[t.ALL=0]="ALL",t[t.SOME=1]="SOME"}(s||(s={}));class h{get size(){return this._size}constructor(e=10485760){this._maxSize=e,this._db=new Map,this._size=0,this._hit=0,this._miss=0,this._removeFuncs=new _PooledArray_js__WEBPACK_IMPORTED_MODULE_0__.A,this._users=new _PooledArray_js__WEBPACK_IMPORTED_MODULE_0__.A}destroy(){this.clearAll(),this._removeFuncs.clear(),this._users.clear()}register(t){this._users.push(t)}deregister(t){this._users.removeUnordered(t)}registerRemoveFunc(t,e){this._removeFuncs.push([t,e])}deregisterRemoveFunc(t){this._removeFuncs.filterInPlace((e=>e[0]!==t))}get maxSize(){return this._maxSize}set maxSize(t){this._maxSize=Math.max(t,-1),this._checkSize()}getSize(t,e){const i=this._db.get(t.id+e);return i?.size??0}put(t,r,h,o,_){r=t.id+r;const a=this._db.get(r);if(a&&(this._size-=a.size,t.size-=a.size,this._db.delete(r),a.entry!==h&&this._notifyRemove(r,a.entry,a.size,s.ALL)),o>this._maxSize)return void this._notifyRemove(r,h,o,s.ALL);if(void 0===h)return void console.warn("Refusing to cache undefined entry ");if(!o||o<0)return console.warn(`Refusing to cache entry with size ${o} for key ${r}`),void this._notifyRemove(r,h,0,s.ALL);const c=1+Math.max(_,i)-e;this._db.set(r,new n(h,o,c)),this._size+=o,t.size+=o,this._checkSize()}updateSize(t,e,i,r){e=t.id+e;const h=this._db.get(e);if(h&&h.entry===i){for(this._size-=h.size,t.size-=h.size;r>this._maxSize;){const t=this._notifyRemove(e,i,r,s.SOME);if(!(null!=t&&t>0))return void this._db.delete(e);r=t}h.size=r,this._size+=r,t.size+=r,this._checkSize()}}pop(t,e){e=t.id+e;const i=this._db.get(e);if(i)return this._size-=i.size,t.size-=i.size,this._db.delete(e),++this._hit,i.entry;++this._miss}get(t,e){e=t.id+e;const i=this._db.get(e);if(void 0!==i)return this._db.delete(e),i.lives=i.lifetime,this._db.set(e,i),++this._hit,i.entry;++this._miss}peek(t,e){const i=this._db.get(t.id+e);return i?++this._hit:++this._miss,i?.entry}get performanceInfo(){const t={Size:Math.round(this._size/1048576)+"/"+Math.round(this._maxSize/1048576)+"MB","Hit rate":Math.round(100*this._getHitRate())+"%",Entries:this._db.size.toString()},i={},s=new Array;this._db.forEach(((t,e)=>{const r=t.lifetime;s[r]=(s[r]||0)+t.size,this._users.forAll((s=>{const{id:r,name:h}=s;if(e.startsWith(r)){const e=i[h]||0;i[h]=e+t.size}}))}));const r={};this._users.forAll((t=>{const e=t.name;if("hitRate"in t&&"number"==typeof t.hitRate&&!isNaN(t.hitRate)&&t.hitRate>0){const s=i[e]||0;i[e]=s,r[e]=Math.round(100*t.hitRate)+"%"}else r[e]="0%"}));const h=Object.keys(i);h.sort(((t,e)=>i[e]-i[t])),h.forEach((e=>t[e]=Math.round(i[e]/2**20)+"MB / "+r[e]));for(let o=s.length-1;o>=0;--o){const i=s[o];i&&(t["Priority "+(o+e-1)]=Math.round(i/this._size*100)+"%")}return t}resetStats(){this._hit=this._miss=0,this._users.forAll((t=>t.resetHitRate()))}clear(t){const e=t.id;this._db.forEach(((t,i)=>{i.startsWith(e)&&(this._size-=t.size,this._db.delete(i),this._notifyRemove(i,t.entry,t.size,s.ALL))})),t.size=0}clearAll(){this._db.forEach(((t,e)=>this._notifyRemove(e,t.entry,t.size,s.ALL))),this._users.forAll((t=>t.size=0)),this._size=0,this._db.clear()}_getHitRate(){return this._hit/(this._hit+this._miss)}_notifyRemove(t,e,i,s){let r;return this._removeFuncs.some((h=>{if(t.startsWith(h[0])){const t=h[1](e,s,i);return"number"==typeof t&&(r=t),!0}return!1})),r}_checkSize(){this._users.forAll((t=>this._checkSizeLimits(t))),this._checkSizeLimits()}_checkSizeLimits(t){const e=t??this;if(e.maxSize<0||e.size<=e.maxSize)return;const i=t?.id;let s=!0;for(;s;){s=!1;for(const[r,h]of this._db)if(0===h.lifetime&&(!i||r.startsWith(i))){if(this._purgeItem(r,h,t),e.size<=.9*e.maxSize)return;s||=this._db.has(r)}}for(const[r,h]of this._db)if((!i||r.startsWith(i))&&(this._purgeItem(r,h,t),e.size<=.9*e.maxSize))return}_purgeItem(t,e,i=this._users.find((e=>t.startsWith(e.id)))){if(this._db.delete(t),e.lives<=1){this._size-=e.size,i&&(i.size-=e.size);const r=this._notifyRemove(t,e.entry,e.size,s.SOME);null!=r&&r>0&&(this._size+=r,i&&(i.size+=r),e.lives=e.lifetime,e.size=r,this._db.set(t,e))}else--e.lives,this._db.set(t,e)}}class n{constructor(t,e,i){this.entry=t,this.size=e,this.lifetime=i,this.lives=i}}},"./node_modules/@arcgis/core/core/memoryEstimations.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Qf:()=>i,Qh:()=>u,RS:()=>n,ez:()=>a,i5:()=>y,lM:()=>e,qK:()=>s});var _typedArrayUtil_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@arcgis/core/core/typedArrayUtil.js");const n=16;function e(r){if(!r)return 0;let t=s;for(const n in r)r.hasOwnProperty(n)&&(t+=f(r[n],!1));return t}function u(r){if(!r)return 0;if("number"==typeof r[0])return i(r);if(Array.isArray(r))return function o(r){const t=r.length;if(0===t||"number"==typeof r[0])return c(r,8);let n=a;for(let e=0;e<t;e++)n+=f(r[e]);return n}(r);let t=s;for(const n in r)r.hasOwnProperty(n)&&(t+=f(r[n]));return t}function f(r,e=!0){switch(typeof r){case"object":return e?u(r):s;case"string":return function t(r){return 32+r.length}(r);case"number":return n;case"boolean":return 4;default:return 8}}function i(...t){return t.reduce(((t,e)=>t+(e?(0,_typedArrayUtil_js__WEBPACK_IMPORTED_MODULE_0__.iu)(e)?e.byteLength+y:Array.isArray(e)?c(e,n):0:0)),0)}function c(r,t){return a+r.length*t}const s=32,a=16,y=145},"./node_modules/@arcgis/core/core/sql/WhereClauseCache.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{WhereClauseCache:()=>r});var _LRUCache_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@arcgis/core/core/LRUCache.js"),_WhereClause_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@arcgis/core/core/sql/WhereClause.js");class r{constructor(e,r){this._cache=new _LRUCache_js__WEBPACK_IMPORTED_MODULE_0__.q(e),this._invalidCache=new _LRUCache_js__WEBPACK_IMPORTED_MODULE_0__.q(r)}get(t,r){const i=`${r?.uid}:${t}`,c=this._cache.get(i);if(c)return c;if(null!=this._invalidCache.get(i))return null;try{const c=_WhereClause_js__WEBPACK_IMPORTED_MODULE_1__.default.create(t,{fieldsIndex:r});return this._cache.put(i,c),c}catch(n){return this._invalidCache.put(i,n),null}}getError(t,e){const r=`${e?.uid}:${t}`;return this._invalidCache.get(r)??null}}},"./node_modules/@arcgis/core/geometry/support/normalizeUtils.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{O7:()=>P,Hr:()=>v,el:()=>R,mT:()=>L,XX:()=>M});var config=__webpack_require__("./node_modules/@arcgis/core/config.js"),Error=__webpack_require__("./node_modules/@arcgis/core/core/Error.js"),Logger=__webpack_require__("./node_modules/@arcgis/core/core/Logger.js"),Polygon=__webpack_require__("./node_modules/@arcgis/core/geometry/Polygon.js"),Polyline=__webpack_require__("./node_modules/@arcgis/core/geometry/Polyline.js"),normalizeUtilsCommon=__webpack_require__("./node_modules/@arcgis/core/geometry/support/normalizeUtilsCommon.js"),spatialReferenceUtils=__webpack_require__("./node_modules/@arcgis/core/geometry/support/spatialReferenceUtils.js"),webMercatorUtils=__webpack_require__("./node_modules/@arcgis/core/geometry/support/webMercatorUtils.js"),request=__webpack_require__("./node_modules/@arcgis/core/request.js"),jsonUtils=__webpack_require__("./node_modules/@arcgis/core/geometry/support/jsonUtils.js"),utils=__webpack_require__("./node_modules/@arcgis/core/rest/utils.js");var urlUtils=__webpack_require__("./node_modules/@arcgis/core/core/urlUtils.js"),geometryService_utils=__webpack_require__("./node_modules/@arcgis/core/rest/geometryService/utils.js");const normalizeUtils_m=()=>Logger.A.getLogger("esri.geometry.support.normalizeUtils");function y(t){return"polygon"===t[0].type}function x(t){return"polyline"===t[0].type}function d(t){const e=[];let n=0,o=0;for(let s=0;s<t.length;s++){const r=t[s];let i=null;for(let t=0;t<r.length;t++)i=r[t],e.push(i),0===t?(n=i[0],o=n):(n=Math.min(n,i[0]),o=Math.max(o,i[0]));i&&e.push([(n+o)/2,0])}return e}function M(t,n){if(!(t instanceof Polyline.A||t instanceof Polygon.A)){const t="straightLineDensify: the input geometry is neither polyline nor polygon";throw normalizeUtils_m().error(t),new Error.A(t)}const i=(0,normalizeUtilsCommon.r8)(t),l=[];for(const e of i){const t=[];l.push(t),t.push([e[0][0],e[0][1]]);for(let o=0;o<e.length-1;o++){const s=e[o][0],r=e[o][1],i=e[o+1][0],l=e[o+1][1],c=Math.sqrt((i-s)*(i-s)+(l-r)*(l-r)),f=(l-r)/c,u=(i-s)/c,p=c/n;if(p>1){for(let l=1;l<=p-1;l++){const e=l*n,o=u*e+s,i=f*e+r;t.push([o,i])}const e=(c+Math.floor(p-1)*n)/2,o=u*e+s,i=f*e+r;t.push([o,i])}t.push([i,l])}}return function g(t){return"polygon"===t.type}(t)?new Polygon.A({rings:l,spatialReference:t.spatialReference}):new Polyline.A({paths:l,spatialReference:t.spatialReference})}function w(t,e,n){if(e){const e=M(t,1e6);t=(0,webMercatorUtils.ci)(e,!0)}return n&&(t=(0,normalizeUtilsCommon.kS)(t,n)),t}function b(t,e,n){if(Array.isArray(t)){const o=t[0];if(o>e){const n=(0,normalizeUtilsCommon.kd)(o,e);t[0]=o+n*(-2*e)}else if(o<n){const e=(0,normalizeUtilsCommon.kd)(o,n);t[0]=o+e*(-2*n)}}else{const o=t.x;if(o>e){const n=(0,normalizeUtilsCommon.kd)(o,e);t=t.clone().offset(n*(-2*e),0)}else if(o<n){const e=(0,normalizeUtilsCommon.kd)(o,n);t=t.clone().offset(e*(-2*n),0)}}return t}function j(t,e){let n=-1;for(let o=0;o<e.cutIndexes.length;o++){const s=e.cutIndexes[o],i=e.geometries[o],c=(0,normalizeUtilsCommon.r8)(i);for(let t=0;t<c.length;t++){const e=c[t];e.some((n=>{if(n[0]<180)return!0;{let n=0;for(let t=0;t<e.length;t++){const o=e[t][0];n=o>n?o:n}n=Number(n.toFixed(9));const o=-360*(0,normalizeUtilsCommon.kd)(n,180);for(let s=0;s<e.length;s++){const e=i.getPoint(t,s);i.setPoint(t,s,e.clone().offset(o,0))}return!0}}))}if(s===n){if(y(t))for(const e of(0,normalizeUtilsCommon.r8)(i))t[s]=t[s].addRing(e);else if(x(t))for(const e of(0,normalizeUtilsCommon.r8)(i))t[s]=t[s].addPath(e)}else n=s,t[s]=i}return t}async function R(e,n,r){if(!Array.isArray(e))return R([e],n);n&&"string"!=typeof n&&normalizeUtils_m().warn("normalizeCentralMeridian()","The url object is deprecated, use the url string instead");const p="string"==typeof n?n:n?.url??config.default.geometryServiceUrl;let g,y,x,d,M,v,P,L,U=0;const z=[],A=[];for(const t of e)if(null!=t)if(g||(g=t.spatialReference,y=(0,spatialReferenceUtils.Vp)(g),x=g.isWebMercator,v=x?102100:4326,d=normalizeUtilsCommon.j7[v].maxX,M=normalizeUtilsCommon.j7[v].minX,P=normalizeUtilsCommon.j7[v].plus180Line,L=normalizeUtilsCommon.j7[v].minus180Line),y)if("mesh"===t.type)A.push(t);else if("point"===t.type)A.push(b(t.clone(),d,M));else if("multipoint"===t.type){const e=t.clone();e.points=e.points.map((t=>b(t,d,M))),A.push(e)}else if("extent"===t.type){const e=t.clone()._normalize(!1,!1,y);A.push(e.rings?new Polygon.A(e):e)}else if(t.extent){const e=t.extent,n=(0,normalizeUtilsCommon.kd)(e.xmin,M)*(2*d);let o=0===n?t.clone():(0,normalizeUtilsCommon.kS)(t.clone(),n);e.offset(n,0);let{xmin:s,xmax:r}=e;s=Number(s.toFixed(9)),r=Number(r.toFixed(9)),e.intersects(P)&&r!==d?(U=r>U?r:U,o=w(o,x),z.push(o),A.push("cut")):e.intersects(L)&&s!==M?(U=r*(2*d)>U?r*(2*d):U,o=w(o,x,360),z.push(o),A.push("cut")):A.push(o)}else A.push(t.clone());else A.push(t);else A.push(t);let F=(0,normalizeUtilsCommon.kd)(U,d),N=-90;const S=F,k=new Polyline.A;for(;F>0;){const t=360*F-180;k.addPath([[t,N],[t,-1*N]]),N*=-1,F--}if(z.length>0&&S>0){const t=j(z,await async function cut_i(i,n,p,m){const a=(0,utils.Dl)(i),u=n[0].spatialReference,c={...m,responseType:"json",query:{...a.query,f:"json",sr:(0,spatialReferenceUtils.YX)(u),target:JSON.stringify({geometryType:(0,jsonUtils.$B)(n[0]),geometries:n}),cutter:JSON.stringify(p)}},f=await(0,request.A)(a.path+"/cut",c),{cutIndexes:y,geometries:g=[]}=f.data;return{cutIndexes:y,geometries:g.map((e=>{const t=(0,jsonUtils.rS)(e);return t.spatialReference=u,t}))}}(p,z,k,r)),n=[],o=[];for(let r=0;r<A.length;r++){const s=A[r];if("cut"!==s)o.push(s);else{const s=t.shift(),i=e[r];null!=i&&"polygon"===i.type&&i.rings&&i.rings.length>1&&s.rings.length>=i.rings.length?(n.push(s),o.push("simplify")):o.push(x?(0,webMercatorUtils.Gh)(s):s)}}if(!n.length)return o;const s=await async function m(m,p,f){const n="string"==typeof m?(0,urlUtils.An)(m):m,a=p[0].spatialReference,u=(0,jsonUtils.$B)(p[0]),l={...f,query:{...n.query,f:"json",sr:(0,spatialReferenceUtils.YX)(a),geometries:JSON.stringify((0,geometryService_utils.X)(p))}},{data:y}=await(0,request.A)(n.path+"/simplify",l);return(0,geometryService_utils.V)(y.geometries,u,a)}(p,n,r),i=[];for(let e=0;e<o.length;e++){const t=o[e];"simplify"!==t?i.push(t):i.push(x?(0,webMercatorUtils.Gh)(s.shift()):s.shift())}return i}const C=[];for(let t=0;t<A.length;t++){const e=A[t];if("cut"!==e)C.push(e);else{const t=z.shift();C.push(!0===x?(0,webMercatorUtils.Gh)(t):t)}}return C}function v(t){if(!t)return null;const e=t.extent;if(!e)return null;const n=t.spatialReference&&(0,spatialReferenceUtils.Vp)(t.spatialReference);if(!n)return e;const[o,s]=n.valid,r=2*s,{width:i}=e;let l,{xmin:c,xmax:u}=e;if([c,u]=[u,c],"extent"===t.type||0===i||i<=s||i>r||c<o||u>s)return e;switch(t.type){case"polygon":if(!(t.rings.length>1))return e;l=d(t.rings);break;case"polyline":if(!(t.paths.length>1))return e;l=d(t.paths);break;case"multipoint":l=t.points}const p=e.clone();for(let f=0;f<l.length;f++){let t=l[f][0];t<0?(t+=s,u=Math.max(t,u)):(t-=s,c=Math.min(t,c))}return p.xmin=c,p.xmax=u,p.width<i?(p.xmin-=s,p.xmax-=s,p):e}function P(t,e,n){const o=(0,spatialReferenceUtils.Vp)(n);if(null==o)return t;const[s,r]=o.valid,i=2*r;let l=0,c=0;e>r?l=Math.ceil(Math.abs(e-r)/i):e<s&&(l=-Math.ceil(Math.abs(e-s)/i)),t>r?c=Math.ceil(Math.abs(t-r)/i):t<s&&(c=-Math.ceil(Math.abs(t-s)/i));let u=t+(l-c)*i;const p=u-e;return p>r?u-=i:p<s&&(u+=i),u}function L(t,e){const n=(0,spatialReferenceUtils.Vp)(e);if(n){const[e,o]=n.valid,s=o-e;if(t<e)for(;t<e;)t+=s;if(t>o)for(;t>o;)t-=s}return t}},"./node_modules/@arcgis/core/geometry/support/normalizeUtilsCommon.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{j7:()=>r,kS:()=>s,kd:()=>i,r8:()=>o});var _Polyline_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@arcgis/core/geometry/Polyline.js"),_SpatialReference_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@arcgis/core/geometry/SpatialReference.js"),_jsonUtils_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@arcgis/core/geometry/support/jsonUtils.js");const r={102100:{maxX:20037508.342788905,minX:-20037508.342788905,plus180Line:new _Polyline_js__WEBPACK_IMPORTED_MODULE_0__.A({paths:[[[20037508.342788905,-20037508.342788905],[20037508.342788905,20037508.342788905]]],spatialReference:_SpatialReference_js__WEBPACK_IMPORTED_MODULE_1__.A.WebMercator}),minus180Line:new _Polyline_js__WEBPACK_IMPORTED_MODULE_0__.A({paths:[[[-20037508.342788905,-20037508.342788905],[-20037508.342788905,20037508.342788905]]],spatialReference:_SpatialReference_js__WEBPACK_IMPORTED_MODULE_1__.A.WebMercator})},4326:{maxX:180,minX:-180,plus180Line:new _Polyline_js__WEBPACK_IMPORTED_MODULE_0__.A({paths:[[[180,-180],[180,180]]],spatialReference:_SpatialReference_js__WEBPACK_IMPORTED_MODULE_1__.A.WGS84}),minus180Line:new _Polyline_js__WEBPACK_IMPORTED_MODULE_0__.A({paths:[[[-180,-180],[-180,180]]],spatialReference:_SpatialReference_js__WEBPACK_IMPORTED_MODULE_1__.A.WGS84})}};function i(e,n){return Math.ceil((e-n)/(2*n))}function s(e,n){const t=o(e);for(const r of t)for(const e of r)e[0]+=n;return e}function o(e){return(0,_jsonUtils_js__WEBPACK_IMPORTED_MODULE_2__.Bi)(e)?e.rings:e.paths}},"./node_modules/@arcgis/core/layers/graphics/data/QueryEngine.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{do:()=>L,ux:()=>V});var arrayUtils=__webpack_require__("./node_modules/@arcgis/core/core/arrayUtils.js"),compilerUtils=__webpack_require__("./node_modules/@arcgis/core/core/compilerUtils.js"),Error=__webpack_require__("./node_modules/@arcgis/core/core/Error.js"),JSONSupport=(__webpack_require__("./node_modules/@arcgis/core/core/has.js"),__webpack_require__("./node_modules/@arcgis/core/core/JSONSupport.js")),lang=__webpack_require__("./node_modules/@arcgis/core/core/lang.js"),maybe=__webpack_require__("./node_modules/@arcgis/core/core/maybe.js"),promiseUtils=__webpack_require__("./node_modules/@arcgis/core/core/promiseUtils.js"),unitUtils=__webpack_require__("./node_modules/@arcgis/core/core/unitUtils.js"),projection=__webpack_require__("./node_modules/@arcgis/core/geometry/projection.js"),aaBoundingBox=__webpack_require__("./node_modules/@arcgis/core/geometry/support/aaBoundingBox.js"),aaBoundingRect=__webpack_require__("./node_modules/@arcgis/core/geometry/support/aaBoundingRect.js"),boundsUtils=__webpack_require__("./node_modules/@arcgis/core/geometry/support/boundsUtils.js"),jsonUtils=__webpack_require__("./node_modules/@arcgis/core/geometry/support/jsonUtils.js"),spatialReferenceUtils=__webpack_require__("./node_modules/@arcgis/core/geometry/support/spatialReferenceUtils.js"),featureConversionUtils=__webpack_require__("./node_modules/@arcgis/core/layers/graphics/featureConversionUtils.js"),attributeSupport=__webpack_require__("./node_modules/@arcgis/core/layers/graphics/data/attributeSupport.js"),geometryUtils=__webpack_require__("./node_modules/@arcgis/core/layers/graphics/data/geometryUtils.js"),projectionSupport=__webpack_require__("./node_modules/@arcgis/core/layers/graphics/data/projectionSupport.js");class QueryEngineCache_e{constructor(){this._storage=new Map,this._purgeInterval=5,this._sweep=()=>{if(this._timer=void 0,!this._storage)return;const t=1e3*this._purgeInterval,e=performance.now()-t;for(const[s,r]of this._storage){if(!(r.time<e))return void(this._storage.size>0&&(this._timer=setTimeout(this._sweep,t)));this._storage.delete(s)}}}destroy(){this._storage?.clear(),this._storage=null,clearTimeout(this._timer)}put(t,e){this._storage?.set(t,new r(e)),this._scheduleSweep()}get(t){const e=this._storage?.get(t);if(e)return this._storage?.delete(t),e.time=performance.now(),this._storage?.set(t,e),e.items}clear(){this._storage?.clear()}_scheduleSweep(){this._storage&&(this._timer??=setTimeout(this._sweep,1e3*this._purgeInterval))}get test(){}}let s=0;class r{constructor(t){this.items=t,this.time=performance.now(),this.id=s++}}var QueryEngineCapabilities=__webpack_require__("./node_modules/@arcgis/core/layers/graphics/data/QueryEngineCapabilities.js"),QueryEngineResult=__webpack_require__("./node_modules/@arcgis/core/layers/graphics/data/QueryEngineResult.js"),queryUtils=__webpack_require__("./node_modules/@arcgis/core/layers/graphics/data/queryUtils.js"),queryValidationUtils=__webpack_require__("./node_modules/@arcgis/core/layers/graphics/data/queryValidationUtils.js"),spatialQuerySupport=__webpack_require__("./node_modules/@arcgis/core/layers/graphics/data/spatialQuerySupport.js"),timeSupport=__webpack_require__("./node_modules/@arcgis/core/layers/graphics/data/timeSupport.js"),FieldsIndex=__webpack_require__("./node_modules/@arcgis/core/layers/support/FieldsIndex.js"),Scheduler=__webpack_require__("./node_modules/@arcgis/core/views/support/Scheduler.js");class L{constructor(e){this._changeHandle=null,this.capabilities={query:QueryEngineCapabilities.F},this.geometryType=e.geometryType,this.hasM=!!e.hasM,this.hasZ=!!e.hasZ,this.objectIdField=e.objectIdField,this.spatialReference=e.spatialReference,this.definitionExpression=e.definitionExpression,this.featureStore=e.featureStore,this.aggregateAdapter=e.aggregateAdapter,this._cache=e.cache??new QueryEngineCache_e,this.timeInfo=e.timeInfo,this._changeHandle=this.featureStore.events.on("changed",(()=>this._clearCache())),this.fieldsIndex=JSONSupport.A.isSerializable(e.fieldsIndex)?e.fieldsIndex:FieldsIndex.A.fromJSON(e.fieldsIndex),!e.availableFields||1===e.availableFields.length&&"*"===e.availableFields[0]?this.availableFields=new Set(this.fieldsIndex.fields.map((e=>e.name))):this.availableFields=new Set(e.availableFields.map((e=>this.fieldsIndex.get(e)?.name)).filter((e=>null!=e))),e.scheduler&&e.priority&&(this._frameTask=e.scheduler.registerTask(e.priority))}destroy(){this._changeHandle=(0,maybe.xt)(this._changeHandle),this._frameTask=(0,maybe.xt)(this._frameTask),this._clearCache(),(0,maybe.pR)(this._cache)}get featureAdapter(){return this.featureStore.featureAdapter}_clearCache(){this._cache.clear(),this._allFeaturesPromise=null,this._timeExtentPromise=null,this._fullExtentPromise=null}async executeQuery(e,t){const s=(0,promiseUtils.Mq)(t);try{const t=await this._executeQuery(e,{},s);return await t.createQueryResponse()}catch(i){if(i!==queryUtils.v8)throw i;return new QueryEngineResult.G([],e,this).createQueryResponse()}}async executeQueryForCount(e={},t){const s=(0,promiseUtils.Mq)(t);try{return(await this._executeQuery(e,{returnGeometry:!1,returnCentroid:!1,outSR:null},s)).createQueryResponseForCount()}catch(i){if(i!==queryUtils.v8)throw i;return 0}}async executeQueryForExtent(e,t){const s=(0,promiseUtils.Mq)(t),i=e.outSR;try{const t=await this._executeQuery(e,{returnGeometry:!0,returnCentroid:!1,outSR:null},s),r=t.size;return r?{count:r,extent:await this._getBounds(t.items,t.spatialReference,i||this.spatialReference)}:{count:0,extent:null}}catch(r){if(r===queryUtils.v8)return{count:0,extent:null};throw r}}async executeQueryForIds(e,t){return this.executeQueryForIdSet(e,t).then((e=>Array.from(e)))}async executeQueryForIdSet(e,t){const s=(0,promiseUtils.Mq)(t);try{const t=await this._executeQuery(e,{returnGeometry:!0,returnCentroid:!1,outSR:null},s),i=t.items,r=new Set;return await this.reschedule((()=>{for(const e of i)r.add(t.featureAdapter.getObjectId(e))}),s),r}catch(i){if(i===queryUtils.v8)return new Set;throw i}}async executeQueryForLatestObservations(e,t){const s=(0,promiseUtils.Mq)(t);if(!this.timeInfo?.trackIdField)throw new Error.A("unsupported-query","Missing timeInfo or timeInfo.trackIdField",{query:e,timeInfo:this.timeInfo});try{const t=await this._executeQuery(e,{},s);return await this.reschedule((()=>this._filterLatest(t)),s),await t.createQueryResponse()}catch(r){if(r!==queryUtils.v8)throw r;return new QueryEngineResult.G([],e,this).createQueryResponse()}}async executeAttributeBinsQuery(e,t){const s=(0,promiseUtils.Mq)(t);let i;e=(0,lang.o8)(e);try{e=await this.schedule((()=>(0,queryUtils.iJ)(e,this.definitionExpression,this.spatialReference)),s),e=await this.reschedule((()=>(0,queryValidationUtils.FQ)(e,{availableFields:this.availableFields,fieldsIndex:this.fieldsIndex,geometryType:this.geometryType,spatialReference:this.spatialReference})),s);const t=await this.reschedule((()=>this._executeSceneFilterQuery(e,s)),s);i=await this.reschedule((()=>this._executeGeometryQuery(e,t,s)),s),await this.reschedule((()=>this._executeAggregateIdsQuery(i)),s),await this.reschedule((()=>this.executeObjectIdsQuery(i)),s),await this.reschedule((()=>this.executeTimeQuery(i)),s),await this.reschedule((()=>this.executeAttributesQuery(i)),s)}catch(r){if(r!==queryUtils.v8)throw r;i=new QueryEngineResult.G([],e,this)}return i.createQueryBinsResponse(e)}async executeQueryForSummaryStatistics(e={},t,s){const i=(0,promiseUtils.Mq)(s),{field:r,normalizationField:a,valueExpression:n}=t;return(await this._executeQueryForStatistics(e,{field:r,normalizationField:a,valueExpression:n},i)).createSummaryStatisticsResponse(t)}async executeQueryForUniqueValues(e={},t,s){const i=(0,promiseUtils.Mq)(s),{field:r,field2:a,field3:n,valueExpression:u}=t;return(await this._executeQueryForStatistics(e,{field:r,field2:a,field3:n,valueExpression:u},i)).createUniqueValuesResponse(t)}async executeQueryForClassBreaks(e={},t,s){const i=(0,promiseUtils.Mq)(s),{field:r,normalizationField:a,valueExpression:n}=t;return(await this._executeQueryForStatistics(e,{field:r,normalizationField:a,valueExpression:n},i)).createClassBreaksResponse(t)}async executeQueryForHistogram(e={},t,s){const i=(0,promiseUtils.Mq)(s),{field:r,normalizationField:a,valueExpression:n}=t;return(await this._executeQueryForStatistics(e,{field:r,normalizationField:a,valueExpression:n},i)).createHistogramResponse(t)}async fetchRecomputedExtents(e){const t=(0,promiseUtils.Mq)(e);this._timeExtentPromise||=(0,timeSupport.W)(this.timeInfo,this.featureStore);const[s,i]=await Promise.all([this._getFullExtent(),this._timeExtentPromise]);return(0,promiseUtils.Te)(t),{fullExtent:s,timeExtent:i}}async _getBounds(e,t,s){const i=(0,aaBoundingBox.hZ)((0,aaBoundingBox.vt)(),aaBoundingBox.qv);await this.featureStore.forEachBounds(e,(e=>(0,aaBoundingBox.RF)(i,e)));const r={xmin:i[0],ymin:i[1],xmax:i[3],ymax:i[4],spatialReference:(0,geometryUtils.ag)(this.spatialReference)};this.hasZ&&isFinite(i[2])&&isFinite(i[5])&&(r.zmin=i[2],r.zmax=i[5],r.hasZ=!0);const a=(0,projectionSupport.Cv)(r,t,s);if(a.spatialReference=(0,geometryUtils.ag)(s),a.xmax-a.xmin==0){const e=(0,unitUtils.GA)(a.spatialReference);a.xmin-=e,a.xmax+=e}if(a.ymax-a.ymin==0){const e=(0,unitUtils.GA)(a.spatialReference);a.ymin-=e,a.ymax+=e}if(this.hasZ&&null!=a.zmin&&null!=a.zmax&&a.zmax-a.zmin==0){const e=(0,unitUtils.GA)(a.spatialReference);a.zmin-=e,a.zmax+=e}return a}_getFullExtent(){return this._fullExtentPromise||="getFullExtent"in this.featureStore&&this.featureStore.getFullExtent?Promise.resolve(this.featureStore.getFullExtent(this.spatialReference)):this._getAllFeatures().then((e=>this._getBounds(e,this.spatialReference,this.spatialReference))),this._fullExtentPromise}async schedule(e,t){return this._frameTask?.schedule(e,t)??e(Scheduler.Bb)}async reschedule(e,t){return this._frameTask?.reschedule(e,t)??e(Scheduler.Bb)}async _getAllFeaturesQueryEngineResult(e){return new QueryEngineResult.G(await this._getAllFeatures(),e,this)}async _getAllFeatures(){if(null==this._allFeaturesPromise){const e=[];this._allFeaturesPromise=(async()=>await this.featureStore.forEach((t=>e.push(t))))().then((()=>(0,compilerUtils.zI)(e)))}const e=this._allFeaturesPromise,t=await e;return e===this._allFeaturesPromise?t.slice():this._getAllFeatures()}async _executeQuery(e,t,s){e=(0,lang.o8)(e),e=await this.schedule((()=>(0,queryUtils.GC)(e,this.definitionExpression,this.spatialReference)),s),e=await this.reschedule((()=>(0,queryValidationUtils.B4)(e,{availableFields:this.availableFields,fieldsIndex:this.fieldsIndex,geometryType:this.geometryType,spatialReference:this.spatialReference})),s),e={...e,...t};const i=await this.reschedule((()=>this._executeSceneFilterQuery(e,s)),s),r=await this.reschedule((()=>this._executeGeometryQuery(e,i,s)),s);return await this.reschedule((()=>this._executeAggregateIdsQuery(r)),s),await this.reschedule((()=>this.executeObjectIdsQuery(r)),s),await this.reschedule((()=>this.executeTimeQuery(r)),s),await this.reschedule((()=>this.executeAttributesQuery(r)),s),r}async _executeSceneFilterQuery(e,t){if(null==e.sceneFilter)return null;const{outSR:s,returnGeometry:i,returnCentroid:r}=e,a=this.featureStore.featureSpatialReference,n=e.sceneFilter.geometry,u=null==a||(0,spatialReferenceUtils.aI)(a,n.spatialReference)?n:(0,projectionSupport.Cv)(n,a);if(!u)return null;const l=i||r,o=(0,spatialReferenceUtils.fn)(s)&&!(0,spatialReferenceUtils.aI)(this.spatialReference,s)&&l?async e=>this._project(e,s):e=>e,h=this.featureAdapter,c=await this.reschedule((()=>this.searchFeatures(V(u))),t);if("disjoint"===e.sceneFilter.spatialRelationship){if(!c.length)return null;const s=new Set;for(const e of c)s.add(h.getObjectId(e));const i=await this.reschedule((()=>this._getAllFeatures()),t),r=await this.reschedule((async()=>{const r=await(0,spatialQuerySupport.xt)("esriSpatialRelDisjoint",u,this.geometryType,this.hasZ,this.hasM),n=await this.runSpatialFilter(i,(e=>!s.has(h.getObjectId(e))||r(h.getGeometry(e))),t);return new QueryEngineResult.G(n,e,this)}),t);return o(r)}if(!c.length)return new QueryEngineResult.G([],e,this);if(this._canExecuteSinglePass(u,e))return o(new QueryEngineResult.G(c,e,this));const m=await(0,spatialQuerySupport.xt)("esriSpatialRelContains",u,this.geometryType,this.hasZ,this.hasM),f=await this.runSpatialFilter(c,(e=>m(h.getGeometry(e))),t);return o(new QueryEngineResult.G(f,e,this))}async _executeGeometryQuery(s,i,r){if(null!=i&&0===i.items.length)return i;const{geometry:a,outSR:n,returnGeometry:u,returnCentroid:l}=s,o=i?null:this._getCacheKey(s),h=o?this._cache.get(o):null;if(h)return new QueryEngineResult.G(h,s,this);const c=(0,spatialReferenceUtils.fn)(n)&&!(0,spatialReferenceUtils.aI)(this.spatialReference,n),m=u||l,f=async e=>(c&&m&&await this._project(e,n),o&&this._cache.put(o,e.items),e),d=this.featureStore.featureSpatialReference,y=!a||null==d||(0,spatialReferenceUtils.aI)(d,a.spatialReference)?a:(0,projectionSupport.Cv)(a,d);if(!y)return f(null!=i?i:await this._getAllFeaturesQueryEngineResult(s));const p=this.featureAdapter;let g=await this.reschedule((()=>this.searchFeatures(V(a))),r);const x=s.spatialRel??"esriSpatialRelIntersects";if("esriSpatialRelDisjoint"===x){if(!g.length)return f(null!=i?i:await this._getAllFeaturesQueryEngineResult(s));const e=new Set;for(const s of g)e.add(p.getObjectId(s));const t=null!=i?i.items:await this.reschedule((()=>this._getAllFeatures()),r),a=await this.reschedule((async()=>{const i=await(0,spatialQuerySupport.xt)(x,y,this.geometryType,this.hasZ,this.hasM),n=await this.runSpatialFilter(t,(t=>!e.has(p.getObjectId(t))||i(p.getGeometry(t))),r);return new QueryEngineResult.G(n,s,this)}),r);return f(a)}if(null!=i){const s=new arrayUtils.vW;g=g.filter((t=>(0,arrayUtils.qh)(i.items,t,i.items.length,s)>=0))}if(!g.length){const e=new QueryEngineResult.G([],s,this);return o&&this._cache.put(o,e.items),e}if(this._canExecuteSinglePass(y,s))return f(new QueryEngineResult.G(g,s,this));const w=await(0,spatialQuerySupport.xt)(x,y,this.geometryType,this.hasZ,this.hasM),F=await this.runSpatialFilter(g,(e=>w(p.getGeometry(e))),r);return f(new QueryEngineResult.G(F,s,this))}_executeAggregateIdsQuery(e){if(0===e.items.length||!e.query.aggregateIds?.length||null==this.aggregateAdapter)return;const t=new Set;for(const i of e.query.aggregateIds)this.aggregateAdapter.getFeatureObjectIds(i).forEach((e=>t.add(e)));const s=this.featureAdapter.getObjectId;e.items=e.items.filter((e=>t.has(s(e))))}executeObjectIdsQuery(e){if(0===e.items.length||!e.query.objectIds?.length)return;const t=new Set(e.query.objectIds),s=this.featureAdapter.getObjectId;e.items=e.items.filter((e=>t.has(s(e))))}executeTimeQuery(e){if(0===e.items.length)return;const t=(0,timeSupport.I)(this.timeInfo,e.query.timeExtent,this.featureAdapter);null!=t&&(e.items=e.items.filter(t))}executeAttributesQuery(e){if(0===e.items.length)return;const t=(0,attributeSupport.j4)(e.query.where,this.fieldsIndex);if(t){if(!t.isStandardized)throw new TypeError("Where clause is not standardized");e.items=e.items.filter((e=>t.testFeature(e,this.featureAdapter)))}}async runSpatialFilter(e,t,s){if(!t)return e;if(null==this._frameTask)return e.filter((e=>t(e)));let i=0;const r=new Array,a=async n=>{for(;i<e.length;){const u=e[i++];t(u)&&(r.push(u),n.madeProgress()),n.done&&await this.reschedule((e=>a(e)),s)}};return this.reschedule((e=>a(e)),s).then((()=>r))}_filterLatest(e){const{trackIdField:t,startTimeField:s,endTimeField:i}=this.timeInfo,r=i||s,a=new Map,n=this.featureAdapter.getAttribute;for(const u of e.items){const e=n(u,t),s=n(u,r),i=a.get(e);(!i||s>n(i,r))&&a.set(e,u)}e.items=Array.from(a.values())}_getCacheKey(e){const{geometry:t,spatialRel:s,returnGeometry:i,returnCentroid:r,outSR:a,resultType:n,cacheHint:u}=e;if("tile"!==n&&!u)return null;const l=i||r;return(0,spatialReferenceUtils.fn)(a)&&!(0,spatialReferenceUtils.aI)(this.spatialReference,a)&&l?JSON.stringify([t,s,a]):JSON.stringify([t,s])}_canExecuteSinglePass(e,t){const{spatialRel:s}=t;return(0,spatialQuerySupport.tC)(e)&&("esriSpatialRelEnvelopeIntersects"===s||"esriGeometryPoint"===this.geometryType&&("esriSpatialRelIntersects"===s||"esriSpatialRelContains"===s))}async _project(e,t){if(!t||(0,spatialReferenceUtils.aI)(this.spatialReference,t))return e;const i=this.featureAdapter;let r;try{const e=await this._getFullExtent();r=(0,projection.getTransformation)(this.spatialReference,t,e)}catch{}const a=await(0,projectionSupport.lK)(e.items.map((e=>(0,geometryUtils.pL)(this.geometryType,this.hasZ,this.hasM,i.getGeometry(e)))),this.spatialReference,t,r);return e.items=(0,compilerUtils.zI)(a.map(((t,s)=>i.cloneWithGeometry(e.items[s],(0,featureConversionUtils.Ux)(t,this.hasZ,this.hasM))))),e}async searchFeatures(e){const t=new Set;await Promise.all(e.map((e=>this.featureStore.forEachInBounds(e,(e=>t.add(e))))));const s=Array.from(t.values());return t.clear(),s}async _executeQueryForStatistics(e,t,s){e=(0,lang.o8)(e);try{e=await this.schedule((()=>(0,queryUtils.GC)(e,this.definitionExpression,this.spatialReference)),s),e=await this.reschedule((()=>(0,queryValidationUtils.mO)(e,t,{availableFields:this.availableFields,fieldsIndex:this.fieldsIndex,geometryType:this.geometryType,spatialReference:this.spatialReference})),s);const i=await this.reschedule((()=>this._executeSceneFilterQuery(e,s)),s),r=await this.reschedule((()=>this._executeGeometryQuery(e,i,s)),s);return await this.reschedule((()=>this._executeAggregateIdsQuery(r)),s),await this.reschedule((()=>this.executeObjectIdsQuery(r)),s),await this.reschedule((()=>this.executeTimeQuery(r)),s),await this.reschedule((()=>this.executeAttributesQuery(r)),s),r}catch(i){if(i!==queryUtils.v8)throw i;return new QueryEngineResult.G([],e,this)}}get test(){}}function V(e){if((0,spatialQuerySupport.tC)(e)){if((0,jsonUtils.ZC)(e))return[(0,aaBoundingRect.fA)(Math.min(e.xmin,e.xmax),Math.min(e.ymin,e.ymax),Math.max(e.xmin,e.xmax),Math.max(e.ymin,e.ymax))];if((0,jsonUtils.Bi)(e))return e.rings.map((e=>(0,aaBoundingRect.fA)(Math.min(e[0][0],e[2][0]),Math.min(e[0][1],e[2][1]),Math.max(e[0][0],e[2][0]),Math.max(e[0][1],e[2][1]))))}return[(0,boundsUtils.Rg)((0,aaBoundingRect.vt)(),e)]}},"./node_modules/@arcgis/core/layers/graphics/data/QueryEngineCapabilities.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{F:()=>t,P:()=>s});const t={supportsStatistics:!0,supportsPercentileStatistics:!0,supportsSpatialAggregationStatistics:!1,supportedSpatialAggregationStatistics:{envelope:!1,centroid:!1,convexHull:!1},supportsCentroid:!0,supportsCacheHint:!0,supportsCurrentUser:!1,supportsDistance:!0,supportsDistinct:!0,supportsExtent:!0,supportsGeometryProperties:!1,supportsHavingClause:!0,supportsOrderBy:!0,supportsPagination:!0,supportsQuantization:!0,supportsQuantizationEditMode:!1,supportsQueryGeometry:!0,supportsResultType:!0,supportsReturnMesh:!1,supportsSqlExpression:!0,supportsMaxRecordCountFactor:!1,supportsStandardizedQueriesOnly:!0,supportsTopFeaturesQuery:!1,supportsQueryByAnonymous:!0,supportsQueryByOthers:!0,supportsHistoricMoment:!1,supportsFormatPBF:!1,supportsDisjointSpatialRelationship:!0,supportsDefaultSpatialReference:!1,supportsFullTextSearch:!1,supportsCompactGeometry:!1,maxRecordCountFactor:void 0,maxRecordCount:void 0,standardMaxRecordCount:void 0,tileMaxRecordCount:void 0,supportsTrueCurve:!1},s={supportsDate:!0,supportsFixedInterval:!0,supportsAutoInterval:!0,supportsFixedBoundaries:!0,supportsStackBy:!0,supportsSplitBy:!0,supportsSnapToData:!1,supportsReturnFullIntervalBin:!1,supportsFirstDayOfWeek:!1,supportsNormalization:!0,supportedStatistics:{count:!0,sum:!0,avg:!0,var:!0,stddev:!0,min:!0,max:!0,percentileContinuous:!0,percentileDiscrete:!0,envelope:!0,centroid:!0,convexHull:!0},supportedNormalizationTypes:{field:!0,log:!0,naturalLog:!0,percentOfTotal:!0,squareRoot:!0}}},"./node_modules/@arcgis/core/layers/graphics/data/QueryEngineResult.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{G:()=>C});var lang=__webpack_require__("./node_modules/@arcgis/core/core/lang.js"),timeUtils=__webpack_require__("./node_modules/@arcgis/core/core/timeUtils.js"),centroid=__webpack_require__("./node_modules/@arcgis/core/geometry/support/centroid.js"),extentUtils=__webpack_require__("./node_modules/@arcgis/core/geometry/support/extentUtils.js"),quantizationUtils=__webpack_require__("./node_modules/@arcgis/core/geometry/support/quantizationUtils.js"),spatialReferenceUtils=__webpack_require__("./node_modules/@arcgis/core/geometry/support/spatialReferenceUtils.js"),attributeSupport=__webpack_require__("./node_modules/@arcgis/core/layers/graphics/data/attributeSupport.js"),geometryUtils=__webpack_require__("./node_modules/@arcgis/core/layers/graphics/data/geometryUtils.js"),fieldUtils=__webpack_require__("./node_modules/@arcgis/core/layers/support/fieldUtils.js"),utils=__webpack_require__("./node_modules/@arcgis/core/smartMapping/statistics/support/utils.js"),statistics_utils=__webpack_require__("./node_modules/@arcgis/core/statistics/utils.js"),arcadeOnDemand=__webpack_require__("./node_modules/@arcgis/core/support/arcadeOnDemand.js");class AttributesBuilder_c{constructor(s,a,l){this._fieldDataCache=new Map,this._returnDistinctMap=new Map,this.returnDistinctValues=s.returnDistinctValues??!1,this.fieldsIndex=l,this.featureAdapter=a;const r=s.outFields;if(r&&!r.includes("*")){this.outFields=r;let s=0;for(const a of r){const r=(0,attributeSupport.Wq)(a),n=this.fieldsIndex.get(r),u=n?null:(0,attributeSupport.j4)(r,l),o=n?n.name:(0,attributeSupport.SY)(a)||"FIELD_EXP_"+s++;this._fieldDataCache.set(a,{alias:o,clause:u})}}}countDistinctValues(t){return this.returnDistinctValues?(t.forEach((t=>this.getAttributes(t))),this._returnDistinctMap.size):t.length}getAttributes(t){const e=this._processAttributesForOutFields(t);return this._processAttributesForDistinctValues(e)}getFieldValue(t,i,s){const a=s?s.name:i;let l=null;return this._fieldDataCache.has(a)?l=this._fieldDataCache.get(a)?.clause:s||(l=(0,attributeSupport.j4)(i,this.fieldsIndex),this._fieldDataCache.set(a,{alias:a,clause:l})),s?this.featureAdapter.getAttribute(t,a):l?.calculateValue(t,this.featureAdapter)}getDataValues(t,e,i=!0){const s=e.normalizationType,d=e.normalizationTotal,c=this.fieldsIndex.get(e.field),h=(0,fieldUtils.zD)(c)||(0,fieldUtils.Ah)(c),f=(0,fieldUtils.OH)(c);return t.map((t=>{let a=e.field&&this.getFieldValue(t,e.field,this.fieldsIndex.get(e.field));if(e.field2?(a=`${(0,statistics_utils.gJ)(a)}${e.fieldDelimiter}${(0,statistics_utils.gJ)(this.getFieldValue(t,e.field2,this.fieldsIndex.get(e.field2)))}`,e.field3&&(a=`${a}${e.fieldDelimiter}${(0,statistics_utils.gJ)(this.getFieldValue(t,e.field3,this.fieldsIndex.get(e.field3)))}`)):"string"==typeof a&&i&&(h?a=a?new Date(a).getTime():null:f&&(a=a?(0,utils.rb)(a):null)),s&&Number.isFinite(a)){const i="field"===s&&e.normalizationField?this.getFieldValue(t,e.normalizationField,this.fieldsIndex.get(e.normalizationField)):null;a=(0,statistics_utils.zS)(a,s,i,d)}return a}))}async getExpressionValues(t,e,i,a,l){const{arcadeUtils:r}=await(0,arcadeOnDemand.lw)(),n=r.hasGeometryOperations(e);n&&await r.enableGeometryOperations();const u=r.createFunction(e),o=r.getViewInfo(i),c={fields:this.fieldsIndex.fields};return t.map((t=>{const e={attributes:this.featureAdapter.getAttributes(t),layer:c,geometry:n?{...(0,geometryUtils.pL)(a.geometryType,a.hasZ,a.hasM,this.featureAdapter.getGeometry(t)),spatialReference:i?.spatialReference}:null},d=r.createExecContext(e,o,l);return r.executeFunction(u,d)}))}validateItem(t,i){return this._fieldDataCache.has(i)||this._fieldDataCache.set(i,{alias:i,clause:(0,attributeSupport.j4)(i,this.fieldsIndex)}),this._fieldDataCache.get(i)?.clause?.testFeature(t,this.featureAdapter)??!1}validateItems(t,i){return this._fieldDataCache.has(i)||this._fieldDataCache.set(i,{alias:i,clause:(0,attributeSupport.j4)(i,this.fieldsIndex)}),this._fieldDataCache.get(i)?.clause?.testSet(t,this.featureAdapter)??!1}_processAttributesForOutFields(t){const e=this.outFields;if(!e?.length)return this.featureAdapter.getAttributes(t);const i={};for(const s of e){const{alias:e,clause:a}=this._fieldDataCache.get(s);i[e]=a?a.calculateValue(t,this.featureAdapter):this.featureAdapter.getAttribute(t,e)}return i}_processAttributesForDistinctValues(t){if(null==t||!this.returnDistinctValues)return t;const e=this.outFields,i=[];if(e)for(const l of e){const{alias:e}=this._fieldDataCache.get(l);i.push(t[e])}else for(const l in t)i.push(t[l]);const s=`${(e||["*"]).join(",")}=${i.join(",")}`;let a=this._returnDistinctMap.get(s)||0;return this._returnDistinctMap.set(s,++a),a>1?null:t}}var projectionSupport=__webpack_require__("./node_modules/@arcgis/core/layers/graphics/data/projectionSupport.js"),queryUtils=__webpack_require__("./node_modules/@arcgis/core/layers/graphics/data/queryUtils.js"),SnappingCandidate=__webpack_require__("./node_modules/@arcgis/core/layers/graphics/data/SnappingCandidate.js"),AutoIntervalBinParameters=__webpack_require__("./node_modules/@arcgis/core/rest/support/AutoIntervalBinParameters.js"),DateBinParameters=__webpack_require__("./node_modules/@arcgis/core/rest/support/DateBinParameters.js"),FixedBoundariesBinParameters=__webpack_require__("./node_modules/@arcgis/core/rest/support/FixedBoundariesBinParameters.js"),FixedIntervalBinParameters=__webpack_require__("./node_modules/@arcgis/core/rest/support/FixedIntervalBinParameters.js");const G="bin";class C{constructor(e,t,i){this.items=e,this.query=t,this.geometryType=i.geometryType,this.hasM=i.hasM,this.hasZ=i.hasZ,this.fieldsIndex=i.fieldsIndex,this.objectIdField=i.objectIdField,this.spatialReference=i.spatialReference,this.featureAdapter=i.featureAdapter}get size(){return this.items.length}createQueryResponseForCount(){const e=new AttributesBuilder_c(this.query,this.featureAdapter,this.fieldsIndex);if(!this.query.outStatistics)return e.countDistinctValues(this.items);const{groupByFieldsForStatistics:t,having:i,outStatistics:s}=this.query,a=t?.length;if(!a)return 1;const r=new Map,n=new Map,o=new Set;for(const l of s){const{statisticType:s}=l,a="exceedslimit"!==s?l.onStatisticField:void 0;if(!n.has(a)){const i=[];for(const s of t){const t=this._getAttributeValues(e,s,this.items,r);i.push(t)}n.set(a,this._calculateUniqueValues(i,this.items,e.returnDistinctValues))}const u=n.get(a);for(const t in u){const{data:s,items:a}=u[t],r=s.join(",");i&&!e.validateItems(a,i)||o.add(r)}}return o.size}async createQueryResponse(){let e;if(e=this.query.outStatistics?this.query.outStatistics.some((e=>"exceedslimit"===e.statisticType))?this._createExceedsLimitQueryResponse():await this._createStatisticsQueryResponse(this.query,this.items):this._createFeatureQueryResponse(this.query),this.query.returnQueryGeometry){const t=this.query.geometry;(0,spatialReferenceUtils.fn)(this.query.outSR)&&!(0,spatialReferenceUtils.aI)(t.spatialReference,this.query.outSR)?e.queryGeometry=(0,geometryUtils.ag)({spatialReference:this.query.outSR,...(0,projectionSupport.Cv)(t,t.spatialReference,this.query.outSR)}):e.queryGeometry=(0,geometryUtils.ag)({spatialReference:this.query.outSR,...t})}return e}createSnappingResponse(e,t){const i=this.featureAdapter,s=O(this.hasZ,this.hasM),{point:a,mode:r}=e,n="number"==typeof e.distance?e.distance:e.distance.x,o="number"==typeof e.distance?e.distance:e.distance.y,l={candidates:[]},u="esriGeometryPolygon"===this.geometryType,c="esriGeometryPolyline"===this.geometryType||"esriGeometryPoint"===this.geometryType,m=this._getPointCreator(r,this.spatialReference,t),d=new H(null,0),h=new H(null,0),p={x:0,y:0,z:0};for(const g of this.items){const t=i.getGeometry(g);if(null==t)continue;const{coords:r}=t,x=t.isPoint?Q:t.lengths;if(d.coords=r,h.coords=r,e.returnEdge){let e=0;for(let t=0;t<x.length;t++){const r=x[t],c=e;for(let t=0;t<r;t++,e+=s){if(!u&&t===r-1)continue;const y=d;y.coordsIndex=e;const x=h;x.coordsIndex=t===r-1?c:e+s;const T=p;if(!E(p,a,y,x))continue;const I=(a.x-T.x)/n,F=(a.y-T.y)/o,_=I*I+F*F;_<=1&&l.candidates.push((0,SnappingCandidate.P)(i.getObjectId(g),m(T),Math.sqrt(_),m(y),m(x)))}}}if("all"===e.vertexMode){let e=0;for(let t=0;t<x.length;t++){const r=x[t],c=e,p=h;p.coordsIndex=c;for(let t=0;t<r;t++,e+=s){const s=d;if(s.coordsIndex=e,u&&t===r-1&&s.x===p.x&&s.y===p.y)continue;const c=(a.x-s.x)/n,h=(a.y-s.y)/o,f=c*c+h*h;f<=1&&l.candidates.push((0,SnappingCandidate.k)(i.getObjectId(g),m(s),Math.sqrt(f)))}}}else if(c&&"ends"===e.vertexMode){let e=0;const t=[];for(let i=0;i<x.length;i++){t.push(e);const a=x[i];e+=a*s,!u&&a>1&&t.push(e-s)}for(const s of t){const e=d;e.coordsIndex=s;const t=(a.x-e.x)/n,r=(a.y-e.y)/o,u=t*t+r*r;u<=1&&l.candidates.push((0,SnappingCandidate.k)(i.getObjectId(g),m(e),Math.sqrt(u)))}}}return l.candidates.sort(((e,t)=>e.distance-t.distance)),l}_getPointCreator(e,t,i){const s=null==i||(0,spatialReferenceUtils.aI)(t,i)?e=>e:e=>(0,projectionSupport.Cv)(e,t,i),{hasZ:a}=this;return"3d"===e?a?({x:e,y:t,z:i})=>s({x:e,y:t,z:i}):({x:e,y:t})=>s({x:e,y:t,z:0}):({x:e,y:t})=>s({x:e,y:t})}async createSummaryStatisticsResponse(e){const{field:t,valueExpression:i,normalizationField:s,normalizationType:a,normalizationTotal:r,minValue:n,maxValue:o,scale:l,timeZone:u,outStatisticTypes:c}=e,m=this.fieldsIndex.get(t),d=(0,fieldUtils.vE)(m)||(0,fieldUtils.zD)(m)||(0,fieldUtils.Ah)(m),h=await this._getDataValues({field:t,valueExpression:i,normalizationField:s,normalizationType:a,normalizationTotal:r,scale:l,timeZone:u},this.items),p=(0,statistics_utils.Vb)({normalizationType:a,normalizationField:s,minValue:n,maxValue:o}),f={value:.5,fieldType:m?.type},y=(0,fieldUtils.yM)(m)?(0,statistics_utils.z9)({values:h,supportsNullCount:p,percentileParams:f,outStatisticTypes:c}):(0,statistics_utils.G_)({values:h,minValue:n,maxValue:o,useSampleStdDev:!a,supportsNullCount:p,percentileParams:f,outStatisticTypes:c});return(0,statistics_utils.oZ)(y,c,d)}async createUniqueValuesResponse(e){const{field:t,valueExpression:i,domains:s,returnAllCodedValues:a,scale:r,timeZone:n}=e,o=await this._getDataValues({field:t,field2:e.field2,field3:e.field3,fieldDelimiter:e.fieldDelimiter,valueExpression:i,scale:r,timeZone:n},this.items,!1),l=(0,statistics_utils.b3)(o);return(0,statistics_utils.lv)(l,s,a,e.fieldDelimiter)}async createClassBreaksResponse(e){const{field:t,valueExpression:i,normalizationField:s,normalizationType:a,normalizationTotal:r,classificationMethod:n,standardDeviationInterval:o,minValue:l,maxValue:u,numClasses:c,scale:m,timeZone:d}=e,h=await this._getDataValues({field:t,valueExpression:i,normalizationField:s,normalizationType:a,normalizationTotal:r,scale:m,timeZone:d},this.items),p=(0,statistics_utils.Rw)(h,{field:t,normalizationField:s,normalizationType:a,normalizationTotal:r,classificationMethod:n,standardDeviationInterval:o,minValue:l,maxValue:u,numClasses:c});return(0,statistics_utils.jM)(p,n)}async createHistogramResponse(e){const{field:t,valueExpression:i,normalizationField:s,normalizationType:a,normalizationTotal:r,classificationMethod:n,standardDeviationInterval:o,minValue:l,maxValue:u,numBins:c,scale:m,timeZone:d}=e,h=await this._getDataValues({field:t,valueExpression:i,normalizationField:s,normalizationType:a,normalizationTotal:r,scale:m,timeZone:d},this.items);return(0,statistics_utils.$y)(h,{field:t,normalizationField:s,normalizationType:a,normalizationTotal:r,classificationMethod:n,standardDeviationInterval:o,minValue:l,maxValue:u,numBins:c})}_sortFeatures(e,t,i){if(e.length>1&&t?.length)for(const s of t.slice().reverse()){const t=s.split(" "),a=t[0],r=this.fieldsIndex.get(a),n=!!t[1]&&"desc"===t[1].toLowerCase(),o=(0,statistics_utils.FM)(r?.type,n);e.sort(((e,t)=>{const s=i(e,a,r),n=i(t,a,r);return o(s,n)}))}}_createFeatureQueryResponse(e){const{items:t,geometryType:i,hasM:s,hasZ:a,objectIdField:r,spatialReference:o}=this,{outFields:l,outSR:u,quantizationParameters:m,resultRecordCount:d,resultOffset:h,returnZ:p,returnM:f}=e,y=null!=d&&t.length>(h||0)+d,g=l&&(l.includes("*")?[...this.fieldsIndex.fields]:l.map((e=>this.fieldsIndex.get(e))));return{exceededTransferLimit:y,features:this._createFeatures(e,t),fields:g,geometryType:i,hasM:s&&f,hasZ:a&&p,objectIdFieldName:r,spatialReference:(0,geometryUtils.ag)(u||o),transform:m&&(0,quantizationUtils.VV)(m)||null}}_createFeatures(e,t){const i=new AttributesBuilder_c(e,this.featureAdapter,this.fieldsIndex),{hasM:s,hasZ:a}=this,{orderByFields:r,quantizationParameters:o,returnGeometry:l,returnCentroid:c,maxAllowableOffset:h,resultOffset:p,resultRecordCount:f,returnZ:y=!1,returnM:g=!1}=e,x=a&&y,T=s&&g;let I=[],F=0;const _=[...t];if(this._sortFeatures(_,r,((e,t,s)=>i.getFieldValue(e,t,s))),this.geometryType&&(l||c)){const e=(0,quantizationUtils.VV)(o)??void 0,t="esriGeometryPolygon"===this.geometryType||"esriGeometryPolyline"===this.geometryType;if(l&&!c)for(const s of _){const a=this.featureAdapter.getGeometry(s),r={attributes:i.getAttributes(s),geometry:(0,geometryUtils.pL)(this.geometryType,this.hasZ,this.hasM,a,h,e,x,T)};t&&a&&!r.geometry&&(r.centroid=(0,geometryUtils.LQ)(this,this.featureAdapter.getCentroid(s,this),e)),I[F++]=r}else if(!l&&c)for(const s of _)I[F++]={attributes:i.getAttributes(s),centroid:(0,geometryUtils.LQ)(this,this.featureAdapter.getCentroid(s,this),e)};else for(const s of _)I[F++]={attributes:i.getAttributes(s),centroid:(0,geometryUtils.LQ)(this,this.featureAdapter.getCentroid(s,this),e),geometry:(0,geometryUtils.pL)(this.geometryType,this.hasZ,this.hasM,this.featureAdapter.getGeometry(s),h,e,x,T)}}else for(const n of _){const e=i.getAttributes(n);e&&(I[F++]={attributes:e})}const V=p||0;if(null!=f){const e=V+f;I=I.slice(V,Math.min(I.length,e))}return I}_createExceedsLimitQueryResponse(){let e=!1,t=Number.POSITIVE_INFINITY,i=Number.POSITIVE_INFINITY,s=Number.POSITIVE_INFINITY;for(const a of this.query.outStatistics??[])if("exceedslimit"===a.statisticType){t=null!=a.maxPointCount?a.maxPointCount:Number.POSITIVE_INFINITY,i=null!=a.maxRecordCount?a.maxRecordCount:Number.POSITIVE_INFINITY,s=null!=a.maxVertexCount?a.maxVertexCount:Number.POSITIVE_INFINITY;break}if("esriGeometryPoint"===this.geometryType)e=this.items.length>t;else if(this.items.length>i)e=!0;else{const t=O(this.hasZ,this.hasM),i=this.featureAdapter;e=this.items.reduce(((e,t)=>{const s=i.getGeometry(t);return e+(null!=s&&s.coords.length||0)}),0)/t>s}return{fields:[{name:"exceedslimit",type:"esriFieldTypeInteger",alias:"exceedslimit",sqlType:"sqlTypeInteger",domain:null,defaultValue:null}],features:[{attributes:{exceedslimit:Number(e)}}]}}async _createStatisticsQueryResponse(e,t,i={attributes:{}}){const s=[],a=new Map,r=new Map,n=new Map,o=new Map,l=new AttributesBuilder_c(e,this.featureAdapter,this.fieldsIndex),c=e.outStatistics,{groupByFieldsForStatistics:m,having:d,orderByFields:h,resultRecordCount:p}=e,f=m?.length,y=!!f,g=y?m[0]:null,x=y&&!this.fieldsIndex.get(g);for(const u of c??[]){const{outStatisticFieldName:e,statisticType:c}=u,h=u,p="exceedslimit"!==c?u.onStatisticField:void 0,T="percentile_disc"===c||"percentile_cont"===c,F="EnvelopeAggregate"===c||"CentroidAggregate"===c||"ConvexHullAggregate"===c,_=y&&1===f&&(p===g||x)&&"count"===c;if(y){if(!n.has(p)){const e=[];for(const i of m){const s=this._getAttributeValues(l,i,t,a);e.push(s)}n.set(p,this._calculateUniqueValues(e,t,!F&&l.returnDistinctValues))}const i=n.get(p);if(!i)continue;const s=Object.keys(i);for(const r of s){const{count:s,data:n,items:u,itemPositions:c}=i[r],f=n.join(",");if(!d||l.validateItems(u,d)){const i=o.get(f)||{attributes:{}};if(F){i.aggregateGeometries||(i.aggregateGeometries={});const{aggregateGeometries:e,outStatisticFieldName:t}=await this._getAggregateGeometry(h,u);i.aggregateGeometries[t]=e}else{let r=null;if(_)r=s;else{const e=this._getAttributeValues(l,p,t,a),i=c.map((t=>e[t]));r=T&&"statisticParameters"in h?this._getPercentileValue(h,i):this._getStatisticValue(h,i,null,l.returnDistinctValues)}i.attributes[e]=r}let r=0;m.forEach(((e,t)=>i.attributes[this.fieldsIndex.get(e)?e:"EXPR_"+ ++r]=n[t])),o.set(f,i)}}}else if(F){i.aggregateGeometries||(i.aggregateGeometries={});const{aggregateGeometries:e,outStatisticFieldName:s}=await this._getAggregateGeometry(h,t);i.aggregateGeometries[s]=e}else{const s=this._getAttributeValues(l,p,t,a);i.attributes[e]=T&&"statisticParameters"in h?this._getPercentileValue(h,s):this._getStatisticValue(h,s,r,l.returnDistinctValues)}const V="min"!==c&&"max"!==c||!(0,fieldUtils.yM)(this.fieldsIndex.get(p))&&!this._isAnyDateField(p)?null:this.fieldsIndex.get(p)?.type;s.push({name:e,alias:e,type:V||"esriFieldTypeDouble"})}const T=y?Array.from(o.values()):[i];return this._sortFeatures(T,h,((e,t)=>e.attributes[t])),p&&(T.length=Math.min(p,T.length)),{fields:s,features:T}}_isAnyDateField(e){const t=this.fieldsIndex.get(e);return(0,fieldUtils.vE)(t)||(0,fieldUtils.zD)(t)||(0,fieldUtils.Ah)(t)||(0,fieldUtils.OH)(t)}async _getAggregateGeometry(e,t){const{convexHull:n,union:o}=await Promise.all([__webpack_require__.e(3048),__webpack_require__.e(1808)]).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@arcgis/core/geometry/geometryEngineJSON.js")),{statisticType:l,outStatisticFieldName:u}=e,{featureAdapter:c,spatialReference:d,geometryType:h,hasZ:p,hasM:f}=this,y=t.map((e=>(0,geometryUtils.pL)(h,p,f,c.getGeometry(e)))),g=n(d,y,!0)[0],x={aggregateGeometries:null,outStatisticFieldName:null};if("EnvelopeAggregate"===l){const e=g?(0,extentUtils.v)(g):(0,extentUtils.HA)(o(d,y));x.aggregateGeometries={...e,spatialReference:d},x.outStatisticFieldName=u||"extent"}else if("CentroidAggregate"===l){const e=g?(0,centroid.l8)(g):(0,centroid.Z4)((0,extentUtils.HA)(o(d,y)));x.aggregateGeometries={x:e[0],y:e[1],spatialReference:d},x.outStatisticFieldName=u||"centroid"}else"ConvexHullAggregate"===l&&(x.aggregateGeometries=g,x.outStatisticFieldName=u||"convexHull");return x}_getStatisticValue(e,t,i,s){const{onStatisticField:a,statisticType:r}=e;let n=null;return n=i?.has(a)?i.get(a):(0,fieldUtils.yM)(this.fieldsIndex.get(a))||this._isAnyDateField(a)?(0,statistics_utils.z9)({values:t,returnDistinct:s}):(0,statistics_utils.G_)({values:s?[...new Set(t)]:t,minValue:null,maxValue:null,useSampleStdDev:!0}),i&&i.set(a,n),n["var"===r?"variance":r]}_getPercentileValue(e,t){const{onStatisticField:i,statisticParameters:s,statisticType:a}=e,{value:r,orderBy:n}=s,o=this.fieldsIndex.get(i);return(0,statistics_utils.qg)(t,{value:r,orderBy:n,fieldType:o?.type,isDiscrete:"percentile_disc"===a})}_getAttributeValues(e,t,i,s){if(s.has(t))return s.get(t);const a=this.fieldsIndex.get(t),r=i.map((i=>e.getFieldValue(i,t,a)));return s.set(t,r),r}_calculateUniqueValues(e,t,i){const s={},a=t.length;for(let r=0;r<a;r++){const a=t[r],n=[];for(const t of e)n.push(t[r]);const o=n.join(",");null==s[o]?s[o]={count:1,data:n,items:[a],itemPositions:[r]}:(i||s[o].count++,s[o].items.push(a),s[o].itemPositions.push(r))}return s}async _getDataValues(t,i,s=!0){const a=new AttributesBuilder_c(this.query,this.featureAdapter,this.fieldsIndex),{valueExpression:r,scale:n,timeZone:o}=t;return r?a.getExpressionValues(i,r,{viewingMode:"map",scale:n,spatialReference:this.query.outSR||this.spatialReference},{geometryType:this.geometryType,hasZ:this.hasZ,hasM:this.hasM},o):a.getDataValues(i,(0,lang.o8)(t),s)}async _calculateHistogramBins(e,t,i){if(null==t.min&&null==t.max)return[];const s=t.intervals,a=t.min??0,r=t.max??0,n=s.map((([e,t])=>({minValue:e,maxValue:t,count:0,items:[]})));for(let o=0;o<e.length;o++){const t=e[o],l=i[o];if(null!=t&&t>=a&&t<=r){const e=(0,statistics_utils.Ak)(s,t);e>-1&&(n[e].count++,n[e].items.push(l))}}return n}async createQueryBinsResponse(e){const t=e.bin?.splitBy;if(!t)return this._createBinsResponse(e);const{value:i,outAlias:s,valueType:a}=t,r=[],n=[{name:s??i,alias:s??i,type:a??"esriFieldTypeString"},{name:G,alias:G,type:"esriFieldTypeInteger"}],o=new AttributesBuilder_c(e,this.featureAdapter,this.fieldsIndex),l=new Map,c=[...this.items];this._sortFeatures(c,[i],((e,t,i)=>o.getFieldValue(e,t,i)));const m=this._getAttributeValues(o,i,c,l),d=this._calculateUniqueValues([m],c,o.returnDistinctValues);for(const u in d){const{items:t}=d[u],a=await this._createBinsResponse(e,t);if(r.push(...a.features.map((e=>({...e,attributes:{...e.attributes,[s??i]:u}})))),a.fields)for(const e of a.fields)n.some((t=>t.name===e.name))||n.push(e)}return{fields:n,features:r}}async _createBinsResponse(e,t){const i=e.bin;switch(t=t??this.items,i.type){case"autoIntervalBin":return this._createAutoIntervalBinsResponse(AutoIntervalBinParameters.A.fromJSON(i),e,t);case"dateBin":return this._createDateBinsResponse(DateBinParameters.A.fromJSON(i),e,t);case"fixedBoundariesBin":return this._createFixedBoundariesBinsResponse(FixedBoundariesBinParameters.A.fromJSON(i),e,t);case"fixedIntervalBin":return this._createFixedIntervalBinsResponse(FixedIntervalBinParameters.A.fromJSON(i),e,t)}}async _createAutoIntervalBinsResponse(e,t,i){const{field:s,normalizationField:a,numBins:r,normalizationType:n,normalizationTotal:o,start:l,end:u}=e,c=await this._getDataValues({field:e.field,normalizationField:e.normalizationField,normalizationType:e.normalizationType,normalizationTotal:e.normalizationTotal,timeZone:t.outTimeReference?.ianaTimeZone},i),m=(0,statistics_utils.sU)(c,{field:s,normalizationField:a,normalizationType:n,normalizationTotal:o,numBins:r,minValue:(0,queryUtils.dO)(l,!1),maxValue:(0,queryUtils.dO)(u,!1)}),d=await this._calculateHistogramBins(c,m,i);return this._createFeaturesFromHistogramBins(d,t)}async _createDateBinsResponse(e,i,s){const{field:a,interval:r,start:n,end:o}=e,l=r.unit,u="quarters"===l?3*timeUtils.vf.months:timeUtils.vf[l],c=r.value*u/timeUtils.vf.milliseconds,m=await this._getDataValues({field:e.field,timeZone:i.outTimeReference?.ianaTimeZone},s),d=(0,fieldUtils.OH)(this.fieldsIndex.get(a)),h=(0,statistics_utils.sU)(m,{field:a,classificationMethod:"defined-interval",definedInterval:c,minValue:(0,queryUtils.dO)(n,d),maxValue:(0,queryUtils.dO)(o,d)},!0),f=await this._calculateHistogramBins(m,h,s);return this._createFeaturesFromHistogramBins(f,i)}async _createFixedBoundariesBinsResponse(e,t,i){const{field:s}=e,a=await this._getDataValues({field:s,timeZone:t.outTimeReference?.ianaTimeZone},i),r=(0,fieldUtils.OH)(this.fieldsIndex.get(s)),n=e.boundaries.map((e=>(0,queryUtils.dO)(e,r))).sort(((e,t)=>e-t)),o=[];for(let c=0;c<n.length-1;c++)o.push([n[c],n[c+1]]);const l={intervals:o,min:n.at(0),max:n.at(-1)},u=await this._calculateHistogramBins(a,l,i);return this._createFeaturesFromHistogramBins(u,t)}async _createFixedIntervalBinsResponse(e,t,i){const{field:s,interval:a,start:r,end:n}=e,o=await this._getDataValues({field:e.field,normalizationField:e.normalizationField,normalizationType:e.normalizationType,normalizationTotal:e.normalizationTotal,timeZone:t.outTimeReference?.ianaTimeZone},i),l=(0,fieldUtils.OH)(this.fieldsIndex.get(s)),u=(0,statistics_utils.sU)(o,{field:s,classificationMethod:"defined-interval",definedInterval:a,minValue:(0,queryUtils.dO)(r,l),maxValue:(0,queryUtils.dO)(n,l)},!0),c=await this._calculateHistogramBins(o,u,i);return this._createFeaturesFromHistogramBins(c,t)}async _createFeaturesFromHistogramBins(e,t){const{upperBoundaryAlias:i,lowerBoundaryAlias:s}=t,a=s||"lowerBoundary",r=i||"upperBoundary",n=[],o=[{name:a,alias:a,type:"esriFieldTypeDouble"},{name:r,alias:r,type:"esriFieldTypeDouble"}],l=t.bin?.stackBy?.value,u=t.bin?.stackBy?.outAlias;l&&o.push({name:G,alias:G,type:"esriFieldTypeInteger"},{name:u??l,alias:u??l,type:"esriFieldTypeString"});let c=0;for(const m of e){const{minValue:e,maxValue:i,items:s}=m,d={attributes:{}};let h;if(d.attributes[a]=e,d.attributes[r]=i,l?(h=await this._createStatisticsQueryResponse({...t,groupByFieldsForStatistics:[l],orderByFields:[l]},s),d.attributes[G]=++c,"flat"===t.bin.jsonStyle?n.push(...h.features.map((({attributes:{EXPR_1:e,...t},...i})=>({...i,attributes:u??e?{...t,[u??e]:e,...d.attributes}:{...t,...d.attributes}})))):(d.stackedAttributes=h.features.map((({attributes:{EXPR_1:e,...t}})=>u??e?{...t,[u??e]:e}:t)),n.push(d))):(t.bin?.splitBy&&(d.attributes[G]=++c),h=await this._createStatisticsQueryResponse(t,s,d),n.push(d)),h.fields)for(const t of h.fields)o.some((e=>e.name===t.name))||o.push(t)}return"desc"===t.binOrder&&n.reverse(),{fields:o,features:n}}}function E(e,t,i,s){const a=s.x-i.x,r=s.y-i.y,n=t.x-i.x,o=t.y-i.y,l=a*a+r*r;if(0===l)return!1;const u=n*a+o*r,c=Math.min(1,Math.max(0,u/l));return e.x=i.x+a*c,e.y=i.y+r*c,!0}function O(e,t){return e?t?4:3:t?3:2}class H{constructor(e,t){this.coords=e,this.coordsIndex=t}get x(){return this.coords[this.coordsIndex]}get y(){return this.coords[this.coordsIndex+1]}get z(){return this.coords[this.coordsIndex+2]}}const Q=[1]},"./node_modules/@arcgis/core/layers/graphics/data/SnappingCandidate.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{function t(t,e,r){return{objectId:t,target:e,distance:r,type:"vertex"}}function e(t,e,r,n,d,a=!1){return{objectId:t,target:e,distance:r,type:"edge",start:n,end:d,draped:a}}__webpack_require__.d(__webpack_exports__,{P:()=>e,k:()=>t})},"./node_modules/@arcgis/core/layers/graphics/data/attributeSupport.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{MG:()=>g,SN:()=>p,SY:()=>y,VW:()=>a,Wq:()=>u,eD:()=>f,j4:()=>c,vl:()=>o});var _core_Error_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@arcgis/core/core/Error.js"),_core_sql_WhereClauseCache_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@arcgis/core/core/sql/WhereClauseCache.js"),_support_fieldType_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@arcgis/core/layers/support/fieldType.js");const s=new _core_sql_WhereClauseCache_js__WEBPACK_IMPORTED_MODULE_1__.WhereClauseCache(50,500),t="unsupported-query",n=" as ",o=new Set(["esriFieldTypeOID","esriFieldTypeSmallInteger","esriFieldTypeBigInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble","esriFieldTypeLong"]),a=new Set(["esriFieldTypeDate","esriFieldTypeDateOnly","esriFieldTypeTimeOnly","esriFieldTypeTimestampOffset"]),l=new Set(["esriFieldTypeString","esriFieldTypeGUID","esriFieldTypeGlobalID",...o,...a]);function d(i,r,n={}){const o=c(r,i);if(!o){const n=s.getError(r,i);throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_0__.A(t,"invalid SQL expression",{expression:r,error:n})}const a=n.expressionName||"expression";if(n.validateStandardized&&!o.isStandardized)throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_0__.A(t,`${a} is not standard`,{expression:r});if(n.validateAggregate&&!o.isAggregate)throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_0__.A(t,`${a} does not contain a valid aggregate function`,{expression:r});return o.fieldNames}function p(e,i,r,s){if(!r)return!0;const t="where clause";return g(e,i,d(e,r,{validateStandardized:!0,expressionName:t}),{expressionName:t,query:s}),!0}function f(i,r,s,n,o){if(!s)return!0;const a="having clause",l=d(i,s,{validateAggregate:!0,expressionName:a});g(i,r,l,{expressionName:a,query:o});const p=c(s,i),f=p?.getExpressions().every((e=>{const{aggregateType:r,field:s}=e,t=i.get(s)?.name;return n.some((e=>{const{onStatisticField:s,statisticType:n}=e,o=i.get(s)?.name;return o===t&&n.toLowerCase().trim()===r}))}));if(!f)throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_0__.A(t,"expressions in having clause should also exist in outStatistics",{having:s});return!0}function c(e,i){return e?s.get(e,i):null}function u(e){return/\((.*?)\)/.test(e)?e:e.split(n)[0]}function y(e){return e.split(n)[1]}function g(i,r,s,n={}){const o=new Map;if(function m(e,i,r,s,t){const n=t.includes("*")?[...r,...t.filter((e=>"*"!==e))]:t;for(const a of n)if(i.get(a))T(e,i,r,s,a);else try{const t=d(i,u(a),{validateStandardized:!0});for(const n of t)T(e,i,r,s,n)}catch(o){e.set(a,{type:"expression-error",expression:a,error:o})}}(o,i,r,n.allowedFieldTypes??l,s),o.size){const i=n.expressionName??"expression";throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_0__.A(t,`${i} contains invalid or missing fields`,{errors:Array.from(o.values()),query:n.query})}}function T(e,i,s,t,n){const o=i.get(n);o?s.has(o.name)?"all"!==t&&!1===t?.has(o.type)&&e.set(n,{type:"invalid-type",fieldName:o.name,fieldType:_support_fieldType_js__WEBPACK_IMPORTED_MODULE_2__.m.fromJSON(o.type),allowedFieldTypes:Array.from(t,(e=>_support_fieldType_js__WEBPACK_IMPORTED_MODULE_2__.m.fromJSON(e)))}):e.set(n,{type:"missing-field",fieldName:o.name}):e.set(n,{type:"invalid-field",fieldName:n})}},"./node_modules/@arcgis/core/layers/graphics/data/queryValidationUtils.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{B4:()=>c,FQ:()=>p,mO:()=>y});var _core_Error_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@arcgis/core/core/Error.js"),_attributeSupport_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@arcgis/core/layers/graphics/data/attributeSupport.js"),_projectionSupport_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@arcgis/core/layers/graphics/data/projectionSupport.js"),_spatialQuerySupport_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@arcgis/core/layers/graphics/data/spatialQuerySupport.js"),_support_arcadeOnDemand_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/@arcgis/core/support/arcadeOnDemand.js");const u="unsupported-query";async function p(t,i){const s=t.bin;if(!s.onField&&!s.onExpression?.value||"autoIntervalBin"===s.type&&null==s.parameters.numberOfBins||"dateBin"===s.type&&(null==s.parameters.number||null==s.parameters.unit)||"fixedBoundariesBin"===s.type&&null==s.parameters.boundaries||"fixedIntervalBin"===s.type&&null==s.parameters.interval)throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_0__.A(u,"Unsupported query options",{query:t});return c(t,i)}async function c(t,{fieldsIndex:i,geometryType:s,spatialReference:r,availableFields:n}){if(null!=t.geometryPrecision||t.multipatchOption&&"xyFootprint"!==t.multipatchOption||t.pixelSize||t.relationParam||t.text)throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_0__.A(u,"Unsupported query options",{query:t});return d(i,n,t),function m(t,i,r){const{outStatistics:o,groupByFieldsForStatistics:a,having:l}=r,p=a?.length,c=o?.length;if(l){if(!p||!c)throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_0__.A(u,"outStatistics and groupByFieldsForStatistics should be specified with having",{query:r});(0,_attributeSupport_js__WEBPACK_IMPORTED_MODULE_1__.eD)(t,i,l,o,r)}if(c){if(!function F(e){return null!=e&&e.every((e=>"exceedslimit"!==e.statisticType))}(o))return;const n=o.map((e=>e.onStatisticField)).filter(Boolean);(0,_attributeSupport_js__WEBPACK_IMPORTED_MODULE_1__.MG)(t,i,n,{expressionName:"onStatisticFields",query:r}),p&&(0,_attributeSupport_js__WEBPACK_IMPORTED_MODULE_1__.MG)(t,i,a,{expressionName:"groupByFieldsForStatistics",query:r});for(const a of o){const{onStatisticField:n,statisticType:o}=a;if("percentile_disc"!==o&&"percentile_cont"!==o||!("statisticParameters"in a))t.get(n)&&"count"!==o&&"min"!==o&&"max"!==o&&(0,_attributeSupport_js__WEBPACK_IMPORTED_MODULE_1__.MG)(t,i,[n],{expressionName:`outStatistics with '${o}' statistic type`,allowedFieldTypes:f,query:r});else{const{statisticParameters:t}=a;if(!t)throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_0__.A(u,"statisticParameters should be set for percentile type",{definition:a,query:r})}}}}(i,n,t),Promise.all([(0,_spatialQuerySupport_js__WEBPACK_IMPORTED_MODULE_3__.c0)(t,s,r),(0,_projectionSupport_js__WEBPACK_IMPORTED_MODULE_2__.Nk)(r,t.outSR)]).then((()=>t))}function d(t,i,n){const{outFields:o,orderByFields:a,returnDistinctValues:l,outStatistics:p}=n,c=p?p.map((e=>e.outStatisticFieldName&&e.outStatisticFieldName.toLowerCase())).filter(Boolean):[];if(a&&a.length>0){const e=" asc",r=" desc",o=a.map((t=>{const i=t.toLowerCase();return i.includes(e)?i.split(e)[0]:i.includes(r)?i.split(r)[0]:t})).filter((e=>!c.includes(e)));(0,_attributeSupport_js__WEBPACK_IMPORTED_MODULE_1__.MG)(t,i,o,{expressionName:"orderByFields",query:n})}if(o&&o.length>0)(0,_attributeSupport_js__WEBPACK_IMPORTED_MODULE_1__.MG)(t,i,o,{expressionName:"outFields",query:n,allowedFieldTypes:"all"});else if(l)throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_0__.A(u,"outFields should be specified for returnDistinctValues",{query:n});(0,_attributeSupport_js__WEBPACK_IMPORTED_MODULE_1__.SN)(t,i,n.where,n)}const f=new Set([..._attributeSupport_js__WEBPACK_IMPORTED_MODULE_1__.vl,..._attributeSupport_js__WEBPACK_IMPORTED_MODULE_1__.VW]);async function y(t,i,{fieldsIndex:s,geometryType:r,spatialReference:n,availableFields:l}){if(null!=t.geometryPrecision||t.multipatchOption||t.pixelSize||t.relationParam||t.text||t.outStatistics||t.groupByFieldsForStatistics||t.having||t.orderByFields)throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_0__.A(u,"Unsupported query options",{query:t});return d(s,l,t),Promise.all([h(s,l,i,t),(0,_spatialQuerySupport_js__WEBPACK_IMPORTED_MODULE_3__.c0)(t,r,n),(0,_projectionSupport_js__WEBPACK_IMPORTED_MODULE_2__.Nk)(n,t.outSR)]).then((()=>t))}async function h(t,i,r,n){let o=[];if(r.valueExpression){const{arcadeUtils:e}=await(0,_support_arcadeOnDemand_js__WEBPACK_IMPORTED_MODULE_4__.lw)();o=e.extractFieldNames(r.valueExpression)}if(r.field&&o.push(r.field),r.field2&&o.push(r.field2),r.field3&&o.push(r.field3),r.normalizationField&&o.push(r.normalizationField),!o.length&&!r.valueExpression)throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_0__.A(u,"field or valueExpression is required",{params:r});(0,_attributeSupport_js__WEBPACK_IMPORTED_MODULE_1__.MG)(t,i,o,{expressionName:"statistics",query:n})}},"./node_modules/@arcgis/core/layers/support/FieldsIndex.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>Z});var _core_Error_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@arcgis/core/core/Error.js"),_core_JSONSupport_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@arcgis/core/core/JSONSupport.js"),_core_Logger_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@arcgis/core/core/Logger.js"),_core_MapUtils_js__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./node_modules/@arcgis/core/core/MapUtils.js"),_core_sql_UnknownTimeZone_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@arcgis/core/core/sql/UnknownTimeZone.js"),_fieldUtils_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/@arcgis/core/layers/support/fieldUtils.js"),_time_constants_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/@arcgis/core/time/constants.js"),_time_timeZoneUtils_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./node_modules/@arcgis/core/time/timeZoneUtils.js"),luxon__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./node_modules/luxon/src/luxon.js");const T=new Map;class Z{static fromJSON(e){return new Z(e.fields,e.timeZoneByFieldName)}static fromLayer(e){return new Z(e.fields??[],S(e))}static fromLayerJSON(e){return new Z(e.fields??[],S(e))}constructor(e=[],i){this._fieldsMap=new Map,this._normalizedFieldsMap=new Map,this._dateFieldsSet=new Set,this._numericFieldsSet=new Set,this._requiredFields=null,this.dateFields=[],this.numericFields=[],this.fields=e||[],this._timeZoneByFieldName=i?new Map(i):null;const t=[];for(const s of this.fields){const e=s?.name,i=M(e);if(e&&i){const n=w(e);this._fieldsMap.set(e,s),this._fieldsMap.set(n,s),this._normalizedFieldsMap.set(i,s),t.push(`${n}:${s.type}:${this._timeZoneByFieldName?.get(e)}`),(0,_fieldUtils_js__WEBPACK_IMPORTED_MODULE_4__.vE)(s)?(this.dateFields.push(s),this._dateFieldsSet.add(s)):(0,_fieldUtils_js__WEBPACK_IMPORTED_MODULE_4__.WA)(s)&&(this._numericFieldsSet.add(s),this.numericFields.push(s)),(0,_fieldUtils_js__WEBPACK_IMPORTED_MODULE_4__.te)(s)||(0,_fieldUtils_js__WEBPACK_IMPORTED_MODULE_4__.Xz)(s)||(s.editable=null==s.editable||!!s.editable,s.nullable=null==s.nullable||!!s.nullable)}}t.sort(),this.uid=t.join()}get requiredFields(){if(!this._requiredFields){this._requiredFields=[];for(const e of this.fields)(0,_fieldUtils_js__WEBPACK_IMPORTED_MODULE_4__.te)(e)||(0,_fieldUtils_js__WEBPACK_IMPORTED_MODULE_4__.Xz)(e)||e.nullable||void 0!==(0,_fieldUtils_js__WEBPACK_IMPORTED_MODULE_4__.lD)(e)||this._requiredFields.push(e)}return this._requiredFields}equals(e){return this.uid===e?.uid}has(e){return null!=this.get(e)}get(e){if(!e)return;let i=this._fieldsMap.get(e);return i||(i=this._fieldsMap.get(w(e))??this._normalizedFieldsMap.get(M(e)),i&&this._fieldsMap.set(e,i),i)}getTimeZone(i){const s=this.get(i&&"string"!=typeof i?i.name:i);return s?this._timeZoneByFieldName?this._timeZoneByFieldName.get(s.name):"date"===s.type||"esriFieldTypeDate"===s.type?(_core_Logger_js__WEBPACK_IMPORTED_MODULE_2__.A.getLogger("esri.layers.support.FieldsIndex").errorOnce(new _core_Error_js__WEBPACK_IMPORTED_MODULE_0__.A("getTimeZone:no-timezone-information",`no time zone information for field '${s.name}'`)),_time_constants_js__WEBPACK_IMPORTED_MODULE_5__.n$):N.has(s.type)?_time_constants_js__WEBPACK_IMPORTED_MODULE_5__.L5:null:null}getLuxonTimeZone(e){const i=this.getTimeZone(e);return i?i===_time_constants_js__WEBPACK_IMPORTED_MODULE_5__.L5?_core_sql_UnknownTimeZone_js__WEBPACK_IMPORTED_MODULE_3__.GB.instance:i===_time_constants_js__WEBPACK_IMPORTED_MODULE_5__.n$?luxon__WEBPACK_IMPORTED_MODULE_7__.mQ.utcInstance:(0,_core_MapUtils_js__WEBPACK_IMPORTED_MODULE_8__.tE)(T,i,(()=>luxon__WEBPACK_IMPORTED_MODULE_7__.oh.create(i))):null}isDateField(e){return this._dateFieldsSet.has(this.get(e))}isTimeOnlyField(e){return(0,_fieldUtils_js__WEBPACK_IMPORTED_MODULE_4__.OH)(this.get(e))}isNumericField(e){return this._numericFieldsSet.has(this.get(e))}normalizeFieldName(e){return this.get(e)?.name??void 0}toJSON(){return{fields:this.fields.map((e=>_core_JSONSupport_js__WEBPACK_IMPORTED_MODULE_1__.A.isSerializable(e)?e.toJSON():e)),timeZoneByFieldName:this._timeZoneByFieldName?Array.from(this._timeZoneByFieldName.entries()):null}}}function w(e){return e.trim().toLowerCase()}function M(e){return(0,_fieldUtils_js__WEBPACK_IMPORTED_MODULE_4__.rS)(e)?.toLowerCase()??""}const N=new Set(["time-only","date-only","timestamp-offset","esriFieldTypeDateOnly","esriFieldTypeTimeOnly","esriFieldTypeTimestampOffset"]);function S(e){const i=new Map;if(!e.fields)return i;const t=!0===e.datesInUnknownTimezone,{timeInfo:s,editFieldsInfo:n}=e,r=(s?"startField"in s?s.startField:s.startTimeField:"")??"",l=(s?"endField"in s?s.endField:s.endTimeField:"")??"",o=function g(e){return"dateFieldsTimeZone"in e}(e)?e.dateFieldsTimeZone??null:e.dateFieldsTimeReference?(0,_time_timeZoneUtils_js__WEBPACK_IMPORTED_MODULE_6__.ZS)(e.dateFieldsTimeReference):null,d=n?function y(e){return"timeZone"in e}(n)?n.timeZone??o:n.dateFieldsTimeReference?(0,_time_timeZoneUtils_js__WEBPACK_IMPORTED_MODULE_6__.ZS)(n.dateFieldsTimeReference):o??_time_constants_js__WEBPACK_IMPORTED_MODULE_5__.n$:null,a=s?function _(e){return"timeZone"in e}(s)?s.timeZone??o:s.timeReference?(0,_time_timeZoneUtils_js__WEBPACK_IMPORTED_MODULE_6__.ZS)(s.timeReference):o:null,m=new Map([[w(n?.creationDateField??""),d],[w(n?.editDateField??""),d],[w(r),a],[w(l),a]]);for(const{name:u,type:f}of e.fields)if(N.has(f))i.set(u,_time_constants_js__WEBPACK_IMPORTED_MODULE_5__.L5);else if("date"!==f&&"esriFieldTypeDate"!==f)i.set(u,null);else if(t)i.set(u,_time_constants_js__WEBPACK_IMPORTED_MODULE_5__.L5);else{const e=m.get(w(u??""))??o;i.set(u,e)}return i}},"./node_modules/@arcgis/core/layers/support/PromiseQueue.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{T:()=>i});var _core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@arcgis/core/core/promiseUtils.js"),_core_signal_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@arcgis/core/core/signal.js"),_views_support_Yield_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@arcgis/core/views/support/Yield.js");class i{constructor(){this._tasks=new Array,this._runningTasks=(0,_core_signal_js__WEBPACK_IMPORTED_MODULE_1__.v)(0)}get length(){return this._tasks.length}get running(){return this._runningTasks.value>0}destroy(){this.cancelAll()}runTask(s){if(0===this.length)return _views_support_Yield_js__WEBPACK_IMPORTED_MODULE_2__.G;for(;!s.done&&this._process(s);)s.madeProgress()}push(s,t,e){return++this._runningTasks.value,new Promise(((r,n)=>this._tasks.push(new a(r,n,s,t,e)))).finally((()=>--this._runningTasks.value))}unshift(s,t,e){return++this._runningTasks.value,new Promise(((r,n)=>this._tasks.unshift(new a(r,n,s,t,e)))).finally((()=>--this._runningTasks.value))}_process(r){if(0===this._tasks.length)return!1;const n=this._tasks.shift();try{const i=(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_0__.G4)(n.signal);if(i&&!n.abortCallback)n.reject((0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_0__.NK)());else{const s=i?n.abortCallback?.((0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_0__.NK)()):n.callback(r);(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_0__.$X)(s)?s.then(n.resolve,n.reject):n.resolve(s)}}catch(i){n.reject(i)}return!0}cancelAll(){const s=(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_0__.NK)();for(const t of this._tasks)if(t.abortCallback){const e=t.abortCallback(s);t.resolve(e)}else t.reject(s);this._tasks.length=0}}class a{constructor(s,t,e,r=void 0,n=void 0){this.resolve=s,this.reject=t,this.callback=e,this.signal=r,this.abortCallback=n}}},"./node_modules/@arcgis/core/renderers/support/heatmapUtils.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{O3:()=>f,PU:()=>a,YW:()=>u,ex:()=>c,hv:()=>l,zp:()=>e});var _core_mathUtils_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@arcgis/core/core/mathUtils.js"),_core_screenUtils_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@arcgis/core/core/screenUtils.js"),_chunks_vec42_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@arcgis/core/chunks/vec42.js"),_core_libs_gl_matrix_2_factories_vec4f64_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@arcgis/core/core/libs/gl-matrix-2/factories/vec4f64.js");const c=2.4;function e(t){return(0,_core_screenUtils_js__WEBPACK_IMPORTED_MODULE_3__.PN)(t*c)}function a(t){return(0,_core_screenUtils_js__WEBPACK_IMPORTED_MODULE_3__.Lz)(t)/c}function s(r,o,i,c){let{color:e,ratio:a}=o,{color:s,ratio:f}=i;if(f===a){const t=1e-6;1===f?a-=t:f+=t}const l=(0,_core_mathUtils_js__WEBPACK_IMPORTED_MODULE_0__.qE)((c-a)/(f-a),0,1);(0,_chunks_vec42_js__WEBPACK_IMPORTED_MODULE_1__.l)(r,e.toArray(),s.toArray(),l)}function f(t){const o=new Uint8ClampedArray(2048);if(t=t.filter((({ratio:t})=>t>=0&&t<=1)).sort(((t,r)=>t.ratio-r.ratio)).map((({color:t,ratio:r})=>({color:t,ratio:Math.max(r,.001)}))),t.length<1)return o;let n=t[0],c=t[0],e=1;const a=(0,_core_libs_gl_matrix_2_factories_vec4f64_js__WEBPACK_IMPORTED_MODULE_2__.vt)();for(let i=0;i<512;i++){const f=(i+.5)/512;for(;f>c.ratio&&e<t.length;)n=c,c=t[e++];s(a,n,c,f),o.set(a,4*i)}return o}function l(t,r,o){const n=Math.sqrt(t**2+r**2)/o;return n>1?0:3/(Math.PI*o**2)*(1-n**2)**2}function u(t){return"function"==typeof t?t:t?r=>+r[t]:()=>1}},"./node_modules/@arcgis/core/rest/geometryService/utils.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{V:()=>o,X:()=>r});var _geometry_support_jsonUtils_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@arcgis/core/geometry/support/jsonUtils.js");function r(t){return{geometryType:(0,_geometry_support_jsonUtils_js__WEBPACK_IMPORTED_MODULE_0__.$B)(t[0]),geometries:t.map((e=>e.toJSON()))}}function o(e,r,o){const n=(0,_geometry_support_jsonUtils_js__WEBPACK_IMPORTED_MODULE_0__.xD)(r);return e.map((e=>{const t=n.fromJSON(e);return t.spatialReference=o,t}))}},"./node_modules/@arcgis/core/rest/support/AutoIntervalBinParameters.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>c});var _chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@arcgis/core/chunks/tslib.es6.js"),_core_object_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@arcgis/core/core/object.js"),_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/decorators/property.js"),_core_accessorSupport_ensureType_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/ensureType.js"),_core_accessorSupport_decorators_enumeration_js__WEBPACK_IMPORTED_MODULE_6__=(__webpack_require__("./node_modules/@arcgis/core/core/has.js"),__webpack_require__("./node_modules/@arcgis/core/core/RandomLCG.js"),__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/decorators/enumeration.js")),_core_accessorSupport_decorators_subclass_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/decorators/subclass.js"),_BinParametersBase_js__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./node_modules/@arcgis/core/rest/support/BinParametersBase.js"),_NormalizationBinParametersMixin_js__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./node_modules/@arcgis/core/rest/support/NormalizationBinParametersMixin.js");function p(r,e,o){(0,_core_object_js__WEBPACK_IMPORTED_MODULE_1__.sM)(o,r instanceof Date?r.getTime():r,e)}let m=class extends((0,_NormalizationBinParametersMixin_js__WEBPACK_IMPORTED_MODULE_9__.K)(_BinParametersBase_js__WEBPACK_IMPORTED_MODULE_8__.A)){constructor(r){super(r),this.numBins=null,this.end=null,this.start=null,this.type="auto-interval"}};(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_2__.MZ)({type:Number,json:{name:"parameters.numberOfBins",write:!0}})],m.prototype,"numBins",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_2__.MZ)({json:{name:"parameters.end",write:{writer:p}}})],m.prototype,"end",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_2__.MZ)({json:{name:"parameters.start",write:{writer:p}}})],m.prototype,"start",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_enumeration_js__WEBPACK_IMPORTED_MODULE_6__.e)({autoIntervalBin:"auto-interval"},{readOnly:!0})],m.prototype,"type",void 0),m=(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_subclass_js__WEBPACK_IMPORTED_MODULE_7__.$)("esri.rest.support.AutoIntervalBinParameters")],m);const c=m;m.from=(0,_core_accessorSupport_ensureType_js__WEBPACK_IMPORTED_MODULE_3__.dp)(m)},"./node_modules/@arcgis/core/rest/support/BinParametersBase.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>u});var tslib_es6=__webpack_require__("./node_modules/@arcgis/core/chunks/tslib.es6.js"),Clonable=__webpack_require__("./node_modules/@arcgis/core/core/Clonable.js"),jsonMap=__webpack_require__("./node_modules/@arcgis/core/core/jsonMap.js"),JSONSupport=__webpack_require__("./node_modules/@arcgis/core/core/JSONSupport.js"),property=__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/decorators/property.js"),enumeration=(__webpack_require__("./node_modules/@arcgis/core/core/has.js"),__webpack_require__("./node_modules/@arcgis/core/core/Logger.js"),__webpack_require__("./node_modules/@arcgis/core/core/RandomLCG.js"),__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/decorators/enumeration.js")),subclass=__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/decorators/subclass.js"),ensureType=__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/ensureType.js");const a=new jsonMap.J({esriFieldTypeInteger:"integer",esriFieldTypeString:"string"});let l=class extends(Clonable.A.ClonableMixin(JSONSupport.A)){constructor(o){super(o),this.alias=null,this.responseType=null,this.type=null,this.value=null,this.valueType=null}};(0,tslib_es6._)([(0,property.MZ)({type:String,json:{name:"outAlias",write:!0}})],l.prototype,"alias",void 0),(0,tslib_es6._)([(0,property.MZ)({type:String})],l.prototype,"responseType",void 0),(0,tslib_es6._)([(0,property.MZ)({type:String,json:{write:!0}})],l.prototype,"type",void 0),(0,tslib_es6._)([(0,property.MZ)({type:String,json:{write:!0}})],l.prototype,"value",void 0),(0,tslib_es6._)([(0,enumeration.e)(a)],l.prototype,"valueType",void 0),l=(0,tslib_es6._)([(0,subclass.$)("esri.rest.support.AttributeBinsGrouping")],l);const c=l;l.from=(0,ensureType.dp)(l);const BinParametersBase_l=new jsonMap.J({esriFieldTypeSmallInteger:"small-integer",esriFieldTypeInteger:"integer",esriFieldTypeSingle:"single",esriFieldTypeDouble:"double",esriFieldTypeLong:"long",esriFieldTypeDate:"date",esriFieldTypeDateOnly:"date-only",esriFieldTypeTimeOnly:"time-only",esriFieldTypeTimestampOffset:"timestamp-offset"}),BinParametersBase_a=new jsonMap.J({naturalLog:"natural-log",squareRoot:"square-root"});let y=class extends(Clonable.A.ClonableMixin(JSONSupport.A)){constructor(e){super(e),this.expression=null,this.expressionValueType=null,this.field=null,this.firstDayOfWeek=null,this.hideUpperBound=null,this.splitBy=null,this.stackBy=null,this.transformation=null}};(0,tslib_es6._)([(0,property.MZ)({type:String,json:{name:"onExpression.value",write:!0}})],y.prototype,"expression",void 0),(0,tslib_es6._)([(0,enumeration.e)(BinParametersBase_l,{name:"onExpression.valueType"})],y.prototype,"expressionValueType",void 0),(0,tslib_es6._)([(0,property.MZ)({type:String,json:{name:"onField",write:!0}})],y.prototype,"field",void 0),(0,tslib_es6._)([(0,property.MZ)({type:String,json:{write:!0}})],y.prototype,"firstDayOfWeek",void 0),(0,tslib_es6._)([(0,property.MZ)({type:String,json:{write:!0}})],y.prototype,"hideUpperBound",void 0),(0,tslib_es6._)([(0,property.MZ)({type:c,json:{write:{overridePolicy(){return{enabled:null!=this.splitBy?.value||null!=this.splitBy?.type}}}}})],y.prototype,"splitBy",void 0),(0,tslib_es6._)([(0,property.MZ)({type:c,json:{write:{target:{stackBy:{type:c},jsonStyle:{type:String}},writer:(e,t)=>{e&&(t.stackBy=e.toJSON(),null!=e.responseType&&(t.jsonStyle=e.responseType))},overridePolicy(){return{enabled:null!=this.stackBy?.value||null!=this.stackBy?.type}}},read:{source:["stackBy","jsonStyle"],reader:(e,t)=>c.fromJSON({...t.stackBy,responseType:t.jsonStyle})}}})],y.prototype,"stackBy",void 0),(0,tslib_es6._)([(0,enumeration.e)(BinParametersBase_a)],y.prototype,"transformation",void 0),y=(0,tslib_es6._)([(0,subclass.$)("esri.rest.support.BinParametersBase")],y);const u=y},"./node_modules/@arcgis/core/rest/support/DateBinParameters.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>DateBinParameters_u});var tslib_es6=__webpack_require__("./node_modules/@arcgis/core/chunks/tslib.es6.js"),object=__webpack_require__("./node_modules/@arcgis/core/core/object.js"),property=__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/decorators/property.js"),ensureType=__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/ensureType.js"),enumeration=(__webpack_require__("./node_modules/@arcgis/core/core/has.js"),__webpack_require__("./node_modules/@arcgis/core/core/RandomLCG.js"),__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/decorators/enumeration.js")),subclass=__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/decorators/subclass.js"),BinParametersBase=__webpack_require__("./node_modules/@arcgis/core/rest/support/BinParametersBase.js"),Clonable=__webpack_require__("./node_modules/@arcgis/core/core/Clonable.js"),jsonMap=__webpack_require__("./node_modules/@arcgis/core/core/jsonMap.js"),JSONSupport=__webpack_require__("./node_modules/@arcgis/core/core/JSONSupport.js");const m=(0,jsonMap.O)()({year:"years",quarter:"quarters",month:"months",week:"weeks",day:"days",hour:"hours",minute:"minutes",second:"seconds"});let n=class extends(Clonable.A.ClonableMixin(JSONSupport.A)){constructor(o){super(o),this.value=null,this.unit=null}};(0,tslib_es6._)([(0,property.MZ)({type:Number,json:{name:"number",write:!0}})],n.prototype,"value",void 0),(0,tslib_es6._)([(0,enumeration.e)(m)],n.prototype,"unit",void 0),n=(0,tslib_es6._)([(0,subclass.$)("esri.rest.support.DateBinTimeInterval")],n);const u=n;function i(t,r,o){(0,object.sM)(o,"string"==typeof t?t:t?.getTime(),r)}function l(t,e){const r=t.parameters[e];return r?"string"==typeof r?r:new Date(r):null}n.from=(0,ensureType.dp)(n);let DateBinParameters_m=class extends BinParametersBase.A{constructor(t){super(t),this.end=null,this.interval=null,this.offset=null,this.returnFullIntervalBin=null,this.start=null,this.snapToData=null,this.type="date"}};(0,tslib_es6._)([(0,property.MZ)({cast:t=>null!=t?"string"==typeof t?t:new Date(t):null,json:{name:"parameters.end",read:{reader:(t,e)=>l(e,"end")},write:{writer:i}}})],DateBinParameters_m.prototype,"end",void 0),(0,tslib_es6._)([(0,property.MZ)({type:u,json:{name:"parameters",write:!0}})],DateBinParameters_m.prototype,"interval",void 0),(0,tslib_es6._)([(0,property.MZ)({type:u,json:{name:"parameters.offset",write:!0}})],DateBinParameters_m.prototype,"offset",void 0),(0,tslib_es6._)([(0,property.MZ)({type:Boolean,json:{name:"parameters.returnFullIntervalBin",write:!0}})],DateBinParameters_m.prototype,"returnFullIntervalBin",void 0),(0,tslib_es6._)([(0,property.MZ)({cast:t=>null!=t?"string"==typeof t?t:new Date(t):null,json:{name:"parameters.start",read:{reader:(t,e)=>l(e,"start")},write:{writer:i}}})],DateBinParameters_m.prototype,"start",void 0),(0,tslib_es6._)([(0,property.MZ)({type:String,json:{name:"parameters.snapToData",write:!0}})],DateBinParameters_m.prototype,"snapToData",void 0),(0,tslib_es6._)([(0,enumeration.e)({dateBin:"date"},{readOnly:!0})],DateBinParameters_m.prototype,"type",void 0),DateBinParameters_m=(0,tslib_es6._)([(0,subclass.$)("esri.rest.support.DateBinParameters")],DateBinParameters_m);const DateBinParameters_u=DateBinParameters_m;DateBinParameters_m.from=(0,ensureType.dp)(DateBinParameters_m)},"./node_modules/@arcgis/core/rest/support/FixedBoundariesBinParameters.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>m});var _chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@arcgis/core/chunks/tslib.es6.js"),_core_object_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@arcgis/core/core/object.js"),_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/decorators/property.js"),_core_accessorSupport_ensureType_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/ensureType.js"),_core_accessorSupport_decorators_enumeration_js__WEBPACK_IMPORTED_MODULE_6__=(__webpack_require__("./node_modules/@arcgis/core/core/has.js"),__webpack_require__("./node_modules/@arcgis/core/core/RandomLCG.js"),__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/decorators/enumeration.js")),_core_accessorSupport_decorators_subclass_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/decorators/subclass.js"),_BinParametersBase_js__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./node_modules/@arcgis/core/rest/support/BinParametersBase.js");let n=class extends _BinParametersBase_js__WEBPACK_IMPORTED_MODULE_8__.A{constructor(r){super(r),this.boundaries=[],this.type="fixed-boundaries"}};(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_2__.MZ)({json:{name:"parameters.boundaries",write:{writer:function c(r,e,s){(0,_core_object_js__WEBPACK_IMPORTED_MODULE_1__.sM)(s,r&&function p(r){return r[0]instanceof Date}(r)?r.map((r=>r.getTime())):r,e)}}}})],n.prototype,"boundaries",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_enumeration_js__WEBPACK_IMPORTED_MODULE_6__.e)({fixedBoundariesBin:"fixed-boundaries"},{readOnly:!0})],n.prototype,"type",void 0),n=(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_subclass_js__WEBPACK_IMPORTED_MODULE_7__.$)("esri.rest.support.FixedBoundariesBinParameters")],n);const m=n;n.from=(0,_core_accessorSupport_ensureType_js__WEBPACK_IMPORTED_MODULE_3__.dp)(n)},"./node_modules/@arcgis/core/rest/support/FixedIntervalBinParameters.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>c});var _chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@arcgis/core/chunks/tslib.es6.js"),_core_object_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@arcgis/core/core/object.js"),_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/decorators/property.js"),_core_accessorSupport_ensureType_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/ensureType.js"),_core_accessorSupport_decorators_enumeration_js__WEBPACK_IMPORTED_MODULE_6__=(__webpack_require__("./node_modules/@arcgis/core/core/has.js"),__webpack_require__("./node_modules/@arcgis/core/core/RandomLCG.js"),__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/decorators/enumeration.js")),_core_accessorSupport_decorators_subclass_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/decorators/subclass.js"),_BinParametersBase_js__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./node_modules/@arcgis/core/rest/support/BinParametersBase.js"),_NormalizationBinParametersMixin_js__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./node_modules/@arcgis/core/rest/support/NormalizationBinParametersMixin.js");function n(r,t,o){(0,_core_object_js__WEBPACK_IMPORTED_MODULE_1__.sM)(o,r instanceof Date?r.getTime():r,t)}let m=class extends((0,_NormalizationBinParametersMixin_js__WEBPACK_IMPORTED_MODULE_9__.K)(_BinParametersBase_js__WEBPACK_IMPORTED_MODULE_8__.A)){constructor(r){super(r),this.end=null,this.interval=null,this.start=null,this.type="fixed-interval"}};(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_2__.MZ)({json:{name:"parameters.end",write:{writer:n}}})],m.prototype,"end",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_2__.MZ)({type:Number,json:{name:"parameters.interval",write:!0}})],m.prototype,"interval",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_2__.MZ)({json:{name:"parameters.start",write:{writer:n}}})],m.prototype,"start",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_enumeration_js__WEBPACK_IMPORTED_MODULE_6__.e)({fixedIntervalBin:"fixed-interval"},{readOnly:!0})],m.prototype,"type",void 0),m=(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_subclass_js__WEBPACK_IMPORTED_MODULE_7__.$)("esri.rest.support.FixedIntervalBinParameters")],m);const c=m;m.from=(0,_core_accessorSupport_ensureType_js__WEBPACK_IMPORTED_MODULE_3__.dp)(m)},"./node_modules/@arcgis/core/rest/support/NormalizationBinParametersMixin.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{K:()=>m,Q:()=>n});var _chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@arcgis/core/chunks/tslib.es6.js"),_core_jsonMap_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@arcgis/core/core/jsonMap.js"),_core_Logger_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@arcgis/core/core/Logger.js"),_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/decorators/property.js"),_core_accessorSupport_decorators_enumeration_js__WEBPACK_IMPORTED_MODULE_6__=(__webpack_require__("./node_modules/@arcgis/core/core/has.js"),__webpack_require__("./node_modules/@arcgis/core/core/RandomLCG.js"),__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/decorators/enumeration.js")),_core_accessorSupport_decorators_subclass_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/decorators/subclass.js");const n=(0,_core_jsonMap_js__WEBPACK_IMPORTED_MODULE_1__.O)()({naturalLog:"natural-log",squareRoot:"square-root",percentOfTotal:"percent-of-total",log:"log",field:"field"}),l="percent-of-total",s="field",m=t=>{let m=class extends t{constructor(){super(...arguments),this.normalizationField=null,this.normalizationMaxValue=null,this.normalizationMinValue=null,this.normalizationTotal=null}get normalizationType(){let o=this._get("normalizationType");const t=!!this.normalizationField,a=null!=this.normalizationTotal;return t||a?(o=t&&s||a&&l||null,t&&a&&_core_Logger_js__WEBPACK_IMPORTED_MODULE_2__.A.getLogger(this).warn("warning: both normalizationField and normalizationTotal are set!")):o!==s&&o!==l||(o=null),o}set normalizationType(o){this._set("normalizationType",o)}};return(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_3__.MZ)({type:String,json:{name:"parameters.normalizationField",write:!0}})],m.prototype,"normalizationField",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_3__.MZ)({type:Number,json:{name:"parameters.normalizationMaxValue",write:!0}})],m.prototype,"normalizationMaxValue",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_3__.MZ)({type:Number,json:{name:"parameters.normalizationMinValue",write:!0}})],m.prototype,"normalizationMinValue",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_3__.MZ)({type:Number,json:{name:"parameters.normalizationTotal",write:!0}})],m.prototype,"normalizationTotal",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_enumeration_js__WEBPACK_IMPORTED_MODULE_6__.e)(n,{name:"parameters.normalizationType"})],m.prototype,"normalizationType",null),m=(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_subclass_js__WEBPACK_IMPORTED_MODULE_7__.$)("esri.rest.support.NormalizationBinParametersMixin")],m),m}},"./node_modules/@arcgis/core/rest/utils.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Dl:()=>f,jV:()=>i,lF:()=>s});__webpack_require__("./node_modules/@arcgis/core/config.js"),__webpack_require__("./node_modules/@arcgis/core/kernel.js");var _core_lang_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@arcgis/core/core/lang.js"),_core_urlUtils_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@arcgis/core/core/urlUtils.js");__webpack_require__("./node_modules/@arcgis/core/support/apiKeyUtils.js");function i(r,t){return t?{...t,query:{...r??{},...t.query}}:{query:r}}function f(r){return"string"==typeof r?(0,_core_urlUtils_js__WEBPACK_IMPORTED_MODULE_3__.An)(r):(0,_core_lang_js__WEBPACK_IMPORTED_MODULE_2__.o8)(r)}function s(r,t,o){const n={};for(const e in r){if("declaredClass"===e)continue;const i=r[e];if(null!=i&&"function"!=typeof i)if(Array.isArray(i))n[e]=i.map((r=>s(r)));else if("object"==typeof i)if(i.toJSON){const r=i.toJSON(o?.[e]);n[e]=t?r:JSON.stringify(r)}else n[e]=t?i:JSON.stringify(i);else n[e]=i}return n}},"./node_modules/@arcgis/core/smartMapping/support/utils.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{EG:()=>U,Ll:()=>M,R3:()=>j,UH:()=>f,aM:()=>k,fs:()=>$,i0:()=>N});var _intl_date_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@arcgis/core/intl/date.js"),_layers_support_fieldUtils_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@arcgis/core/layers/support/fieldUtils.js"),_support_arcadeOnDemand_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@arcgis/core/support/arcadeOnDemand.js"),_time_constants_js__WEBPACK_IMPORTED_MODULE_4__=(__webpack_require__("./node_modules/@arcgis/core/support/basemapUtils.js"),__webpack_require__("./node_modules/@arcgis/core/time/constants.js")),_time_timeZoneUtils_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/@arcgis/core/time/timeZoneUtils.js");const f=",",h={years:365,months:30,days:1,hours:1/24,minutes:1/1440,seconds:1/86400,milliseconds:1/864e5},v=new Set(["integer","small-integer"]);let T=null;function $(t){return(0,_layers_support_fieldUtils_js__WEBPACK_IMPORTED_MODULE_1__.vE)(t)||(0,_layers_support_fieldUtils_js__WEBPACK_IMPORTED_MODULE_1__.zD)(t)||(0,_layers_support_fieldUtils_js__WEBPACK_IMPORTED_MODULE_1__.Ah)(t)}async function U(t){const{field:e,field2:n,field3:r,normalizationField:o,valueExpression:i}=t;let s=[];if(i){if(!T){const{arcadeUtils:t}=await(0,_support_arcadeOnDemand_js__WEBPACK_IMPORTED_MODULE_2__.lw)();T=t}s=T.extractFieldNames(i)}return e&&s.push(e),n&&s.push(n),r&&s.push(r),o&&s.push(o),s}function D(t){return String(t).padStart(2,"0")}function S(t,e,n){let r;return"date"===e||"number"===e?("number"===e&&(t=new Date(t)),r=`TIMESTAMP'${n?t.getFullYear():t.getUTCFullYear()}-${D((n?t.getMonth():t.getUTCMonth())+1)}-${D(n?t.getDate():t.getUTCDate())} ${D(n?t.getHours():t.getUTCHours())}:${D(n?t.getMinutes():t.getUTCMinutes())}:${D(n?t.getSeconds():t.getUTCSeconds())}'`):r=t,r}function k(t,e,n,r){const{hasQueryEngine:o}=t,i=`(${S(n,C(t,n),o)} - ${S(e,C(t,e),o)})`;let s=h[r],a="/";return s<1&&(s=1/s,a="*"),{sqlExpression:1===s?i:`(${i} ${a} ${s})`,sqlWhere:null}}function C(t,e){if(e instanceof Date)return"date";if("number"==typeof e)return"number";if("string"==typeof e){const n=t.getField(e);if("<now>"===e.toLowerCase())return;if((0,_layers_support_fieldUtils_js__WEBPACK_IMPORTED_MODULE_1__.vE)(n))return"field"}}function j(t,e){const n=e&&t.getField(e);return!!n&&v.has(n.type)}function M(t){return`cast(${t} as float)`}function N(i,s){const{format:a,timeZoneOptions:l,fieldType:u}=s??{};let f,c;if(l&&({timeZone:f,timeZoneName:c}=(0,_time_timeZoneUtils_js__WEBPACK_IMPORTED_MODULE_5__.hv)(l.layerTimeZone,l.datesInUnknownTimezone,l.viewTimeZone,(0,_intl_date_js__WEBPACK_IMPORTED_MODULE_0__.J2)(a||"short-date-short-time"),u)),"string"==typeof i&&isNaN(Date.parse("time-only"===u?`1970-01-01T${i}Z`:i)))return i;switch(u){case"date-only":{const n=(0,_intl_date_js__WEBPACK_IMPORTED_MODULE_0__.J2)(a||"short-date");return"string"==typeof i?(0,_intl_date_js__WEBPACK_IMPORTED_MODULE_0__.iS)(i,{...n}):(0,_intl_date_js__WEBPACK_IMPORTED_MODULE_0__.Yq)(i,{...n,timeZone:_time_constants_js__WEBPACK_IMPORTED_MODULE_4__.n$})}case"time-only":{const n=(0,_intl_date_js__WEBPACK_IMPORTED_MODULE_0__.J2)(a||"short-time");return"string"==typeof i?(0,_intl_date_js__WEBPACK_IMPORTED_MODULE_0__.F8)(i,n):(0,_intl_date_js__WEBPACK_IMPORTED_MODULE_0__.Yq)(i,{...n,timeZone:_time_constants_js__WEBPACK_IMPORTED_MODULE_4__.n$})}case"timestamp-offset":{if(!f&&"string"==typeof i&&new Date(i).toISOString()!==i)return i;const r=a||l?(0,_intl_date_js__WEBPACK_IMPORTED_MODULE_0__.J2)(a||"short-date-short-time"):void 0,o=r?{...r,timeZone:f,timeZoneName:c}:void 0;return"string"==typeof i?(0,_intl_date_js__WEBPACK_IMPORTED_MODULE_0__.Ey)(i,o):(0,_intl_date_js__WEBPACK_IMPORTED_MODULE_0__.Yq)(i,o)}default:{const n=a||l?(0,_intl_date_js__WEBPACK_IMPORTED_MODULE_0__.J2)(a||"short-date-short-time"):void 0;return(0,_intl_date_js__WEBPACK_IMPORTED_MODULE_0__.Yq)("string"==typeof i?new Date(i):i,n?{...n,timeZone:f,timeZoneName:c}:void 0)}}}},"./node_modules/@arcgis/core/support/basemapDefinitions.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{H:()=>a,q:()=>s});var _assets_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@arcgis/core/assets.js"),_intl_messages_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@arcgis/core/intl/messages.js");async function s(e){if(!e)return;const s=e.includes("-vector")?e.slice(0,e.indexOf("-vector")):e.includes("-3d")?e.slice(0,e.indexOf("-3d")):e,a=await(0,_intl_messages_js__WEBPACK_IMPORTED_MODULE_1__.ud)("esri/t9n/basemaps");return a[e]||a[s]}const a={satellite:{id:"satellite",classic:!0,get thumbnailUrl(){return(0,_assets_js__WEBPACK_IMPORTED_MODULE_0__.s)("esri/images/basemap/satellite.jpg")},baseMapLayers:[{id:"satellite-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Imagery",showLegend:!1,visibility:!0,opacity:1}]},hybrid:{id:"hybrid",classic:!0,get thumbnailUrl(){return(0,_assets_js__WEBPACK_IMPORTED_MODULE_0__.s)("esri/images/basemap/hybrid.jpg")},baseMapLayers:[{id:"hybrid-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Imagery",showLegend:!1,visibility:!0,opacity:1},{id:"hybrid-reference-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/30d6b8271e1849cd9c3042060001f425/resources/styles/root.json",layerType:"VectorTileLayer",title:"Hybrid Reference Layer",isReference:!0,showLegend:!1,visibility:!0,opacity:1}]},terrain:{id:"terrain",classic:!0,get thumbnailUrl(){return(0,_assets_js__WEBPACK_IMPORTED_MODULE_0__.s)("esri/images/basemap/terrain.jpg")},baseMapLayers:[{id:"terrain-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/World_Terrain_Base/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Terrain Base",showLegend:!1,visibility:!0,opacity:1},{id:"terrain-reference-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/Reference/World_Reference_Overlay/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Reference Overlay",isReference:!0,showLegend:!1,visibility:!0,opacity:1}]},oceans:{id:"oceans",classic:!0,get thumbnailUrl(){return(0,_assets_js__WEBPACK_IMPORTED_MODULE_0__.s)("esri/images/basemap/oceans.jpg")},baseMapLayers:[{id:"oceans-base-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Ocean/World_Ocean_Base/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Ocean Base",showLegend:!1,visibility:!0,opacity:1},{id:"oceans-reference-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Ocean/World_Ocean_Reference/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Ocean Reference",isReference:!0,showLegend:!1,visibility:!0,opacity:1}]},osm:{id:"osm",classic:!0,get thumbnailUrl(){return(0,_assets_js__WEBPACK_IMPORTED_MODULE_0__.s)("esri/images/basemap/osm.jpg")},baseMapLayers:[{id:"osm-base-layer",layerType:"OpenStreetMap",title:"Open Street Map",showLegend:!1,visibility:!0,opacity:1}]},"dark-gray-vector":{id:"dark-gray-vector",classic:!0,get thumbnailUrl(){return(0,_assets_js__WEBPACK_IMPORTED_MODULE_0__.s)("esri/images/basemap/dark-gray-vector.jpg")},baseMapLayers:[{id:"dark-gray-base-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/5e9b3685f4c24d8781073dd928ebda50/resources/styles/root.json",layerType:"VectorTileLayer",title:"Dark Gray Base",visibility:!0,opacity:1},{id:"dark-gray-reference-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/747cb7a5329c478cbe6981076cc879c5/resources/styles/root.json",layerType:"VectorTileLayer",title:"Dark Gray Reference",isReference:!0,visibility:!0,opacity:1}]},get"dark-gray"(){return{...this["dark-gray-vector"],id:"dark-gray"}},"gray-vector":{id:"gray-vector",classic:!0,get thumbnailUrl(){return(0,_assets_js__WEBPACK_IMPORTED_MODULE_0__.s)("esri/images/basemap/gray-vector.jpg")},baseMapLayers:[{id:"gray-base-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/291da5eab3a0412593b66d384379f89f/resources/styles/root.json",layerType:"VectorTileLayer",title:"Light Gray Base",visibility:!0,opacity:1},{id:"gray-reference-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/1768e8369a214dfab4e2167d5c5f2454/resources/styles/root.json",layerType:"VectorTileLayer",title:"Light Gray Reference",isReference:!0,visibility:!0,opacity:1}]},get gray(){return{...this["gray-vector"],id:"gray"}},"streets-vector":{id:"streets-vector",classic:!0,get thumbnailUrl(){return(0,_assets_js__WEBPACK_IMPORTED_MODULE_0__.s)("esri/images/basemap/streets-vector.jpg")},baseMapLayers:[{id:"streets-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/de26a3cf4cc9451298ea173c4b324736/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Streets",visibility:!0,opacity:1}]},get streets(){return{...this["streets-vector"],id:"streets"}},"topo-vector":{id:"topo-vector",classic:!0,get thumbnailUrl(){return(0,_assets_js__WEBPACK_IMPORTED_MODULE_0__.s)("esri/images/basemap/topo-vector.jpg")},baseMapLayers:[{id:"world-hillshade-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Hillshade",showLegend:!1,visibility:!0,opacity:1},{id:"topo-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/7dc6cea0b1764a1f9af2e679f642f0f5/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Topo",visibility:!0,opacity:1}]},get topo(){return{...this["topo-vector"],id:"topo"}},"streets-night-vector":{id:"streets-night-vector",classic:!0,get thumbnailUrl(){return(0,_assets_js__WEBPACK_IMPORTED_MODULE_0__.s)("esri/images/basemap/streets-night.jpg")},baseMapLayers:[{id:"streets-night-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/86f556a2d1fd468181855a35e344567f/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Streets Night",visibility:!0,opacity:1}]},"streets-relief-vector":{id:"streets-relief-vector",classic:!0,get thumbnailUrl(){return(0,_assets_js__WEBPACK_IMPORTED_MODULE_0__.s)("esri/images/basemap/streets-relief.jpg")},baseMapLayers:[{id:"world-hillshade-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Hillshade",showLegend:!1,visibility:!0,opacity:1},{id:"streets-relief-vector-base-layer",styleUrl:"//www.arcgis.com/sharing/rest/content/items/b266e6d17fc345b498345613930fbd76/resources/styles/root.json",title:"World Streets Relief",layerType:"VectorTileLayer",visibility:!0,opacity:1}]},"streets-navigation-vector":{id:"streets-navigation-vector",classic:!0,get thumbnailUrl(){return(0,_assets_js__WEBPACK_IMPORTED_MODULE_0__.s)("esri/images/basemap/streets-navigation.jpg")},baseMapLayers:[{id:"streets-navigation-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/63c47b7177f946b49902c24129b87252/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Streets Navigation",visibility:!0,opacity:1}]},"topo-3d":{id:"topo-3d",is3d:!0,get thumbnailUrl(){return(0,_assets_js__WEBPACK_IMPORTED_MODULE_0__.s)("esri/images/basemap/topo-3d.png")},baseMapLayers:[{id:"topo-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/1e7d1784d1ef4b79ba6764d0bd6c3150/resources/styles/root.json",layerType:"VectorTileLayer",title:"Topographic",visibility:!0,opacity:1},{id:"topo-3d-trees",title:"Trees",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Trees_Thematic_v1/SceneServer",itemId:"f75fef56b2d944fe92ef9f7737b4f953",layerType:"ArcGISSceneServiceLayer"},{id:"topo-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_DarkLabels_v1/SceneServer",itemId:"a84404ad39c64c328d0596e361ec459b",layerType:"ArcGISSceneServiceLayer"},{id:"topo-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]},"navigation-3d":{id:"navigation-3d",is3d:!0,get thumbnailUrl(){return(0,_assets_js__WEBPACK_IMPORTED_MODULE_0__.s)("esri/images/basemap/navigation-3d.jpg")},baseMapLayers:[{id:"navigation-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/ccc904ff872b4144b94934e55e32784b/resources/styles/root.json",layerType:"VectorTileLayer",title:"Navigation",visibility:!0,opacity:1},{id:"navigation-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_DarkLabels_v1/SceneServer",itemId:"a84404ad39c64c328d0596e361ec459b",layerType:"ArcGISSceneServiceLayer"},{id:"navigation-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]},"streets-3d":{id:"streets-3d",is3d:!0,get thumbnailUrl(){return(0,_assets_js__WEBPACK_IMPORTED_MODULE_0__.s)("esri/images/basemap/streets-3d.png")},baseMapLayers:[{id:"streets-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/198298c4c64c4cb19de5b46aa00c198d/resources/styles/root.json",layerType:"VectorTileLayer",title:"Streets",visibility:!0,opacity:1},{id:"streets-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_DarkLabels_v1/SceneServer",itemId:"a84404ad39c64c328d0596e361ec459b",layerType:"ArcGISSceneServiceLayer"},{id:"streets-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]},"osm-3d":{id:"osm-3d",is3d:!0,get thumbnailUrl(){return(0,_assets_js__WEBPACK_IMPORTED_MODULE_0__.s)("esri/images/basemap/osm-3d.png")},baseMapLayers:[{id:"osm-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/8628d259c9d14bdc848771c23c513940/resources/styles/root.json",layerType:"VectorTileLayer",title:"OpenStreetMap",visibility:!0,opacity:1},{id:"osm-3d-trees",title:"Trees",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Trees_Thematic_v1/SceneServer",itemId:"f75fef56b2d944fe92ef9f7737b4f953",layerType:"ArcGISSceneServiceLayer"},{id:"osm-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_DarkLabels_v1/SceneServer",itemId:"a84404ad39c64c328d0596e361ec459b",layerType:"ArcGISSceneServiceLayer"},{id:"osm-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]},"gray-3d":{id:"gray-3d",is3d:!0,get thumbnailUrl(){return(0,_assets_js__WEBPACK_IMPORTED_MODULE_0__.s)("esri/images/basemap/gray-3d.png")},baseMapLayers:[{id:"gray-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/01a14b466345455ba4176d2e6390db92/resources/styles/root.json",layerType:"VectorTileLayer",title:"Streets",visibility:!0,opacity:1},{id:"gray-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_DarkLabels_v1/SceneServer",itemId:"a84404ad39c64c328d0596e361ec459b",layerType:"ArcGISSceneServiceLayer"},{id:"gray-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]},"navigation-dark-3d":{id:"navigation-dark-3d",itemId:"5a1365328b4943f09a54cf5fd1205707",is3d:!0,baseMapLayers:[{id:"navigation-dark-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/451a1777ab3f4bf095fae24a117439d9/resources/styles/root.json",layerType:"VectorTileLayer",title:"Navigation Dark"},{id:"navigation-dark-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_LightLabels_v1/SceneServer/layers/0",itemId:"f364b70b012a4da5a4b5921e193eac4a",layerType:"ArcGISSceneServiceLayer"},{id:"navigation-dark-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]},"streets-dark-3d":{id:"streets-dark-3d",itemId:"8a4efa2c20484ec9b4557895e65736ff",is3d:!0,baseMapLayers:[{id:"streets-dark-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/bc599b6d741a4ac084b7eea7bf8c5938/resources/styles/root.json",layerType:"VectorTileLayer",title:"OpenStreetMap Streets Night (for 3D)"},{id:"streets-dark-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_LightLabels_v1/SceneServer",itemId:"f364b70b012a4da5a4b5921e193eac4a",layerType:"ArcGISSceneServiceLayer"},{id:"streets-dark-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]},"dark-gray-3d":{id:"dark-gray-3d",itemId:"a8b7322a5fe94002bb0f5e0eeb0c5c18",is3d:!0,baseMapLayers:[{id:"dark-gray-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/4178f71acb934fb89f169e7d667c20c6/resources/styles/root.json",layerType:"VectorTileLayer",title:"OpenStreetMap Dark Gray Canvas (for 3D)"},{id:"dark-gray-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_LightLabels_v1/SceneServer/layers/0",itemId:"f364b70b012a4da5a4b5921e193eac4a",layerType:"ArcGISSceneServiceLayer"},{id:"dark-gray-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]}}},"./node_modules/@arcgis/core/support/basemapUtils.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{ns:()=>c});__webpack_require__("./node_modules/@arcgis/core/core/Collection.js"),__webpack_require__("./node_modules/@arcgis/core/core/urlUtils.js"),__webpack_require__("./node_modules/@arcgis/core/layers/effects/utils.js"),__webpack_require__("./node_modules/@arcgis/core/support/basemapDefinitions.js");function c(e,r){return!(!e.basemap?.referenceLayers?.some((e=>e.uid===r))&&!e.basemap?.baseLayers?.some((e=>e.uid===r)))}},"./node_modules/@arcgis/core/views/support/RenderState.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{var I;__webpack_require__.d(__webpack_exports__,{M:()=>I}),function(I){I[I.ANIMATING=0]="ANIMATING",I[I.INTERACTING=1]="INTERACTING",I[I.IDLE=2]="IDLE"}(I||(I={}))},"./node_modules/@arcgis/core/views/support/Scheduler.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Bb:()=>C,W6:()=>g,mj:()=>I,nu:()=>F});var g,_core_Handles_js__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__("./node_modules/@arcgis/core/core/Handles.js"),_core_Logger_js__WEBPACK_IMPORTED_MODULE_1__=(__webpack_require__("./node_modules/@arcgis/core/core/has.js"),__webpack_require__("./node_modules/@arcgis/core/core/Logger.js")),_core_maybe_js__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__("./node_modules/@arcgis/core/core/maybe.js"),_core_PerformanceSampler_js__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__("./node_modules/@arcgis/core/core/PerformanceSampler.js"),_core_PooledArray_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@arcgis/core/core/PooledArray.js"),_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@arcgis/core/core/promiseUtils.js"),_core_reactiveUtils_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/@arcgis/core/core/reactiveUtils.js"),_core_signal_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/@arcgis/core/core/signal.js"),_core_time_js__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("./node_modules/@arcgis/core/core/time.js"),_layers_support_PromiseQueue_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./node_modules/@arcgis/core/layers/support/PromiseQueue.js"),_debugFlags_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./node_modules/@arcgis/core/views/support/debugFlags.js"),_RenderState_js__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./node_modules/@arcgis/core/views/support/RenderState.js"),_Yield_js__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./node_modules/@arcgis/core/views/support/Yield.js");function I(){return new U.Scheduler}!function(e){e.RESOURCE_CONTROLLER_IMMEDIATE="immediate",e.RESOURCE_CONTROLLER="schedule",e.SLIDE="slide",e.STREAM_DATA_LOADER="stream loader",e.ELEVATION_QUERY="elevation query",e.TERRAIN_SURFACE="terrain",e.SURFACE_GEOMETRY_UPDATES="surface geometry updates",e.LOD_RENDERER="LoD renderer",e.GRAPHICS_CORE="Graphics3D",e.I3S_CONTROLLER="I3S",e.POINT_CLOUD_LAYER="point cloud",e.FEATURE_TILE_FETCHER="feature fetcher",e.OVERLAY="overlay",e.STAGE="stage",e.GRAPHICS_DECONFLICTOR="graphics deconflictor",e.FILTER_VISIBILITY="Graphics3D filter visibility",e.SCALE_VISIBILITY="Graphics3D scale visibility",e.FRUSTUM_VISIBILITY="Graphics3D frustum visibility",e.POINT_OF_INTEREST_FREQUENT="POI frequent",e.POINT_OF_INTEREST_INFREQUENT="POI infrequent",e.LABELER="labeler",e.FEATURE_QUERY_ENGINE="feature query",e.FEATURE_TILE_TREE="feature tile tree",e.FEATURE_TILE_TREE_ACTIVE="fast feature tile tree",e.ELEVATION_ALIGNMENT="elevation alignment",e.ELEVATION_ALIGNMENT_SCENE="elevation alignment scene",e.TEXT_TEXTURE_ATLAS="text texture atlas",e.TEXTURE_UNLOAD="texture unload",e.LINE_OF_SIGHT_TOOL="line of sight tool",e.LINE_OF_SIGHT_TOOL_INTERACTIVE="interactive line of sight tool",e.ELEVATION_PROFILE="elevation profile",e.SNAPPING="snapping",e.SHADOW_ACCUMULATOR="shadow accumulator",e.CLOUDS_GENERATOR="clouds generator",e.MAPVIEW_FETCH_QUEUE="mapview fetch queue",e.MAPVIEW_LAYERVIEW_UPDATE="mapview layerview update",e.MAPVIEW_VECTOR_TILE_PARSING_QUEUE="mapview vector tile parsing queue",e[e.NONE=0]="NONE",e[e.TEST_PRIO=1]="TEST_PRIO"}(g||(g={}));const p=new Map([[g.RESOURCE_CONTROLLER_IMMEDIATE,0],[g.RESOURCE_CONTROLLER,4],[g.SLIDE,0],[g.STREAM_DATA_LOADER,0],[g.ELEVATION_QUERY,0],[g.TERRAIN_SURFACE,1],[g.SURFACE_GEOMETRY_UPDATES,1],[g.LOD_RENDERER,2],[g.GRAPHICS_CORE,2],[g.I3S_CONTROLLER,2],[g.POINT_CLOUD_LAYER,2],[g.FEATURE_TILE_FETCHER,2],[g.CLOUDS_GENERATOR,2],[g.OVERLAY,4],[g.STAGE,4],[g.GRAPHICS_DECONFLICTOR,4],[g.FILTER_VISIBILITY,4],[g.SCALE_VISIBILITY,4],[g.FRUSTUM_VISIBILITY,4],[g.POINT_OF_INTEREST_FREQUENT,6],[g.POINT_OF_INTEREST_INFREQUENT,30],[g.LABELER,8],[g.FEATURE_QUERY_ENGINE,8],[g.FEATURE_TILE_TREE,16],[g.FEATURE_TILE_TREE_ACTIVE,0],[g.ELEVATION_ALIGNMENT,12],[g.ELEVATION_ALIGNMENT_SCENE,14],[g.TEXT_TEXTURE_ATLAS,12],[g.TEXTURE_UNLOAD,12],[g.LINE_OF_SIGHT_TOOL,16],[g.LINE_OF_SIGHT_TOOL_INTERACTIVE,0],[g.SNAPPING,0],[g.SHADOW_ACCUMULATOR,30],[g.MAPVIEW_FETCH_QUEUE,0],[g.MAPVIEW_LAYERVIEW_UPDATE,2],[g.MAPVIEW_VECTOR_TILE_PARSING_QUEUE,0]]);function A(e){return p.has(e)?p.get(e):"number"==typeof e?e:1}const f=(0,_core_time_js__WEBPACK_IMPORTED_MODULE_10__.l5)(6.5),L=(0,_core_time_js__WEBPACK_IMPORTED_MODULE_10__.l5)(1),N=(0,_core_time_js__WEBPACK_IMPORTED_MODULE_10__.l5)(30),O=(0,_core_time_js__WEBPACK_IMPORTED_MODULE_10__.l5)(1e3/30),S=(0,_core_time_js__WEBPACK_IMPORTED_MODULE_10__.l5)(100);var U,k;!function(a){a.Scheduler=class n{get updating(){return this._updating.value}_updatingChanged(){this._updating.value=this._tasks.some((e=>e.needsUpdate))}constructor(){this._updating=(0,_core_signal_js__WEBPACK_IMPORTED_MODULE_5__.v)(!0),this._microTaskQueued=!1,this._frameNumber=0,this.performanceInfo={total:new _core_PerformanceSampler_js__WEBPACK_IMPORTED_MODULE_11__.A("total"),tasks:new Map},this._frameTaskTimes=new Map,this._budget=new I,this._state=_RenderState_js__WEBPACK_IMPORTED_MODULE_8__.M.INTERACTING,this._tasks=new _core_PooledArray_js__WEBPACK_IMPORTED_MODULE_2__.A,this._runQueue=new _core_PooledArray_js__WEBPACK_IMPORTED_MODULE_2__.A,this._load=0,this._idleStateCallbacks=new _core_PooledArray_js__WEBPACK_IMPORTED_MODULE_2__.A,this._idleUpdatesStartFired=!1,this._forceTask=!1,this._debug=!1,this._debugHandle=(0,_core_reactiveUtils_js__WEBPACK_IMPORTED_MODULE_4__.watch)((()=>_debugFlags_js__WEBPACK_IMPORTED_MODULE_7__.A.SCHEDULER_LOG_SLOW_TASKS),(e=>this._debug=e),_core_reactiveUtils_js__WEBPACK_IMPORTED_MODULE_4__.Vh);for(const e of Object.keys(g))this.performanceInfo.tasks.set(g[e],new _core_PerformanceSampler_js__WEBPACK_IMPORTED_MODULE_11__.A(g[e]))}destroy(){this._tasks.toArray().forEach((e=>e.remove())),this._tasks.clear(),(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_12__.xt)(this._debugHandle),this._microTaskQueued=!1,this._updatingChanged()}taskRunningChanged(e){this._updatingChanged(),e&&this._budget.remaining>0&&!this._microTaskQueued&&(this._microTaskQueued=!0,queueMicrotask((()=>{this._microTaskQueued&&(this._microTaskQueued=!1,this._budget.remaining>0&&this._schedule()&&this._runFrame())})))}registerTask(e,t){const s=new _(this,e,t);return this._tasks.push(s),this._updatingChanged(),this.performanceInfo.tasks.has(e)||this.performanceInfo.tasks.set(e,new _core_PerformanceSampler_js__WEBPACK_IMPORTED_MODULE_11__.A(e)),s}registerIdleStateCallbacks(e,t){const s={idleBegin:e,idleEnd:t};this._idleStateCallbacks.push(s),this.state===_RenderState_js__WEBPACK_IMPORTED_MODULE_8__.M.IDLE&&this._idleUpdatesStartFired&&s.idleBegin();const r=this;return{remove:()=>this._removeIdleStateCallbacks(s),set idleBegin(e){r._idleUpdatesStartFired&&(s.idleEnd(),r._state===_RenderState_js__WEBPACK_IMPORTED_MODULE_8__.M.IDLE&&e()),s.idleBegin=e},set idleEnd(e){s.idleEnd=e}}}get load(){return this._load}set state(e){this._state!==e&&(this._state=e,this.state!==_RenderState_js__WEBPACK_IMPORTED_MODULE_8__.M.IDLE&&this._idleUpdatesStartFired&&(this._idleUpdatesStartFired=!1,this._idleStateCallbacks.forAll((e=>e.idleEnd()))))}get state(){return this._state}frame(e){this._startFrameTaskTimes();const t=this._updateBudget(e);if(t){const e=this._budget.now();this._runFrame(),this._recordFrameTaskTimes(this._budget.now()-e)}else this._recordFrameTaskTimes(0);return t}_updateBudget(e){this._test&&(this._test.usedBudget=0),++this._frameNumber;let t=f,s=e.frameDuration,r=L;switch(this.state){case _RenderState_js__WEBPACK_IMPORTED_MODULE_8__.M.IDLE:t=(0,_core_time_js__WEBPACK_IMPORTED_MODULE_10__.l5)(0),s=(0,_core_time_js__WEBPACK_IMPORTED_MODULE_10__.l5)(Math.max(S,e.frameDuration)),r=N;break;case _RenderState_js__WEBPACK_IMPORTED_MODULE_8__.M.INTERACTING:s=(0,_core_time_js__WEBPACK_IMPORTED_MODULE_10__.l5)(Math.max(O,e.frameDuration));case _RenderState_js__WEBPACK_IMPORTED_MODULE_8__.M.ANIMATING:}return s=(0,_core_time_js__WEBPACK_IMPORTED_MODULE_10__.l5)(s-e.elapsedFrameTime-t),this.state!==_RenderState_js__WEBPACK_IMPORTED_MODULE_8__.M.IDLE&&s<L&&!this._forceTask?(this._forceTask=!0,!1):(s=(0,_core_time_js__WEBPACK_IMPORTED_MODULE_10__.l5)(Math.max(s,r)),this._budget.reset(s,this.state),this._updateLoad(),this._schedule())}_runFrame(){switch(this._forceTask=!1,this._microTaskQueued=!1,this.state){case _RenderState_js__WEBPACK_IMPORTED_MODULE_8__.M.IDLE:this._idleUpdatesStartFired||(this._idleUpdatesStartFired=!0,this._idleStateCallbacks.forAll((e=>e.idleBegin()))),this._runIdle();break;case _RenderState_js__WEBPACK_IMPORTED_MODULE_8__.M.INTERACTING:this._runInteracting();break;default:this._runAnimating()}this._test&&(this._test.usedBudget=this._budget.elapsed)}stopFrame(){this._budget.reset((0,_core_time_js__WEBPACK_IMPORTED_MODULE_10__.l5)(0),this._state),this._budget.madeProgress()}_removeIdleStateCallbacks(e){this._idleUpdatesStartFired&&e.idleEnd(),this._idleStateCallbacks.removeUnordered(e)}removeTask(e){this._tasks.removeUnordered(e),this._runQueue.removeUnordered(e),this._updatingChanged()}_updateTask(e){this._tasks.forAll((t=>{t.name===e&&t.setPriority(e)}))}_getState(e){if(this._runQueue.some((t=>t.name===e)))return k.SCHEDULED;let t=k.IDLE;return this._tasks.forAll((s=>{s.name===e&&s.needsUpdate&&(s.schedulePriority<=1?t=k.READY:t!==k.READY&&(t=k.WAITING))})),t}_getRuntime(e){let t=0;return this._tasks.forAll((s=>{s.name===e&&(t+=s.runtime)})),t}_resetRuntimes(){this._tasks.forAll((e=>e.runtime=0))}_getRunning(){const e=new Map;if(this._tasks.forAll((t=>{t.needsUpdate&&e.set(t.name,(e.get(t.name)||0)+1)})),0===e.size)return null;let t="";return e.forEach(((e,s)=>{t+=e>1?` ${e}x ${s}`:` ${s}`})),t}_runIdle(){this._run()}_runInteracting(){this._run()}_runAnimating(){this._run()}_updateLoad(){const e=this._tasks.reduce(((e,t)=>t.needsUpdate?++e:e),0);this._load=.9*this._load+e*(1-.9)}_schedule(){for(this._runQueue.filterInPlace((e=>!!e.needsUpdate||(e.schedulePriority=e.basePriority,!1))),this._tasks.forAll((e=>{0===e.basePriority&&e.needsUpdate&&!this._runQueue.includes(e)&&e.blockFrame!==this._frameNumber&&this._runQueue.unshift(e)}));0===this._runQueue.length;){let e=!1,t=0;if(this._tasks.forAll((s=>{s.needsUpdate&&0!==s.schedulePriority&&0!==s.basePriority&&s.blockFrame!==this._frameNumber&&(e=!0,t=Math.max(t,s.basePriority),1===s.schedulePriority?(s.schedulePriority=0,this._runQueue.push(s)):--s.schedulePriority)})),!e)return this._updatingChanged(),!1}return this._updatingChanged(),!0}_run(){do{for(;this._runQueue.length>0;){const s=this._budget.now(),r=this._runQueue.pop();this._budget.resetProgress();try{r.task.runTask(this._budget)===_Yield_js__WEBPACK_IMPORTED_MODULE_9__.G&&(r.blockFrame=this._frameNumber)}catch(e){_core_Logger_js__WEBPACK_IMPORTED_MODULE_1__.A.getLogger("esri.views.support.Scheduler").error(`Exception in task "${r.name}"`,e),r.blockFrame=this._frameNumber}!this._budget.hasProgressed&&r.blockFrame!==this._frameNumber&&r.needsUpdate&&(r.name,g.I3S_CONTROLLER,r.blockFrame=this._frameNumber),r.schedulePriority=r.basePriority;const i=this._budget.now()-s;if(r.runtime+=i,this._frameTaskTimes.set(r.priority,this._frameTaskTimes.get(r.priority)+i),this._budget.remaining<=0)return void this._updatingChanged()}}while(this._schedule());this._updatingChanged()}_startFrameTaskTimes(){for(const e of Object.keys(g))this._frameTaskTimes.set(g[e],0)}_recordFrameTaskTimes(e){this._frameTaskTimes.forEach(((e,t)=>this.performanceInfo.tasks.get(t).push(e))),this.performanceInfo.total.push(e)}get test(){return this._test}};class _{get task(){return this._task.value}get updating(){return this._queue.running}constructor(t,s,r){this._scheduler=t,this.name=s,this.blockFrame=0,this.runtime=0,this._queue=new _layers_support_PromiseQueue_js__WEBPACK_IMPORTED_MODULE_6__.T,this._handles=new _core_Handles_js__WEBPACK_IMPORTED_MODULE_13__.A,this._basePriority=A(s),this.schedulePriority=this._basePriority,this._task=(0,_core_signal_js__WEBPACK_IMPORTED_MODULE_5__.v)(null!=r?r:this._queue),this._handles.add((0,_core_reactiveUtils_js__WEBPACK_IMPORTED_MODULE_4__.when)((()=>this.task.running),(e=>t.taskRunningChanged(e))))}remove(){this.processQueue(C),this._scheduler.removeTask(this),this.schedule=F.schedule,this.reschedule=F.reschedule,this._handles.destroy()}get basePriority(){return this._basePriority}setPriority(e){if(this.name===e)return;this.name=e;const t=A(e);0!==this._basePriority&&0===this.schedulePriority||(this.schedulePriority=t),this._basePriority=t}get priority(){return this.name}set priority(e){this.setPriority(e)}get needsUpdate(){return this.updating||this.task.running}schedule(e,t,s){return this._queue.push(e,t,s)}reschedule(e,t,s){return this._queue.unshift(e,t,s)}processQueue(e){return this._queue.runTask(e)}}class I{constructor(){this._begin="undefined"!=typeof performance?performance.now():0,this._budget=0,this._state=_RenderState_js__WEBPACK_IMPORTED_MODULE_8__.M.IDLE,this._done=!1,this._progressed=!1,this._enabled=!0}run(e){return!this.done&&(!0===e()&&this.madeProgress(),!0)}get done(){return this._done}get budget(){return this._budget}madeProgress(){return this._progressed=!0,this._done=this.elapsed>=this._budget&&this._enabled,this._done}get state(){return this._state}get enabled(){return this._enabled}set enabled(e){this._enabled=e}reset(e,t){this._begin=this.now(),this._budget=e,this._state=t,this.resetProgress()}get remaining(){return Math.max(this._budget-this.elapsed,0)}now(){return performance.now()}get elapsed(){return this.now()-this._begin}resetProgress(){this._progressed=!1,this._done=!1}get hasProgressed(){return this._progressed}}a.Budget=I}(U||(U={})),function(e){e.SCHEDULED="s",e.READY="r",e.WAITING="w",e.IDLE="i"}(k||(k={}));const C=(()=>{const e=new U.Budget;return e.enabled=!1,e})();const F=new class P{remove(){}processQueue(){}schedule(e,t,s){try{if((0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_3__.G4)(t)){const e=(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_3__.NK)();return s?Promise.resolve(s(e)):Promise.reject(e)}return(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_3__.z7)(e(C))}catch(r){return Promise.reject(r)}}reschedule(e,t,s){return this.schedule(e,t,s)}}},"./node_modules/@arcgis/core/views/support/Yield.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{G:()=>o});const o=Symbol("Yield")},"./node_modules/@arcgis/core/views/support/debugFlags.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>E});var _chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@arcgis/core/chunks/tslib.es6.js"),_core_Accessor_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@arcgis/core/core/Accessor.js"),_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/decorators/property.js"),_core_accessorSupport_decorators_subclass_js__WEBPACK_IMPORTED_MODULE_6__=(__webpack_require__("./node_modules/@arcgis/core/core/has.js"),__webpack_require__("./node_modules/@arcgis/core/core/Logger.js"),__webpack_require__("./node_modules/@arcgis/core/core/RandomLCG.js"),__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/decorators/subclass.js"));let e=class extends _core_Accessor_js__WEBPACK_IMPORTED_MODULE_1__.A{constructor(){super(...arguments),this.SCHEDULER_LOG_SLOW_TASKS=!1,this.FEATURE_SERVICE_SNAPPING_SOURCE_TILE_TREE_SHOW_TILES=!1}};(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_2__.MZ)()],e.prototype,"SCHEDULER_LOG_SLOW_TASKS",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_2__.MZ)()],e.prototype,"FEATURE_SERVICE_SNAPPING_SOURCE_TILE_TREE_SHOW_TILES",void 0),e=(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_subclass_js__WEBPACK_IMPORTED_MODULE_6__.$)("esri.views.support.debugFlags")],e);const E=new e}}]);