{"version":3,"file":"js/flood-map-ui.js","mappings":"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","sources":["webpack://defraMap/./src/js/provider/esri-sdk/constants.js","webpack://defraMap/./node_modules/preact/dist/preact.module.js","webpack://defraMap/./node_modules/preact/hooks/dist/hooks.module.js","webpack://defraMap/./node_modules/preact/compat/dist/compat.module.js","webpack://defraMap/./node_modules/preact/compat/client.mjs","webpack://defraMap/./src/js/lib/query.js","webpack://defraMap/./src/js/store/app-reducer.js","webpack://defraMap/./src/js/store/app-provider.jsx","webpack://defraMap/./node_modules/geodesy/dms.js","webpack://defraMap/./node_modules/geodesy/latlon-spherical.js","webpack://defraMap/./src/js/lib/viewport.js","webpack://defraMap/./src/js/store/viewport-reducer.js","webpack://defraMap/./src/js/store/viewport-provider.jsx","webpack://defraMap/./src/js/store/use-app.js","webpack://defraMap/./src/js/hooks/use-query-state.js","webpack://defraMap/./src/js/store/use-viewport.js","webpack://defraMap/./src/js/lib/debounce.js","webpack://defraMap/./src/js/components/status.jsx","webpack://defraMap/./src/js/components/padding-box.jsx","webpack://defraMap/./src/js/hooks/use-pixel-obscurred.js","webpack://defraMap/./src/js/components/target.jsx","webpack://defraMap/./src/js/components/viewport.jsx","webpack://defraMap/./src/js/components/exit.jsx","webpack://defraMap/./src/js/hooks/use-outside-interact.js","webpack://defraMap/./src/js/lib/search.js","webpack://defraMap/./src/js/store/search-reducer.js","webpack://defraMap/./src/js/components/autocomplete.jsx","webpack://defraMap/./node_modules/geodesy/vector3d.js","webpack://defraMap/./node_modules/geodesy/latlon-ellipsoidal.js","webpack://defraMap/./node_modules/geodesy/latlon-ellipsoidal-datum.js","webpack://defraMap/./node_modules/geodesy/osgridref.js","webpack://defraMap/./src/js/provider/os-open-names/provider.js","webpack://defraMap/./src/js/provider/esri-world-geocoder/provider.js","webpack://defraMap/./src/js/components/search.jsx","webpack://defraMap/./src/js/components/panel.jsx","webpack://defraMap/./src/js/components/segment-group.jsx","webpack://defraMap/./src/js/components/segments.jsx","webpack://defraMap/./src/js/components/more.jsx","webpack://defraMap/./src/js/lib/symbols.js","webpack://defraMap/./src/js/components/key-symbol.jsx","webpack://defraMap/./src/js/components/layer-group.jsx","webpack://defraMap/./src/js/components/layers.jsx","webpack://defraMap/./src/js/components/draw-start.jsx","webpack://defraMap/./src/js/components/styles.jsx","webpack://defraMap/./src/js/components/keyboard.jsx","webpack://defraMap/./src/js/components/legend-button.jsx","webpack://defraMap/./src/js/components/key-button.jsx","webpack://defraMap/./src/js/components/draw-finish.jsx","webpack://defraMap/./src/js/components/search-button.jsx","webpack://defraMap/./src/js/components/styles-button.jsx","webpack://defraMap/./src/js/components/tooltip.jsx","webpack://defraMap/./src/js/components/zoom.jsx","webpack://defraMap/./src/js/components/reset.jsx","webpack://defraMap/./src/js/components/location.jsx","webpack://defraMap/./src/js/components/attribution.jsx","webpack://defraMap/./src/js/components/error.jsx","webpack://defraMap/./src/js/components/viewport-label.jsx","webpack://defraMap/./src/js/components/draw-cancel.jsx","webpack://defraMap/./src/js/components/draw-edit.jsx","webpack://defraMap/./src/js/components/query-button.jsx","webpack://defraMap/./src/js/components/help.jsx","webpack://defraMap/./src/js/components/help-button.jsx","webpack://defraMap/./src/js/components/container.jsx","webpack://defraMap/./src/js/provider/esri-sdk/query.js","webpack://defraMap/./src/js/provider/esri-sdk/provider.js","webpack://defraMap/./src/js/provider/esri-sdk/events.js","webpack://defraMap/./src/js/provider/esri-sdk/marker.js","webpack://defraMap/./src/app.jsx","webpack://defraMap/./src/root.js"],"sourcesContent":["export const defaults = {\n  PRECISION: 6,\n  POLYGON_QUERY_STROKE: '#d4351c',\n  POLYGON_QUERY_STROKE_DARK: '#ffffff'\n}\n","var n,l,u,t,i,o,r,f,e,c,s,a,h={},p=[],v=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,y=Array.isArray;function d(n,l){for(var u in l)n[u]=l[u];return n}function w(n){var l=n.parentNode;l&&l.removeChild(n)}function _(l,u,t){var i,o,r,f={};for(r in u)\"key\"==r?i=u[r]:\"ref\"==r?o=u[r]:f[r]=u[r];if(arguments.length>2&&(f.children=arguments.length>3?n.call(arguments,2):t),\"function\"==typeof l&&null!=l.defaultProps)for(r in l.defaultProps)void 0===f[r]&&(f[r]=l.defaultProps[r]);return g(l,f,i,o,null)}function g(n,t,i,o,r){var f={type:n,props:t,key:i,ref:o,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,constructor:void 0,__v:null==r?++u:r,__i:-1,__u:0};return null==r&&null!=l.vnode&&l.vnode(f),f}function m(){return{current:null}}function k(n){return n.children}function b(n,l){this.props=n,this.context=l}function x(n,l){if(null==l)return n.__?x(n.__,n.__i+1):null;for(var u;l<n.__k.length;l++)if(null!=(u=n.__k[l])&&null!=u.__e)return u.__e;return\"function\"==typeof n.type?x(n):null}function C(n){var l,u;if(null!=(n=n.__)&&null!=n.__c){for(n.__e=n.__c.base=null,l=0;l<n.__k.length;l++)if(null!=(u=n.__k[l])&&null!=u.__e){n.__e=n.__c.base=u.__e;break}return C(n)}}function M(n){(!n.__d&&(n.__d=!0)&&i.push(n)&&!P.__r++||o!==l.debounceRendering)&&((o=l.debounceRendering)||r)(P)}function P(){var n,u,t,o,r,e,c,s;for(i.sort(f);n=i.shift();)n.__d&&(u=i.length,o=void 0,e=(r=(t=n).__v).__e,c=[],s=[],t.__P&&((o=d({},r)).__v=r.__v+1,l.vnode&&l.vnode(o),O(t.__P,o,r,t.__n,t.__P.namespaceURI,32&r.__u?[e]:null,c,null==e?x(r):e,!!(32&r.__u),s),o.__v=r.__v,o.__.__k[o.__i]=o,j(c,o,s),o.__e!=e&&C(o)),i.length>u&&i.sort(f));P.__r=0}function S(n,l,u,t,i,o,r,f,e,c,s){var a,v,y,d,w,_=t&&t.__k||p,g=l.length;for(u.__d=e,$(u,l,_),e=u.__d,a=0;a<g;a++)null!=(y=u.__k[a])&&\"boolean\"!=typeof y&&\"function\"!=typeof y&&(v=-1===y.__i?h:_[y.__i]||h,y.__i=a,O(n,y,v,i,o,r,f,e,c,s),d=y.__e,y.ref&&v.ref!=y.ref&&(v.ref&&N(v.ref,null,y),s.push(y.ref,y.__c||d,y)),null==w&&null!=d&&(w=d),65536&y.__u||v.__k===y.__k?e=I(y,e,n):\"function\"==typeof y.type&&void 0!==y.__d?e=y.__d:d&&(e=d.nextSibling),y.__d=void 0,y.__u&=-196609);u.__d=e,u.__e=w}function $(n,l,u){var t,i,o,r,f,e=l.length,c=u.length,s=c,a=0;for(n.__k=[],t=0;t<e;t++)r=t+a,null!=(i=n.__k[t]=null==(i=l[t])||\"boolean\"==typeof i||\"function\"==typeof i?null:\"string\"==typeof i||\"number\"==typeof i||\"bigint\"==typeof i||i.constructor==String?g(null,i,null,null,null):y(i)?g(k,{children:i},null,null,null):void 0===i.constructor&&i.__b>0?g(i.type,i.props,i.key,i.ref?i.ref:null,i.__v):i)?(i.__=n,i.__b=n.__b+1,f=L(i,u,r,s),i.__i=f,o=null,-1!==f&&(s--,(o=u[f])&&(o.__u|=131072)),null==o||null===o.__v?(-1==f&&a--,\"function\"!=typeof i.type&&(i.__u|=65536)):f!==r&&(f==r-1?a=f-r:f==r+1?a++:f>r?s>e-r?a+=f-r:a--:f<r&&a++,f!==t+a&&(i.__u|=65536))):(o=u[r])&&null==o.key&&o.__e&&0==(131072&o.__u)&&(o.__e==n.__d&&(n.__d=x(o)),V(o,o,!1),u[r]=null,s--);if(s)for(t=0;t<c;t++)null!=(o=u[t])&&0==(131072&o.__u)&&(o.__e==n.__d&&(n.__d=x(o)),V(o,o))}function I(n,l,u){var t,i;if(\"function\"==typeof n.type){for(t=n.__k,i=0;t&&i<t.length;i++)t[i]&&(t[i].__=n,l=I(t[i],l,u));return l}n.__e!=l&&(l&&n.type&&!u.contains(l)&&(l=x(n)),u.insertBefore(n.__e,l||null),l=n.__e);do{l=l&&l.nextSibling}while(null!=l&&8===l.nodeType);return l}function H(n,l){return l=l||[],null==n||\"boolean\"==typeof n||(y(n)?n.some(function(n){H(n,l)}):l.push(n)),l}function L(n,l,u,t){var i=n.key,o=n.type,r=u-1,f=u+1,e=l[u];if(null===e||e&&i==e.key&&o===e.type&&0==(131072&e.__u))return u;if(t>(null!=e&&0==(131072&e.__u)?1:0))for(;r>=0||f<l.length;){if(r>=0){if((e=l[r])&&0==(131072&e.__u)&&i==e.key&&o===e.type)return r;r--}if(f<l.length){if((e=l[f])&&0==(131072&e.__u)&&i==e.key&&o===e.type)return f;f++}}return-1}function T(n,l,u){\"-\"===l[0]?n.setProperty(l,null==u?\"\":u):n[l]=null==u?\"\":\"number\"!=typeof u||v.test(l)?u:u+\"px\"}function A(n,l,u,t,i){var o;n:if(\"style\"===l)if(\"string\"==typeof u)n.style.cssText=u;else{if(\"string\"==typeof t&&(n.style.cssText=t=\"\"),t)for(l in t)u&&l in u||T(n.style,l,\"\");if(u)for(l in u)t&&u[l]===t[l]||T(n.style,l,u[l])}else if(\"o\"===l[0]&&\"n\"===l[1])o=l!==(l=l.replace(/(PointerCapture)$|Capture$/i,\"$1\")),l=l.toLowerCase()in n||\"onFocusOut\"===l||\"onFocusIn\"===l?l.toLowerCase().slice(2):l.slice(2),n.l||(n.l={}),n.l[l+o]=u,u?t?u.u=t.u:(u.u=e,n.addEventListener(l,o?s:c,o)):n.removeEventListener(l,o?s:c,o);else{if(\"http://www.w3.org/2000/svg\"==i)l=l.replace(/xlink(H|:h)/,\"h\").replace(/sName$/,\"s\");else if(\"width\"!=l&&\"height\"!=l&&\"href\"!=l&&\"list\"!=l&&\"form\"!=l&&\"tabIndex\"!=l&&\"download\"!=l&&\"rowSpan\"!=l&&\"colSpan\"!=l&&\"role\"!=l&&\"popover\"!=l&&l in n)try{n[l]=null==u?\"\":u;break n}catch(n){}\"function\"==typeof u||(null==u||!1===u&&\"-\"!==l[4]?n.removeAttribute(l):n.setAttribute(l,\"popover\"==l&&1==u?\"\":u))}}function F(n){return function(u){if(this.l){var t=this.l[u.type+n];if(null==u.t)u.t=e++;else if(u.t<t.u)return;return t(l.event?l.event(u):u)}}}function O(n,u,t,i,o,r,f,e,c,s){var a,h,p,v,w,_,g,m,x,C,M,P,$,I,H,L,T=u.type;if(void 0!==u.constructor)return null;128&t.__u&&(c=!!(32&t.__u),r=[e=u.__e=t.__e]),(a=l.__b)&&a(u);n:if(\"function\"==typeof T)try{if(m=u.props,x=\"prototype\"in T&&T.prototype.render,C=(a=T.contextType)&&i[a.__c],M=a?C?C.props.value:a.__:i,t.__c?g=(h=u.__c=t.__c).__=h.__E:(x?u.__c=h=new T(m,M):(u.__c=h=new b(m,M),h.constructor=T,h.render=q),C&&C.sub(h),h.props=m,h.state||(h.state={}),h.context=M,h.__n=i,p=h.__d=!0,h.__h=[],h._sb=[]),x&&null==h.__s&&(h.__s=h.state),x&&null!=T.getDerivedStateFromProps&&(h.__s==h.state&&(h.__s=d({},h.__s)),d(h.__s,T.getDerivedStateFromProps(m,h.__s))),v=h.props,w=h.state,h.__v=u,p)x&&null==T.getDerivedStateFromProps&&null!=h.componentWillMount&&h.componentWillMount(),x&&null!=h.componentDidMount&&h.__h.push(h.componentDidMount);else{if(x&&null==T.getDerivedStateFromProps&&m!==v&&null!=h.componentWillReceiveProps&&h.componentWillReceiveProps(m,M),!h.__e&&(null!=h.shouldComponentUpdate&&!1===h.shouldComponentUpdate(m,h.__s,M)||u.__v===t.__v)){for(u.__v!==t.__v&&(h.props=m,h.state=h.__s,h.__d=!1),u.__e=t.__e,u.__k=t.__k,u.__k.forEach(function(n){n&&(n.__=u)}),P=0;P<h._sb.length;P++)h.__h.push(h._sb[P]);h._sb=[],h.__h.length&&f.push(h);break n}null!=h.componentWillUpdate&&h.componentWillUpdate(m,h.__s,M),x&&null!=h.componentDidUpdate&&h.__h.push(function(){h.componentDidUpdate(v,w,_)})}if(h.context=M,h.props=m,h.__P=n,h.__e=!1,$=l.__r,I=0,x){for(h.state=h.__s,h.__d=!1,$&&$(u),a=h.render(h.props,h.state,h.context),H=0;H<h._sb.length;H++)h.__h.push(h._sb[H]);h._sb=[]}else do{h.__d=!1,$&&$(u),a=h.render(h.props,h.state,h.context),h.state=h.__s}while(h.__d&&++I<25);h.state=h.__s,null!=h.getChildContext&&(i=d(d({},i),h.getChildContext())),x&&!p&&null!=h.getSnapshotBeforeUpdate&&(_=h.getSnapshotBeforeUpdate(v,w)),S(n,y(L=null!=a&&a.type===k&&null==a.key?a.props.children:a)?L:[L],u,t,i,o,r,f,e,c,s),h.base=u.__e,u.__u&=-161,h.__h.length&&f.push(h),g&&(h.__E=h.__=null)}catch(n){if(u.__v=null,c||null!=r){for(u.__u|=c?160:32;e&&8===e.nodeType&&e.nextSibling;)e=e.nextSibling;r[r.indexOf(e)]=null,u.__e=e}else u.__e=t.__e,u.__k=t.__k;l.__e(n,u,t)}else null==r&&u.__v===t.__v?(u.__k=t.__k,u.__e=t.__e):u.__e=z(t.__e,u,t,i,o,r,f,c,s);(a=l.diffed)&&a(u)}function j(n,u,t){u.__d=void 0;for(var i=0;i<t.length;i++)N(t[i],t[++i],t[++i]);l.__c&&l.__c(u,n),n.some(function(u){try{n=u.__h,u.__h=[],n.some(function(n){n.call(u)})}catch(n){l.__e(n,u.__v)}})}function z(l,u,t,i,o,r,f,e,c){var s,a,p,v,d,_,g,m=t.props,k=u.props,b=u.type;if(\"svg\"===b?o=\"http://www.w3.org/2000/svg\":\"math\"===b?o=\"http://www.w3.org/1998/Math/MathML\":o||(o=\"http://www.w3.org/1999/xhtml\"),null!=r)for(s=0;s<r.length;s++)if((d=r[s])&&\"setAttribute\"in d==!!b&&(b?d.localName===b:3===d.nodeType)){l=d,r[s]=null;break}if(null==l){if(null===b)return document.createTextNode(k);l=document.createElementNS(o,b,k.is&&k),r=null,e=!1}if(null===b)m===k||e&&l.data===k||(l.data=k);else{if(r=r&&n.call(l.childNodes),m=t.props||h,!e&&null!=r)for(m={},s=0;s<l.attributes.length;s++)m[(d=l.attributes[s]).name]=d.value;for(s in m)if(d=m[s],\"children\"==s);else if(\"dangerouslySetInnerHTML\"==s)p=d;else if(\"key\"!==s&&!(s in k)){if(\"value\"==s&&\"defaultValue\"in k||\"checked\"==s&&\"defaultChecked\"in k)continue;A(l,s,null,d,o)}for(s in k)d=k[s],\"children\"==s?v=d:\"dangerouslySetInnerHTML\"==s?a=d:\"value\"==s?_=d:\"checked\"==s?g=d:\"key\"===s||e&&\"function\"!=typeof d||m[s]===d||A(l,s,d,m[s],o);if(a)e||p&&(a.__html===p.__html||a.__html===l.innerHTML)||(l.innerHTML=a.__html),u.__k=[];else if(p&&(l.innerHTML=\"\"),S(l,y(v)?v:[v],u,t,i,\"foreignObject\"===b?\"http://www.w3.org/1999/xhtml\":o,r,f,r?r[0]:t.__k&&x(t,0),e,c),null!=r)for(s=r.length;s--;)null!=r[s]&&w(r[s]);e||(s=\"value\",void 0!==_&&(_!==l[s]||\"progress\"===b&&!_||\"option\"===b&&_!==m[s])&&A(l,s,_,m[s],o),s=\"checked\",void 0!==g&&g!==l[s]&&A(l,s,g,m[s],o))}return l}function N(n,u,t){try{if(\"function\"==typeof n){var i=\"function\"==typeof n.__u;i&&n.__u(),i&&null==u||(n.__u=n(u))}else n.current=u}catch(n){l.__e(n,t)}}function V(n,u,t){var i,o;if(l.unmount&&l.unmount(n),(i=n.ref)&&(i.current&&i.current!==n.__e||N(i,null,u)),null!=(i=n.__c)){if(i.componentWillUnmount)try{i.componentWillUnmount()}catch(n){l.__e(n,u)}i.base=i.__P=null}if(i=n.__k)for(o=0;o<i.length;o++)i[o]&&V(i[o],u,t||\"function\"!=typeof n.type);t||null==n.__e||w(n.__e),n.__c=n.__=n.__e=n.__d=void 0}function q(n,l,u){return this.constructor(n,u)}function B(u,t,i){var o,r,f,e;l.__&&l.__(u,t),r=(o=\"function\"==typeof i)?null:i&&i.__k||t.__k,f=[],e=[],O(t,u=(!o&&i||t).__k=_(k,null,[u]),r||h,h,t.namespaceURI,!o&&i?[i]:r?null:t.firstChild?n.call(t.childNodes):null,f,!o&&i?i:r?r.__e:t.firstChild,o,e),j(f,u,e)}function D(n,l){B(n,l,D)}function E(l,u,t){var i,o,r,f,e=d({},l.props);for(r in l.type&&l.type.defaultProps&&(f=l.type.defaultProps),u)\"key\"==r?i=u[r]:\"ref\"==r?o=u[r]:e[r]=void 0===u[r]&&void 0!==f?f[r]:u[r];return arguments.length>2&&(e.children=arguments.length>3?n.call(arguments,2):t),g(l.type,e,i||l.key,o||l.ref,null)}function G(n,l){var u={__c:l=\"__cC\"+a++,__:n,Consumer:function(n,l){return n.children(l)},Provider:function(n){var u,t;return this.getChildContext||(u=[],(t={})[l]=this,this.getChildContext=function(){return t},this.componentWillUnmount=function(){u=null},this.shouldComponentUpdate=function(n){this.props.value!==n.value&&u.some(function(n){n.__e=!0,M(n)})},this.sub=function(n){u.push(n);var l=n.componentWillUnmount;n.componentWillUnmount=function(){u&&u.splice(u.indexOf(n),1),l&&l.call(n)}}),n.children}};return u.Provider.__=u.Consumer.contextType=u}n=p.slice,l={__e:function(n,l,u,t){for(var i,o,r;l=l.__;)if((i=l.__c)&&!i.__)try{if((o=i.constructor)&&null!=o.getDerivedStateFromError&&(i.setState(o.getDerivedStateFromError(n)),r=i.__d),null!=i.componentDidCatch&&(i.componentDidCatch(n,t||{}),r=i.__d),r)return i.__E=i}catch(l){n=l}throw n}},u=0,t=function(n){return null!=n&&null==n.constructor},b.prototype.setState=function(n,l){var u;u=null!=this.__s&&this.__s!==this.state?this.__s:this.__s=d({},this.state),\"function\"==typeof n&&(n=n(d({},u),this.props)),n&&d(u,n),null!=n&&this.__v&&(l&&this._sb.push(l),M(this))},b.prototype.forceUpdate=function(n){this.__v&&(this.__e=!0,n&&this.__h.push(n),M(this))},b.prototype.render=k,i=[],r=\"function\"==typeof Promise?Promise.prototype.then.bind(Promise.resolve()):setTimeout,f=function(n,l){return n.__v.__b-l.__v.__b},P.__r=0,e=0,c=F(!1),s=F(!0),a=0;export{b as Component,k as Fragment,E as cloneElement,G as createContext,_ as createElement,m as createRef,_ as h,D as hydrate,t as isValidElement,l as options,B as render,H as toChildArray};\n//# sourceMappingURL=preact.module.js.map\n","import{options as n}from\"preact\";var t,r,u,i,o=0,f=[],c=n,e=c.__b,a=c.__r,v=c.diffed,l=c.__c,m=c.unmount,s=c.__;function d(n,t){c.__h&&c.__h(r,n,o||t),o=0;var u=r.__H||(r.__H={__:[],__h:[]});return n>=u.__.length&&u.__.push({}),u.__[n]}function h(n){return o=1,p(D,n)}function p(n,u,i){var o=d(t++,2);if(o.t=n,!o.__c&&(o.__=[i?i(u):D(void 0,u),function(n){var t=o.__N?o.__N[0]:o.__[0],r=o.t(t,n);t!==r&&(o.__N=[r,o.__[1]],o.__c.setState({}))}],o.__c=r,!r.u)){var f=function(n,t,r){if(!o.__c.__H)return!0;var u=o.__c.__H.__.filter(function(n){return!!n.__c});if(u.every(function(n){return!n.__N}))return!c||c.call(this,n,t,r);var i=!1;return u.forEach(function(n){if(n.__N){var t=n.__[0];n.__=n.__N,n.__N=void 0,t!==n.__[0]&&(i=!0)}}),!(!i&&o.__c.props===n)&&(!c||c.call(this,n,t,r))};r.u=!0;var c=r.shouldComponentUpdate,e=r.componentWillUpdate;r.componentWillUpdate=function(n,t,r){if(this.__e){var u=c;c=void 0,f(n,t,r),c=u}e&&e.call(this,n,t,r)},r.shouldComponentUpdate=f}return o.__N||o.__}function y(n,u){var i=d(t++,3);!c.__s&&C(i.__H,u)&&(i.__=n,i.i=u,r.__H.__h.push(i))}function _(n,u){var i=d(t++,4);!c.__s&&C(i.__H,u)&&(i.__=n,i.i=u,r.__h.push(i))}function A(n){return o=5,T(function(){return{current:n}},[])}function F(n,t,r){o=6,_(function(){return\"function\"==typeof n?(n(t()),function(){return n(null)}):n?(n.current=t(),function(){return n.current=null}):void 0},null==r?r:r.concat(n))}function T(n,r){var u=d(t++,7);return C(u.__H,r)&&(u.__=n(),u.__H=r,u.__h=n),u.__}function q(n,t){return o=8,T(function(){return n},t)}function x(n){var u=r.context[n.__c],i=d(t++,9);return i.c=n,u?(null==i.__&&(i.__=!0,u.sub(r)),u.props.value):n.__}function P(n,t){c.useDebugValue&&c.useDebugValue(t?t(n):n)}function b(n){var u=d(t++,10),i=h();return u.__=n,r.componentDidCatch||(r.componentDidCatch=function(n,t){u.__&&u.__(n,t),i[1](n)}),[i[0],function(){i[1](void 0)}]}function g(){var n=d(t++,11);if(!n.__){for(var u=r.__v;null!==u&&!u.__m&&null!==u.__;)u=u.__;var i=u.__m||(u.__m=[0,0]);n.__=\"P\"+i[0]+\"-\"+i[1]++}return n.__}function j(){for(var n;n=f.shift();)if(n.__P&&n.__H)try{n.__H.__h.forEach(z),n.__H.__h.forEach(B),n.__H.__h=[]}catch(t){n.__H.__h=[],c.__e(t,n.__v)}}c.__b=function(n){r=null,e&&e(n)},c.__=function(n,t){n&&t.__k&&t.__k.__m&&(n.__m=t.__k.__m),s&&s(n,t)},c.__r=function(n){a&&a(n),t=0;var i=(r=n.__c).__H;i&&(u===r?(i.__h=[],r.__h=[],i.__.forEach(function(n){n.__N&&(n.__=n.__N),n.i=n.__N=void 0})):(i.__h.forEach(z),i.__h.forEach(B),i.__h=[],t=0)),u=r},c.diffed=function(n){v&&v(n);var t=n.__c;t&&t.__H&&(t.__H.__h.length&&(1!==f.push(t)&&i===c.requestAnimationFrame||((i=c.requestAnimationFrame)||w)(j)),t.__H.__.forEach(function(n){n.i&&(n.__H=n.i),n.i=void 0})),u=r=null},c.__c=function(n,t){t.some(function(n){try{n.__h.forEach(z),n.__h=n.__h.filter(function(n){return!n.__||B(n)})}catch(r){t.some(function(n){n.__h&&(n.__h=[])}),t=[],c.__e(r,n.__v)}}),l&&l(n,t)},c.unmount=function(n){m&&m(n);var t,r=n.__c;r&&r.__H&&(r.__H.__.forEach(function(n){try{z(n)}catch(n){t=n}}),r.__H=void 0,t&&c.__e(t,r.__v))};var k=\"function\"==typeof requestAnimationFrame;function w(n){var t,r=function(){clearTimeout(u),k&&cancelAnimationFrame(t),setTimeout(n)},u=setTimeout(r,100);k&&(t=requestAnimationFrame(r))}function z(n){var t=r,u=n.__c;\"function\"==typeof u&&(n.__c=void 0,u()),r=t}function B(n){var t=r;n.__c=n.__(),r=t}function C(n,t){return!n||n.length!==t.length||t.some(function(t,r){return t!==n[r]})}function D(n,t){return\"function\"==typeof t?t(n):t}export{q as useCallback,x as useContext,P as useDebugValue,y as useEffect,b as useErrorBoundary,g as useId,F as useImperativeHandle,_ as useLayoutEffect,T as useMemo,p as useReducer,A as useRef,h as useState};\n//# sourceMappingURL=hooks.module.js.map\n","import{Component as n,createElement as t,options as e,toChildArray as r,Fragment as u,render as o,hydrate as i,createContext as c,createRef as l,cloneElement as f}from\"preact\";export{Component,Fragment,createContext,createElement,createRef}from\"preact\";import{useCallback as a,useContext as s,useDebugValue as h,useEffect as v,useId as d,useImperativeHandle as p,useLayoutEffect as m,useMemo as y,useReducer as _,useRef as b,useState as S}from\"preact/hooks\";export*from\"preact/hooks\";function g(n,t){for(var e in t)n[e]=t[e];return n}function E(n,t){for(var e in n)if(\"__source\"!==e&&!(e in t))return!0;for(var r in t)if(\"__source\"!==r&&n[r]!==t[r])return!0;return!1}function C(n,t){this.props=n,this.context=t}function x(n,e){function r(n){var t=this.props.ref,r=t==n.ref;return!r&&t&&(t.call?t(null):t.current=null),e?!e(this.props,n)||!r:E(this.props,n)}function u(e){return this.shouldComponentUpdate=r,t(n,e)}return u.displayName=\"Memo(\"+(n.displayName||n.name)+\")\",u.prototype.isReactComponent=!0,u.__f=!0,u}(C.prototype=new n).isPureReactComponent=!0,C.prototype.shouldComponentUpdate=function(n,t){return E(this.props,n)||E(this.state,t)};var R=e.__b;e.__b=function(n){n.type&&n.type.__f&&n.ref&&(n.props.ref=n.ref,n.ref=null),R&&R(n)};var w=\"undefined\"!=typeof Symbol&&Symbol.for&&Symbol.for(\"react.forward_ref\")||3911;function k(n){function t(t){var e=g({},t);return delete e.ref,n(e,t.ref||null)}return t.$$typeof=w,t.render=t,t.prototype.isReactComponent=t.__f=!0,t.displayName=\"ForwardRef(\"+(n.displayName||n.name)+\")\",t}var I=function(n,t){return null==n?null:r(r(n).map(t))},N={map:I,forEach:I,count:function(n){return n?r(n).length:0},only:function(n){var t=r(n);if(1!==t.length)throw\"Children.only\";return t[0]},toArray:r},M=e.__e;e.__e=function(n,t,e,r){if(n.then)for(var u,o=t;o=o.__;)if((u=o.__c)&&u.__c)return null==t.__e&&(t.__e=e.__e,t.__k=e.__k),u.__c(n,t);M(n,t,e,r)};var T=e.unmount;function A(n,t,e){return n&&(n.__c&&n.__c.__H&&(n.__c.__H.__.forEach(function(n){\"function\"==typeof n.__c&&n.__c()}),n.__c.__H=null),null!=(n=g({},n)).__c&&(n.__c.__P===e&&(n.__c.__P=t),n.__c=null),n.__k=n.__k&&n.__k.map(function(n){return A(n,t,e)})),n}function D(n,t,e){return n&&e&&(n.__v=null,n.__k=n.__k&&n.__k.map(function(n){return D(n,t,e)}),n.__c&&n.__c.__P===t&&(n.__e&&e.appendChild(n.__e),n.__c.__e=!0,n.__c.__P=e)),n}function L(){this.__u=0,this.t=null,this.__b=null}function O(n){var t=n.__.__c;return t&&t.__a&&t.__a(n)}function F(n){var e,r,u;function o(o){if(e||(e=n()).then(function(n){r=n.default||n},function(n){u=n}),u)throw u;if(!r)throw e;return t(r,o)}return o.displayName=\"Lazy\",o.__f=!0,o}function U(){this.u=null,this.o=null}e.unmount=function(n){var t=n.__c;t&&t.__R&&t.__R(),t&&32&n.__u&&(n.type=null),T&&T(n)},(L.prototype=new n).__c=function(n,t){var e=t.__c,r=this;null==r.t&&(r.t=[]),r.t.push(e);var u=O(r.__v),o=!1,i=function(){o||(o=!0,e.__R=null,u?u(c):c())};e.__R=i;var c=function(){if(!--r.__u){if(r.state.__a){var n=r.state.__a;r.__v.__k[0]=D(n,n.__c.__P,n.__c.__O)}var t;for(r.setState({__a:r.__b=null});t=r.t.pop();)t.forceUpdate()}};r.__u++||32&t.__u||r.setState({__a:r.__b=r.__v.__k[0]}),n.then(i,i)},L.prototype.componentWillUnmount=function(){this.t=[]},L.prototype.render=function(n,e){if(this.__b){if(this.__v.__k){var r=document.createElement(\"div\"),o=this.__v.__k[0].__c;this.__v.__k[0]=A(this.__b,r,o.__O=o.__P)}this.__b=null}var i=e.__a&&t(u,null,n.fallback);return i&&(i.__u&=-33),[t(u,null,e.__a?null:n.children),i]};var V=function(n,t,e){if(++e[1]===e[0]&&n.o.delete(t),n.props.revealOrder&&(\"t\"!==n.props.revealOrder[0]||!n.o.size))for(e=n.u;e;){for(;e.length>3;)e.pop()();if(e[1]<e[0])break;n.u=e=e[2]}};function W(n){return this.getChildContext=function(){return n.context},n.children}function P(n){var e=this,r=n.i;e.componentWillUnmount=function(){o(null,e.l),e.l=null,e.i=null},e.i&&e.i!==r&&e.componentWillUnmount(),e.l||(e.i=r,e.l={nodeType:1,parentNode:r,childNodes:[],contains:function(){return!0},appendChild:function(n){this.childNodes.push(n),e.i.appendChild(n)},insertBefore:function(n,t){this.childNodes.push(n),e.i.appendChild(n)},removeChild:function(n){this.childNodes.splice(this.childNodes.indexOf(n)>>>1,1),e.i.removeChild(n)}}),o(t(W,{context:e.context},n.__v),e.l)}function j(n,e){var r=t(P,{__v:n,i:e});return r.containerInfo=e,r}(U.prototype=new n).__a=function(n){var t=this,e=O(t.__v),r=t.o.get(n);return r[0]++,function(u){var o=function(){t.props.revealOrder?(r.push(u),V(t,n,r)):u()};e?e(o):o()}},U.prototype.render=function(n){this.u=null,this.o=new Map;var t=r(n.children);n.revealOrder&&\"b\"===n.revealOrder[0]&&t.reverse();for(var e=t.length;e--;)this.o.set(t[e],this.u=[1,0,this.u]);return n.children},U.prototype.componentDidUpdate=U.prototype.componentDidMount=function(){var n=this;this.o.forEach(function(t,e){V(n,e,t)})};var z=\"undefined\"!=typeof Symbol&&Symbol.for&&Symbol.for(\"react.element\")||60103,B=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|dominant|fill|flood|font|glyph(?!R)|horiz|image(!S)|letter|lighting|marker(?!H|W|U)|overline|paint|pointer|shape|stop|strikethrough|stroke|text(?!L)|transform|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/,H=/^on(Ani|Tra|Tou|BeforeInp|Compo)/,Z=/[A-Z0-9]/g,Y=\"undefined\"!=typeof document,$=function(n){return(\"undefined\"!=typeof Symbol&&\"symbol\"==typeof Symbol()?/fil|che|rad/:/fil|che|ra/).test(n)};function q(n,t,e){return null==t.__k&&(t.textContent=\"\"),o(n,t),\"function\"==typeof e&&e(),n?n.__c:null}function G(n,t,e){return i(n,t),\"function\"==typeof e&&e(),n?n.__c:null}n.prototype.isReactComponent={},[\"componentWillMount\",\"componentWillReceiveProps\",\"componentWillUpdate\"].forEach(function(t){Object.defineProperty(n.prototype,t,{configurable:!0,get:function(){return this[\"UNSAFE_\"+t]},set:function(n){Object.defineProperty(this,t,{configurable:!0,writable:!0,value:n})}})});var J=e.event;function K(){}function Q(){return this.cancelBubble}function X(){return this.defaultPrevented}e.event=function(n){return J&&(n=J(n)),n.persist=K,n.isPropagationStopped=Q,n.isDefaultPrevented=X,n.nativeEvent=n};var nn,tn={enumerable:!1,configurable:!0,get:function(){return this.class}},en=e.vnode;e.vnode=function(n){\"string\"==typeof n.type&&function(n){var t=n.props,e=n.type,u={};for(var o in t){var i=t[o];if(!(\"value\"===o&&\"defaultValue\"in t&&null==i||Y&&\"children\"===o&&\"noscript\"===e||\"class\"===o||\"className\"===o)){var c=o.toLowerCase();\"defaultValue\"===o&&\"value\"in t&&null==t.value?o=\"value\":\"download\"===o&&!0===i?i=\"\":\"translate\"===c&&\"no\"===i?i=!1:\"ondoubleclick\"===c?o=\"ondblclick\":\"onchange\"!==c||\"input\"!==e&&\"textarea\"!==e||$(t.type)?\"onfocus\"===c?o=\"onfocusin\":\"onblur\"===c?o=\"onfocusout\":H.test(o)?o=c:-1===e.indexOf(\"-\")&&B.test(o)?o=o.replace(Z,\"-$&\").toLowerCase():null===i&&(i=void 0):c=o=\"oninput\",\"oninput\"===c&&u[o=c]&&(o=\"oninputCapture\"),u[o]=i}}\"select\"==e&&u.multiple&&Array.isArray(u.value)&&(u.value=r(t.children).forEach(function(n){n.props.selected=-1!=u.value.indexOf(n.props.value)})),\"select\"==e&&null!=u.defaultValue&&(u.value=r(t.children).forEach(function(n){n.props.selected=u.multiple?-1!=u.defaultValue.indexOf(n.props.value):u.defaultValue==n.props.value})),t.class&&!t.className?(u.class=t.class,Object.defineProperty(u,\"className\",tn)):(t.className&&!t.class||t.class&&t.className)&&(u.class=u.className=t.className),n.props=u}(n),n.$$typeof=z,en&&en(n)};var rn=e.__r;e.__r=function(n){rn&&rn(n),nn=n.__c};var un=e.diffed;e.diffed=function(n){un&&un(n);var t=n.props,e=n.__e;null!=e&&\"textarea\"===n.type&&\"value\"in t&&t.value!==e.value&&(e.value=null==t.value?\"\":t.value),nn=null};var on={ReactCurrentDispatcher:{current:{readContext:function(n){return nn.__n[n.__c].props.value},useCallback:a,useContext:s,useDebugValue:h,useDeferredValue:bn,useEffect:v,useId:d,useImperativeHandle:p,useInsertionEffect:gn,useLayoutEffect:m,useMemo:y,useReducer:_,useRef:b,useState:S,useSyncExternalStore:Cn,useTransition:Sn}}},cn=\"17.0.2\";function ln(n){return t.bind(null,n)}function fn(n){return!!n&&n.$$typeof===z}function an(n){return fn(n)&&n.type===u}function sn(n){return!!n&&!!n.displayName&&(\"string\"==typeof n.displayName||n.displayName instanceof String)&&n.displayName.startsWith(\"Memo(\")}function hn(n){return fn(n)?f.apply(null,arguments):n}function vn(n){return!!n.__k&&(o(null,n),!0)}function dn(n){return n&&(n.base||1===n.nodeType&&n)||null}var pn=function(n,t){return n(t)},mn=function(n,t){return n(t)},yn=u;function _n(n){n()}function bn(n){return n}function Sn(){return[!1,_n]}var gn=m,En=fn;function Cn(n,t){var e=t(),r=S({h:{__:e,v:t}}),u=r[0].h,o=r[1];return m(function(){u.__=e,u.v=t,xn(u)&&o({h:u})},[n,e,t]),v(function(){return xn(u)&&o({h:u}),n(function(){xn(u)&&o({h:u})})},[n]),e}function xn(n){var t,e,r=n.v,u=n.__;try{var o=r();return!((t=u)===(e=o)&&(0!==t||1/t==1/e)||t!=t&&e!=e)}catch(n){return!0}}var Rn={useState:S,useId:d,useReducer:_,useEffect:v,useLayoutEffect:m,useInsertionEffect:gn,useTransition:Sn,useDeferredValue:bn,useSyncExternalStore:Cn,startTransition:_n,useRef:b,useImperativeHandle:p,useMemo:y,useCallback:a,useContext:s,useDebugValue:h,version:\"17.0.2\",Children:N,render:q,hydrate:G,unmountComponentAtNode:vn,createPortal:j,createElement:t,createContext:c,createFactory:ln,cloneElement:hn,createRef:l,Fragment:u,isValidElement:fn,isElement:En,isFragment:an,isMemo:sn,findDOMNode:dn,Component:n,PureComponent:C,memo:x,forwardRef:k,flushSync:mn,unstable_batchedUpdates:pn,StrictMode:yn,Suspense:L,SuspenseList:U,lazy:F,__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED:on};export{N as Children,C as PureComponent,yn as StrictMode,L as Suspense,U as SuspenseList,on as __SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,hn as cloneElement,ln as createFactory,j as createPortal,Rn as default,dn as findDOMNode,mn as flushSync,k as forwardRef,G as hydrate,En as isElement,an as isFragment,sn as isMemo,fn as isValidElement,F as lazy,x as memo,q as render,_n as startTransition,vn as unmountComponentAtNode,pn as unstable_batchedUpdates,bn as useDeferredValue,gn as useInsertionEffect,Cn as useSyncExternalStore,Sn as useTransition,cn as version};\n//# sourceMappingURL=compat.module.js.map\n","import { render, hydrate, unmountComponentAtNode } from 'preact/compat';\n\nexport function createRoot(container) {\n\treturn {\n\t\t// eslint-disable-next-line\n\t\trender: function (children) {\n\t\t\trender(children, container);\n\t\t},\n\t\t// eslint-disable-next-line\n\t\tunmount: function () {\n\t\t\tunmountComponentAtNode(container);\n\t\t}\n\t};\n}\n\nexport function hydrateRoot(container, children) {\n\thydrate(children, container);\n\treturn createRoot(container);\n}\n\nexport default {\n\tcreateRoot,\n\thydrateRoot\n};\n","import { getQueryParam, hasQueryParam } from './utils'\nimport { settings } from '../store/constants'\n\nexport const parseSegments = (dataSegments, seg) => {\n  if (!dataSegments) return\n\n  const queryParams = new URLSearchParams(window.location.search)\n  seg = seg || queryParams.get('seg')?.split(',')\n\n  const segments = []\n\n  for (let i = 0; i < dataSegments.length; i++) {\n    const g = dataSegments[i]\n    const hasParent = !!g.parentIds?.length\n    const hasActiveParent = g.parentIds?.some(p => segments.includes(p))\n    const q = g.items.find(s => seg?.includes(s?.id))?.id\n    const c = g.items.find(l => l.isSelected)?.id || g.items[0]?.id\n    if (!(hasParent && !hasActiveParent)) {\n      segments.push(q || c)\n    }\n  }\n\n  return segments\n}\n\nexport const parseLayers = (dataLayers, dataSegments, seg) => {\n  if (!dataLayers) return\n\n  const queryParams = new URLSearchParams(window.location.search)\n  seg = seg || parseSegments(dataSegments)\n  const lyr = queryParams.get('lyr')?.split(',') || []\n\n  let layers = []\n\n  for (let i = 0; i < dataLayers.length; i++) {\n    const g = dataLayers[i]\n    const c = g.items.filter(l => l.id && l.isSelected).map(l => l.id)\n    const q = g.items.filter(l => lyr.includes(l.id)).map(l => l.id)\n    layers = layers.concat(queryParams.has('lyr') ? q : c)\n  }\n\n  return [...new Set(layers)]\n}\n\nexport const parseGroups = (data, segments, layers, zoom, hasInputs, queryLabel) => {\n  // Filter groups\n  let groups = data.filter(g =>\n  // Only groups that are within zoom\n    (g.minZoom ? g.minZoom <= zoom : g && g.maxZoom ? g.maxZoom > zoom : g) &&\n        // Only groups that have an active parent\n        (g.parentIds ? g.parentIds.some(i => segments.includes(i)) : g)\n  )\n\n  // Flatten groups and items and remove non-checked items for use in key\n  if (!hasInputs) {\n    const ramps = []\n    let flatItems = []\n    groups.forEach(g => {\n      const checkedRadioId = g.items.find(item => layers.includes(item.id))?.id\n      g.items.forEach(item => {\n        const isChecked = g?.type === 'radio' ? item.id === checkedRadioId : layers.includes(item.id)\n        const isVisible = isChecked || !item.id\n        if (!(isVisible && (item.fill || item.icon || item.items?.length))) return\n        if (item.display === 'ramp') {\n          ramps.push(item)\n        } else if (item.items) {\n          flatItems = flatItems.concat(item.items)\n        } else {\n          flatItems.push(item)\n        }\n      })\n    })\n\n    // Add query polygon\n    if (queryLabel) {\n      flatItems.push({\n        display: 'query-polygon',\n        label: queryLabel\n      })\n    }\n\n    groups = ramps.concat([{ items: flatItems }]).filter(g => g.items.length)\n  }\n\n  return groups\n}\n\nexport const parseQuery = (info) => {\n  // Move to utils\n  const featureIdParam = settings.params.featureId\n  const featureId = hasQueryParam(featureIdParam) ? getQueryParam(featureIdParam) : info?.featureId\n\n  const targetMarkerParam = settings.params.targetMarker\n  let targetMarkerQuery = getQueryParam(targetMarkerParam)?.split(',')\n  targetMarkerQuery = targetMarkerQuery?.length === 3\n    ? {\n        coord: [parseFloat(targetMarkerQuery[0]), parseFloat(targetMarkerQuery[1])],\n        hasData: targetMarkerQuery[2] === 'true'\n      }\n    : null\n\n  const targetMarker = targetMarkerQuery || (!info?.featureId && info?.markerCoord\n    ? {\n        coord: info?.markerCoord,\n        hasData: info?.hasData\n      }\n    : null)\n\n  return {\n    featureId,\n    targetMarker\n  }\n}\n","import { parseSegments, parseLayers, parseQuery } from '../lib/query'\n\nexport const initialState = (options) => {\n  const { legend, search, info, queryPolygon } = options\n\n  const { featureId, targetMarker } = parseQuery(info)\n\n  let activePanel\n  if (info && (featureId || targetMarker)) {\n    activePanel = 'INFO'\n  } else if (legend?.isVisible) {\n    activePanel = ['compact', 'inset'].includes(legend?.display) ? 'LEGEND' : 'KEY'\n  }\n\n  return {\n    isContainerReady: false,\n    search,\n    legend,\n    info,\n    queryPolygon,\n    segments: legend ? parseSegments(legend.segments) : null,\n    layers: legend?.key ? parseLayers(legend.key, legend.segments) : null,\n    featureId,\n    targetMarker: !featureId ? targetMarker : null,\n    pointerQuery: null,\n    activePanel,\n    activePanelHasFocus: false,\n    hasViewportLabel: false,\n    mode: 'default',\n    isFrameVisible: false,\n    query: null,\n    hash: null\n  }\n}\n\nexport const reducer = (state, action) => {\n  switch (action.type) {\n    case 'CONTAINER_READY':\n      return {\n        ...state,\n        isContainerReady: true\n      }\n    case 'SET_SEARCH':\n      return {\n        ...state,\n        search: action.data\n      }\n    case 'SET_INFO':\n      return {\n        ...state,\n        info: action.data,\n        activePanel: action.data ? 'INFO' : state.activePanel !== 'INFO' ? state.activePanel : null,\n        hasViewportLabel: false\n      }\n    case 'SET_DRAW':\n      return {\n        ...state,\n        queryPolygon: action.data,\n        targetMarker: null\n      }\n    case 'SET_SELECTED':\n      return {\n        ...state,\n        featureId: action.featureId,\n        targetMarker: action.targetMarker,\n        activePanel: Object.hasOwn(action, 'activePanel') ? action.activePanel : state.activePanel,\n        activePanelHasFocus: action.activePanelHasFocus || state.activePanelHasFocus,\n        hash: Date.now()\n      }\n    case 'ERROR':\n      return {\n        ...state,\n        error: {\n          label: action.label,\n          message: action.message\n        },\n        activePanel: 'ERROR',\n        hasViewportLabel: false\n      }\n    case 'OPEN':\n      return {\n        ...state,\n        activePanel: action.data,\n        activePanelHasFocus: true,\n        hasViewportLabel: false,\n        featureId: action.data === 'INFO' ? state.featureId : ''\n      }\n    case 'CLOSE':\n      return {\n        ...state,\n        featureId: null,\n        targetMarker: null,\n        activePanel: null\n      }\n    case 'SET_IS_MOBILE':\n      return {\n        ...state,\n        isMobile: action.value\n      }\n    case 'SET_IS_DESKTOP':\n      return {\n        ...state,\n        isDesktop: action.value,\n        isFixed: state.legend?.position?.includes('fixed') && action.value\n      }\n    case 'SET_IS_KEYBOARD':\n      return {\n        ...state,\n        isKeyboard: action.value\n      }\n    case 'SET_MODE':\n      return {\n        ...state,\n        mode: action.value,\n        query: Object.hasOwn(action, 'query') ? action.query : state.query,\n        isFrameVisible: Object.hasOwn(action, 'isFrameVisible') ? action.isFrameVisible : state.isFrameVisible,\n        activePanel: state.mode !== 'draw' && action.value === 'frame' ? 'HELP' : null,\n        featureId: null,\n        targetMarker: null\n      }\n    case 'TOGGLE_SEGMENTS':\n      return {\n        ...state,\n        segments: action.segments,\n        layers: action.layers,\n        featureId: null,\n        targetMarker: null\n      }\n    case 'TOGGLE_LAYERS':\n      return {\n        ...state,\n        layers: action.layers\n      }\n    case 'TOGGLE_VIEWPORT_LABEL': {\n      const hasViewportLabel = action.data && (!state.isMobile || !state.activePanel || state.activePanel === 'LEGEND')\n      return {\n        ...state,\n        hasViewportLabel\n      }\n    }\n    default:\n      return state\n  }\n}\n","import React, { createContext, useReducer, useMemo } from 'react'\nimport { initialState, reducer } from './app-reducer.js'\n\nexport const AppContext = createContext()\n\nexport const AppProvider = ({ options, app, children }) => {\n  const [state, dispatch] = useReducer(reducer, initialState(options))\n\n  const store = useMemo(() => ({\n    ...app,\n    ...state,\n    options,\n    dispatch\n  }))\n\n  return (\n    <AppContext.Provider value={store}>\n      {children}\n    </AppContext.Provider>\n  )\n}\n","/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  */\n/* Geodesy representation conversion functions                        (c) Chris Veness 2002-2020  */\n/*                                                                                   MIT Licence  */\n/* www.movable-type.co.uk/scripts/latlong.html                                                    */\n/* www.movable-type.co.uk/scripts/js/geodesy/geodesy-library.html#dms                             */\n/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  */\n\n/* eslint no-irregular-whitespace: [2, { skipComments: true }] */\n\n\n/**\n * Latitude/longitude points may be represented as decimal degrees, or subdivided into sexagesimal\n * minutes and seconds. This module provides methods for parsing and representing degrees / minutes\n * / seconds.\n *\n * @module dms\n */\n\n\n/* Degree-minutes-seconds (& cardinal directions) separator character */\nlet dmsSeparator = '\\u202f'; // U+202F = 'narrow no-break space'\n\n\n/**\n * Functions for parsing and representing degrees / minutes / seconds.\n */\nclass Dms {\n\n    // note Unicode Degree = U+00B0. Prime = U+2032, Double prime = U+2033\n\n    /**\n     * Separator character to be used to separate degrees, minutes, seconds, and cardinal directions.\n     *\n     * Default separator is U+202F ‘narrow no-break space’.\n     *\n     * To change this (e.g. to empty string or full space), set Dms.separator prior to invoking\n     * formatting.\n     *\n     * @example\n     *   import LatLon, { Dms } from '/js/geodesy/latlon-spherical.js';\n     *   const p = new LatLon(51.2, 0.33).toString('dms');  // 51° 12′ 00″ N, 000° 19′ 48″ E\n     *   Dms.separator = '';                                // no separator\n     *   const pʹ = new LatLon(51.2, 0.33).toString('dms'); // 51°12′00″N, 000°19′48″E\n     */\n    static get separator()     { return dmsSeparator; }\n    static set separator(char) { dmsSeparator = char; }\n\n\n    /**\n     * Parses string representing degrees/minutes/seconds into numeric degrees.\n     *\n     * This is very flexible on formats, allowing signed decimal degrees, or deg-min-sec optionally\n     * suffixed by compass direction (NSEW); a variety of separators are accepted. Examples -3.62,\n     * '3 37 12W', '3°37′12″W'.\n     *\n     * Thousands/decimal separators must be comma/dot; use Dms.fromLocale to convert locale-specific\n     * thousands/decimal separators.\n     *\n     * @param   {string|number} dms - Degrees or deg/min/sec in variety of formats.\n     * @returns {number}        Degrees as decimal number.\n     *\n     * @example\n     *   const lat = Dms.parse('51° 28′ 40.37″ N');\n     *   const lon = Dms.parse('000° 00′ 05.29″ W');\n     *   const p1 = new LatLon(lat, lon); // 51.4779°N, 000.0015°W\n     */\n    static parse(dms) {\n        // check for signed decimal degrees without NSEW, if so return it directly\n        if (!isNaN(parseFloat(dms)) && isFinite(dms)) return Number(dms);\n\n        // strip off any sign or compass dir'n & split out separate d/m/s\n        const dmsParts = String(dms).trim().replace(/^-/, '').replace(/[NSEW]$/i, '').split(/[^0-9.,]+/);\n        if (dmsParts[dmsParts.length-1]=='') dmsParts.splice(dmsParts.length-1);  // from trailing symbol\n\n        if (dmsParts == '') return NaN;\n\n        // and convert to decimal degrees...\n        let deg = null;\n        switch (dmsParts.length) {\n            case 3:  // interpret 3-part result as d/m/s\n                deg = dmsParts[0]/1 + dmsParts[1]/60 + dmsParts[2]/3600;\n                break;\n            case 2:  // interpret 2-part result as d/m\n                deg = dmsParts[0]/1 + dmsParts[1]/60;\n                break;\n            case 1:  // just d (possibly decimal) or non-separated dddmmss\n                deg = dmsParts[0];\n                // check for fixed-width unseparated format eg 0033709W\n                //if (/[NS]/i.test(dmsParts)) deg = '0' + deg;  // - normalise N/S to 3-digit degrees\n                //if (/[0-9]{7}/.test(deg)) deg = deg.slice(0,3)/1 + deg.slice(3,5)/60 + deg.slice(5)/3600;\n                break;\n            default:\n                return NaN;\n        }\n        if (/^-|[WS]$/i.test(dms.trim())) deg = -deg; // take '-', west and south as -ve\n\n        return Number(deg);\n    }\n\n\n    /**\n     * Converts decimal degrees to deg/min/sec format\n     *  - degree, prime, double-prime symbols are added, but sign is discarded, though no compass\n     *    direction is added.\n     *  - degrees are zero-padded to 3 digits; for degrees latitude, use .slice(1) to remove leading\n     *    zero.\n     *\n     * @private\n     * @param   {number} deg - Degrees to be formatted as specified.\n     * @param   {string} [format=d] - Return value as 'd', 'dm', 'dms' for deg, deg+min, deg+min+sec.\n     * @param   {number} [dp=4|2|0] - Number of decimal places to use – default 4 for d, 2 for dm, 0 for dms.\n     * @returns {string} Degrees formatted as deg/min/secs according to specified format.\n     */\n    static toDms(deg, format='d', dp=undefined) {\n        if (isNaN(deg)) return null;  // give up here if we can't make a number from deg\n        if (typeof deg == 'string' && deg.trim() == '') return null;\n        if (typeof deg == 'boolean') return null;\n        if (deg == Infinity) return null;\n        if (deg == null) return null;\n\n        // default values\n        if (dp === undefined) {\n            switch (format) {\n                case 'd':   case 'deg':         dp = 4; break;\n                case 'dm':  case 'deg+min':     dp = 2; break;\n                case 'dms': case 'deg+min+sec': dp = 0; break;\n                default:          format = 'd'; dp = 4; break; // be forgiving on invalid format\n            }\n        }\n\n        deg = Math.abs(deg);  // (unsigned result ready for appending compass dir'n)\n\n        let dms = null, d = null, m = null, s = null;\n        switch (format) {\n            default: // invalid format spec!\n            case 'd': case 'deg':\n                d = deg.toFixed(dp);                       // round/right-pad degrees\n                if (d<100) d = '0' + d;                    // left-pad with leading zeros (note may include decimals)\n                if (d<10) d = '0' + d;\n                dms = d + '°';\n                break;\n            case 'dm': case 'deg+min':\n                d = Math.floor(deg);                       // get component deg\n                m = ((deg*60) % 60).toFixed(dp);           // get component min & round/right-pad\n                if (m == 60) { m = (0).toFixed(dp); d++; } // check for rounding up\n                d = ('000'+d).slice(-3);                   // left-pad with leading zeros\n                if (m<10) m = '0' + m;                     // left-pad with leading zeros (note may include decimals)\n                dms = d + '°'+Dms.separator + m + '′';\n                break;\n            case 'dms': case 'deg+min+sec':\n                d = Math.floor(deg);                       // get component deg\n                m = Math.floor((deg*3600)/60) % 60;        // get component min\n                s = (deg*3600 % 60).toFixed(dp);           // get component sec & round/right-pad\n                if (s == 60) { s = (0).toFixed(dp); m++; } // check for rounding up\n                if (m == 60) { m = 0; d++; }               // check for rounding up\n                d = ('000'+d).slice(-3);                   // left-pad with leading zeros\n                m = ('00'+m).slice(-2);                    // left-pad with leading zeros\n                if (s<10) s = '0' + s;                     // left-pad with leading zeros (note may include decimals)\n                dms = d + '°'+Dms.separator + m + '′'+Dms.separator + s + '″';\n                break;\n        }\n\n        return dms;\n    }\n\n\n    /**\n     * Converts numeric degrees to deg/min/sec latitude (2-digit degrees, suffixed with N/S).\n     *\n     * @param   {number} deg - Degrees to be formatted as specified.\n     * @param   {string} [format=d] - Return value as 'd', 'dm', 'dms' for deg, deg+min, deg+min+sec.\n     * @param   {number} [dp=4|2|0] - Number of decimal places to use – default 4 for d, 2 for dm, 0 for dms.\n     * @returns {string} Degrees formatted as deg/min/secs according to specified format.\n     *\n     * @example\n     *   const lat = Dms.toLat(-3.62, 'dms'); // 3°37′12″S\n     */\n    static toLat(deg, format, dp) {\n        const lat = Dms.toDms(Dms.wrap90(deg), format, dp);\n        return lat===null ? '–' : lat.slice(1) + Dms.separator + (deg<0 ? 'S' : 'N');  // knock off initial '0' for lat!\n    }\n\n\n    /**\n     * Convert numeric degrees to deg/min/sec longitude (3-digit degrees, suffixed with E/W).\n     *\n     * @param   {number} deg - Degrees to be formatted as specified.\n     * @param   {string} [format=d] - Return value as 'd', 'dm', 'dms' for deg, deg+min, deg+min+sec.\n     * @param   {number} [dp=4|2|0] - Number of decimal places to use – default 4 for d, 2 for dm, 0 for dms.\n     * @returns {string} Degrees formatted as deg/min/secs according to specified format.\n     *\n     * @example\n     *   const lon = Dms.toLon(-3.62, 'dms'); // 3°37′12″W\n     */\n    static toLon(deg, format, dp) {\n        const lon = Dms.toDms(Dms.wrap180(deg), format, dp);\n        return lon===null ? '–' : lon + Dms.separator + (deg<0 ? 'W' : 'E');\n    }\n\n\n    /**\n     * Converts numeric degrees to deg/min/sec as a bearing (0°..360°).\n     *\n     * @param   {number} deg - Degrees to be formatted as specified.\n     * @param   {string} [format=d] - Return value as 'd', 'dm', 'dms' for deg, deg+min, deg+min+sec.\n     * @param   {number} [dp=4|2|0] - Number of decimal places to use – default 4 for d, 2 for dm, 0 for dms.\n     * @returns {string} Degrees formatted as deg/min/secs according to specified format.\n     *\n     * @example\n     *   const lon = Dms.toBrng(-3.62, 'dms'); // 356°22′48″\n     */\n    static toBrng(deg, format, dp) {\n        const brng =  Dms.toDms(Dms.wrap360(deg), format, dp);\n        return brng===null ? '–' : brng.replace('360', '0');  // just in case rounding took us up to 360°!\n    }\n\n\n    /**\n     * Converts DMS string from locale thousands/decimal separators to JavaScript comma/dot separators\n     * for subsequent parsing.\n     *\n     * Both thousands and decimal separators must be followed by a numeric character, to facilitate\n     * parsing of single lat/long string (in which whitespace must be left after the comma separator).\n     *\n     * @param   {string} str - Degrees/minutes/seconds formatted with locale separators.\n     * @returns {string} Degrees/minutes/seconds formatted with standard Javascript separators.\n     *\n     * @example\n     *   const lat = Dms.fromLocale('51°28′40,12″N');                          // '51°28′40.12″N' in France\n     *   const p = new LatLon(Dms.fromLocale('51°28′40,37″N, 000°00′05,29″W'); // '51.4779°N, 000.0015°W' in France\n     */\n    static fromLocale(str) {\n        const locale = (123456.789).toLocaleString();\n        const separator = { thousands: locale.slice(3, 4), decimal: locale.slice(7, 8) };\n        return str.replace(separator.thousands, '⁜').replace(separator.decimal, '.').replace('⁜', ',');\n    }\n\n\n    /**\n     * Converts DMS string from JavaScript comma/dot thousands/decimal separators to locale separators.\n     *\n     * Can also be used to format standard numbers such as distances.\n     *\n     * @param   {string} str - Degrees/minutes/seconds formatted with standard Javascript separators.\n     * @returns {string} Degrees/minutes/seconds formatted with locale separators.\n     *\n     * @example\n     *   const Dms.toLocale('123,456.789');                   // '123.456,789' in France\n     *   const Dms.toLocale('51°28′40.12″N, 000°00′05.31″W'); // '51°28′40,12″N, 000°00′05,31″W' in France\n     */\n    static toLocale(str) {\n        const locale = (123456.789).toLocaleString();\n        const separator = { thousands: locale.slice(3, 4), decimal: locale.slice(7, 8) };\n        return str.replace(/,([0-9])/, '⁜$1').replace('.', separator.decimal).replace('⁜', separator.thousands);\n    }\n\n\n    /**\n     * Returns compass point (to given precision) for supplied bearing.\n     *\n     * @param   {number} bearing - Bearing in degrees from north.\n     * @param   {number} [precision=3] - Precision (1:cardinal / 2:intercardinal / 3:secondary-intercardinal).\n     * @returns {string} Compass point for supplied bearing.\n     *\n     * @example\n     *   const point = Dms.compassPoint(24);    // point = 'NNE'\n     *   const point = Dms.compassPoint(24, 1); // point = 'N'\n     */\n    static compassPoint(bearing, precision=3) {\n        if (![ 1, 2, 3 ].includes(Number(precision))) throw new RangeError(`invalid precision ‘${precision}’`);\n        // note precision could be extended to 4 for quarter-winds (eg NbNW), but I think they are little used\n\n        bearing = Dms.wrap360(bearing); // normalise to range 0..360°\n\n        const cardinals = [\n            'N', 'NNE', 'NE', 'ENE',\n            'E', 'ESE', 'SE', 'SSE',\n            'S', 'SSW', 'SW', 'WSW',\n            'W', 'WNW', 'NW', 'NNW' ];\n        const n = 4 * 2**(precision-1); // no of compass points at req’d precision (1=>4, 2=>8, 3=>16)\n        const cardinal = cardinals[Math.round(bearing*n/360)%n * 16/n];\n\n        return cardinal;\n    }\n\n\n    /**\n     * Constrain degrees to range -90..+90 (for latitude); e.g. -91 => -89, 91 => 89.\n     *\n     * @private\n     * @param {number} degrees\n     * @returns degrees within range -90..+90.\n     */\n    static wrap90(degrees) {\n        if (-90<=degrees && degrees<=90) return degrees; // avoid rounding due to arithmetic ops if within range\n\n        // latitude wrapping requires a triangle wave function; a general triangle wave is\n        //     f(x) = 4a/p ⋅ | (x-p/4)%p - p/2 | - a\n        // where a = amplitude, p = period, % = modulo; however, JavaScript '%' is a remainder operator\n        // not a modulo operator - for modulo, replace 'x%n' with '((x%n)+n)%n'\n        const x = degrees, a = 90, p = 360;\n        return 4*a/p * Math.abs((((x-p/4)%p)+p)%p - p/2) - a;\n    }\n\n    /**\n     * Constrain degrees to range -180..+180 (for longitude); e.g. -181 => 179, 181 => -179.\n     *\n     * @private\n     * @param {number} degrees\n     * @returns degrees within range -180..+180.\n     */\n    static wrap180(degrees) {\n        if (-180<=degrees && degrees<=180) return degrees; // avoid rounding due to arithmetic ops if within range\n\n        // longitude wrapping requires a sawtooth wave function; a general sawtooth wave is\n        //     f(x) = (2ax/p - p/2) % p - a\n        // where a = amplitude, p = period, % = modulo; however, JavaScript '%' is a remainder operator\n        // not a modulo operator - for modulo, replace 'x%n' with '((x%n)+n)%n'\n        const x = degrees, a = 180, p = 360;\n        return (((2*a*x/p - p/2)%p)+p)%p - a;\n    }\n\n    /**\n     * Constrain degrees to range 0..360 (for bearings); e.g. -1 => 359, 361 => 1.\n     *\n     * @private\n     * @param {number} degrees\n     * @returns degrees within range 0..360.\n     */\n    static wrap360(degrees) {\n        if (0<=degrees && degrees<360) return degrees; // avoid rounding due to arithmetic ops if within range\n\n        // bearing wrapping requires a sawtooth wave function with a vertical offset equal to the\n        // amplitude and a corresponding phase shift; this changes the general sawtooth wave function from\n        //     f(x) = (2ax/p - p/2) % p - a\n        // to\n        //     f(x) = (2ax/p) % p\n        // where a = amplitude, p = period, % = modulo; however, JavaScript '%' is a remainder operator\n        // not a modulo operator - for modulo, replace 'x%n' with '((x%n)+n)%n'\n        const x = degrees, a = 180, p = 360;\n        return (((2*a*x/p)%p)+p)%p;\n    }\n\n}\n\n\n// Extend Number object with methods to convert between degrees & radians\nNumber.prototype.toRadians = function() { return this * Math.PI / 180; };\nNumber.prototype.toDegrees = function() { return this * 180 / Math.PI; };\n\n/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  */\n\nexport default Dms;\n","/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  */\n/* Latitude/longitude spherical geodesy tools                         (c) Chris Veness 2002-2021  */\n/*                                                                                   MIT Licence  */\n/* www.movable-type.co.uk/scripts/latlong.html                                                    */\n/* www.movable-type.co.uk/scripts/geodesy-library.html#latlon-spherical                           */\n/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  */\n\nimport Dms from './dms.js';\n\nconst π = Math.PI;\n\n\n/**\n * Library of geodesy functions for operations on a spherical earth model.\n *\n * Includes distances, bearings, destinations, etc, for both great circle paths and rhumb lines,\n * and other related functions.\n *\n * All calculations are done using simple spherical trigonometric formulae.\n *\n * @module latlon-spherical\n */\n\n// note greek letters (e.g. φ, λ, θ) are used for angles in radians to distinguish from angles in\n// degrees (e.g. lat, lon, brng)\n\n\n/* LatLonSpherical - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  */\n\n\n/**\n * Latitude/longitude points on a spherical model earth, and methods for calculating distances,\n * bearings, destinations, etc on (orthodromic) great-circle paths and (loxodromic) rhumb lines.\n */\nclass LatLonSpherical {\n\n    /**\n     * Creates a latitude/longitude point on the earth’s surface, using a spherical model earth.\n     *\n     * @param  {number} lat - Latitude (in degrees).\n     * @param  {number} lon - Longitude (in degrees).\n     * @throws {TypeError} Invalid lat/lon.\n     *\n     * @example\n     *   import LatLon from '/js/geodesy/latlon-spherical.js';\n     *   const p = new LatLon(52.205, 0.119);\n     */\n    constructor(lat, lon) {\n        if (isNaN(lat)) throw new TypeError(`invalid lat ‘${lat}’`);\n        if (isNaN(lon)) throw new TypeError(`invalid lon ‘${lon}’`);\n\n        this._lat = Dms.wrap90(Number(lat));\n        this._lon = Dms.wrap180(Number(lon));\n    }\n\n\n    /**\n     * Latitude in degrees north from equator (including aliases lat, latitude): can be set as\n     * numeric or hexagesimal (deg-min-sec); returned as numeric.\n     */\n    get lat()       { return this._lat; }\n    get latitude()  { return this._lat; }\n    set lat(lat) {\n        this._lat = isNaN(lat) ? Dms.wrap90(Dms.parse(lat)) : Dms.wrap90(Number(lat));\n        if (isNaN(this._lat)) throw new TypeError(`invalid lat ‘${lat}’`);\n    }\n    set latitude(lat) {\n        this._lat = isNaN(lat) ? Dms.wrap90(Dms.parse(lat)) : Dms.wrap90(Number(lat));\n        if (isNaN(this._lat)) throw new TypeError(`invalid latitude ‘${lat}’`);\n    }\n\n    /**\n     * Longitude in degrees east from international reference meridian (including aliases lon, lng,\n     * longitude): can be set as numeric or hexagesimal (deg-min-sec); returned as numeric.\n     */\n    get lon()       { return this._lon; }\n    get lng()       { return this._lon; }\n    get longitude() { return this._lon; }\n    set lon(lon) {\n        this._lon = isNaN(lon) ? Dms.wrap180(Dms.parse(lon)) : Dms.wrap180(Number(lon));\n        if (isNaN(this._lon)) throw new TypeError(`invalid lon ‘${lon}’`);\n    }\n    set lng(lon) {\n        this._lon = isNaN(lon) ? Dms.wrap180(Dms.parse(lon)) : Dms.wrap180(Number(lon));\n        if (isNaN(this._lon)) throw new TypeError(`invalid lng ‘${lon}’`);\n    }\n    set longitude(lon) {\n        this._lon = isNaN(lon) ? Dms.wrap180(Dms.parse(lon)) : Dms.wrap180(Number(lon));\n        if (isNaN(this._lon)) throw new TypeError(`invalid longitude ‘${lon}’`);\n    }\n\n\n    /** Conversion factors; 1000 * LatLon.metresToKm gives 1. */\n    static get metresToKm()            { return 1/1000; }\n    /** Conversion factors; 1000 * LatLon.metresToMiles gives 0.621371192237334. */\n    static get metresToMiles()         { return 1/1609.344; }\n    /** Conversion factors; 1000 * LatLon.metresToMiles gives 0.5399568034557236. */\n    static get metresToNauticalMiles() { return 1/1852; }\n\n\n    /**\n     * Parses a latitude/longitude point from a variety of formats.\n     *\n     * Latitude & longitude (in degrees) can be supplied as two separate parameters, as a single\n     * comma-separated lat/lon string, or as a single object with { lat, lon } or GeoJSON properties.\n     *\n     * The latitude/longitude values may be numeric or strings; they may be signed decimal or\n     * deg-min-sec (hexagesimal) suffixed by compass direction (NSEW); a variety of separators are\n     * accepted. Examples -3.62, '3 37 12W', '3°37′12″W'.\n     *\n     * Thousands/decimal separators must be comma/dot; use Dms.fromLocale to convert locale-specific\n     * thousands/decimal separators.\n     *\n     * @param   {number|string|Object} lat|latlon - Latitude (in degrees) or comma-separated lat/lon or lat/lon object.\n     * @param   {number|string}        [lon]      - Longitude (in degrees).\n     * @returns {LatLon} Latitude/longitude point.\n     * @throws  {TypeError} Invalid point.\n     *\n     * @example\n     *   const p1 = LatLon.parse(52.205, 0.119);                                    // numeric pair (≡ new LatLon)\n     *   const p2 = LatLon.parse('52.205', '0.119');                                // numeric string pair (≡ new LatLon)\n     *   const p3 = LatLon.parse('52.205, 0.119');                                  // single string numerics\n     *   const p4 = LatLon.parse('52°12′18.0″N', '000°07′08.4″E');                  // DMS pair\n     *   const p5 = LatLon.parse('52°12′18.0″N, 000°07′08.4″E');                    // single string DMS\n     *   const p6 = LatLon.parse({ lat: 52.205, lon: 0.119 });                      // { lat, lon } object numeric\n     *   const p7 = LatLon.parse({ lat: '52°12′18.0″N', lng: '000°07′08.4″E' });    // { lat, lng } object DMS\n     *   const p8 = LatLon.parse({ type: 'Point', coordinates: [ 0.119, 52.205] }); // GeoJSON\n     */\n    static parse(...args) {\n        if (args.length == 0) throw new TypeError('invalid (empty) point');\n        if (args[0]===null || args[1]===null) throw new TypeError('invalid (null) point');\n\n        let lat=undefined, lon=undefined;\n\n        if (args.length == 2) { // regular (lat, lon) arguments\n            [ lat, lon ] = args;\n            lat = Dms.wrap90(Dms.parse(lat));\n            lon = Dms.wrap180(Dms.parse(lon));\n            if (isNaN(lat) || isNaN(lon)) throw new TypeError(`invalid point ‘${args.toString()}’`);\n        }\n\n        if (args.length == 1 && typeof args[0] == 'string') { // single comma-separated lat,lon string\n            [ lat, lon ] = args[0].split(',');\n            lat = Dms.wrap90(Dms.parse(lat));\n            lon = Dms.wrap180(Dms.parse(lon));\n            if (isNaN(lat) || isNaN(lon)) throw new TypeError(`invalid point ‘${args[0]}’`);\n        }\n\n        if (args.length == 1 && typeof args[0] == 'object') { // single { lat, lon } object\n            const ll = args[0];\n            if (ll.type == 'Point' && Array.isArray(ll.coordinates)) { // GeoJSON\n                [ lon, lat ] = ll.coordinates;\n            } else { // regular { lat, lon } object\n                if (ll.latitude  != undefined) lat = ll.latitude;\n                if (ll.lat       != undefined) lat = ll.lat;\n                if (ll.longitude != undefined) lon = ll.longitude;\n                if (ll.lng       != undefined) lon = ll.lng;\n                if (ll.lon       != undefined) lon = ll.lon;\n                lat = Dms.wrap90(Dms.parse(lat));\n                lon = Dms.wrap180(Dms.parse(lon));\n            }\n            if (isNaN(lat) || isNaN(lon)) throw new TypeError(`invalid point ‘${JSON.stringify(args[0])}’`);\n        }\n\n        if (isNaN(lat) || isNaN(lon)) throw new TypeError(`invalid point ‘${args.toString()}’`);\n\n        return new LatLonSpherical(lat, lon);\n    }\n\n\n    /**\n     * Returns the distance along the surface of the earth from ‘this’ point to destination point.\n     *\n     * Uses haversine formula: a = sin²(Δφ/2) + cosφ1·cosφ2 · sin²(Δλ/2); d = 2 · atan2(√a, √(a-1)).\n     *\n     * @param   {LatLon} point - Latitude/longitude of destination point.\n     * @param   {number} [radius=6371e3] - Radius of earth (defaults to mean radius in metres).\n     * @returns {number} Distance between this point and destination point, in same units as radius.\n     * @throws  {TypeError} Invalid radius.\n     *\n     * @example\n     *   const p1 = new LatLon(52.205, 0.119);\n     *   const p2 = new LatLon(48.857, 2.351);\n     *   const d = p1.distanceTo(p2);       // 404.3×10³ m\n     *   const m = p1.distanceTo(p2, 3959); // 251.2 miles\n     */\n    distanceTo(point, radius=6371e3) {\n        if (!(point instanceof LatLonSpherical)) point = LatLonSpherical.parse(point); // allow literal forms\n        if (isNaN(radius)) throw new TypeError(`invalid radius ‘${radius}’`);\n\n        // a = sin²(Δφ/2) + cos(φ1)⋅cos(φ2)⋅sin²(Δλ/2)\n        // δ = 2·atan2(√(a), √(1−a))\n        // see mathforum.org/library/drmath/view/51879.html for derivation\n\n        const R = radius;\n        const φ1 = this.lat.toRadians(),  λ1 = this.lon.toRadians();\n        const φ2 = point.lat.toRadians(), λ2 = point.lon.toRadians();\n        const Δφ = φ2 - φ1;\n        const Δλ = λ2 - λ1;\n\n        const a = Math.sin(Δφ/2)*Math.sin(Δφ/2) + Math.cos(φ1)*Math.cos(φ2) * Math.sin(Δλ/2)*Math.sin(Δλ/2);\n        const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));\n        const d = R * c;\n\n        return d;\n    }\n\n\n    /**\n     * Returns the initial bearing from ‘this’ point to destination point.\n     *\n     * @param   {LatLon} point - Latitude/longitude of destination point.\n     * @returns {number} Initial bearing in degrees from north (0°..360°).\n     *\n     * @example\n     *   const p1 = new LatLon(52.205, 0.119);\n     *   const p2 = new LatLon(48.857, 2.351);\n     *   const b1 = p1.initialBearingTo(p2); // 156.2°\n     */\n    initialBearingTo(point) {\n        if (!(point instanceof LatLonSpherical)) point = LatLonSpherical.parse(point); // allow literal forms\n        if (this.equals(point)) return NaN; // coincident points\n\n        // tanθ = sinΔλ⋅cosφ2 / cosφ1⋅sinφ2 − sinφ1⋅cosφ2⋅cosΔλ\n        // see mathforum.org/library/drmath/view/55417.html for derivation\n\n        const φ1 = this.lat.toRadians();\n        const φ2 = point.lat.toRadians();\n        const Δλ = (point.lon - this.lon).toRadians();\n\n        const x = Math.cos(φ1) * Math.sin(φ2) - Math.sin(φ1) * Math.cos(φ2) * Math.cos(Δλ);\n        const y = Math.sin(Δλ) * Math.cos(φ2);\n        const θ = Math.atan2(y, x);\n\n        const bearing = θ.toDegrees();\n\n        return Dms.wrap360(bearing);\n    }\n\n\n    /**\n     * Returns final bearing arriving at destination point from ‘this’ point; the final bearing will\n     * differ from the initial bearing by varying degrees according to distance and latitude.\n     *\n     * @param   {LatLon} point - Latitude/longitude of destination point.\n     * @returns {number} Final bearing in degrees from north (0°..360°).\n     *\n     * @example\n     *   const p1 = new LatLon(52.205, 0.119);\n     *   const p2 = new LatLon(48.857, 2.351);\n     *   const b2 = p1.finalBearingTo(p2); // 157.9°\n     */\n    finalBearingTo(point) {\n        if (!(point instanceof LatLonSpherical)) point = LatLonSpherical.parse(point); // allow literal forms\n\n        // get initial bearing from destination point to this point & reverse it by adding 180°\n\n        const bearing = point.initialBearingTo(this) + 180;\n\n        return Dms.wrap360(bearing);\n    }\n\n\n    /**\n     * Returns the midpoint between ‘this’ point and destination point.\n     *\n     * @param   {LatLon} point - Latitude/longitude of destination point.\n     * @returns {LatLon} Midpoint between this point and destination point.\n     *\n     * @example\n     *   const p1 = new LatLon(52.205, 0.119);\n     *   const p2 = new LatLon(48.857, 2.351);\n     *   const pMid = p1.midpointTo(p2); // 50.5363°N, 001.2746°E\n     */\n    midpointTo(point) {\n        if (!(point instanceof LatLonSpherical)) point = LatLonSpherical.parse(point); // allow literal forms\n\n        // φm = atan2( sinφ1 + sinφ2, √( (cosφ1 + cosφ2⋅cosΔλ)² + cos²φ2⋅sin²Δλ ) )\n        // λm = λ1 + atan2(cosφ2⋅sinΔλ, cosφ1 + cosφ2⋅cosΔλ)\n        // midpoint is sum of vectors to two points: mathforum.org/library/drmath/view/51822.html\n\n        const φ1 = this.lat.toRadians();\n        const λ1 = this.lon.toRadians();\n        const φ2 = point.lat.toRadians();\n        const Δλ = (point.lon - this.lon).toRadians();\n\n        // get cartesian coordinates for the two points\n        const A = { x: Math.cos(φ1), y: 0, z: Math.sin(φ1) }; // place point A on prime meridian y=0\n        const B = { x: Math.cos(φ2)*Math.cos(Δλ), y: Math.cos(φ2)*Math.sin(Δλ), z: Math.sin(φ2) };\n\n        // vector to midpoint is sum of vectors to two points (no need to normalise)\n        const C = { x: A.x + B.x, y: A.y + B.y, z: A.z + B.z };\n\n        const φm = Math.atan2(C.z, Math.sqrt(C.x*C.x + C.y*C.y));\n        const λm = λ1 + Math.atan2(C.y, C.x);\n\n        const lat = φm.toDegrees();\n        const lon = λm.toDegrees();\n\n        return new LatLonSpherical(lat, lon);\n    }\n\n\n    /**\n     * Returns the point at given fraction between ‘this’ point and given point.\n     *\n     * @param   {LatLon} point - Latitude/longitude of destination point.\n     * @param   {number} fraction - Fraction between the two points (0 = this point, 1 = specified point).\n     * @returns {LatLon} Intermediate point between this point and destination point.\n     *\n     * @example\n     *   const p1 = new LatLon(52.205, 0.119);\n     *   const p2 = new LatLon(48.857, 2.351);\n     *   const pInt = p1.intermediatePointTo(p2, 0.25); // 51.3721°N, 000.7073°E\n     */\n    intermediatePointTo(point, fraction) {\n        if (!(point instanceof LatLonSpherical)) point = LatLonSpherical.parse(point); // allow literal forms\n        if (this.equals(point)) return new LatLonSpherical(this.lat, this.lon); // coincident points\n\n        const φ1 = this.lat.toRadians(), λ1 = this.lon.toRadians();\n        const φ2 = point.lat.toRadians(), λ2 = point.lon.toRadians();\n\n        // distance between points\n        const Δφ = φ2 - φ1;\n        const Δλ = λ2 - λ1;\n        const a = Math.sin(Δφ/2) * Math.sin(Δφ/2)\n            + Math.cos(φ1) * Math.cos(φ2) * Math.sin(Δλ/2) * Math.sin(Δλ/2);\n        const δ = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));\n\n        const A = Math.sin((1-fraction)*δ) / Math.sin(δ);\n        const B = Math.sin(fraction*δ) / Math.sin(δ);\n\n        const x = A * Math.cos(φ1) * Math.cos(λ1) + B * Math.cos(φ2) * Math.cos(λ2);\n        const y = A * Math.cos(φ1) * Math.sin(λ1) + B * Math.cos(φ2) * Math.sin(λ2);\n        const z = A * Math.sin(φ1) + B * Math.sin(φ2);\n\n        const φ3 = Math.atan2(z, Math.sqrt(x*x + y*y));\n        const λ3 = Math.atan2(y, x);\n\n        const lat = φ3.toDegrees();\n        const lon = λ3.toDegrees();\n\n        return new LatLonSpherical(lat, lon);\n    }\n\n\n    /**\n     * Returns the destination point from ‘this’ point having travelled the given distance on the\n     * given initial bearing (bearing normally varies around path followed).\n     *\n     * @param   {number} distance - Distance travelled, in same units as earth radius (default: metres).\n     * @param   {number} bearing - Initial bearing in degrees from north.\n     * @param   {number} [radius=6371e3] - (Mean) radius of earth (defaults to radius in metres).\n     * @returns {LatLon} Destination point.\n     *\n     * @example\n     *   const p1 = new LatLon(51.47788, -0.00147);\n     *   const p2 = p1.destinationPoint(7794, 300.7); // 51.5136°N, 000.0983°W\n     */\n    destinationPoint(distance, bearing, radius=6371e3) {\n        // sinφ2 = sinφ1⋅cosδ + cosφ1⋅sinδ⋅cosθ\n        // tanΔλ = sinθ⋅sinδ⋅cosφ1 / cosδ−sinφ1⋅sinφ2\n        // see mathforum.org/library/drmath/view/52049.html for derivation\n\n        const δ = distance / radius; // angular distance in radians\n        const θ = Number(bearing).toRadians();\n\n        const φ1 = this.lat.toRadians(), λ1 = this.lon.toRadians();\n\n        const sinφ2 = Math.sin(φ1) * Math.cos(δ) + Math.cos(φ1) * Math.sin(δ) * Math.cos(θ);\n        const φ2 = Math.asin(sinφ2);\n        const y = Math.sin(θ) * Math.sin(δ) * Math.cos(φ1);\n        const x = Math.cos(δ) - Math.sin(φ1) * sinφ2;\n        const λ2 = λ1 + Math.atan2(y, x);\n\n        const lat = φ2.toDegrees();\n        const lon = λ2.toDegrees();\n\n        return new LatLonSpherical(lat, lon);\n    }\n\n\n    /**\n     * Returns the point of intersection of two paths defined by point and bearing.\n     *\n     * @param   {LatLon}      p1 - First point.\n     * @param   {number}      brng1 - Initial bearing from first point.\n     * @param   {LatLon}      p2 - Second point.\n     * @param   {number}      brng2 - Initial bearing from second point.\n     * @returns {LatLon|null} Destination point (null if no unique intersection defined).\n     *\n     * @example\n     *   const p1 = new LatLon(51.8853, 0.2545), brng1 = 108.547;\n     *   const p2 = new LatLon(49.0034, 2.5735), brng2 =  32.435;\n     *   const pInt = LatLon.intersection(p1, brng1, p2, brng2); // 50.9078°N, 004.5084°E\n     */\n    static intersection(p1, brng1, p2, brng2) {\n        if (!(p1 instanceof LatLonSpherical)) p1 = LatLonSpherical.parse(p1); // allow literal forms\n        if (!(p2 instanceof LatLonSpherical)) p2 = LatLonSpherical.parse(p2); // allow literal forms\n        if (isNaN(brng1)) throw new TypeError(`invalid brng1 ‘${brng1}’`);\n        if (isNaN(brng2)) throw new TypeError(`invalid brng2 ‘${brng2}’`);\n\n        // see www.edwilliams.org/avform.htm#Intersection\n\n        const φ1 = p1.lat.toRadians(), λ1 = p1.lon.toRadians();\n        const φ2 = p2.lat.toRadians(), λ2 = p2.lon.toRadians();\n        const θ13 = Number(brng1).toRadians(), θ23 = Number(brng2).toRadians();\n        const Δφ = φ2 - φ1, Δλ = λ2 - λ1;\n\n        // angular distance p1-p2\n        const δ12 = 2 * Math.asin(Math.sqrt(Math.sin(Δφ/2) * Math.sin(Δφ/2)\n            + Math.cos(φ1) * Math.cos(φ2) * Math.sin(Δλ/2) * Math.sin(Δλ/2)));\n        if (Math.abs(δ12) < Number.EPSILON) return new LatLonSpherical(p1.lat, p1.lon); // coincident points\n\n        // initial/final bearings between points\n        const cosθa = (Math.sin(φ2) - Math.sin(φ1)*Math.cos(δ12)) / (Math.sin(δ12)*Math.cos(φ1));\n        const cosθb = (Math.sin(φ1) - Math.sin(φ2)*Math.cos(δ12)) / (Math.sin(δ12)*Math.cos(φ2));\n        const θa = Math.acos(Math.min(Math.max(cosθa, -1), 1)); // protect against rounding errors\n        const θb = Math.acos(Math.min(Math.max(cosθb, -1), 1)); // protect against rounding errors\n\n        const θ12 = Math.sin(λ2-λ1)>0 ? θa : 2*π-θa;\n        const θ21 = Math.sin(λ2-λ1)>0 ? 2*π-θb : θb;\n\n        const α1 = θ13 - θ12; // angle 2-1-3\n        const α2 = θ21 - θ23; // angle 1-2-3\n\n        if (Math.sin(α1) == 0 && Math.sin(α2) == 0) return null; // infinite intersections\n        if (Math.sin(α1) * Math.sin(α2) < 0) return null;        // ambiguous intersection (antipodal/360°)\n\n        const cosα3 = -Math.cos(α1)*Math.cos(α2) + Math.sin(α1)*Math.sin(α2)*Math.cos(δ12);\n\n        const δ13 = Math.atan2(Math.sin(δ12)*Math.sin(α1)*Math.sin(α2), Math.cos(α2) + Math.cos(α1)*cosα3);\n\n        const φ3 = Math.asin(Math.min(Math.max(Math.sin(φ1)*Math.cos(δ13) + Math.cos(φ1)*Math.sin(δ13)*Math.cos(θ13), -1), 1));\n\n        const Δλ13 = Math.atan2(Math.sin(θ13)*Math.sin(δ13)*Math.cos(φ1), Math.cos(δ13) - Math.sin(φ1)*Math.sin(φ3));\n        const λ3 = λ1 + Δλ13;\n\n        const lat = φ3.toDegrees();\n        const lon = λ3.toDegrees();\n\n        return new LatLonSpherical(lat, lon);\n    }\n\n\n    /**\n     * Returns (signed) distance from ‘this’ point to great circle defined by start-point and\n     * end-point.\n     *\n     * @param   {LatLon} pathStart - Start point of great circle path.\n     * @param   {LatLon} pathEnd - End point of great circle path.\n     * @param   {number} [radius=6371e3] - (Mean) radius of earth (defaults to radius in metres).\n     * @returns {number} Distance to great circle (-ve if to left, +ve if to right of path).\n     *\n     * @example\n     *   const pCurrent = new LatLon(53.2611, -0.7972);\n     *   const p1 = new LatLon(53.3206, -1.7297);\n     *   const p2 = new LatLon(53.1887, 0.1334);\n     *   const d = pCurrent.crossTrackDistanceTo(p1, p2);  // -307.5 m\n     */\n    crossTrackDistanceTo(pathStart, pathEnd, radius=6371e3) {\n        if (!(pathStart instanceof LatLonSpherical)) pathStart = LatLonSpherical.parse(pathStart); // allow literal forms\n        if (!(pathEnd instanceof LatLonSpherical)) pathEnd = LatLonSpherical.parse(pathEnd);       // allow literal forms\n        const R = radius;\n\n        if (this.equals(pathStart)) return 0;\n\n        const δ13 = pathStart.distanceTo(this, R) / R;\n        const θ13 = pathStart.initialBearingTo(this).toRadians();\n        const θ12 = pathStart.initialBearingTo(pathEnd).toRadians();\n\n        const δxt = Math.asin(Math.sin(δ13) * Math.sin(θ13 - θ12));\n\n        return δxt * R;\n    }\n\n\n    /**\n     * Returns how far ‘this’ point is along a path from from start-point, heading towards end-point.\n     * That is, if a perpendicular is drawn from ‘this’ point to the (great circle) path, the\n     * along-track distance is the distance from the start point to where the perpendicular crosses\n     * the path.\n     *\n     * @param   {LatLon} pathStart - Start point of great circle path.\n     * @param   {LatLon} pathEnd - End point of great circle path.\n     * @param   {number} [radius=6371e3] - (Mean) radius of earth (defaults to radius in metres).\n     * @returns {number} Distance along great circle to point nearest ‘this’ point.\n     *\n     * @example\n     *   const pCurrent = new LatLon(53.2611, -0.7972);\n     *   const p1 = new LatLon(53.3206, -1.7297);\n     *   const p2 = new LatLon(53.1887,  0.1334);\n     *   const d = pCurrent.alongTrackDistanceTo(p1, p2);  // 62.331 km\n     */\n    alongTrackDistanceTo(pathStart, pathEnd, radius=6371e3) {\n        if (!(pathStart instanceof LatLonSpherical)) pathStart = LatLonSpherical.parse(pathStart); // allow literal forms\n        if (!(pathEnd instanceof LatLonSpherical)) pathEnd = LatLonSpherical.parse(pathEnd);       // allow literal forms\n        const R = radius;\n\n        if (this.equals(pathStart)) return 0;\n\n        const δ13 = pathStart.distanceTo(this, R) / R;\n        const θ13 = pathStart.initialBearingTo(this).toRadians();\n        const θ12 = pathStart.initialBearingTo(pathEnd).toRadians();\n\n        const δxt = Math.asin(Math.sin(δ13) * Math.sin(θ13-θ12));\n\n        const δat = Math.acos(Math.cos(δ13) / Math.abs(Math.cos(δxt)));\n\n        return δat*Math.sign(Math.cos(θ12-θ13)) * R;\n    }\n\n\n    /**\n     * Returns maximum latitude reached when travelling on a great circle on given bearing from\n     * ‘this’ point (‘Clairaut’s formula’). Negate the result for the minimum latitude (in the\n     * southern hemisphere).\n     *\n     * The maximum latitude is independent of longitude; it will be the same for all points on a\n     * given latitude.\n     *\n     * @param   {number} bearing - Initial bearing.\n     * @returns {number} Maximum latitude reached.\n     */\n    maxLatitude(bearing) {\n        const θ = Number(bearing).toRadians();\n\n        const φ = this.lat.toRadians();\n\n        const φMax = Math.acos(Math.abs(Math.sin(θ) * Math.cos(φ)));\n\n        return φMax.toDegrees();\n    }\n\n\n    /**\n     * Returns the pair of meridians at which a great circle defined by two points crosses the given\n     * latitude. If the great circle doesn't reach the given latitude, null is returned.\n     *\n     * @param   {LatLon}      point1 - First point defining great circle.\n     * @param   {LatLon}      point2 - Second point defining great circle.\n     * @param   {number}      latitude - Latitude crossings are to be determined for.\n     * @returns {Object|null} Object containing { lon1, lon2 } or null if given latitude not reached.\n     */\n    static crossingParallels(point1, point2, latitude) {\n        if (point1.equals(point2)) return null; // coincident points\n\n        const φ = Number(latitude).toRadians();\n\n        const φ1 = point1.lat.toRadians();\n        const λ1 = point1.lon.toRadians();\n        const φ2 = point2.lat.toRadians();\n        const λ2 = point2.lon.toRadians();\n\n        const Δλ = λ2 - λ1;\n\n        const x = Math.sin(φ1) * Math.cos(φ2) * Math.cos(φ) * Math.sin(Δλ);\n        const y = Math.sin(φ1) * Math.cos(φ2) * Math.cos(φ) * Math.cos(Δλ) - Math.cos(φ1) * Math.sin(φ2) * Math.cos(φ);\n        const z = Math.cos(φ1) * Math.cos(φ2) * Math.sin(φ) * Math.sin(Δλ);\n\n        if (z * z > x * x + y * y) return null; // great circle doesn't reach latitude\n\n        const λm = Math.atan2(-y, x);               // longitude at max latitude\n        const Δλi = Math.acos(z / Math.sqrt(x*x + y*y)); // Δλ from λm to intersection points\n\n        const λi1 = λ1 + λm - Δλi;\n        const λi2 = λ1 + λm + Δλi;\n\n        const lon1 = λi1.toDegrees();\n        const lon2 = λi2.toDegrees();\n\n        return {\n            lon1: Dms.wrap180(lon1),\n            lon2: Dms.wrap180(lon2),\n        };\n    }\n\n\n    /* Rhumb - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  */\n\n\n    /**\n     * Returns the distance travelling from ‘this’ point to destination point along a rhumb line.\n     *\n     * @param   {LatLon} point - Latitude/longitude of destination point.\n     * @param   {number} [radius=6371e3] - (Mean) radius of earth (defaults to radius in metres).\n     * @returns {number} Distance in km between this point and destination point (same units as radius).\n     *\n     * @example\n     *   const p1 = new LatLon(51.127, 1.338);\n     *   const p2 = new LatLon(50.964, 1.853);\n     *   const d = p1.distanceTo(p2); //  40.31 km\n     */\n    rhumbDistanceTo(point, radius=6371e3) {\n        if (!(point instanceof LatLonSpherical)) point = LatLonSpherical.parse(point); // allow literal forms\n\n        // see www.edwilliams.org/avform.htm#Rhumb\n\n        const R = radius;\n        const φ1 = this.lat.toRadians();\n        const φ2 = point.lat.toRadians();\n        const Δφ = φ2 - φ1;\n        let Δλ = Math.abs(point.lon - this.lon).toRadians();\n        // if dLon over 180° take shorter rhumb line across the anti-meridian:\n        if (Math.abs(Δλ) > π) Δλ = Δλ > 0 ? -(2 * π - Δλ) : (2 * π + Δλ);\n\n        // on Mercator projection, longitude distances shrink by latitude; q is the 'stretch factor'\n        // q becomes ill-conditioned along E-W line (0/0); use empirical tolerance to avoid it (note ε is too small)\n        const Δψ = Math.log(Math.tan(φ2 / 2 + π / 4) / Math.tan(φ1 / 2 + π / 4));\n        const q = Math.abs(Δψ) > 10e-12 ? Δφ / Δψ : Math.cos(φ1);\n\n        // distance is pythagoras on 'stretched' Mercator projection, √(Δφ² + q²·Δλ²)\n        const δ = Math.sqrt(Δφ*Δφ + q*q * Δλ*Δλ); // angular distance in radians\n        const d = δ * R;\n\n        return d;\n    }\n\n\n    /**\n     * Returns the bearing from ‘this’ point to destination point along a rhumb line.\n     *\n     * @param   {LatLon}    point - Latitude/longitude of destination point.\n     * @returns {number}    Bearing in degrees from north.\n     *\n     * @example\n     *   const p1 = new LatLon(51.127, 1.338);\n     *   const p2 = new LatLon(50.964, 1.853);\n     *   const d = p1.rhumbBearingTo(p2); // 116.7°\n     */\n    rhumbBearingTo(point) {\n        if (!(point instanceof LatLonSpherical)) point = LatLonSpherical.parse(point); // allow literal forms\n        if (this.equals(point)) return NaN; // coincident points\n\n        const φ1 = this.lat.toRadians();\n        const φ2 = point.lat.toRadians();\n        let Δλ = (point.lon - this.lon).toRadians();\n        // if dLon over 180° take shorter rhumb line across the anti-meridian:\n        if (Math.abs(Δλ) > π) Δλ = Δλ > 0 ? -(2 * π - Δλ) : (2 * π + Δλ);\n\n        const Δψ = Math.log(Math.tan(φ2 / 2 + π / 4) / Math.tan(φ1 / 2 + π / 4));\n\n        const θ = Math.atan2(Δλ, Δψ);\n\n        const bearing = θ.toDegrees();\n\n        return Dms.wrap360(bearing);\n    }\n\n\n    /**\n     * Returns the destination point having travelled along a rhumb line from ‘this’ point the given\n     * distance on the given bearing.\n     *\n     * @param   {number} distance - Distance travelled, in same units as earth radius (default: metres).\n     * @param   {number} bearing - Bearing in degrees from north.\n     * @param   {number} [radius=6371e3] - (Mean) radius of earth (defaults to radius in metres).\n     * @returns {LatLon} Destination point.\n     *\n     * @example\n     *   const p1 = new LatLon(51.127, 1.338);\n     *   const p2 = p1.rhumbDestinationPoint(40300, 116.7); // 50.9642°N, 001.8530°E\n     */\n    rhumbDestinationPoint(distance, bearing, radius=6371e3) {\n        const φ1 = this.lat.toRadians(), λ1 = this.lon.toRadians();\n        const θ = Number(bearing).toRadians();\n\n        const δ = distance / radius; // angular distance in radians\n\n        const Δφ = δ * Math.cos(θ);\n        let φ2 = φ1 + Δφ;\n\n        // check for some daft bugger going past the pole, normalise latitude if so\n        if (Math.abs(φ2) > π / 2) φ2 = φ2 > 0 ? π - φ2 : -π - φ2;\n\n        const Δψ = Math.log(Math.tan(φ2 / 2 + π / 4) / Math.tan(φ1 / 2 + π / 4));\n        const q = Math.abs(Δψ) > 10e-12 ? Δφ / Δψ : Math.cos(φ1); // E-W course becomes ill-conditioned with 0/0\n\n        const Δλ = δ * Math.sin(θ) / q;\n        const λ2 = λ1 + Δλ;\n\n        const lat = φ2.toDegrees();\n        const lon = λ2.toDegrees();\n\n        return new LatLonSpherical(lat, lon);\n    }\n\n\n    /**\n     * Returns the loxodromic midpoint (along a rhumb line) between ‘this’ point and second point.\n     *\n     * @param   {LatLon} point - Latitude/longitude of second point.\n     * @returns {LatLon} Midpoint between this point and second point.\n     *\n     * @example\n     *   const p1 = new LatLon(51.127, 1.338);\n     *   const p2 = new LatLon(50.964, 1.853);\n     *   const pMid = p1.rhumbMidpointTo(p2); // 51.0455°N, 001.5957°E\n     */\n    rhumbMidpointTo(point) {\n        if (!(point instanceof LatLonSpherical)) point = LatLonSpherical.parse(point); // allow literal forms\n\n        // see mathforum.org/kb/message.jspa?messageID=148837\n\n        const φ1 = this.lat.toRadians(); let λ1 = this.lon.toRadians();\n        const φ2 = point.lat.toRadians(), λ2 = point.lon.toRadians();\n\n        if (Math.abs(λ2 - λ1) > π) λ1 += 2 * π; // crossing anti-meridian\n\n        const φ3 = (φ1 + φ2) / 2;\n        const f1 = Math.tan(π / 4 + φ1 / 2);\n        const f2 = Math.tan(π / 4 + φ2 / 2);\n        const f3 = Math.tan(π / 4 + φ3 / 2);\n        let λ3 = ((λ2 - λ1) * Math.log(f3) + λ1 * Math.log(f2) - λ2 * Math.log(f1)) / Math.log(f2 / f1);\n\n        if (!isFinite(λ3)) λ3 = (λ1 + λ2) / 2; // parallel of latitude\n\n        const lat = φ3.toDegrees();\n        const lon = λ3.toDegrees();\n\n        return new LatLonSpherical(lat, lon);\n    }\n\n\n    /* Area - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - */\n\n\n    /**\n     * Calculates the area of a spherical polygon where the sides of the polygon are great circle\n     * arcs joining the vertices.\n     *\n     * @param   {LatLon[]} polygon - Array of points defining vertices of the polygon.\n     * @param   {number}   [radius=6371e3] - (Mean) radius of earth (defaults to radius in metres).\n     * @returns {number}   The area of the polygon in the same units as radius.\n     *\n     * @example\n     *   const polygon = [new LatLon(0,0), new LatLon(1,0), new LatLon(0,1)];\n     *   const area = LatLon.areaOf(polygon); // 6.18e9 m²\n     */\n    static areaOf(polygon, radius=6371e3) {\n        // uses method due to Karney: osgeo-org.1560.x6.nabble.com/Area-of-a-spherical-polygon-td3841625.html;\n        // for each edge of the polygon, tan(E/2) = tan(Δλ/2)·(tan(φ₁/2)+tan(φ₂/2)) / (1+tan(φ₁/2)·tan(φ₂/2))\n        // where E is the spherical excess of the trapezium obtained by extending the edge to the equator\n        // (Karney's method is probably more efficient than the more widely known L’Huilier’s Theorem)\n\n        const R = radius;\n\n        // close polygon so that last point equals first point\n        const closed = polygon[0].equals(polygon[polygon.length-1]);\n        if (!closed) polygon.push(polygon[0]);\n\n        const nVertices = polygon.length - 1;\n\n        let S = 0; // spherical excess in steradians\n        for (let v=0; v<nVertices; v++) {\n            const φ1 = polygon[v].lat.toRadians();\n            const φ2 = polygon[v+1].lat.toRadians();\n            const Δλ = (polygon[v+1].lon - polygon[v].lon).toRadians();\n            const E = 2 * Math.atan2(Math.tan(Δλ/2) * (Math.tan(φ1/2)+Math.tan(φ2/2)), 1 + Math.tan(φ1/2)*Math.tan(φ2/2));\n            S += E;\n        }\n\n        if (isPoleEnclosedBy(polygon)) S = Math.abs(S) - 2*π;\n\n        const A = Math.abs(S * R*R); // area in units of R\n\n        if (!closed) polygon.pop(); // restore polygon to pristine condition\n\n        return A;\n\n        // returns whether polygon encloses pole: sum of course deltas around pole is 0° rather than\n        // normal ±360°: blog.element84.com/determining-if-a-spherical-polygon-contains-a-pole.html\n        function isPoleEnclosedBy(p) {\n            // TODO: any better test than this?\n            let ΣΔ = 0;\n            let prevBrng = p[0].initialBearingTo(p[1]);\n            for (let v=0; v<p.length-1; v++) {\n                const initBrng = p[v].initialBearingTo(p[v+1]);\n                const finalBrng = p[v].finalBearingTo(p[v+1]);\n                ΣΔ += (initBrng - prevBrng + 540) % 360 - 180;\n                ΣΔ += (finalBrng - initBrng + 540) % 360 - 180;\n                prevBrng = finalBrng;\n            }\n            const initBrng = p[0].initialBearingTo(p[1]);\n            ΣΔ += (initBrng - prevBrng + 540) % 360 - 180;\n            // TODO: fix (intermittant) edge crossing pole - eg (85,90), (85,0), (85,-90)\n            const enclosed = Math.abs(ΣΔ) < 90; // 0°-ish\n            return enclosed;\n        }\n    }\n\n\n    /* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  */\n\n\n    /**\n     * Checks if another point is equal to ‘this’ point.\n     *\n     * @param   {LatLon} point - Point to be compared against this point.\n     * @returns {bool}   True if points have identical latitude and longitude values.\n     *\n     * @example\n     *   const p1 = new LatLon(52.205, 0.119);\n     *   const p2 = new LatLon(52.205, 0.119);\n     *   const equal = p1.equals(p2); // true\n     */\n    equals(point) {\n        if (!(point instanceof LatLonSpherical)) point = LatLonSpherical.parse(point); // allow literal forms\n\n        if (Math.abs(this.lat - point.lat) > Number.EPSILON) return false;\n        if (Math.abs(this.lon - point.lon) > Number.EPSILON) return false;\n\n        return true;\n    }\n\n\n    /**\n     * Converts ‘this’ point to a GeoJSON object.\n     *\n     * @returns {Object} this point as a GeoJSON ‘Point’ object.\n     */\n    toGeoJSON() {\n        return { type: 'Point', coordinates: [ this.lon, this.lat ] };\n    }\n\n\n    /**\n     * Returns a string representation of ‘this’ point, formatted as degrees, degrees+minutes, or\n     * degrees+minutes+seconds.\n     *\n     * @param   {string} [format=d] - Format point as 'd', 'dm', 'dms', or 'n' for signed numeric.\n     * @param   {number} [dp=4|2|0] - Number of decimal places to use: default 4 for d, 2 for dm, 0 for dms.\n     * @returns {string} Comma-separated formatted latitude/longitude.\n     * @throws  {RangeError} Invalid format.\n     *\n     * @example\n     *   const greenwich = new LatLon(51.47788, -0.00147);\n     *   const d = greenwich.toString();                        // 51.4779°N, 000.0015°W\n     *   const dms = greenwich.toString('dms', 2);              // 51°28′40.37″N, 000°00′05.29″W\n     *   const [lat, lon] = greenwich.toString('n').split(','); // 51.4779, -0.0015\n     */\n    toString(format='d', dp=undefined) {\n        // note: explicitly set dp to undefined for passing through to toLat/toLon\n        if (![ 'd', 'dm', 'dms', 'n' ].includes(format)) throw new RangeError(`invalid format ‘${format}’`);\n\n        if (format == 'n') { // signed numeric degrees\n            if (dp == undefined) dp = 4;\n            return `${this.lat.toFixed(dp)},${this.lon.toFixed(dp)}`;\n        }\n        const lat = Dms.toLat(this.lat, format, dp);\n        const lon = Dms.toLon(this.lon, format, dp);\n        return `${lat}, ${lon}`;\n    }\n\n}\n\n\n/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  */\n\nexport { LatLonSpherical as default, Dms };\n","import LatLon from 'geodesy/latlon-spherical.js'\n\nexport const getFocusPadding = (el, scale) => {\n  if (!el) return\n  const parent = el.closest('.fm-o-main').getBoundingClientRect()\n  const box = el.getBoundingClientRect()\n  const padding = {\n    top: ((box.y || box.top) - (parent.y || parent.top)) / scale,\n    left: ((box.x || box.left) - (parent.x || parent.left)) / scale,\n    right: (parent.width - box.width - ((box.x || box.left) - (parent.x || parent.left))) / scale,\n    bottom: (parent.height - box.height - ((box.y || box.top) - (parent.y || parent.top))) / scale\n  }\n  return padding\n}\n\nexport const getFocusBounds = (el, scale) => {\n  if (!el) return\n  const parent = el.closest('.fm-o-main').getBoundingClientRect()\n  const box = el.getBoundingClientRect()\n  const m = 10\n  const bounds = [[\n    ((box.x || box.left) - (parent.x || parent.left) + m) / scale,\n    (((box.y || box.top) - (parent.y || parent.top)) + box.height - m) / scale\n  ], [\n    (box.width + ((box.x || box.left) - (parent.x || parent.left)) - m) / scale,\n    ((box.y || box.top) - (parent.y || parent.top) + m) / scale\n  ]]\n  return bounds\n}\n\nexport const getMapPixel = (box, scale) => {\n  const { offsetTop, offsetLeft, offsetWidth, offsetHeight } = box\n  const point = [(offsetLeft + (offsetWidth / 2)) / scale, (offsetTop + (offsetHeight / 2)) / scale]\n  return point\n}\n\nexport const getDistance = (coord1, coord2) => {\n  let distance\n  if (coord1[0] > 1000) {\n    const x = Math.abs(coord1[0] - coord2[0])\n    const y = Math.abs(coord1[1] - coord2[1])\n    const dist = Math.sqrt((Math.pow(x, 2)) + (Math.pow(y, 2)))\n    distance = dist\n  } else {\n    const p1 = new LatLon(coord1[1], coord1[0])\n    const p2 = new LatLon(coord2[1], coord2[0])\n    distance = p1.distanceTo(p2)\n  }\n  return Math.round(distance)\n}\n\nexport const getUnits = (metres) => {\n  let units\n  if (metres < 800) {\n    units = `${metres} metres`\n  } else if (metres < 5000) {\n    units = (metres / 1000 * 0.621371).toFixed(1) + ' miles'\n  } else {\n    units = Math.round((metres / 1000) * 0.621371) + ' miles'\n  }\n  return units\n}\n\nexport const getDirection = (coord1, coord2) => {\n  coord1 = coord1.map(n => n > 1000 ? Math.round(n) : Math.round(n * 100000) / 100000)\n  coord2 = coord2.map(n => n > 1000 ? Math.round(n) : Math.round(n * 100000) / 100000)\n  const ns1 = [coord1[0], coord1[1]]\n  const ns2 = [coord1[0], coord2[1]]\n  const nsd = getDistance(ns1, ns2)\n  const ew1 = [coord1[0], coord1[1]]\n  const ew2 = [coord2[0], coord1[1]]\n  const ewd = getDistance(ew1, ew2)\n  const ewc = coord1[0] < coord2[0] ? 'east' : coord1[0] > coord2[0] ? 'west' : null\n  const nsc = coord1[1] < coord2[1] ? 'north' : coord1[1] > coord2[1] ? 'south' : null\n  const ns = nsc ? `${nsc} ${getUnits(nsd)}` : ''\n  const ew = ewc ? `${ewc} ${getUnits(ewd)}` : ''\n  return ns + (nsc && ewc ? ', ' : '') + ew\n}\n\nexport const getArea = (bbox) => {\n  const ew = getDistance([bbox[0], bbox[1]], [bbox[2], bbox[1]])\n  const ns = getDistance([bbox[0], bbox[1]], [bbox[0], bbox[3]])\n  return `${getUnits(ew)} by ${getUnits(ns)}`\n}\n\nexport const getBoundsChange = (oCentre, oZoom, centre, zoom, bbox) => {\n  const isSameCentre = JSON.stringify(oCentre) === JSON.stringify(centre)\n  const isSameZoom = oZoom === zoom\n  const isMove = oCentre && oZoom && !(isSameCentre && isSameZoom)\n  if (!isMove) return\n  let change\n  if (!isSameCentre && !isSameZoom) {\n    change = 'New area'\n  } else if (!isSameCentre) {\n    change = `${getDirection(oCentre, centre)}`\n  } else {\n    const direction = zoom > oZoom ? 'in' : 'out'\n    change = `zoomed ${direction}, showing ${getArea(bbox)}`\n  }\n  return `${change}: Use ALT plus I to get new details`\n}\n\nexport const getDescription = (place, centre, bbox, features) => {\n  const { featuresTotal, isFeaturesInMap, isPixelFeaturesAtPixel, isPixelFeaturesInMap } = features\n  let text = ''\n\n  if (featuresTotal) {\n    text = `${featuresTotal} feature${featuresTotal === 1 ? '' : 's'} in this view`\n  } else if (isPixelFeaturesAtPixel) {\n    text = 'Data at the centre coordinate'\n  } else if (isPixelFeaturesInMap) {\n    text = 'No data at the centre coordinate'\n  } else if (isFeaturesInMap) {\n    text = 'No feature data in this area'\n  }\n\n  let coord\n  if (centre[0] > 1000) {\n    coord = `easting ${Math.round(centre[0])} long ${Math.round(centre[1])}`\n  } else {\n    coord = `lat ${centre[1].toFixed(4)} long ${centre[0].toFixed(4)}`\n  }\n\n  return `Approximate map centre ${place || coord}. Covering ${getArea(bbox)}. ${text}`\n}\n\nexport const parseCentre = value => {\n  return value?.split(',').slice(0, 2).map(x => parseFloat(x))\n}\n\nexport const parseZoom = value => {\n  return parseFloat(value?.split(',')[2])\n}\n\nexport const setBasemap = (isDarkMode) => {\n  const ls = window.localStorage.getItem('basemap')\n  const oColourScheme = ls?.split(',')[1]\n  const oBasemap = ls?.split(',')[0]\n  const colourScheme = isDarkMode ? 'dark' : 'light'\n  if (colourScheme !== oColourScheme && ['default', 'dark'].includes(oBasemap)) {\n    window.localStorage.removeItem('basemap')\n  }\n  const basemap = ls?.split(',')[0]\n  const reset = isDarkMode ? 'dark' : 'default'\n  return basemap || reset\n}\n\nexport const getSelectedIndex = (key, total, current) => {\n  return key === 'PageDown'\n    ? current === total - 1 ? 0 : current + 1\n    : current > 0 ? current - 1 : total - 1\n}\n\nexport const getSelectedStatus = (featuresInViewport, index) => {\n  const total = featuresInViewport.length\n  const feature = index < featuresInViewport.length ? featuresInViewport[index] : null\n  const status = feature\n    ? `\n        ${total} feature${total !== 1 ? 's' : ''} in this view. ${feature.name}. ${index + 1} of ${total} highlighted.\n    `\n    : ''\n  return status\n}\n\nexport const getShortcutKey = (e, featuresViewport) => {\n  const number = e.code.slice(-1)\n  const hasFeature = featuresViewport?.features.length >= number\n  const id = hasFeature ? featuresViewport.features[number - 1].id : ''\n  return id\n}\n","import { parseCentre, parseZoom, getDescription, getBoundsChange, setBasemap } from '../lib/viewport'\nimport { isSame } from '../lib/utils'\nimport { settings } from './constants'\n\nexport const initialState = (options) => {\n  const { bbox, centre, zoom, place } = options\n  const queryParams = new URLSearchParams(window.location.search)\n  const cz = queryParams.get('cz')\n  const colorSchemeMQ = '(prefers-color-scheme: dark)'\n  const isDarkMode = window?.matchMedia(colorSchemeMQ).matches\n\n  return {\n    bbox: cz ? null : bbox || (centre && zoom ? null : settings.map.BBOX),\n    centre: cz ? parseCentre(cz) : centre || null,\n    zoom: cz ? parseZoom(cz) : zoom || null,\n    place: cz ? null : place,\n    oZoom: zoom,\n    basemap: setBasemap(isDarkMode),\n    size: window.localStorage.getItem('size'),\n    features: null,\n    status: '',\n    isStatusVisuallyHidden: true,\n    error: null,\n    action: 'INIT',\n    isMoving: false,\n    isUpdate: false,\n    isFeaturesChange: false,\n    isPanZoomChange: false,\n    isUserInitiated: false,\n    padding: null,\n    timestamp: Date.now()\n  }\n}\n\nexport const reducer = (state, action) => {\n  switch (action.type) {\n    case 'UPDATE': {\n      const { oPlace, oZoom } = state\n      const { bbox, centre, zoom, features } = action.detail\n      const place = !state.isUserInitiated ? state.action === 'RESET' ? oPlace : state.place : null\n      const description = getDescription(place, centre, bbox, features)\n      const original = { oBbox: bbox, oCentre: centre, rZoom: zoom, oZoom, oPlace: place }\n      const isPanZoom = !(isSame(state.centre, centre) && isSame(state.zoom, zoom))\n      const isGeoLoc = state.action === 'GEOLOC'\n      const isFeaturesChange = !(isSame(state.features, features))\n      const isUpdate = isPanZoom || isGeoLoc || isFeaturesChange\n      const direction = getBoundsChange(state.centre, state.zoom, centre, zoom, bbox)\n      const status = isPanZoom || isGeoLoc ? place ? description : direction : state.status\n      return {\n        ...state,\n        ...(['INIT', 'GEOLOC'].includes(state.action) && original),\n        place,\n        bbox,\n        centre,\n        zoom,\n        status,\n        features,\n        isMoving: false,\n        isFeaturesChange: isPanZoom || isGeoLoc,\n        isUpdate,\n        action: null\n      }\n    }\n    case 'UPDATE_PLACE': {\n      const { centre, bbox, features } = state\n      const { place } = action\n      const description = getDescription(place, centre, bbox, features)\n      return {\n        ...state,\n        place,\n        status: description,\n        isUserInitiated: false,\n        isStatusVisuallyHidden: true\n      }\n    }\n    case 'MOVE_START': {\n      return {\n        ...state,\n        status: 'Map move',\n        isMoving: true,\n        isUpdate: false,\n        isUserInitiated: action.isUserInitiated,\n        isStatusVisuallyHidden: true\n      }\n    }\n    case 'RESET': {\n      return {\n        ...state,\n        place: state.oPlace,\n        action: 'RESET',\n        isUpdate: false\n      }\n    }\n    case 'SEARCH': {\n      return {\n        ...state,\n        bbox: action.bbox,\n        centre: action.centre,\n        zoom: action.zoom,\n        place: action.place,\n        action: 'SEARCH',\n        isStatusVisuallyHidden: true,\n        isUpdate: false,\n        padding: null,\n        timestamp: Date.now()\n      }\n    }\n    case 'GEOLOC': {\n      return {\n        ...state,\n        place: action.place,\n        centre: action.centre,\n        bbox: null,\n        status: '',\n        isStatusVisuallyHidden: true,\n        action: 'GEOLOC',\n        isUpdate: false\n      }\n    }\n    case 'ZOOM_IN': {\n      return {\n        ...state,\n        action: 'ZOOM_IN',\n        isUpdate: false\n      }\n    }\n    case 'ZOOM_OUT': {\n      return {\n        ...state,\n        action: 'ZOOM_OUT',\n        isUpdate: false\n      }\n    }\n    case 'SET_BASEMAP': {\n      return {\n        ...state,\n        action: 'BASEMAP',\n        isUpdate: false,\n        basemap: action.basemap\n      }\n    }\n    case 'SET_SIZE': {\n      return {\n        ...state,\n        action: 'SIZE',\n        isUpdate: false,\n        padding: null,\n        size: action.size\n      }\n    }\n    case 'UPDATE_STATUS': {\n      return {\n        ...state,\n        status: action.status,\n        isStatusVisuallyHidden: action.isStatusVisuallyHidden\n      }\n    }\n    case 'CLEAR_STATUS': {\n      return {\n        ...state,\n        status: '',\n        isStatusVisuallyHidden: false\n      }\n    }\n    case 'CLEAR_FEATURES': {\n      return {\n        ...state,\n        features: null\n      }\n    }\n    case 'SET_PADDING': {\n      const { panel, viewport, isMobile, isAnimate } = action\n      let padding = null\n      const pRect = panel?.getBoundingClientRect()\n      if (pRect?.height > 0) {\n        const vRect = viewport.getBoundingClientRect()\n        const oHeight = pRect.bottom - vRect.top\n        const oWidth = pRect.right - vRect.left\n        const isPortrait = viewport.offsetHeight / oHeight > viewport.offsetWidth / oWidth\n        const top = isPortrait ? Math.round(pRect.height) + 90 : 0\n        const left = isPortrait ? 0 : Math.round(pRect.width) + 70\n        padding = {\n          ...isMobile ? { bottom: 15 + pRect.height } : {},\n          ...isPortrait && !isMobile ? { top } : {},\n          ...!isPortrait && !isMobile ? { left } : {}\n        }\n      }\n      return {\n        ...state,\n        isAnimate,\n        padding\n      }\n    }\n    default:\n      return state\n  }\n}\n","import React, { createContext, useReducer, useMemo } from 'react'\nimport { initialState, reducer } from './viewport-reducer'\n\nexport const ViewportContext = createContext()\n\nexport const ViewportProvider = ({ options, children }) => {\n  const [state, dispatch] = useReducer(reducer, initialState(options))\n\n  const store = useMemo(() => ({\n    ...state,\n    dispatch\n  }))\n\n  return (\n    <ViewportContext.Provider value={store}>\n      {children}\n    </ViewportContext.Provider>\n  )\n}\n","import { useContext } from 'react'\n\nimport { AppContext } from './app-provider.jsx'\n\nexport const useApp = () => useContext(AppContext)\n","import { useCallback } from 'react'\n\nconst { history } = window\n\nexport const useQueryState = (query) => {\n  const navigate = (state, url) => {\n    history.replaceState(state, '', url)\n  }\n\n  const setQuery = useCallback(\n    value => {\n      const existingQueries = new URLSearchParams(window.location.search)\n\n      existingQueries.delete(query)\n      existingQueries.set(query, value)\n      const queryString = existingQueries.toString()\n\n      navigate(window.history.state, `${window.location.pathname}?${decodeURIComponent(queryString)}`)\n    },\n    [navigate, query]\n  )\n\n  return [\n    (new URLSearchParams(window.location.search)).get(query),\n    setQuery\n  ]\n}\n","import { useContext } from 'react'\n\nimport { ViewportContext } from './viewport-provider.jsx'\n\nexport const useViewport = () => useContext(ViewportContext)\n","export const debounce = (callback, wait) => {\n  let timeoutId = null\n  return (...args) => {\n    window.clearTimeout(timeoutId)\n    timeoutId = window.setTimeout(() => {\n      callback.apply(null, args)\n    }, wait)\n  }\n}\n","import React from 'react'\n\nexport default function Status ({ message, isVisuallyHidden }) {\n  return (\n    <div className={`fm-c-status${isVisuallyHidden || !message ? ' fm-c-status--visually-hidden' : ''}`} aria-live='assertive' aria-atomic>\n      <div className='fm-c-status__inner govuk-body-s'>\n        {message}\n      </div>\n    </div>\n  )\n}\n","import React, { useEffect } from 'react'\nimport { useApp } from '../store/use-app.js'\nimport { useViewport } from '../store/use-viewport.js'\n\nexport default function PaddingBox ({ children }) {\n  const { provider, isContainerReady, mode, viewportRef, paddingBoxRef, obscurePanelRef, targetMarker, frameRef, isFrameVisible, isKeyboard, isMobile } = useApp()\n  const { dispatch, features, padding, isAnimate } = useViewport()\n\n  // Update provider padding, need to run this before viewport action effect\n  useEffect(() => {\n    if (!provider.map) return\n    provider.setPadding(targetMarker?.coord, isAnimate)\n  }, [padding])\n\n  // Set initial viewport padding before provider map is initialised\n  useEffect(() => {\n    if (!isContainerReady) return\n    dispatch({ type: 'SET_PADDING', panel: obscurePanelRef?.current, viewport: viewportRef.current, isMobile })\n  }, [isContainerReady])\n\n  // Update padding if isMobile change, needs timeout\n  useEffect(() => {\n    setTimeout(() => {\n      dispatch({ type: 'SET_PADDING', panel: obscurePanelRef.current, viewport: viewportRef.current, isMobile, isAnimate: false })\n    }, 0)\n  }, [isMobile])\n\n  // Reset padding on entering draw mode\n  useEffect(() => {\n    if (!['frame', 'draw'].includes(mode)) return\n    dispatch({ type: 'SET_PADDING', viewport: viewportRef.current, isMobile, isAnimate: false })\n  }, [mode])\n\n  // Template properties\n  const isVisible = isKeyboard && features?.isFeaturesInMap\n  const isActive = isKeyboard && features?.featuresInViewport.length\n\n  return (\n    <div className={`fm-c-padding-box${isFrameVisible ? ' fm-c-padding-box--frame-mode' : ''}${isVisible ? ' fm-c-padding-box--visible' : ''}${isActive ? ' fm-c-padding-box--active' : ''}`} {...padding ? { style: padding } : {}} ref={paddingBoxRef}>\n      <div className='fm-c-padding-box__frame' ref={frameRef} />\n      {children}\n    </div>\n  )\n}\n","import { useEffect, useState } from 'react'\nimport { useApp } from '../store/use-app'\nimport { useViewport } from '../store/use-viewport.js'\n\n// Hook that alerts if pixel is obscured\n\nexport const usePixelObscurred = () => {\n  const { provider, info, viewportRef, targetMarker, isMobile, padding } = useApp()\n  const { size } = useViewport()\n\n  const [isObscurred, setIsObscurred] = useState(false)\n\n  useEffect(() => {\n    if (!(targetMarker?.coord && provider.map)) return\n    let pixel = provider.getPixel(targetMarker.coord)\n    const scale = size === 'large' ? 2 : 1\n    pixel = pixel.map(c => c * scale)\n    const { top, left } = viewportRef.current.getBoundingClientRect()\n    const topEl = document.elementFromPoint(pixel[0] + left, pixel[1] + top)\n    const isObscurred = !!topEl?.closest('.fm-c-panel--info')\n    setIsObscurred(isObscurred)\n\n    return () => {\n      setIsObscurred(false)\n    }\n  }, [provider.map, isMobile, padding, info, targetMarker])\n\n  return [isObscurred]\n}\n","import React, { useEffect } from 'react'\nimport { useApp } from '../store/use-app.js'\nimport { useViewport } from '../store/use-viewport.js'\nimport { usePixelObscurred } from '../hooks/use-pixel-obscurred'\n\nexport default function Target () {\n  const { provider, mode, targetMarker, activePanel, viewportRef, obscurePanelRef, isContainerReady, isKeyboard, isMobile } = useApp()\n  const { dispatch, features } = useViewport()\n  const [isObscurred] = usePixelObscurred()\n\n  const isTargetCentre = isKeyboard && !(targetMarker && activePanel === 'INFO')\n  const hasTargetData = isTargetCentre ? features?.isPixelFeaturesAtPixel : targetMarker?.hasData\n  const targetCoord = !isTargetCentre ? targetMarker?.coord : null\n  const isTargetVisible = isTargetCentre && mode === 'default' && !!features ? features?.resultType === 'pixel' : !!targetCoord\n\n  // Conditionally show target marker\n  useEffect(() => {\n    provider.setTargetMarker(targetCoord, hasTargetData, isTargetVisible)\n  }, [provider.map, targetCoord, hasTargetData, isTargetVisible])\n\n  // Update padding if target marker is obscurred\n  useEffect(() => {\n    if (!isObscurred || !(isContainerReady && obscurePanelRef.current)) return\n    dispatch({ type: 'SET_PADDING', panel: obscurePanelRef.current, viewport: viewportRef.current, isMobile, isAnimate: true })\n  }, [isObscurred])\n\n  return (\n    !targetCoord && isTargetVisible\n      ? (\n        <div className={`fm-c-marker fm-c-marker--target fm-c-marker--visible fm-c-marker--centre${hasTargetData ? ' fm-c-marker--has-data' : ''}`} aria-label='Map marker'>\n          <div class='fm-c-marker__inner'>\n            <svg width='69' height='69' viewBox='0 0 69 69' fillRule='evenodd' fill='none' stroke='currentColor'>\n              <circle cx='34.5' cy='34.5' r='33' strokeWidth='2' />\n              <path d='M1.5 34.5H31m3.5-33V31m0 36.5V38m33-3.5H38' />\n            </svg>\n          </div>\n        </div>\n        )\n      : null\n  )\n}\n","import React, { useEffect, useRef, useMemo } from 'react'\nimport { useQueryState } from '../hooks/use-query-state.js'\nimport { useApp } from '../store/use-app.js'\nimport { useViewport } from '../store/use-viewport.js'\nimport { settings, offsets, events } from '../store/constants.js'\nimport { debounce } from '../lib/debounce.js'\nimport { setBasemap, getSelectedStatus, getShortcutKey, getSelectedIndex, getMapPixel } from '../lib/viewport.js'\nimport eventBus from '../lib/eventbus.js'\nimport Status from './status.jsx'\nimport PaddingBox from './padding-box.jsx'\nimport Target from './target.jsx'\n\nexport default function Viewport () {\n  const { isContainerReady, provider, options, parent, mode, segments, layers, viewportRef, paddingBoxRef, frameRef, activePanel, activeRef, featureId, targetMarker, isKeyboard, isDarkMode } = useApp()\n\n  if (!provider) return\n\n  const { id, queryFeature, queryPixel, minZoom, maxZoom } = options\n  const appDispatch = useApp().dispatch\n\n  const { bbox, centre, zoom, oCentre, oZoom, rZoom, features, basemap, size, status, isStatusVisuallyHidden, action, timestamp, isMoving, isUpdate } = useViewport()\n  const viewportDispatch = useViewport().dispatch\n\n  const [, setQueryCz] = useQueryState(settings.params.centreZoom)\n  const [, setQueryId] = useQueryState(settings.params.featureId)\n  const [, setQueryTarget] = useQueryState(settings.params.targetMarker)\n\n  const mapContainerRef = useRef(null)\n  const featureIdRef = useRef(-1)\n  const startPixel = useRef([0, 0])\n  const isDraggingRef = useRef(false)\n\n  const handleKeyDown = e => {\n    // Pan map (Cursor keys)\n    if (!e.altKey && offsets.pan[e.key.toUpperCase()]) {\n      e.preventDefault()\n      const offset = offsets[e.shiftKey ? 'shiftPan' : 'pan'][e.key.toUpperCase()]\n      provider.panBy(offset)\n    }\n\n    // Zoom map (+ or -)\n    if (['+', '-', '=', '_'].includes(e.key)) {\n      ['+', '='].includes(e.key) ? provider.zoomIn() : provider.zoomOut()\n    }\n\n    // Select feature or query centre (Enter or Space)\n    if (['Enter', 'Space'].includes(e.key)) {\n      if (mode !== 'default') return\n      if (featureIdRef.current >= 0 && features.featuresInViewport?.length) {\n        const id = features.featuresInViewport[featureIdRef.current].id\n        provider.queryFeature(id)\n      } else if (!isMoving) {\n        const scale = size === 'large' ? 2 : 1\n        const point = getMapPixel(paddingBoxRef.current, scale)\n        provider.queryPoint(point)\n      }\n    }\n\n    // Cycle through feature list (PageUp and PageDown)\n    if (queryFeature && ['PageDown', 'PageUp'].includes(e.key) && features.featuresInViewport?.length >= 1) {\n      e.preventDefault()\n      const { featuresInViewport } = features\n      const selectedIndex = getSelectedIndex(e.key, featuresInViewport.length, featureIdRef.current)\n      featureIdRef.current = selectedIndex < featuresInViewport.length ? selectedIndex : 0\n      const status = getSelectedStatus(featuresInViewport, selectedIndex)\n      const id = featuresInViewport[selectedIndex]?.id || featuresInViewport[0]?.id\n      appDispatch({\n        type: 'SET_SELECTED',\n        featureId: id,\n        activePanel: null\n      })\n      // Debounce status update\n      debounceUpdateStatus(status)\n    }\n  }\n\n  const handleKeyUp = e => {\n    // Get map details (Alt + i)\n    if (provider.getNearest && e.altKey && e.code.slice(-1) === 'I') {\n      viewportDispatch({ type: 'CLEAR_STATUS' })\n      // Debounce place update\n      debounceUpdatePlace(centre)\n    }\n\n    // Open keyboard controls (Alt + k)\n    if (e.altKey && e.code.slice(-1) === 'K') {\n      appDispatch({ type: 'OPEN', data: 'KEYBOARD' })\n    }\n\n    // Feature shortcut keys (Alt + 1 - 9)\n    if (e.altKey && /^[1-9]$/.test(e.code.slice(-1))) {\n      const id = getShortcutKey(e, features?.featuresInViewport)\n      provider.queryFeature(id)\n    }\n\n    // Clear selected feature\n    if (['Escape', 'Esc'].includes(e.key)) {\n      e.preventDefault()\n      appDispatch({ type: 'SET_SELECTED', id: null })\n    }\n  }\n\n  const handleClick = e => {\n    if (mode !== 'default' || isDraggingRef.current) return\n    const { layerX, layerY } = e.nativeEvent\n    const scale = size === 'large' ? 2 : 1\n    const point = [layerX / scale, layerY / scale]\n    provider.queryPoint(point)\n  }\n\n  const handleMapLoad = e => {\n    eventBus.dispatch(parent, events.APP_READY, {\n      ...e.detail, mode, segments, layers, basemap, size\n    })\n  }\n\n  const handleMovestart = e => {\n    const isUserInitiated = e.detail.isUserInitiated\n    viewportDispatch({ type: 'MOVE_START', isUserInitiated })\n    if (!(isKeyboard && activePanel === 'INFO' && isUserInitiated)) return\n    appDispatch({ type: 'CLOSE' })\n  }\n\n  const handlePointerDown = e => {\n    startPixel.current = [e.pageX, e.pageY]\n    isDraggingRef.current = false\n  }\n\n  const handlePointerUp = e => {\n    const diffX = Math.abs(e.pageX - startPixel.current[0])\n    const diffY = Math.abs(e.pageY - startPixel.current[1])\n    isDraggingRef.current = diffX >= offsets.drag || diffY >= offsets.drag\n  }\n\n  // Get new bbox after map moveend\n  const handleUpdate = e => {\n    viewportDispatch({ type: 'UPDATE', detail: e.detail })\n  }\n\n  // Provider map click\n  const handleMapQuery = e => {\n    const { resultType } = e.detail\n    const { items, isPixelFeaturesAtPixel, coord } = e.detail.features\n    const selectedId = resultType === 'feature' && items.length ? items[0].id : null\n    const targetMarker = resultType === 'pixel' ? { coord, hasData: isPixelFeaturesAtPixel } : null\n    appDispatch({\n      type: 'SET_SELECTED',\n      featureId: selectedId,\n      targetMarker,\n      activePanelHasFocus: true\n    })\n    eventBus.dispatch(parent, events.APP_QUERY, e.detail)\n  }\n\n  // Provider style change\n  const handleMapStyle = e => {\n    eventBus.dispatch(parent, events.APP_CHANGE, { ...e.detail, size, mode, segments, layers })\n  }\n\n  // Update place\n  const debounceUpdatePlace = debounce(async (centre) => {\n    const place = await provider.getNearest(centre)\n    viewportDispatch({ type: 'UPDATE_PLACE', place })\n  }, 300)\n\n  // Update status\n  const debounceUpdateStatus = debounce(status => {\n    viewportDispatch({ type: 'UPDATE_STATUS', status, isStatusVisuallyHidden: true })\n  }, 300)\n\n  // Template properties\n  const isFocusVisible = isKeyboard && document.activeElement === viewportRef.current\n  const isDarkBasemap = ['dark', 'aerial'].includes(basemap)\n\n  // Initial render\n  useEffect(() => {\n    if (isContainerReady && !provider.map) {\n      provider.init({\n        target: mapContainerRef.current,\n        paddingBox: paddingBoxRef.current,\n        frame: frameRef.current,\n        bbox,\n        centre,\n        zoom,\n        minZoom,\n        maxZoom,\n        basemap,\n        size,\n        featureLayers: queryFeature || [],\n        pixelLayers: queryPixel || []\n      })\n\n      provider.addEventListener('load', handleMapLoad)\n      provider.addEventListener('update', handleUpdate)\n      provider.addEventListener('mapquery', handleMapQuery)\n    }\n\n    // We need to know if open was triggered by the button\n    if (document.querySelector('[data-fm-open]')) {\n      activeRef.current = viewportRef.current\n    }\n\n    return () => {\n      provider.removeEventListener('load', handleMapLoad)\n      provider.removeEventListener('update', handleUpdate)\n      provider.removeEventListener('mapquery', handleMapQuery)\n      provider?.remove()\n    }\n  }, [isContainerReady])\n\n  // Add movestart event listner each time activePanel changes\n  useEffect(() => {\n    provider.addEventListener('movestart', handleMovestart)\n\n    return () => {\n      provider.removeEventListener('movestart', handleMovestart)\n    }\n  }, [isKeyboard, activePanel])\n\n  // Handle viewport action\n  useEffect(() => {\n    provider.addEventListener('style', handleMapStyle)\n\n    switch (action) {\n      case 'SEARCH':\n        bbox ? provider.fitBbox(bbox) : provider.setCentre(centre, zoom)\n        break\n      case 'RESET':\n        provider.setCentre(oCentre, rZoom)\n        break\n      case 'GEOLOC':\n        provider.setCentre(centre, oZoom)\n        provider.showLocation(centre)\n        break\n      case 'ZOOM_IN':\n        provider.zoomIn()\n        break\n      case 'ZOOM_OUT':\n        provider.zoomOut()\n        break\n      case 'SIZE':\n        window.localStorage.setItem('size', size)\n        provider.setSize(size)\n        break\n      case 'BASEMAP':\n        window.localStorage.setItem('basemap', `${basemap},${isDarkMode ? 'dark' : 'light'}`)\n        provider.setBasemap(basemap)\n        break\n    }\n\n    return () => {\n      provider.removeEventListener('style', handleMapStyle)\n    }\n  }, [timestamp, action, mode, basemap, size])\n\n  // All query params, debounced by provider. Must be min 300ms\n  useEffect(() => {\n    if (!isUpdate) return\n    setQueryCz(`${centre.toString()},${zoom}`)\n  }, [isUpdate])\n\n  // Swap basemap on light/dark mode change\n  useEffect(() => {\n    if (!provider.map) return\n\n    const basemap = setBasemap(isDarkMode)\n    viewportDispatch({ type: 'SET_BASEMAP', basemap })\n  }, [isDarkMode])\n\n  // Set initial selected feature or target\n  useEffect(() => {\n    provider.selectFeature(featureId)\n    // Update query params\n    setQueryId(featureId || '')\n    const queryTarget = targetMarker ? Object.keys(targetMarker).map(k => { return targetMarker[k] }).join(',') : ''\n    setQueryTarget(queryTarget)\n  }, [featureId, targetMarker])\n\n  return (\n    <div\n      id={`${id}-viewport`}\n      className={`fm-o-viewport${size !== 'small' ? ' fm-o-viewport--' + size : ''}${isDarkBasemap ? ' fm-o-viewport--dark-basemap' : ''}${isFocusVisible ? ' fm-u-focus-visible' : ''}`}\n      role='application'\n      aria-labelledby={`${id}-viewport-label`}\n      onClick={handleClick}\n      onKeyDown={handleKeyDown}\n      onKeyUp={handleKeyUp}\n      onPointerDown={handlePointerDown}\n      onPointerUp={handlePointerUp}\n      {...(featureId ? { 'aria-activedescendant': `${id}-feature-${featureId}` } : {})}\n      aria-owns={`${id}-viewport-features`}\n      tabIndex='0'\n      ref={viewportRef}\n      data-fm-viewport\n    >\n      <div id={`${id}-map-container`} className='fm-o-map-container' ref={mapContainerRef} />\n      <PaddingBox>\n        <Target />\n      </PaddingBox>\n      <ul id={`${id}-viewport-features`} className='fm-u-visually-hidden' role='listbox' aria-labelledby={`${id}-viewport-label`}>\n        {features?.featuresInViewport.map((feature, i) => {\n          return (\n            <li key={i} id={`${id}-feature-${feature.id}`} role='option' aria-selected={featureId === (feature.id)} aria-setsize='-1' tabIndex='-1'>{feature.name}</li>\n          )\n        })}\n      </ul>\n      {useMemo(() => {\n        return (\n          <Status message={status} isVisuallyHidden={isStatusVisuallyHidden} />\n        )\n      }, [status])}\n    </div>\n  )\n}\n","import React from 'react'\nimport { useApp } from '../store/use-app'\n\nexport default function Exit () {\n  const { options, isBack, handleExit, isDesktop } = useApp()\n\n  const isFixed = options.legend.display !== 'inset' && isDesktop\n\n  const Path = ({ isBack, isFixed }) => {\n    if (isBack && isFixed) {\n      return (\n        <path d='M10,8.6L15.6,3L17,4.4L11.4,10L17,15.6L15.6,17L10,11.4L4.4,17L3,15.6L8.6,10L3,4.4L4.4,3L10,8.6Z' fill='currentColor' strokeWidth='0' />\n      )\n    } else if (isBack && !isFixed) {\n      return (\n        <path d='M10.193,17.777l-7.778,-7.777l7.778,-7.778l1.414,1.414l-6.364,6.364l6.364,6.363l-1.414,1.414Z' fill='currentColor' strokeWidth='0' />\n      )\n    } else {\n      return (\n        <path d='M3.828 10l8.486 8.485-1.415 1.414L1 10 10.899.101l1.415 1.414L3.828 10z' fill='currentColor' strokeWidth='0' />\n      )\n    }\n  }\n\n  return (\n    <button onClick={handleExit} className='fm-c-btn fm-c-btn--exit govuk-body-s'>\n      <svg aria-hidden='true' focusable='false' width={isBack ? '14' : '20'} height='20' viewBox={isBack ? '0 0 14 20' : '0 0 20 20'}>\n        <Path isBack={isBack} isFixed={isFixed} />\n      </svg>\n      <span className='fm-c-btn__label'>{isBack ? 'Back' : 'Exit'}</span>\n    </button>\n  )\n}\n","import { useEffect } from 'react'\n\n/**\n * Hook that alerts clicks outside of the passed ref\n */\nexport const useOutsideInteract = (ref, type, callback) => {\n  useEffect(() => {\n    /**\n     * Alert if clicked on outside of element\n     */\n    function handleInteractOutside (e) {\n      if (ref.current && document.contains(e.target) && !ref.current.contains(e.target)) {\n        callback(e)\n      }\n    }\n    // Bind the event listener\n    document.addEventListener(type, handleInteractOutside)\n    return () => {\n      // Unbind the event listener on clean up\n      document.removeEventListener(type, handleInteractOutside)\n    }\n  }, [ref])\n}\n","export const createMessage = (suggestions, selected) => {\n  let message = suggestions?.length\n    ? `${suggestions.length} result${suggestions.length !== 0 ? 's' : ''} are available.`\n    : 'No results are available.'\n  message += suggestions?.length && selected >= 0\n    ? ` ${suggestions[selected].text}. ${selected + 1} of ${suggestions.length} is highlighted.`\n    : ''\n  return message\n}\n","import { createMessage } from '../lib/search'\n\nexport const initialState = {\n  isVisible: false,\n  isExpanded: false,\n  isFocusWithin: false,\n  isFocusVisibleWithin: false,\n  selected: -1,\n  suggestions: [],\n  value: '',\n  message: '',\n  status: ''\n}\n\nexport const reducer = (state, action) => {\n  switch (action.type) {\n    case 'EXPAND':\n      return {\n        ...state,\n        isExpanded: true,\n        activeRef: action.activeRef\n      }\n    case 'COLLAPSE':\n      return {\n        ...state,\n        isExpanded: false,\n        activeRef: action.activeRef\n      }\n    case 'FOCUS':\n      return {\n        ...state,\n        isVisible: true,\n        isFocusWithin: true,\n        isFocusVisibleWithin: action.isKeyboard,\n        activeRef: null\n      }\n    case 'BLUR':\n      return {\n        ...state,\n        isVisible: false,\n        isFocusWithin: false,\n        isFocusVisibleWithin: false\n      }\n    case 'MOUSEENTER':\n      return {\n        ...state,\n        selected: -1\n      }\n    case 'CLICK':\n      return {\n        ...state,\n        isVisible: true,\n        isFocusVisibleWithin: action.isKeyboard,\n        activeRef: action.activeRef\n      }\n    case 'CHANGE': {\n      const value = action.value\n      let suggestions = []\n      if (value.length < 3) {\n        suggestions = state.suggestions\n      }\n      return {\n        ...state,\n        suggestions,\n        value,\n        message: createMessage(suggestions, -1),\n        isVisible: value.length >= 3\n      }\n    }\n    case 'ADD_SUGGESTIONS':\n      return {\n        ...state,\n        suggestions: action.suggestions,\n        message: createMessage(action.suggestions, -1)\n      }\n    case 'HIDE_SUGGESTIONS':\n      return {\n        ...state,\n        isVisible: false,\n        message: createMessage(state.suggestions, -1),\n        selected: -1\n      }\n    case 'REVIEW': {\n      let index\n      if (action.key === 'ArrowDown') {\n        index = state.selected === state.suggestions.length - 1 ? state.selected : state.selected + 1\n      } else {\n        index = state.selected > 0 ? state.selected - 1 : -1\n      }\n      return {\n        ...state,\n        isVisible: true,\n        selected: index,\n        message: createMessage(state.suggestions, index),\n        status: ''\n      }\n    }\n    case 'SUBMIT':\n      return {\n        ...state,\n        isVisible: false,\n        value: action.value,\n        message: `${state.isVisible ? 'Collapsed ' : ''}${state.selected >= 0 ? 'Completion selected' : ''}`,\n        selected: -1\n      }\n    case 'CLEAR':\n      return {\n        ...state,\n        isVisible: false,\n        value: '',\n        suggestions: [],\n        activeRef: action.activeRef,\n        message: 'No suggestions',\n        isFocusVisibleWithin: action.isFocusVisibleWithin\n      }\n    case 'CLEAR_STATUS':\n      return {\n        ...state,\n        status: ''\n      }\n    case 'UPDATE_STATUS':\n      return {\n        ...state,\n        status: state.message\n      }\n    default:\n      return state\n  }\n}\n","import React, { useRef, useEffect, useMemo } from 'react'\nimport { debounce } from '../lib/debounce'\nimport Status from './status.jsx'\n\nexport default function Autocomplete ({ id, state, dispatch, provider, updateViewport }) {\n  const selectedRef = useRef()\n\n  const { value, selected } = state\n\n  const debounceUpdateSuggest = debounce(async (value) => {\n    const items = await provider.suggest(value)\n    dispatch({ type: 'ADD_SUGGESTIONS', suggestions: items })\n    updateStatus()\n  }, 350)\n\n  const debounceUpdateStatus = debounce(() => {\n    dispatch({ type: 'UPDATE_STATUS' })\n  }, 500)\n\n  const updateStatus = () => {\n    dispatch({ type: 'CLEAR_STATUS' })\n    debounceUpdateStatus()\n  }\n\n  const handleOnMouseDown = (e, i) => {\n    e.preventDefault()\n    const value = state.suggestions[i].text\n    const id = state.suggestions[i].id\n    dispatch({ type: 'SUBMIT', value })\n    updateViewport(value, id)\n  }\n\n  useEffect(() => {\n    updateStatus()\n  }, [state.isVisible])\n\n  useEffect(() => {\n    updateStatus()\n    setTimeout(() => selectedRef.current?.scrollIntoView(false), 0)\n  }, [selected])\n\n  useEffect(() => {\n    value.length >= 3 ? debounceUpdateSuggest(value) : updateStatus()\n  }, [value])\n\n  return (\n    <div className='fm-c-search__suggestions' {...(!state.isVisible ? { style: { display: 'none' } } : {})} onMouseEnter={() => dispatch({ type: 'MOUSEENTER' })}>\n      {useMemo(() => {\n        return (\n          <Status isVisuallyHidden message={state.status} cache={(new Date()).getTime()} />\n        )\n      }, [state.status])}\n      <ul id={`${id}-suggestions`} role='listbox' aria-labelledby={`${id}-search`} className='fm-c-search__list'>\n        {state.suggestions.map((item, i) =>\n          <li key={item.id} ref={state.selected === i ? selectedRef : null} className={`fm-c-search-item${state.selected === i ? ' fm-c-search-item--selected' : ''} govuk-body-s`} onMouseDown={e => handleOnMouseDown(e, i)} role='option' aria-selected={state.selected === i} aria-posinset={i + 1} aria-setsize={state.suggestions.length} tabIndex='-1'>\n            <span className='fm-c-search-item__primary' dangerouslySetInnerHTML={item.marked} />\n          </li>)}\n      </ul>\n    </div>\n  )\n}\n","/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  */\n/* Vector handling functions                                          (c) Chris Veness 2011-2019  */\n/*                                                                                   MIT Licence  */\n/* www.movable-type.co.uk/scripts/geodesy-library.html#vector3d                                   */\n/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  */\n\n\n/**\n * Library of 3-d vector manipulation routines.\n *\n * @module vector3d\n */\n\n\n/* Vector3d - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - */\n\n\n/**\n * Functions for manipulating generic 3-d vectors.\n *\n * Functions return vectors as return results, so that operations can be chained.\n *\n * @example\n *   const v = v1.cross(v2).dot(v3) // ≡ v1×v2⋅v3\n */\nclass Vector3d {\n\n    /**\n     * Creates a 3-d vector.\n     *\n     * @param {number} x - X component of vector.\n     * @param {number} y - Y component of vector.\n     * @param {number} z - Z component of vector.\n     *\n     * @example\n     *   import Vector3d from '/js/geodesy/vector3d.js';\n     *   const v = new Vector3d(0.267, 0.535, 0.802);\n     */\n    constructor(x, y, z) {\n        if (isNaN(x) || isNaN(y) || isNaN(z)) throw new TypeError(`invalid vector [${x},${y},${z}]`);\n\n        this.x = Number(x);\n        this.y = Number(y);\n        this.z = Number(z);\n    }\n\n\n    /**\n     * Length (magnitude or norm) of ‘this’ vector.\n     *\n     * @returns {number} Magnitude of this vector.\n     */\n    get length() {\n        return Math.sqrt(this.x * this.x + this.y * this.y + this.z * this.z);\n    }\n\n\n    /**\n     * Adds supplied vector to ‘this’ vector.\n     *\n     * @param   {Vector3d} v - Vector to be added to this vector.\n     * @returns {Vector3d} Vector representing sum of this and v.\n     */\n    plus(v) {\n        if (!(v instanceof Vector3d)) throw new TypeError('v is not Vector3d object');\n\n        return new Vector3d(this.x + v.x, this.y + v.y, this.z + v.z);\n    }\n\n\n    /**\n     * Subtracts supplied vector from ‘this’ vector.\n     *\n     * @param   {Vector3d} v - Vector to be subtracted from this vector.\n     * @returns {Vector3d} Vector representing difference between this and v.\n     */\n    minus(v) {\n        if (!(v instanceof Vector3d)) throw new TypeError('v is not Vector3d object');\n\n        return new Vector3d(this.x - v.x, this.y - v.y, this.z - v.z);\n    }\n\n\n    /**\n     * Multiplies ‘this’ vector by a scalar value.\n     *\n     * @param   {number}   x - Factor to multiply this vector by.\n     * @returns {Vector3d} Vector scaled by x.\n     */\n    times(x) {\n        if (isNaN(x)) throw new TypeError(`invalid scalar value ‘${x}’`);\n\n        return new Vector3d(this.x * x, this.y * x, this.z * x);\n    }\n\n\n    /**\n     * Divides ‘this’ vector by a scalar value.\n     *\n     * @param   {number}   x - Factor to divide this vector by.\n     * @returns {Vector3d} Vector divided by x.\n     */\n    dividedBy(x) {\n        if (isNaN(x)) throw new TypeError(`invalid scalar value ‘${x}’`);\n\n        return new Vector3d(this.x / x, this.y / x, this.z / x);\n    }\n\n\n    /**\n     * Multiplies ‘this’ vector by the supplied vector using dot (scalar) product.\n     *\n     * @param   {Vector3d} v - Vector to be dotted with this vector.\n     * @returns {number}   Dot product of ‘this’ and v.\n     */\n    dot(v) {\n        if (!(v instanceof Vector3d)) throw new TypeError('v is not Vector3d object');\n\n        return this.x * v.x + this.y * v.y + this.z * v.z;\n    }\n\n\n    /**\n     * Multiplies ‘this’ vector by the supplied vector using cross (vector) product.\n     *\n     * @param   {Vector3d} v - Vector to be crossed with this vector.\n     * @returns {Vector3d} Cross product of ‘this’ and v.\n     */\n    cross(v) {\n        if (!(v instanceof Vector3d)) throw new TypeError('v is not Vector3d object');\n\n        const x = this.y * v.z - this.z * v.y;\n        const y = this.z * v.x - this.x * v.z;\n        const z = this.x * v.y - this.y * v.x;\n\n        return new Vector3d(x, y, z);\n    }\n\n\n    /**\n     * Negates a vector to point in the opposite direction.\n     *\n     * @returns {Vector3d} Negated vector.\n     */\n    negate() {\n        return new Vector3d(-this.x, -this.y, -this.z);\n    }\n\n\n    /**\n     * Normalizes a vector to its unit vector\n     * – if the vector is already unit or is zero magnitude, this is a no-op.\n     *\n     * @returns {Vector3d} Normalised version of this vector.\n     */\n    unit() {\n        const norm = this.length;\n        if (norm == 1) return this;\n        if (norm == 0) return this;\n\n        const x = this.x / norm;\n        const y = this.y / norm;\n        const z = this.z / norm;\n\n        return new Vector3d(x, y, z);\n    }\n\n\n    /**\n     * Calculates the angle between ‘this’ vector and supplied vector atan2(|p₁×p₂|, p₁·p₂) (or if\n     * (extra-planar) ‘n’ supplied then atan2(n·p₁×p₂, p₁·p₂).\n     *\n     * @param   {Vector3d} v - Vector whose angle is to be determined from ‘this’ vector.\n     * @param   {Vector3d} [n] - Plane normal: if supplied, angle is signed +ve if this->v is\n     *                     clockwise looking along n, -ve in opposite direction.\n     * @returns {number}   Angle (in radians) between this vector and supplied vector (in range 0..π\n     *                     if n not supplied, range -π..+π if n supplied).\n     */\n    angleTo(v, n=undefined) {\n        if (!(v instanceof Vector3d)) throw new TypeError('v is not Vector3d object');\n        if (!(n instanceof Vector3d || n == undefined)) throw new TypeError('n is not Vector3d object');\n\n        // q.v. stackoverflow.com/questions/14066933#answer-16544330, but n·p₁×p₂ is numerically\n        // ill-conditioned, so just calculate sign to apply to |p₁×p₂|\n\n        // if n·p₁×p₂ is -ve, negate |p₁×p₂|\n        const sign = n==undefined || this.cross(v).dot(n)>=0 ? 1 : -1;\n\n        const sinθ = this.cross(v).length * sign;\n        const cosθ = this.dot(v);\n\n        return Math.atan2(sinθ, cosθ);\n    }\n\n\n    /**\n     * Rotates ‘this’ point around an axis by a specified angle.\n     *\n     * @param   {Vector3d} axis - The axis being rotated around.\n     * @param   {number}   angle - The angle of rotation (in degrees).\n     * @returns {Vector3d} The rotated point.\n     */\n    rotateAround(axis, angle) {\n        if (!(axis instanceof Vector3d)) throw new TypeError('axis is not Vector3d object');\n\n        const θ = angle.toRadians();\n\n        // en.wikipedia.org/wiki/Rotation_matrix#Rotation_matrix_from_axis_and_angle\n        // en.wikipedia.org/wiki/Quaternions_and_spatial_rotation#Quaternion-derived_rotation_matrix\n        const p = this.unit();\n        const a = axis.unit();\n\n        const s = Math.sin(θ);\n        const c = Math.cos(θ);\n        const t = 1-c;\n        const x = a.x, y = a.y, z = a.z;\n\n        const r = [ // rotation matrix for rotation about supplied axis\n            [ t*x*x + c,   t*x*y - s*z, t*x*z + s*y ],\n            [ t*x*y + s*z, t*y*y + c,   t*y*z - s*x ],\n            [ t*x*z - s*y, t*y*z + s*x, t*z*z + c   ],\n        ];\n\n        // multiply r × p\n        const rp = [\n            r[0][0]*p.x + r[0][1]*p.y + r[0][2]*p.z,\n            r[1][0]*p.x + r[1][1]*p.y + r[1][2]*p.z,\n            r[2][0]*p.x + r[2][1]*p.y + r[2][2]*p.z,\n        ];\n        const p2 = new Vector3d(rp[0], rp[1], rp[2]);\n\n        return p2;\n        // qv en.wikipedia.org/wiki/Rodrigues'_rotation_formula...\n    }\n\n\n    /**\n     * String representation of vector.\n     *\n     * @param   {number} [dp=3] - Number of decimal places to be used.\n     * @returns {string} Vector represented as [x,y,z].\n     */\n    toString(dp=3) {\n        return `[${this.x.toFixed(dp)},${this.y.toFixed(dp)},${this.z.toFixed(dp)}]`;\n    }\n\n}\n\n\n// Extend Number object with methods to convert between degrees & radians\nNumber.prototype.toRadians = function() { return this * Math.PI / 180; };\nNumber.prototype.toDegrees = function() { return this * 180 / Math.PI; };\n\n/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  */\n\nexport default Vector3d;\n","/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  */\n/* Geodesy tools for an ellipsoidal earth model                       (c) Chris Veness 2005-2022  */\n/*                                                                                   MIT Licence  */\n/* Core class for latlon-ellipsoidal-datum & latlon-ellipsoidal-referenceframe.                   */\n/*                                                                                                */\n/* www.movable-type.co.uk/scripts/latlong-convert-coords.html                                     */\n/* www.movable-type.co.uk/scripts/geodesy-library.html#latlon-ellipsoidal                         */\n/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  */\n\nimport Dms      from './dms.js';\nimport Vector3d from './vector3d.js';\n\n\n/**\n * A latitude/longitude point defines a geographic location on or above/below the earth’s surface,\n * measured in degrees from the equator & the International Reference Meridian and in metres above\n * the ellipsoid, and based on a given datum.\n *\n * As so much modern geodesy is based on WGS-84 (as used by GPS), this module includes WGS-84\n * ellipsoid parameters, and it has methods for converting geodetic (latitude/longitude) points to/from\n * geocentric cartesian points; the latlon-ellipsoidal-datum and latlon-ellipsoidal-referenceframe\n * modules provide transformation parameters for converting between historical datums and between\n * modern reference frames.\n *\n * This module is used for both trigonometric geodesy (eg latlon-ellipsoidal-vincenty) and n-vector\n * geodesy (eg latlon-nvector-ellipsoidal), and also for UTM/MGRS mapping.\n *\n * @module latlon-ellipsoidal\n */\n\n\n/*\n * Ellipsoid parameters; exposed through static getter below.\n *\n * The only ellipsoid defined is WGS84, for use in utm/mgrs, vincenty, nvector.\n */\nconst ellipsoids = {\n    WGS84: { a: 6378137, b: 6356752.314245, f: 1/298.257223563 },\n};\n\n\n/*\n * Datums; exposed through static getter below.\n *\n * The only datum defined is WGS84, for use in utm/mgrs, vincenty, nvector.\n */\nconst datums = {\n    WGS84: { ellipsoid: ellipsoids.WGS84 },\n};\n\n\n// freeze static properties\nObject.freeze(ellipsoids.WGS84);\nObject.freeze(datums.WGS84);\n\n\n/* LatLonEllipsoidal - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  */\n\n\n/**\n * Latitude/longitude points on an ellipsoidal model earth, with ellipsoid parameters and methods\n * for converting points to/from cartesian (ECEF) coordinates.\n *\n * This is the core class, which will usually be used via LatLonEllipsoidal_Datum or\n * LatLonEllipsoidal_ReferenceFrame.\n */\nclass LatLonEllipsoidal {\n\n    /**\n     * Creates a geodetic latitude/longitude point on a (WGS84) ellipsoidal model earth.\n     *\n     * @param  {number} lat - Latitude (in degrees).\n     * @param  {number} lon - Longitude (in degrees).\n     * @param  {number} [height=0] - Height above ellipsoid in metres.\n     * @throws {TypeError} Invalid lat/lon/height.\n     *\n     * @example\n     *   import LatLon from '/js/geodesy/latlon-ellipsoidal.js';\n     *   const p = new LatLon(51.47788, -0.00147, 17);\n     */\n    constructor(lat, lon, height=0) {\n        if (isNaN(lat) || lat == null) throw new TypeError(`invalid lat ‘${lat}’`);\n        if (isNaN(lon) || lon == null) throw new TypeError(`invalid lon ‘${lon}’`);\n        if (isNaN(height) || height == null) throw new TypeError(`invalid height ‘${height}’`);\n\n        this._lat = Dms.wrap90(Number(lat));\n        this._lon = Dms.wrap180(Number(lon));\n        this._height = Number(height);\n    }\n\n\n    /**\n     * Latitude in degrees north from equator (including aliases lat, latitude): can be set as\n     * numeric or hexagesimal (deg-min-sec); returned as numeric.\n     */\n    get lat()       { return this._lat; }\n    get latitude()  { return this._lat; }\n    set lat(lat) {\n        this._lat = isNaN(lat) ? Dms.wrap90(Dms.parse(lat)) : Dms.wrap90(Number(lat));\n        if (isNaN(this._lat)) throw new TypeError(`invalid lat ‘${lat}’`);\n    }\n    set latitude(lat) {\n        this._lat = isNaN(lat) ? Dms.wrap90(Dms.parse(lat)) : Dms.wrap90(Number(lat));\n        if (isNaN(this._lat)) throw new TypeError(`invalid latitude ‘${lat}’`);\n    }\n\n    /**\n     * Longitude in degrees east from international reference meridian (including aliases lon, lng,\n     * longitude): can be set as numeric or hexagesimal (deg-min-sec); returned as numeric.\n     */\n    get lon()       { return this._lon; }\n    get lng()       { return this._lon; }\n    get longitude() { return this._lon; }\n    set lon(lon) {\n        this._lon = isNaN(lon) ? Dms.wrap180(Dms.parse(lon)) : Dms.wrap180(Number(lon));\n        if (isNaN(this._lon)) throw new TypeError(`invalid lon ‘${lon}’`);\n    }\n    set lng(lon) {\n        this._lon = isNaN(lon) ? Dms.wrap180(Dms.parse(lon)) : Dms.wrap180(Number(lon));\n        if (isNaN(this._lon)) throw new TypeError(`invalid lng ‘${lon}’`);\n    }\n    set longitude(lon) {\n        this._lon = isNaN(lon) ? Dms.wrap180(Dms.parse(lon)) : Dms.wrap180(Number(lon));\n        if (isNaN(this._lon)) throw new TypeError(`invalid longitude ‘${lon}’`);\n    }\n\n    /**\n     * Height in metres above ellipsoid.\n     */\n    get height()       { return this._height; }\n    set height(height) { this._height = Number(height); if (isNaN(this._height)) throw new TypeError(`invalid height ‘${height}’`); }\n\n\n    /**\n     * Datum.\n     *\n     * Note this is replicated within LatLonEllipsoidal in order that a LatLonEllipsoidal object can\n     * be monkey-patched to look like a LatLonEllipsoidal_Datum, for Vincenty calculations on\n     * different ellipsoids.\n     *\n     * @private\n     */\n    get datum()      { return this._datum; }\n    set datum(datum) { this._datum = datum; }\n\n\n    /**\n     * Ellipsoids with their parameters; this module only defines WGS84 parameters a = 6378137, b =\n     * 6356752.314245, f = 1/298.257223563.\n     *\n     * @example\n     *   const a = LatLon.ellipsoids.WGS84.a; // 6378137\n     */\n    static get ellipsoids() {\n        return ellipsoids;\n    }\n\n    /**\n     * Datums; this module only defines WGS84 datum, hence no datum transformations.\n     *\n     * @example\n     *   const a = LatLon.datums.WGS84.ellipsoid.a; // 6377563.396\n     */\n    static get datums() {\n        return datums;\n    }\n\n\n    /**\n     * Parses a latitude/longitude point from a variety of formats.\n     *\n     * Latitude & longitude (in degrees) can be supplied as two separate parameters, as a single\n     * comma-separated lat/lon string, or as a single object with { lat, lon } or GeoJSON properties.\n     *\n     * The latitude/longitude values may be numeric or strings; they may be signed decimal or\n     * deg-min-sec (hexagesimal) suffixed by compass direction (NSEW); a variety of separators are\n     * accepted. Examples -3.62, '3 37 12W', '3°37′12″W'.\n     *\n     * Thousands/decimal separators must be comma/dot; use Dms.fromLocale to convert locale-specific\n     * thousands/decimal separators.\n     *\n     * @param   {number|string|Object} lat|latlon - Latitude (in degrees), or comma-separated lat/lon, or lat/lon object.\n     * @param   {number}               [lon]      - Longitude (in degrees).\n     * @param   {number}               [height=0] - Height above ellipsoid in metres.\n     * @returns {LatLon} Latitude/longitude point on WGS84 ellipsoidal model earth.\n     * @throws  {TypeError} Invalid coordinate.\n     *\n     * @example\n     *   const p1 = LatLon.parse(51.47788, -0.00147);              // numeric pair\n     *   const p2 = LatLon.parse('51°28′40″N, 000°00′05″W', 17);   // dms string + height\n     *   const p3 = LatLon.parse({ lat: 52.205, lon: 0.119 }, 17); // { lat, lon } object numeric + height\n     */\n    static parse(...args) {\n        if (args.length == 0) throw new TypeError('invalid (empty) point');\n\n        let lat=undefined, lon=undefined, height=undefined;\n\n        // single { lat, lon } object\n        if (typeof args[0]=='object' && (args.length==1 || !isNaN(parseFloat(args[1])))) {\n            const ll = args[0];\n            if (ll.type == 'Point' && Array.isArray(ll.coordinates)) { // GeoJSON\n                [ lon, lat, height ] = ll.coordinates;\n                height = height || 0;\n            } else { // regular { lat, lon } object\n                if (ll.latitude  != undefined) lat = ll.latitude;\n                if (ll.lat       != undefined) lat = ll.lat;\n                if (ll.longitude != undefined) lon = ll.longitude;\n                if (ll.lng       != undefined) lon = ll.lng;\n                if (ll.lon       != undefined) lon = ll.lon;\n                if (ll.height    != undefined) height = ll.height;\n                lat = Dms.wrap90(Dms.parse(lat));\n                lon = Dms.wrap180(Dms.parse(lon));\n            }\n            if (args[1] != undefined) height = args[1];\n            if (isNaN(lat) || isNaN(lon)) throw new TypeError(`invalid point ‘${JSON.stringify(args[0])}’`);\n        }\n\n        // single comma-separated lat/lon\n        if (typeof args[0] == 'string' && args[0].split(',').length == 2) {\n            [ lat, lon ] = args[0].split(',');\n            lat = Dms.wrap90(Dms.parse(lat));\n            lon = Dms.wrap180(Dms.parse(lon));\n            height = args[1] || 0;\n            if (isNaN(lat) || isNaN(lon)) throw new TypeError(`invalid point ‘${args[0]}’`);\n        }\n\n        // regular (lat, lon) arguments\n        if (lat==undefined && lon==undefined) {\n            [ lat, lon ] = args;\n            lat = Dms.wrap90(Dms.parse(lat));\n            lon = Dms.wrap180(Dms.parse(lon));\n            height = args[2] || 0;\n            if (isNaN(lat) || isNaN(lon)) throw new TypeError(`invalid point ‘${args.toString()}’`);\n        }\n\n        return new this(lat, lon, height); // 'new this' as may return subclassed types\n    }\n\n\n    /**\n     * Converts ‘this’ point from (geodetic) latitude/longitude coordinates to (geocentric)\n     * cartesian (x/y/z) coordinates.\n     *\n     * @returns {Cartesian} Cartesian point equivalent to lat/lon point, with x, y, z in metres from\n     *   earth centre.\n     */\n    toCartesian() {\n        // x = (ν+h)⋅cosφ⋅cosλ, y = (ν+h)⋅cosφ⋅sinλ, z = (ν⋅(1-e²)+h)⋅sinφ\n        // where ν = a/√(1−e²⋅sinφ⋅sinφ), e² = (a²-b²)/a² or (better conditioned) 2⋅f-f²\n        const ellipsoid = this.datum\n            ? this.datum.ellipsoid\n            : this.referenceFrame ? this.referenceFrame.ellipsoid : ellipsoids.WGS84;\n\n        const φ = this.lat.toRadians();\n        const λ = this.lon.toRadians();\n        const h = this.height;\n        const { a, f } = ellipsoid;\n\n        const sinφ = Math.sin(φ), cosφ = Math.cos(φ);\n        const sinλ = Math.sin(λ), cosλ = Math.cos(λ);\n\n        const eSq = 2*f - f*f;                      // 1st eccentricity squared ≡ (a²-b²)/a²\n        const ν = a / Math.sqrt(1 - eSq*sinφ*sinφ); // radius of curvature in prime vertical\n\n        const x = (ν+h) * cosφ * cosλ;\n        const y = (ν+h) * cosφ * sinλ;\n        const z = (ν*(1-eSq)+h) * sinφ;\n\n        return new Cartesian(x, y, z);\n    }\n\n\n    /**\n     * Checks if another point is equal to ‘this’ point.\n     *\n     * @param   {LatLon} point - Point to be compared against this point.\n     * @returns {bool} True if points have identical latitude, longitude, height, and datum/referenceFrame.\n     * @throws  {TypeError} Invalid point.\n     *\n     * @example\n     *   const p1 = new LatLon(52.205, 0.119);\n     *   const p2 = new LatLon(52.205, 0.119);\n     *   const equal = p1.equals(p2); // true\n     */\n    equals(point) {\n        if (!(point instanceof LatLonEllipsoidal)) throw new TypeError(`invalid point ‘${point}’`);\n\n        if (Math.abs(this.lat - point.lat) > Number.EPSILON) return false;\n        if (Math.abs(this.lon - point.lon) > Number.EPSILON) return false;\n        if (Math.abs(this.height - point.height) > Number.EPSILON) return false;\n        if (this.datum != point.datum) return false;\n        if (this.referenceFrame != point.referenceFrame) return false;\n        if (this.epoch != point.epoch) return false;\n\n        return true;\n    }\n\n\n    /**\n     * Returns a string representation of ‘this’ point, formatted as degrees, degrees+minutes, or\n     * degrees+minutes+seconds.\n     *\n     * @param   {string} [format=d] - Format point as 'd', 'dm', 'dms', or 'n' for signed numeric.\n     * @param   {number} [dp=4|2|0] - Number of decimal places to use: default 4 for d, 2 for dm, 0 for dms.\n     * @param   {number} [dpHeight=null] - Number of decimal places to use for height; default is no height display.\n     * @returns {string} Comma-separated formatted latitude/longitude.\n     * @throws  {RangeError} Invalid format.\n     *\n     * @example\n     *   const greenwich = new LatLon(51.47788, -0.00147, 46);\n     *   const d = greenwich.toString();                        // 51.4779°N, 000.0015°W\n     *   const dms = greenwich.toString('dms', 2);              // 51°28′40″N, 000°00′05″W\n     *   const [lat, lon] = greenwich.toString('n').split(','); // 51.4779, -0.0015\n     *   const dmsh = greenwich.toString('dms', 0, 0);          // 51°28′40″N, 000°00′06″W +46m\n     */\n    toString(format='d', dp=undefined, dpHeight=null) {\n        // note: explicitly set dp to undefined for passing through to toLat/toLon\n        if (![ 'd', 'dm', 'dms', 'n' ].includes(format)) throw new RangeError(`invalid format ‘${format}’`);\n\n        const height = (this.height>=0 ? ' +' : ' ') + this.height.toFixed(dpHeight) + 'm';\n        if (format == 'n') { // signed numeric degrees\n            if (dp == undefined) dp = 4;\n            const lat = this.lat.toFixed(dp);\n            const lon = this.lon.toFixed(dp);\n            return `${lat}, ${lon}${dpHeight==null ? '' : height}`;\n        }\n\n        const lat = Dms.toLat(this.lat, format, dp);\n        const lon = Dms.toLon(this.lon, format, dp);\n\n        return `${lat}, ${lon}${dpHeight==null ? '' : height}`;\n    }\n\n}\n\n\n/* Cartesian  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - */\n\n\n/**\n * ECEF (earth-centered earth-fixed) geocentric cartesian coordinates.\n *\n * @extends Vector3d\n */\nclass Cartesian extends Vector3d {\n\n    /**\n     * Creates cartesian coordinate representing ECEF (earth-centric earth-fixed) point.\n     *\n     * @param {number} x - X coordinate in metres (=> 0°N,0°E).\n     * @param {number} y - Y coordinate in metres (=> 0°N,90°E).\n     * @param {number} z - Z coordinate in metres (=> 90°N).\n     *\n     * @example\n     *   import { Cartesian } from '/js/geodesy/latlon-ellipsoidal.js';\n     *   const coord = new Cartesian(3980581.210, -111.159, 4966824.522);\n     */\n    constructor(x, y, z) {\n        super(x, y, z); // arguably redundant constructor, but specifies units & axes\n    }\n\n\n    /**\n     * Converts ‘this’ (geocentric) cartesian (x/y/z) coordinate to (geodetic) latitude/longitude\n     * point on specified ellipsoid.\n     *\n     * Uses Bowring’s (1985) formulation for μm precision in concise form; ‘The accuracy of geodetic\n     * latitude and height equations’, B R Bowring, Survey Review vol 28, 218, Oct 1985.\n     *\n     * @param   {LatLon.ellipsoids} [ellipsoid=WGS84] - Ellipsoid to use when converting point.\n     * @returns {LatLon} Latitude/longitude point defined by cartesian coordinates, on given ellipsoid.\n     * @throws  {TypeError} Invalid ellipsoid.\n     *\n     * @example\n     *   const c = new Cartesian(4027893.924, 307041.993, 4919474.294);\n     *   const p = c.toLatLon(); // 50.7978°N, 004.3592°E\n     */\n    toLatLon(ellipsoid=ellipsoids.WGS84) {\n        // note ellipsoid is available as a parameter for when toLatLon gets subclassed to\n        // Ellipsoidal_Datum / Ellipsoidal_Referenceframe.\n        if (!ellipsoid || !ellipsoid.a) throw new TypeError(`invalid ellipsoid ‘${ellipsoid}’`);\n\n        const { x, y, z } = this;\n        const { a, b, f } = ellipsoid;\n\n        const e2 = 2*f - f*f;           // 1st eccentricity squared ≡ (a²−b²)/a²\n        const ε2 = e2 / (1-e2);         // 2nd eccentricity squared ≡ (a²−b²)/b²\n        const p = Math.sqrt(x*x + y*y); // distance from minor axis\n        const R = Math.sqrt(p*p + z*z); // polar radius\n\n        // parametric latitude (Bowring eqn.17, replacing tanβ = z·a / p·b)\n        const tanβ = (b*z)/(a*p) * (1+ε2*b/R);\n        const sinβ = tanβ / Math.sqrt(1+tanβ*tanβ);\n        const cosβ = sinβ / tanβ;\n\n        // geodetic latitude (Bowring eqn.18: tanφ = z+ε²⋅b⋅sin³β / p−e²⋅cos³β)\n        const φ = isNaN(cosβ) ? 0 : Math.atan2(z + ε2*b*sinβ*sinβ*sinβ, p - e2*a*cosβ*cosβ*cosβ);\n\n        // longitude\n        const λ = Math.atan2(y, x);\n\n        // height above ellipsoid (Bowring eqn.7)\n        const sinφ = Math.sin(φ), cosφ = Math.cos(φ);\n        const ν = a / Math.sqrt(1-e2*sinφ*sinφ); // length of the normal terminated by the minor axis\n        const h = p*cosφ + z*sinφ - (a*a/ν);\n\n        const point = new LatLonEllipsoidal(φ.toDegrees(), λ.toDegrees(), h);\n\n        return point;\n    }\n\n\n    /**\n     * Returns a string representation of ‘this’ cartesian point.\n     *\n     * @param   {number} [dp=0] - Number of decimal places to use.\n     * @returns {string} Comma-separated latitude/longitude.\n     */\n    toString(dp=0) {\n        const x = this.x.toFixed(dp), y = this.y.toFixed(dp), z = this.z.toFixed(dp);\n        return `[${x},${y},${z}]`;\n    }\n\n}\n\n\n/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  */\n\nexport { LatLonEllipsoidal as default, Cartesian, Vector3d, Dms };\n","/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  */\n/* Geodesy tools for conversions between (historical) datums          (c) Chris Veness 2005-2019  */\n/*                                                                                   MIT Licence  */\n/* www.movable-type.co.uk/scripts/latlong-convert-coords.html                                     */\n/* www.movable-type.co.uk/scripts/geodesy-library.html#latlon-ellipsoidal-datum                  */\n/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  */\n\nimport LatLonEllipsoidal, { Cartesian, Dms } from './latlon-ellipsoidal.js';\n\n\n/**\n * Historical geodetic datums: a latitude/longitude point defines a geographic location on or\n * above/below the  earth’s surface, measured in degrees from the equator & the International\n * Reference Meridian and metres above the ellipsoid, and based on a given datum. The datum is\n * based on a reference ellipsoid and tied to geodetic survey reference points.\n *\n * Modern geodesy is generally based on the WGS84 datum (as used for instance by GPS systems), but\n * previously various reference ellipsoids and datum references were used.\n *\n * This module extends the core latlon-ellipsoidal module to include ellipsoid parameters and datum\n * transformation parameters, and methods for converting between different (generally historical)\n * datums.\n *\n * It can be used for UK Ordnance Survey mapping (OS National Grid References are still based on the\n * otherwise historical OSGB36 datum), as well as for historical purposes.\n *\n * q.v. Ordnance Survey ‘A guide to coordinate systems in Great Britain’ Section 6,\n * www.ordnancesurvey.co.uk/docs/support/guide-coordinate-systems-great-britain.pdf, and also\n * www.ordnancesurvey.co.uk/blog/2014/12/2.\n *\n * @module latlon-ellipsoidal-datum\n */\n\n\n/*\n * Ellipsoid parameters; exposed through static getter below.\n */\nconst ellipsoids = {\n    WGS84:         { a: 6378137,     b: 6356752.314245, f: 1/298.257223563 },\n    Airy1830:      { a: 6377563.396, b: 6356256.909,    f: 1/299.3249646   },\n    AiryModified:  { a: 6377340.189, b: 6356034.448,    f: 1/299.3249646   },\n    Bessel1841:    { a: 6377397.155, b: 6356078.962818, f: 1/299.1528128   },\n    Clarke1866:    { a: 6378206.4,   b: 6356583.8,      f: 1/294.978698214 },\n    Clarke1880IGN: { a: 6378249.2,   b: 6356515.0,      f: 1/293.466021294 },\n    GRS80:         { a: 6378137,     b: 6356752.314140, f: 1/298.257222101 },\n    Intl1924:      { a: 6378388,     b: 6356911.946,    f: 1/297           }, // aka Hayford\n    WGS72:         { a: 6378135,     b: 6356750.5,      f: 1/298.26        },\n};\n\n\n/*\n * Datums; exposed through static getter below.\n */\nconst datums = {\n    // transforms: t in metres, s in ppm, r in arcseconds              tx       ty        tz       s        rx        ry        rz\n    ED50:       { ellipsoid: ellipsoids.Intl1924,      transform: [   89.5,    93.8,    123.1,    -1.2,     0.0,      0.0,      0.156    ] }, // epsg.io/1311\n    ETRS89:     { ellipsoid: ellipsoids.GRS80,         transform: [    0,       0,        0,       0,       0,        0,        0        ] }, // epsg.io/1149; @ 1-metre level\n    Irl1975:    { ellipsoid: ellipsoids.AiryModified,  transform: [ -482.530, 130.596, -564.557,  -8.150,   1.042,    0.214,    0.631    ] }, // epsg.io/1954\n    NAD27:      { ellipsoid: ellipsoids.Clarke1866,    transform: [    8,    -160,     -176,       0,       0,        0,        0        ] },\n    NAD83:      { ellipsoid: ellipsoids.GRS80,         transform: [    0.9956, -1.9103,  -0.5215, -0.00062, 0.025915, 0.009426, 0.011599 ] },\n    NTF:        { ellipsoid: ellipsoids.Clarke1880IGN, transform: [  168,      60,     -320,       0,       0,        0,        0        ] },\n    OSGB36:     { ellipsoid: ellipsoids.Airy1830,      transform: [ -446.448, 125.157, -542.060,  20.4894, -0.1502,  -0.2470,  -0.8421   ] }, // epsg.io/1314\n    Potsdam:    { ellipsoid: ellipsoids.Bessel1841,    transform: [ -582,    -105,     -414,      -8.3,     1.04,     0.35,    -3.08     ] },\n    TokyoJapan: { ellipsoid: ellipsoids.Bessel1841,    transform: [  148,    -507,     -685,       0,       0,        0,        0        ] },\n    WGS72:      { ellipsoid: ellipsoids.WGS72,         transform: [    0,       0,       -4.5,    -0.22,    0,        0,        0.554    ] },\n    WGS84:      { ellipsoid: ellipsoids.WGS84,         transform: [    0.0,     0.0,      0.0,     0.0,     0.0,      0.0,      0.0      ] },\n};\n/* sources:\n * - ED50:       www.gov.uk/guidance/oil-and-gas-petroleum-operations-notices#pon-4\n * - Irl1975:    www.osi.ie/wp-content/uploads/2015/05/transformations_booklet.pdf\n * - NAD27:      en.wikipedia.org/wiki/Helmert_transformation\n * - NAD83:      www.uvm.edu/giv/resources/WGS84_NAD83.pdf [strictly, WGS84(G1150) -> NAD83(CORS96) @ epoch 1997.0]\n *               (note NAD83(1986) ≡ WGS84(Original); confluence.qps.nl/pages/viewpage.action?pageId=29855173)\n * - NTF:        Nouvelle Triangulation Francaise geodesie.ign.fr/contenu/fichiers/Changement_systeme_geodesique.pdf\n * - OSGB36:     www.ordnancesurvey.co.uk/docs/support/guide-coordinate-systems-great-britain.pdf\n * - Potsdam:    kartoweb.itc.nl/geometrics/Coordinate%20transformations/coordtrans.html\n * - TokyoJapan: www.geocachingtoolbox.com?page=datumEllipsoidDetails\n * - WGS72:      www.icao.int/safety/pbn/documentation/eurocontrol/eurocontrol wgs 84 implementation manual.pdf\n *\n * more transform parameters are available from earth-info.nga.mil/GandG/coordsys/datums/NATO_DT.pdf,\n * www.fieldenmaps.info/cconv/web/cconv_params.js\n */\n/* note:\n * - ETRS89 reference frames are coincident with WGS-84 at epoch 1989.0 (ie null transform) at the one metre level.\n */\n\n\n// freeze static properties\nObject.keys(ellipsoids).forEach(e => Object.freeze(ellipsoids[e]));\nObject.keys(datums).forEach(d => { Object.freeze(datums[d]); Object.freeze(datums[d].transform); });\n\n\n/* LatLon - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - */\n\n\n/**\n * Latitude/longitude points on an ellipsoidal model earth, with ellipsoid parameters and methods\n * for converting between datums and to geocentric (ECEF) cartesian coordinates.\n *\n * @extends LatLonEllipsoidal\n */\nclass LatLonEllipsoidal_Datum extends LatLonEllipsoidal {\n\n    /**\n     * Creates a geodetic latitude/longitude point on an ellipsoidal model earth using given datum.\n     *\n     * @param {number} lat - Latitude (in degrees).\n     * @param {number} lon - Longitude (in degrees).\n     * @param {number} [height=0] - Height above ellipsoid in metres.\n     * @param {LatLon.datums} datum - Datum this point is defined within.\n     *\n     * @example\n     *   import LatLon from '/js/geodesy/latlon-ellipsoidal-datum.js';\n     *   const p = new LatLon(53.3444, -6.2577, 17, LatLon.datums.Irl1975);\n     */\n    constructor(lat, lon, height=0, datum=datums.WGS84) {\n        if (!datum || datum.ellipsoid==undefined) throw new TypeError(`unrecognised datum ‘${datum}’`);\n\n        super(lat, lon, height);\n\n        this._datum = datum;\n    }\n\n\n    /**\n     * Datum this point is defined within.\n     */\n    get datum() {\n        return this._datum;\n    }\n\n\n    /**\n     * Ellipsoids with their parameters; semi-major axis (a), semi-minor axis (b), and flattening (f).\n     *\n     * Flattening f = (a−b)/a; at least one of these parameters is derived from defining constants.\n     *\n     * @example\n     *   const a = LatLon.ellipsoids.Airy1830.a; // 6377563.396\n     */\n    static get ellipsoids() {\n        return ellipsoids;\n    }\n\n\n    /**\n     * Datums; with associated ellipsoid, and Helmert transform parameters to convert from WGS-84\n     * into given datum.\n     *\n     * Note that precision of various datums will vary, and WGS-84 (original) is not defined to be\n     * accurate to better than ±1 metre. No transformation should be assumed to be accurate to\n     * better than a metre, for many datums somewhat less.\n     *\n     * This is a small sample of commoner datums from a large set of historical datums. I will add\n     * new datums on request.\n     *\n     * @example\n     *   const a = LatLon.datums.OSGB36.ellipsoid.a;                    // 6377563.396\n     *   const tx = LatLon.datums.OSGB36.transform;                     // [ tx, ty, tz, s, rx, ry, rz ]\n     *   const availableDatums = Object.keys(LatLon.datums).join(', '); // ED50, Irl1975, NAD27, ...\n     */\n    static get datums() {\n        return datums;\n    }\n\n\n    // note instance datum getter/setters are in LatLonEllipsoidal\n\n\n    /**\n     * Parses a latitude/longitude point from a variety of formats.\n     *\n     * Latitude & longitude (in degrees) can be supplied as two separate parameters, as a single\n     * comma-separated lat/lon string, or as a single object with { lat, lon } or GeoJSON properties.\n     *\n     * The latitude/longitude values may be numeric or strings; they may be signed decimal or\n     * deg-min-sec (hexagesimal) suffixed by compass direction (NSEW); a variety of separators are\n     * accepted. Examples -3.62, '3 37 12W', '3°37′12″W'.\n     *\n     * Thousands/decimal separators must be comma/dot; use Dms.fromLocale to convert locale-specific\n     * thousands/decimal separators.\n     *\n     * @param   {number|string|Object} lat|latlon - Geodetic Latitude (in degrees) or comma-separated lat/lon or lat/lon object.\n     * @param   {number}               [lon] - Longitude in degrees.\n     * @param   {number}               [height=0] - Height above ellipsoid in metres.\n     * @param   {LatLon.datums}        [datum=WGS84] - Datum this point is defined within.\n     * @returns {LatLon} Latitude/longitude point on ellipsoidal model earth using given datum.\n     * @throws  {TypeError} Unrecognised datum.\n     *\n     * @example\n     *   const p = LatLon.parse('51.47736, 0.0000', 0, LatLon.datums.OSGB36);\n     */\n    static parse(...args) {\n        let datum = datums.WGS84;\n\n        // if the last argument is a datum, use that, otherwise use default WGS-84\n        if (args.length==4 || (args.length==3 && typeof args[2] == 'object')) datum = args.pop();\n\n        if (!datum || datum.ellipsoid==undefined) throw new TypeError(`unrecognised datum ‘${datum}’`);\n\n        const point = super.parse(...args);\n\n        point._datum = datum;\n\n        return point;\n    }\n\n\n    /**\n     * Converts ‘this’ lat/lon coordinate to new coordinate system.\n     *\n     * @param   {LatLon.datums} toDatum - Datum this coordinate is to be converted to.\n     * @returns {LatLon} This point converted to new datum.\n     * @throws  {TypeError} Unrecognised datum.\n     *\n     * @example\n     *   const pWGS84 = new LatLon(51.47788, -0.00147, 0, LatLon.datums.WGS84);\n     *   const pOSGB = pWGS84.convertDatum(LatLon.datums.OSGB36); // 51.4773°N, 000.0001°E\n     */\n    convertDatum(toDatum) {\n        if (!toDatum || toDatum.ellipsoid==undefined) throw new TypeError(`unrecognised datum ‘${toDatum}’`);\n\n        const oldCartesian = this.toCartesian();                 // convert geodetic to cartesian\n        const newCartesian = oldCartesian.convertDatum(toDatum); // convert datum\n        const newLatLon = newCartesian.toLatLon();               // convert cartesian back to geodetic\n\n        return newLatLon;\n    }\n\n\n    /**\n     * Converts ‘this’ point from (geodetic) latitude/longitude coordinates to (geocentric) cartesian\n     * (x/y/z) coordinates, based on the same datum.\n     *\n     * Shadow of LatLonEllipsoidal.toCartesian(), returning Cartesian augmented with\n     * LatLonEllipsoidal_Datum methods/properties.\n     *\n     * @returns {Cartesian} Cartesian point equivalent to lat/lon point, with x, y, z in metres from\n     *   earth centre, augmented with reference frame conversion methods and properties.\n     */\n    toCartesian() {\n        const cartesian = super.toCartesian();\n        const cartesianDatum = new Cartesian_Datum(cartesian.x, cartesian.y, cartesian.z, this.datum);\n        return cartesianDatum;\n    }\n\n}\n\n\n/* Cartesian  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - */\n\n\n/**\n * Augments Cartesian with datum the cooordinate is based on, and methods to convert between datums\n * (using Helmert 7-parameter transforms) and to convert cartesian to geodetic latitude/longitude\n * point.\n *\n * @extends Cartesian\n */\nclass Cartesian_Datum extends Cartesian {\n\n    /**\n     * Creates cartesian coordinate representing ECEF (earth-centric earth-fixed) point, on a given\n     * datum. The datum will identify the primary meridian (for the x-coordinate), and is also\n     * useful in transforming to/from geodetic (lat/lon) coordinates.\n     *\n     * @param  {number} x - X coordinate in metres (=> 0°N,0°E).\n     * @param  {number} y - Y coordinate in metres (=> 0°N,90°E).\n     * @param  {number} z - Z coordinate in metres (=> 90°N).\n     * @param  {LatLon.datums} [datum] - Datum this coordinate is defined within.\n     * @throws {TypeError} Unrecognised datum.\n     *\n     * @example\n     *   import { Cartesian } from '/js/geodesy/latlon-ellipsoidal-datum.js';\n     *   const coord = new Cartesian(3980581.210, -111.159, 4966824.522);\n     */\n    constructor(x, y, z, datum=undefined) {\n        if (datum && datum.ellipsoid==undefined) throw new TypeError(`unrecognised datum ‘${datum}’`);\n\n        super(x, y, z);\n\n        if (datum) this._datum = datum;\n    }\n\n\n    /**\n     * Datum this point is defined within.\n     */\n    get datum() {\n        return this._datum;\n    }\n    set datum(datum) {\n        if (!datum || datum.ellipsoid==undefined) throw new TypeError(`unrecognised datum ‘${datum}’`);\n        this._datum = datum;\n    }\n\n\n    /**\n     * Converts ‘this’ (geocentric) cartesian (x/y/z) coordinate to (geodetic) latitude/longitude\n     * point (based on the same datum, or WGS84 if unset).\n     *\n     * Shadow of Cartesian.toLatLon(), returning LatLon augmented with LatLonEllipsoidal_Datum\n     * methods convertDatum, toCartesian, etc.\n     *\n     * @returns {LatLon} Latitude/longitude point defined by cartesian coordinates.\n     * @throws  {TypeError} Unrecognised datum\n     *\n     * @example\n     *   const c = new Cartesian(4027893.924, 307041.993, 4919474.294);\n     *   const p = c.toLatLon(); // 50.7978°N, 004.3592°E\n     */\n    toLatLon(deprecatedDatum=undefined) {\n        if (deprecatedDatum) {\n            console.info('datum parameter to Cartesian_Datum.toLatLon is deprecated: set datum before calling toLatLon()');\n            this.datum = deprecatedDatum;\n        }\n        const datum = this.datum || datums.WGS84;\n        if (!datum || datum.ellipsoid==undefined) throw new TypeError(`unrecognised datum ‘${datum}’`);\n\n        const latLon = super.toLatLon(datum.ellipsoid); // TODO: what if datum is not geocentric?\n        const point = new LatLonEllipsoidal_Datum(latLon.lat, latLon.lon, latLon.height, this.datum);\n        return point;\n    }\n\n\n    /**\n     * Converts ‘this’ cartesian coordinate to new datum using Helmert 7-parameter transformation.\n     *\n     * @param   {LatLon.datums} toDatum - Datum this coordinate is to be converted to.\n     * @returns {Cartesian} This point converted to new datum.\n     * @throws  {Error} Undefined datum.\n     *\n     * @example\n     *   const c = new Cartesian(3980574.247, -102.127, 4966830.065, LatLon.datums.OSGB36);\n     *   c.convertDatum(LatLon.datums.Irl1975); // [??,??,??]\n     */\n    convertDatum(toDatum) {\n        // TODO: what if datum is not geocentric?\n        if (!toDatum || toDatum.ellipsoid == undefined) throw new TypeError(`unrecognised datum ‘${toDatum}’`);\n        if (!this.datum) throw new TypeError('cartesian coordinate has no datum');\n\n        let oldCartesian = null;\n        let transform = null;\n\n        if (this.datum == undefined || this.datum == datums.WGS84) {\n            // converting from WGS 84\n            oldCartesian = this;\n            transform = toDatum.transform;\n        }\n        if (toDatum == datums.WGS84) {\n            // converting to WGS 84; use inverse transform\n            oldCartesian = this;\n            transform = this.datum.transform.map(p => -p);\n        }\n        if (transform == null) {\n            // neither this.datum nor toDatum are WGS84: convert this to WGS84 first\n            oldCartesian = this.convertDatum(datums.WGS84);\n            transform = toDatum.transform;\n        }\n\n        const newCartesian = oldCartesian.applyTransform(transform);\n        newCartesian.datum = toDatum;\n\n        return newCartesian;\n    }\n\n\n    /**\n     * Applies Helmert 7-parameter transformation to ‘this’ coordinate using transform parameters t.\n     *\n     * This is used in converting datums (geodetic->cartesian, apply transform, cartesian->geodetic).\n     *\n     * @private\n     * @param   {number[]} t - Transformation to apply to this coordinate.\n     * @returns {Cartesian} Transformed point.\n     */\n    applyTransform(t)   {\n        // this point\n        const { x: x1, y: y1, z: z1 } = this;\n\n        // transform parameters\n        const tx = t[0];                    // x-shift in metres\n        const ty = t[1];                    // y-shift in metres\n        const tz = t[2];                    // z-shift in metres\n        const s  = t[3]/1e6 + 1;            // scale: normalise parts-per-million to (s+1)\n        const rx = (t[4]/3600).toRadians(); // x-rotation: normalise arcseconds to radians\n        const ry = (t[5]/3600).toRadians(); // y-rotation: normalise arcseconds to radians\n        const rz = (t[6]/3600).toRadians(); // z-rotation: normalise arcseconds to radians\n\n        // apply transform\n        const x2 = tx + x1*s  - y1*rz + z1*ry;\n        const y2 = ty + x1*rz + y1*s  - z1*rx;\n        const z2 = tz - x1*ry + y1*rx + z1*s;\n\n        return new Cartesian_Datum(x2, y2, z2);\n    }\n}\n\n\n/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  */\n\nexport { LatLonEllipsoidal_Datum as default, Cartesian_Datum as Cartesian, datums, Dms };\n","/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  */\n/* Ordnance Survey Grid Reference functions                           (c) Chris Veness 2005-2021  */\n/*                                                                                   MIT Licence  */\n/* www.movable-type.co.uk/scripts/latlong-gridref.html                                            */\n/* www.movable-type.co.uk/scripts/geodesy-library.html#osgridref                                  */\n/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  */\n\nimport LatLonEllipsoidal, { Dms } from './latlon-ellipsoidal-datum.js';\n\n\n/**\n * Ordnance Survey OSGB grid references provide geocoordinate references for UK mapping purposes.\n *\n * Formulation implemented here due to Thomas, Redfearn, etc is as published by OS, but is inferior\n * to Krüger as used by e.g. Karney 2011.\n *\n * www.ordnancesurvey.co.uk/documents/resources/guide-coordinate-systems-great-britain.pdf.\n *\n * Note OSGB grid references cover Great Britain only; Ireland and the Channel Islands have their\n * own references.\n *\n * Note that these formulae are based on ellipsoidal calculations, and according to the OS are\n * accurate to about 4–5 metres – for greater accuracy, a geoid-based transformation (OSTN15) must\n * be used.\n */\n\n/*\n * Converted 2015 to work with WGS84 by default, OSGB36 as option;\n * www.ordnancesurvey.co.uk/blog/2014/12/confirmation-on-changes-to-latitude-and-longitude\n */\n\n\n/* OsGridRef  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - */\n\n\nconst nationalGrid = {\n    trueOrigin:  { lat: 49, lon: -2 },                 // true origin of grid 49°N,2°W on OSGB36 datum\n    falseOrigin: { easting: -400e3, northing: 100e3 }, // easting & northing of false origin, metres from true origin\n    scaleFactor: 0.9996012717,                         // scale factor on central meridian\n    ellipsoid:   LatLonEllipsoidal.ellipsoids.Airy1830,\n};\n// note Irish National Grid uses t/o 53°30′N, 8°W, f/o 200kmW, 250kmS, scale factor 1.000035, on Airy 1830 Modified ellipsoid\n\n\n/**\n * OS Grid References with methods to parse and convert them to latitude/longitude points.\n */\nclass OsGridRef {\n\n    /**\n     * Creates an OsGridRef object.\n     *\n     * @param {number} easting - Easting in metres from OS Grid false origin.\n     * @param {number} northing - Northing in metres from OS Grid false origin.\n     *\n     * @example\n     *   import OsGridRef from '/js/geodesy/osgridref.js';\n     *   const gridref = new OsGridRef(651409, 313177);\n     */\n    constructor(easting, northing) {\n        this.easting = Number(easting);\n        this.northing = Number(northing);\n\n        if (isNaN(easting)  || this.easting<0  || this.easting>700e3) throw new RangeError(`invalid easting ‘${easting}’`);\n        if (isNaN(northing) || this.northing<0 || this.northing>1300e3) throw new RangeError(`invalid northing ‘${northing}’`);\n    }\n\n\n    /**\n     * Converts ‘this’ Ordnance Survey Grid Reference easting/northing coordinate to latitude/longitude\n     * (SW corner of grid square).\n     *\n     * While OS Grid References are based on OSGB-36, the Ordnance Survey have deprecated the use of\n     * OSGB-36 for latitude/longitude coordinates (in favour of WGS-84), hence this function returns\n     * WGS-84 by default, with OSGB-36 as an option. See www.ordnancesurvey.co.uk/blog/2014/12/2.\n     *\n     * Note formulation implemented here due to Thomas, Redfearn, etc is as published by OS, but is\n     * inferior to Krüger as used by e.g. Karney 2011.\n     *\n     * @param   {LatLon.datum} [datum=WGS84] - Datum to convert grid reference into.\n     * @returns {LatLon}       Latitude/longitude of supplied grid reference.\n     *\n     * @example\n     *   const gridref = new OsGridRef(651409.903, 313177.270);\n     *   const pWgs84 = gridref.toLatLon();                    // 52°39′28.723″N, 001°42′57.787″E\n     *   // to obtain (historical) OSGB36 lat/lon point:\n     *   const pOsgb = gridref.toLatLon(LatLon.datums.OSGB36); // 52°39′27.253″N, 001°43′04.518″E\n     */\n    toLatLon(datum=LatLonEllipsoidal.datums.WGS84) {\n        const { easting: E, northing: N } = this;\n\n        const { a, b } = nationalGrid.ellipsoid;            // a = 6377563.396, b = 6356256.909\n        const φ0 = nationalGrid.trueOrigin.lat.toRadians(); // latitude of true origin, 49°N\n        const λ0 = nationalGrid.trueOrigin.lon.toRadians(); // longitude of true origin, 2°W\n        const E0 = -nationalGrid.falseOrigin.easting;       // easting of true origin, 400km\n        const N0 = -nationalGrid.falseOrigin.northing;      // northing of true origin, -100km\n        const F0 = nationalGrid.scaleFactor;                // 0.9996012717\n\n        const e2 = 1 - (b*b)/(a*a);                         // eccentricity squared\n        const n = (a-b)/(a+b), n2 = n*n, n3 = n*n*n;        // n, n², n³\n\n        let φ=φ0, M=0;\n        do {\n            φ = (N-N0-M)/(a*F0) + φ;\n\n            const Ma = (1 + n + (5/4)*n2 + (5/4)*n3) * (φ-φ0);\n            const Mb = (3*n + 3*n*n + (21/8)*n3) * Math.sin(φ-φ0) * Math.cos(φ+φ0);\n            const Mc = ((15/8)*n2 + (15/8)*n3) * Math.sin(2*(φ-φ0)) * Math.cos(2*(φ+φ0));\n            const Md = (35/24)*n3 * Math.sin(3*(φ-φ0)) * Math.cos(3*(φ+φ0));\n            M = b * F0 * (Ma - Mb + Mc - Md);                // meridional arc\n\n        } while (Math.abs(N-N0-M) >= 0.00001);  // ie until < 0.01mm\n\n        const cosφ = Math.cos(φ), sinφ = Math.sin(φ);\n        const ν = a*F0/Math.sqrt(1-e2*sinφ*sinφ);            // nu = transverse radius of curvature\n        const ρ = a*F0*(1-e2)/Math.pow(1-e2*sinφ*sinφ, 1.5); // rho = meridional radius of curvature\n        const η2 = ν/ρ-1;                                    // eta = ?\n\n        const tanφ = Math.tan(φ);\n        const tan2φ = tanφ*tanφ, tan4φ = tan2φ*tan2φ, tan6φ = tan4φ*tan2φ;\n        const secφ = 1/cosφ;\n        const ν3 = ν*ν*ν, ν5 = ν3*ν*ν, ν7 = ν5*ν*ν;\n        const VII = tanφ/(2*ρ*ν);\n        const VIII = tanφ/(24*ρ*ν3)*(5+3*tan2φ+η2-9*tan2φ*η2);\n        const IX = tanφ/(720*ρ*ν5)*(61+90*tan2φ+45*tan4φ);\n        const X = secφ/ν;\n        const XI = secφ/(6*ν3)*(ν/ρ+2*tan2φ);\n        const XII = secφ/(120*ν5)*(5+28*tan2φ+24*tan4φ);\n        const XIIA = secφ/(5040*ν7)*(61+662*tan2φ+1320*tan4φ+720*tan6φ);\n\n        const dE = (E-E0), dE2 = dE*dE, dE3 = dE2*dE, dE4 = dE2*dE2, dE5 = dE3*dE2, dE6 = dE4*dE2, dE7 = dE5*dE2;\n        φ = φ - VII*dE2 + VIII*dE4 - IX*dE6;\n        const λ = λ0 + X*dE - XI*dE3 + XII*dE5 - XIIA*dE7;\n\n        let point = new LatLon_OsGridRef(φ.toDegrees(), λ.toDegrees(), 0, LatLonEllipsoidal.datums.OSGB36);\n\n        if (datum != LatLonEllipsoidal.datums.OSGB36) {\n            // if point is required in datum other than OSGB36, convert it\n            point = point.convertDatum(datum);\n            // convertDatum() gives us a LatLon: convert to LatLon_OsGridRef which includes toOsGrid()\n            point = new LatLon_OsGridRef(point.lat, point.lon, point.height, point.datum);\n        }\n\n        return point;\n    }\n\n\n    /**\n     * Parses grid reference to OsGridRef object.\n     *\n     * Accepts standard grid references (eg 'SU 387 148'), with or without whitespace separators, from\n     * two-digit references up to 10-digit references (1m × 1m square), or fully numeric comma-separated\n     * references in metres (eg '438700,114800').\n     *\n     * @param   {string}    gridref - Standard format OS Grid Reference.\n     * @returns {OsGridRef} Numeric version of grid reference in metres from false origin (SW corner of\n     *   supplied grid square).\n     * @throws  {Error}     Invalid grid reference.\n     *\n     * @example\n     *   const grid = OsGridRef.parse('TG 51409 13177'); // grid: { easting: 651409, northing: 313177 }\n     */\n    static parse(gridref) {\n        gridref = String(gridref).trim();\n\n        // check for fully numeric comma-separated gridref format\n        let match = gridref.match(/^(\\d+),\\s*(\\d+)$/);\n        if (match) return new OsGridRef(match[1], match[2]);\n\n        // validate format\n        match = gridref.match(/^[HNST][ABCDEFGHJKLMNOPQRSTUVWXYZ]\\s*[0-9]+\\s*[0-9]+$/i);\n        if (!match) throw new Error(`invalid grid reference ‘${gridref}’`);\n\n        // get numeric values of letter references, mapping A->0, B->1, C->2, etc:\n        let l1 = gridref.toUpperCase().charCodeAt(0) - 'A'.charCodeAt(0); // 500km square\n        let l2 = gridref.toUpperCase().charCodeAt(1) - 'A'.charCodeAt(0); // 100km square\n        // shuffle down letters after 'I' since 'I' is not used in grid:\n        if (l1 > 7) l1--;\n        if (l2 > 7) l2--;\n\n        // convert grid letters into 100km-square indexes from false origin (grid square SV):\n        const e100km = ((l1 - 2) % 5) * 5 + (l2 % 5);\n        const n100km = (19 - Math.floor(l1 / 5) * 5) - Math.floor(l2 / 5);\n\n        // skip grid letters to get numeric (easting/northing) part of ref\n        let en = gridref.slice(2).trim().split(/\\s+/);\n        // if e/n not whitespace separated, split half way\n        if (en.length == 1) en = [ en[0].slice(0, en[0].length / 2), en[0].slice(en[0].length / 2) ];\n\n        // validation\n        if (en[0].length != en[1].length) throw new Error(`invalid grid reference ‘${gridref}’`);\n\n        // standardise to 10-digit refs (metres)\n        en[0] = en[0].padEnd(5, '0');\n        en[1] = en[1].padEnd(5, '0');\n\n        const e = e100km + en[0];\n        const n = n100km + en[1];\n\n        return new OsGridRef(e, n);\n    }\n\n\n    /**\n     * Converts ‘this’ numeric grid reference to standard OS Grid Reference.\n     *\n     * @param   {number} [digits=10] - Precision of returned grid reference (10 digits = metres);\n     *   digits=0 will return grid reference in numeric format.\n     * @returns {string} This grid reference in standard format.\n     *\n     * @example\n     *   const gridref = new OsGridRef(651409, 313177).toString(8); // 'TG 5140 1317'\n     *   const gridref = new OsGridRef(651409, 313177).toString(0); // '651409,313177'\n     */\n    toString(digits=10) {\n        if (![ 0,2,4,6,8,10,12,14,16 ].includes(Number(digits))) throw new RangeError(`invalid precision ‘${digits}’`); // eslint-disable-line comma-spacing\n\n        let { easting: e, northing: n } = this;\n\n        // use digits = 0 to return numeric format (in metres) - note northing may be >= 1e7\n        if (digits == 0) {\n            const format = { useGrouping: false,  minimumIntegerDigits: 6, maximumFractionDigits: 3 };\n            const ePad = e.toLocaleString('en', format);\n            const nPad = n.toLocaleString('en', format);\n            return `${ePad},${nPad}`;\n        }\n\n        // get the 100km-grid indices\n        const e100km = Math.floor(e / 100000), n100km = Math.floor(n / 100000);\n\n        // translate those into numeric equivalents of the grid letters\n        let l1 = (19 - n100km) - (19 - n100km) % 5 + Math.floor((e100km + 10) / 5);\n        let l2 = (19 - n100km) * 5 % 25 + e100km % 5;\n\n        // compensate for skipped 'I' and build grid letter-pairs\n        if (l1 > 7) l1++;\n        if (l2 > 7) l2++;\n        const letterPair = String.fromCharCode(l1 + 'A'.charCodeAt(0), l2 + 'A'.charCodeAt(0));\n\n        // strip 100km-grid indices from easting & northing, and reduce precision\n        e = Math.floor((e % 100000) / Math.pow(10, 5 - digits / 2));\n        n = Math.floor((n % 100000) / Math.pow(10, 5 - digits / 2));\n\n        // pad eastings & northings with leading zeros\n        e = e.toString().padStart(digits/2, '0');\n        n = n.toString().padStart(digits/2, '0');\n\n        return `${letterPair} ${e} ${n}`;\n    }\n\n}\n\n\n/* LatLon_OsGridRef - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - */\n\n\n/**\n * Extends LatLon class with method to convert LatLon point to OS Grid Reference.\n *\n * @extends LatLonEllipsoidal\n */\nclass LatLon_OsGridRef extends LatLonEllipsoidal {\n\n    /**\n     * Converts latitude/longitude to Ordnance Survey grid reference easting/northing coordinate.\n     *\n     * @returns {OsGridRef} OS Grid Reference easting/northing.\n     *\n     * @example\n     *   const grid = new LatLon(52.65798, 1.71605).toOsGrid(); // TG 51409 13177\n     *   // for conversion of (historical) OSGB36 latitude/longitude point:\n     *   const grid = new LatLon(52.65798, 1.71605).toOsGrid(LatLon.datums.OSGB36);\n     */\n    toOsGrid() {\n        // if necessary convert to OSGB36 first\n        const point = this.datum == LatLonEllipsoidal.datums.OSGB36\n            ? this\n            : this.convertDatum(LatLonEllipsoidal.datums.OSGB36);\n\n        const φ = point.lat.toRadians();\n        const λ = point.lon.toRadians();\n\n        const { a, b } = nationalGrid.ellipsoid;            // a = 6377563.396, b = 6356256.909\n        const φ0 = nationalGrid.trueOrigin.lat.toRadians(); // latitude of true origin, 49°N\n        const λ0 = nationalGrid.trueOrigin.lon.toRadians(); // longitude of true origin, 2°W\n        const E0 = -nationalGrid.falseOrigin.easting;       // easting of true origin, 400km\n        const N0 = -nationalGrid.falseOrigin.northing;      // northing of true origin, -100km\n        const F0 = nationalGrid.scaleFactor;                // 0.9996012717\n\n        const e2 = 1 - (b*b)/(a*a);                          // eccentricity squared\n        const n = (a-b)/(a+b), n2 = n*n, n3 = n*n*n;         // n, n², n³\n\n        const cosφ = Math.cos(φ), sinφ = Math.sin(φ);\n        const ν = a*F0/Math.sqrt(1-e2*sinφ*sinφ);            // nu = transverse radius of curvature\n        const ρ = a*F0*(1-e2)/Math.pow(1-e2*sinφ*sinφ, 1.5); // rho = meridional radius of curvature\n        const η2 = ν/ρ-1;                                    // eta = ?\n\n        const Ma = (1 + n + (5/4)*n2 + (5/4)*n3) * (φ-φ0);\n        const Mb = (3*n + 3*n*n + (21/8)*n3) * Math.sin(φ-φ0) * Math.cos(φ+φ0);\n        const Mc = ((15/8)*n2 + (15/8)*n3) * Math.sin(2*(φ-φ0)) * Math.cos(2*(φ+φ0));\n        const Md = (35/24)*n3 * Math.sin(3*(φ-φ0)) * Math.cos(3*(φ+φ0));\n        const M = b * F0 * (Ma - Mb + Mc - Md);              // meridional arc\n\n        const cos3φ = cosφ*cosφ*cosφ;\n        const cos5φ = cos3φ*cosφ*cosφ;\n        const tan2φ = Math.tan(φ)*Math.tan(φ);\n        const tan4φ = tan2φ*tan2φ;\n\n        const I = M + N0;\n        const II = (ν/2)*sinφ*cosφ;\n        const III = (ν/24)*sinφ*cos3φ*(5-tan2φ+9*η2);\n        const IIIA = (ν/720)*sinφ*cos5φ*(61-58*tan2φ+tan4φ);\n        const IV = ν*cosφ;\n        const V = (ν/6)*cos3φ*(ν/ρ-tan2φ);\n        const VI = (ν/120) * cos5φ * (5 - 18*tan2φ + tan4φ + 14*η2 - 58*tan2φ*η2);\n\n        const Δλ = λ-λ0;\n        const Δλ2 = Δλ*Δλ, Δλ3 = Δλ2*Δλ, Δλ4 = Δλ3*Δλ, Δλ5 = Δλ4*Δλ, Δλ6 = Δλ5*Δλ;\n\n        let N = I + II*Δλ2 + III*Δλ4 + IIIA*Δλ6;\n        let E = E0 + IV*Δλ + V*Δλ3 + VI*Δλ5;\n\n        N = Number(N.toFixed(3)); // round to mm precision\n        E = Number(E.toFixed(3));\n\n        try {\n            return new OsGridRef(E, N); // note: gets truncated to SW corner of 1m grid square\n        } catch (e) {\n            throw new Error(`${e.message} from (${point.lat.toFixed(6)},${point.lon.toFixed(6)}).toOsGrid()`);\n        }\n    }\n\n\n    /**\n     * Override LatLonEllipsoidal.convertDatum() with version which returns LatLon_OsGridRef.\n     */\n    convertDatum(toDatum) {\n        const osgbED = super.convertDatum(toDatum); // returns LatLonEllipsoidal_Datum\n        const osgbOSGR = new LatLon_OsGridRef(osgbED.lat, osgbED.lon, osgbED.height, osgbED.datum);\n        return osgbOSGR;\n    }\n\n}\n\n\n/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  */\n\nexport { OsGridRef as default, LatLon_OsGridRef as LatLon, Dms };\n","import OsGridRef from 'geodesy/osgridref.js'\nimport config from './config.json'\n\nconst isPostcode = (value) => {\n  value = value.replace(/\\s/g, '')\n  const regex = /^(([A-Z]{1,2}\\d[A-Z\\d]?|ASCN|STHL|TDCU|BBND|[BFS]IQQ|PCRN|TKCA) ?\\d[A-Z]{2}|BFPO ?\\d{1,4}|(KY\\d|MSR|VG|AI)[ -]?\\d{4}|[A-Z]{2} ?\\d{2}|GE ?CX|GIR ?0A{2}|SAN ?TA1)$/i\n  return regex.test(value)\n}\n\n// Exclude Scotalnd, Wales and Northern Ireland results\nconst removeNonEngland = (results) => {\n  return results.filter(r => r.GAZETTEER_ENTRY.COUNTRY.toLowerCase() === 'england')\n}\n\n// Remove duplicates (OS API bug?) eg: 'Newcastle upon Tyne'\nconst removeDuplicates = (results) => {\n  return Array.from(new Map(results.map(result => [result.GAZETTEER_ENTRY.ID, result])).values())\n}\n\n// Remove any item that doesnt contain a part of the query in name1\nconst removeTenuousResults = (results, query) => {\n  const words = query.toLowerCase().replace(/,/g, '').split(' ')\n  return results.filter(l => words.some(w => l.GAZETTEER_ENTRY.NAME1.toLowerCase().includes(w)))\n}\n\n// Mark search charcaters in result\nconst markString = (string, find) => {\n  find = find.replace(/,/g, '')\n  const patterns = [...new Set([find, ...find.trim().split(/[\\s,\\t,\\n]+/)])].join('|')\n  const reg = new RegExp('(' + patterns + ')', 'i', 'g', 'gi')\n  return { __html: string.replace(reg, '<mark>$1</mark>') }\n}\n\nconst place = ({ ID, NAME1, MBR_XMIN, MBR_YMIN, MBR_XMAX, MBR_YMAX, GEOMETRY_X, GEOMETRY_Y }) => {\n  const bbox = MBR_XMIN\n    ? [\n        (new OsGridRef(MBR_XMIN, MBR_YMIN)).toLatLon().lon,\n        (new OsGridRef(MBR_XMIN, MBR_YMIN)).toLatLon().lat,\n        (new OsGridRef(MBR_XMAX, MBR_YMAX)).toLatLon().lon,\n        (new OsGridRef(MBR_XMAX, MBR_YMAX)).toLatLon().lat]\n        .map(n => Math.round(n * 1000000) / 1000000)\n    : [\n        (new OsGridRef(GEOMETRY_X - 500, GEOMETRY_Y - 500)).toLatLon().lon,\n        (new OsGridRef(GEOMETRY_X - 500, GEOMETRY_Y - 500)).toLatLon().lat,\n        (new OsGridRef(GEOMETRY_X + 500, GEOMETRY_Y + 500)).toLatLon().lon,\n        (new OsGridRef(GEOMETRY_X + 500, GEOMETRY_Y + 500)).toLatLon().lat]\n        .map(n => Math.round(n * 1000000) / 1000000)\n  const centre = GEOMETRY_X\n    ? [(new OsGridRef(GEOMETRY_X, GEOMETRY_Y)).toLatLon().lon,\n        (new OsGridRef(GEOMETRY_X, GEOMETRY_Y)).toLatLon().lat]\n        .map(n => Math.round(n * 1000000) / 1000000)\n    : null\n\n  return {\n    id: ID,\n    text: NAME1,\n    bbox,\n    centre\n  }\n}\n\nconst suggestion = (query, { ID, NAME1, COUNTY_UNITARY, DISTRICT_BOROUGH, POSTCODE_DISTRICT, LOCAL_TYPE }) => {\n  const qualifier = `${!['City', 'Postcode'].includes(LOCAL_TYPE) ? POSTCODE_DISTRICT + ', ' : ''}${LOCAL_TYPE !== 'City' ? (COUNTY_UNITARY || DISTRICT_BOROUGH) : ''}`\n  const text = `${NAME1}${qualifier ? ', ' + qualifier : ''}`\n\n  return {\n    id: ID,\n    text: `${NAME1}${qualifier ? ', ' + qualifier : ''}`,\n    marked: markString(text, query)\n  }\n}\n\nconst parseResults = async (query, tokenCallback) => {\n  if (!query) return []\n  let url = config.URL\n  url = url.replace('{query}', encodeURI(query)).replace('{maxresults}', isPostcode(query) ? 1 : 100)\n  let results = []\n  try {\n    const token = (await tokenCallback()).token\n    const response = await fetch(url, {\n      headers: {\n        Authorization: 'Bearer ' + token\n      }\n    })\n    const json = await response.json()\n    if (json.error || json.header.totalresults === 0) return []\n\n    results = removeTenuousResults(json.results, query)\n    results = removeDuplicates(results)\n    results = removeNonEngland(results)\n    results = results.slice(0, 8)\n  } catch (err) {\n    console.log(err)\n  }\n  return results\n}\n\nclass Provider {\n  constructor (tokenCallback) {\n    this.tokenCallback = tokenCallback\n  }\n\n  async suggest (query) {\n    if (!query) return []\n    const results = await parseResults(query, this.tokenCallback)\n    return results.map(l => suggestion(query, l.GAZETTEER_ENTRY))\n  }\n\n  async find (query) {\n    if (!query) return null\n    const results = await parseResults(query, this.tokenCallback)\n    return results.length ? place(results[0].GAZETTEER_ENTRY) : null\n  }\n}\n\nexport default Provider\n","import config from './config.json'\n\nconst isPostcode = (value) => {\n  value = value.replace(/\\s/g, '')\n  const regex = /^(([A-Z]{1,2}\\d[A-Z\\d]?|ASCN|STHL|TDCU|BBND|[BFS]IQQ|PCRN|TKCA) ?\\d[A-Z]{2}|BFPO ?\\d{1,4}|(KY\\d|MSR|VG|AI)[ -]?\\d{4}|[A-Z]{2} ?\\d{2}|GE ?CX|GIR ?0A{2}|SAN ?TA1)$/i\n  return regex.test(value)\n}\n\n// Remove 'England, GBR'\nconst stripSuffix = (results) => {\n  return results.map(r => {\n    return {\n      ...r,\n      text: r.text.replace(', England, GBR', '')\n    }\n  })\n}\n\n// Mark search charcaters in result\nconst markString = (string, find) => {\n  find = find.replace(/,/g, '')\n  const patterns = [...new Set([find, ...find.trim().split(/[\\s,\\t,\\n]+/)])].join('|')\n  const reg = new RegExp('(' + patterns + ')', 'i', 'g', 'gi')\n  return { __html: string.replace(reg, '<mark>$1</mark>') }\n}\n\nconst place = (result) => {\n  const { xmin, ymin, xmax, ymax } = result.extent\n  const { x, y } = result.location\n  const bbox = [xmin, ymin, xmax, ymax].map(n => Math.round(n * 1000000) / 1000000)\n  const centre = [x, y].map(n => Math.round(n * 1000000) / 1000000)\n  const { PlaceName } = result.attributes\n\n  return {\n    id: null,\n    text: PlaceName,\n    bbox,\n    centre\n  }\n}\n\nconst suggestion = (query, { text, magicKey }) => {\n  return {\n    id: magicKey,\n    text,\n    marked: markString(text, query)\n  }\n}\n\nclass Provider {\n  constructor (tokenCallback) {\n    this.tokenCallback = tokenCallback\n  }\n\n  async suggest (query) {\n    if (!query) return []\n    const token = (await this.tokenCallback()).token\n    let url = config.SUGGEST_URL.replace('{token}', token)\n    url = url.replace('{query}', encodeURI(query)).replace('{maxSuggestions}', isPostcode(query) ? 1 : 8)\n    const response = await fetch(url)\n    const json = await response.json()\n    if (json.error || !json.suggestions?.length) return []\n    let results = json.suggestions.filter(r => r.text.toLowerCase().includes('england, gbr'))\n    results = stripSuffix(results)\n    if (!results.length) return []\n    return results.map(r => suggestion(query, r))\n  }\n\n  async find (query, id) {\n    if (!query) return null\n    const token = (await this.tokenCallback()).token\n    let url = config.FIND_ADDRESS_CANDIDATES_URL.replace('{token}', token)\n    url = url.replace('{query}', encodeURI(query)).replace('{maxLocations}', 8).replace('{magicKey}', id || '')\n    const response = await fetch(url)\n    const json = await response.json()\n    if (json.error || !json.candidates?.length) return null\n    const results = json.candidates.filter(r => r.attributes.Region === 'England')\n    return results.length ? place(results[0]) : null\n  }\n}\n\nexport default Provider\n","import React, { useRef, useEffect, useReducer } from 'react'\nimport { useOutsideInteract } from '../hooks/use-outside-interact'\nimport { useApp } from '../store/use-app'\nimport { useViewport } from '../store/use-viewport'\nimport { reducer, initialState } from '../store/search-reducer'\nimport Autocomplete from './autocomplete.jsx'\nimport OsProvider from '../provider/os-open-names/provider.js'\nimport EsriProvider from '../provider/esri-world-geocoder/provider.js'\n\nexport default function Search ({ instigatorRef }) {\n  const { isKeyboard, isMobile, isDesktop, options, search, activeRef, activePanel, activePanelHasFocus, legend } = useApp()\n  const appDispatch = useApp().dispatch\n  const viewportDispatch = useViewport().dispatch\n  const { label, isAutocomplete, tokenCallback } = search\n\n  const searchProvider = search.provider === 'esri-world-geocoder'\n    ? new EsriProvider(tokenCallback)\n    : new OsProvider(tokenCallback)\n\n  const { id } = options\n\n  const formRef = useRef()\n  const clearBtnRef = useRef()\n  const inputRef = useRef()\n\n  const [state, dispatch] = useReducer(reducer, initialState)\n\n  const searchWidth = !isMobile ? (legend.keyWidth || legend.width) : null\n  const isFixed = search.isExpanded && isDesktop\n\n  const updateViewport = async (value, id) => {\n    const location = await searchProvider.find(value, id)\n    if (!location) return\n    const { bbox, centre, zoom, text } = location\n    viewportDispatch({ type: 'SEARCH', bbox, centre, zoom, place: text })\n  }\n\n  const handleKeyUp = e => {\n    if (['Escape', 'Esc'].includes(e.key)) {\n      e.preventDefault()\n      handleCollapse()\n    }\n  }\n\n  const handleSubmit = e => {\n    e.preventDefault()\n    const suggestion = state.selected >= 0 ? state.suggestions[state.selected] : null\n    const value = suggestion?.text || state.value\n    const id = suggestion?.id\n    dispatch({ type: 'SUBMIT', value })\n    updateViewport(value, id)\n  }\n\n  const handleCollapse = () => {\n    appDispatch({ type: 'CLOSE' })\n    activeRef.current = instigatorRef.current\n  }\n\n  const handleClear = () => {\n    dispatch({ type: 'CLEAR', activeRef: inputRef, isFocusVisibleWithin: isKeyboard })\n    inputRef.current.focus()\n  }\n\n  // Hide soft keyboard on touchstart outside search input\n  useOutsideInteract(inputRef, 'touchstart', e => {\n    if (document.activeElement !== inputRef.current) return\n    inputRef.current.blur()\n    if (!formRef.current?.contains(e.target)) return\n    setTimeout(() => inputRef.current.focus(), 0)\n  })\n\n  const handleKeyDown = e => {\n    // Escape key\n    if (['Escape', 'Esc'].includes(e.key)) {\n      e.preventDefault()\n      !(state.value || state.isVisible)\n        ? dispatch({ type: 'COLLAPSE', activeRef: instigatorRef })\n        : dispatch({ type: 'HIDE_SUGGESTIONS' })\n    }\n    // Review suggestions\n    if (['ArrowDown', 'ArrowUp'].includes(e.key) && state.suggestions.length >= 1) {\n      e.preventDefault()\n      dispatch({ type: 'REVIEW', key: e.key })\n    }\n  }\n\n  const handleChange = e => {\n    dispatch({ type: 'CHANGE', value: e.target.value })\n  }\n\n  const handleClick = () => {\n    dispatch({ type: 'CLICK', isKeyboard, activeRef: inputRef })\n  }\n\n  // Move focus to input\n  useEffect(() => {\n    if (isFixed || !instigatorRef || !activePanelHasFocus) return\n    activeRef.current = inputRef.current\n  }, [activePanel])\n\n  return (\n    <div\n      id={`${id}-search-form`} className={`fm-c-search${isFixed ? ' fm-c-search--fixed' : ''}`} onKeyDown={handleKeyDown} onKeyUp={handleKeyUp}\n      {...(!isFixed\n        ? {\n            'aria-labelledby': `${id}-search`,\n            role: 'dialog',\n            'aria-modal': true,\n            open: true\n          }\n        : {})}\n      {...searchWidth\n        ? {\n            style: { width: searchWidth }\n          }\n        : {}}\n      ref={formRef}\n    >\n      <div className='fm-c-search__control'>\n        <form role='search' className={`fm-c-search__form${state.isFocusWithin ? ' fm-u-focus-within' : ''}${state.isFocusVisibleWithin ? ' fm-u-focus-visible-within' : ''}`} aria-controls={`${id}-viewport`} onSubmit={handleSubmit}>\n          {isMobile\n            ? (\n              <button onClick={handleCollapse} type='button' className='fm-c-btn fm-c-btn--search-back govuk-body-s' aria-label='Close search'>\n                <svg aria-hidden='true' focusable='false' width='14' height='20' viewBox='0 0 14 20' fillRule='evenodd' fill='currentColor'>\n                  <path d='M3.828 10l8.486 8.485-1.415 1.414L1 10 10.899.101l1.415 1.414L3.828 10z' strokeWidth='0' />\n                </svg>\n              </button>\n              )\n            : null}\n          <label htmlFor={`${id}-search`} className='fm-u-visually-hidden'>{label}</label>\n          <input id={`${id}-search`} className='fm-c-search__input govuk-body-s' role='combobox' type='search' {...(!state.value ? { 'aria-describedby': `${id}-search-hint` } : {})} aria-owns='fm-suggestions' aria-autocomplete='list' autoComplete='off' placeholder={label} name={`${id}-search`} spellCheck='false' enterKeyHint='search' {...(state.selected >= 0 ? { 'aria-activedescendant': `${id}-search-suggestion-${state.selected}` } : {})} value={state.value} onClick={handleClick} onChange={handleChange} onFocus={() => dispatch({ type: 'FOCUS', isKeyboard })} onBlur={() => dispatch({ type: 'BLUR' })} ref={inputRef} />\n          <div id={`${id}-search-hint`} style={{ display: 'none' }}>\n            When search results are available use up and down arrows to review and enter to select.  Touch device users, explore by touch or with swipe gestures.\n          </div>\n          {isMobile && state.value?.length\n            ? (\n              <button className='fm-c-search__clear' aria-label='Clear search' type='button' onClick={handleClear} ref={clearBtnRef}>\n                <svg aria-hidden='true' focusable='false' width='20' height='20' viewBox='0 0 20 20' fill='currentColor'><path d='M10,8.6L15.6,3L17,4.4L11.4,10L17,15.6L15.6,17L10,11.4L4.4,17L3,15.6L8.6,10L3,4.4L4.4,3L10,8.6Z' style={{ fill: 'currentColor', strokeWidth: '0' }} /></svg>\n              </button>\n              )\n            : null}\n          {!isMobile && !isFixed\n            ? (\n              <button onClick={handleCollapse} type='button' className='fm-c-btn fm-c-btn--search-close govuk-body-s' aria-label='Close search'>\n                <svg aria-hidden='true' focusable='false' width='20' height='20' viewBox='0 0 20 20' fill='currentColor'><path d='M10,8.6L15.6,3L17,4.4L11.4,10L17,15.6L15.6,17L10,11.4L4.4,17L3,15.6L8.6,10L3,4.4L4.4,3L10,8.6Z' style={{ fill: 'currentColor', strokeWidth: '0' }} /></svg>\n              </button>\n              )\n            : null}\n          {isFixed\n            ? (\n              <button className='fm-c-btn fm-c-btn--search govuk-body-s' aria-label='Search'>\n                <svg aria-hidden='true' focusable='false' width='20' height='20' viewBox='0 0 20 20' fillRule='evenodd' fill='currentColor'>\n                  <path d='M12.084 14.312c-1.117.711-2.444 1.123-3.866 1.123C4.235 15.435 1 12.201 1 8.218S4.235 1 8.218 1s7.217 3.235 7.217 7.218c0 1.422-.412 2.749-1.123 3.866L19 16.773 16.773 19l-4.689-4.688zM8.218 2.818c2.98 0 5.4 2.419 5.4 5.4s-2.42 5.4-5.4 5.4-5.4-2.42-5.4-5.4 2.419-5.4 5.4-5.4z' />\n                </svg>\n              </button>\n              )\n            : null}\n        </form>\n      </div>\n      {isAutocomplete\n        ? <Autocomplete id={id} state={state} dispatch={dispatch} provider={searchProvider} updateViewport={updateViewport} />\n        : null}\n    </div>\n  )\n}\n","import React, { useEffect, useState, useRef } from 'react'\nimport { useOutsideInteract } from '../hooks/use-outside-interact'\nimport { useApp } from '../store/use-app'\nimport { constrainFocus, toggleInert } from '../lib/dom'\n\nexport default function Panel ({ className, label, isInset, isFixed, isNotObscure, isHideHeading, isModal, setIsModal, isOutsideInteract, instigatorRef, width, maxWidth, html, children }) {\n  const { options, isMobile, dispatch, obscurePanelRef, activeRef, activePanelHasFocus } = useApp()\n  const { id } = options\n\n  // Ref to element\n  const elementRef = useRef(null)\n  const bodyRef = useRef(null)\n\n  // Scroll tabindex\n  const [hasTabindex, setHasTabindex] = useState(false)\n\n  // Hide keyboard on click outside\n  if (isOutsideInteract) {\n    useOutsideInteract(elementRef, 'click', () => {\n      // if (isFixed || e.target !== viewportRef?.current?.querySelector('canvas')) return\n      handleClose()\n    })\n  }\n\n  // Events\n  const handleClose = () => {\n    if (setIsModal) {\n      setIsModal(false)\n    }\n    dispatch({ type: 'CLOSE' })\n    obscurePanelRef.current = null\n    activeRef.current = instigatorRef.current\n  }\n\n  const handleKeyDown = e => {\n    constrainFocus(e)\n  }\n\n  const handleKeyUp = e => {\n    if (['Escape', 'Esc'].includes(e.key)) {\n      e.preventDefault()\n      handleClose()\n    }\n  }\n\n  const handleFocus = e => {\n    if (e.currentTarget !== e.target) return\n    toggleInert()\n  }\n\n  const handleBlur = e => {\n    if (!(isMobile && elementRef.current?.contains(e.target) && !elementRef.current?.contains(e.relatedTarget))) return\n    dispatch({ type: 'SET_IS_EXPANDED', value: false })\n  }\n\n  // Template properties\n  const panelId = `${id}-panel${className ? '-' + className : ''}`\n  const hasCloseBtn = !isFixed && instigatorRef\n  const hasWidth = width && !(isMobile && isInset)\n\n  // Set initial focus\n  useEffect(() => {\n    // We need to know when if a panel ahs been added before rednering map\n    dispatch({ type: 'CONTAINER_READY' })\n\n    obscurePanelRef.current = isNotObscure ? elementRef.current : null\n    if (instigatorRef?.current && activePanelHasFocus) {\n      activeRef.current = elementRef.current\n    }\n  }, [])\n\n  // Toggle inert elements\n  useEffect(() => {\n    toggleInert()\n  }, [isModal])\n\n  // Conditionally set tabindex on scrollable body\n  useEffect(() => {\n    const height = bodyRef.current?.offsetHeight\n    const scrollHeight = bodyRef.current?.scrollHeight\n    const hasInteractions = bodyRef.current?.querySelector('a, button')\n    setHasTabindex(!hasInteractions && height < scrollHeight)\n  })\n\n  return (\n    <div\n      id={panelId}\n      className={`fm-c-panel${className ? ' fm-c-panel--' + className : ''}${isInset ? ' fm-c-panel--inset' : ''}${hasTabindex ? ' fm-c-panel--has-body-focus' : ''}`}\n      aria-labelledby={`${panelId}-label`}\n      role={instigatorRef ? 'dialog' : 'region'}\n      ref={elementRef}\n      onBlur={handleBlur}\n      {...(instigatorRef\n        ? {\n            open: true,\n            'aria-modal': isModal,\n            onKeyDown: handleKeyDown,\n            onKeyUp: handleKeyUp,\n            onFocus: handleFocus,\n            tabIndex: '-1'\n          }\n        : {})}\n      {...!isMobile && hasWidth\n        ? {\n            style: { width, maxWidth }\n          }\n        : {}}\n    >\n      <div className={`fm-c-panel__header${isHideHeading ? ' fm-c-panel__header--collapse' : ''}`}>\n        <h2 id={`${panelId}-label`} className={isHideHeading ? 'fm-u-visually-hidden' : 'fm-c-panel__heading govuk-heading-s'}>\n          {label}\n        </h2>\n        {hasCloseBtn\n          ? (\n            <button onClick={handleClose} className='fm-c-btn fm-c-btn--close-panel govuk-body-s' aria-label='Close panel'>\n              <svg aria-hidden='true' focusable='false' width='20' height='20' viewBox='0 0 20 20'><path d='M10,8.6L15.6,3L17,4.4L11.4,10L17,15.6L15.6,17L10,11.4L4.4,17L3,15.6L8.6,10L3,4.4L4.4,3L10,8.6Z' style={{ fill: 'currentColor', stroke: 'currentColor', strokeWidth: 0.1 }} /></svg>\n            </button>\n            )\n          : null}\n      </div>\n      <div className='fm-c-panel__body' ref={bodyRef} {...(hasTabindex ? { tabindex: 0 } : {})}>\n        {html\n          ? <div className='fm-c-panel__content' {...({ dangerouslySetInnerHTML: { __html: html } })} />\n          : null}\n        {children}\n      </div>\n    </div>\n  )\n}\n","import React, { useState, Fragment } from 'react'\nimport { useQueryState } from '../hooks/use-query-state'\nimport { useApp } from '../store/use-app'\nimport { useViewport } from '../store/use-viewport'\nimport { events } from '../store/constants'\nimport eventBus from '../lib/eventbus.js'\nimport { parseSegments, parseLayers } from '../lib/query.js'\n\nexport default function SegmentGroup ({ id, group }) {\n  const { parent, mode, segments, legend, dispatch } = useApp()\n  const { basemap, size } = useViewport()\n  const viewportDispatch = useViewport().dispatch\n  const [, setQuerySeg] = useQueryState('seg')\n  const { display, heading, isHidden, isDetails } = group\n  const [isExpanded, setIsExpanded] = useState(group.isExpanded)\n\n  const handleItemClickOrChange = e => {\n    // const group = groups.find(s => s.items.some(i => i.id === e.currentTarget.value))\n    let seg = segments.filter(s => !items.map(i => i.id).includes(s))\n    seg.push(e.currentTarget.value)\n    seg = parseSegments(legend.segments, seg)\n    const lyr = parseLayers(legend.key, legend.segments, seg)\n    dispatch({ type: 'TOGGLE_SEGMENTS', segments: seg, layers: lyr })\n    viewportDispatch({ type: 'CLEAR_FEATURES' })\n    eventBus.dispatch(parent, events.APP_CHANGE, { type: 'segment', mode, basemap, size, segments: seg, layers: lyr })\n\n    // Update query param\n    setQuerySeg(seg.join(','))\n  }\n\n  const handleDetailsClick = () => {\n    setIsExpanded(!isExpanded)\n  }\n\n  const items = group.items.map(i => {\n    return {\n      ...i,\n      isChecked: segments.includes(i.id)\n    }\n  })\n  const selected = items.find(i => i.isChecked).label\n\n  const Heading = () => {\n    return (\n      heading\n        ? <h3 className='fm-c-layers__heading govuk-body-s' aria-hidden='true'>{heading}</h3>\n        : null\n    )\n  }\n\n  return (\n    <div className={`fm-c-segments${display ? ' fm-c-segments--' + display : ''}`} {...isHidden ? { style: { display: 'none' } } : {}}>\n      {isDetails\n        ? (\n          <button className='fm-c-details govuk-body-s' aria-expanded={isExpanded} aria-controls={`content-${id}`} onClick={handleDetailsClick}>\n            <span className='fm-c-details__label'>\n              <span className='fm-c-details__label-focus'>{heading}</span>\n            </span>\n            <span className='fm-c-details__summary'>\n              <span className='fm-c-details__summary-focus'>{selected}</span>\n            </span>\n            <span className='fm-c-details__toggle'>\n              <span className='fm-c-details__toggle-focus'>\n                <span className='fm-c-details__chevron' />\n                {isExpanded ? 'Hide' : 'Show'}\n              </span>\n            </span>\n          </button>\n          )\n        : <Heading />}\n      <div id={`content-${id}`} className='fm-c-segments__inner' role='group' {...heading ? { 'aria-labelledby': `segment-${id}` } : { 'aria-label': 'Segments' }}>\n        {items.map(item => (\n          <Fragment key={item.label.toLowerCase()}>\n            {['timeline', 'segmented'].includes(display)\n              ? (\n                <button aria-pressed={item.isChecked} className='fm-c-segments__button govuk-body-s' value={item.id} onClick={handleItemClickOrChange}>\n                  {!['timeline', 'segmented'].includes(display)\n                    ? <span className='fm-c-segments__button-icon' />\n                    : null}\n                  <span className='fm-c-segments__button-text' dangerouslySetInnerHTML={{ __html: item.label }} />\n                </button>\n                )\n              : (\n                <div className='fm-c-segments__item govuk-body-s'>\n                  <input className='fm-c-segments__radio' defaultChecked={item.isChecked} id={item.id} name={`group-${id}`} type='radio' value={item.id} onChange={handleItemClickOrChange} />\n                  <label className='fm-c-segments__label' htmlFor={item.id} dangerouslySetInnerHTML={{ __html: item.label }} />\n                </div>\n                )}\n          </Fragment>\n        ))}\n      </div>\n    </div>\n  )\n}\n","import React, { Fragment } from 'react'\nimport { useApp } from '../store/use-app'\nimport SegmentGroup from './segment-group.jsx'\n\nexport default function Segments () {\n  const { segments, legend } = useApp()\n  if (!legend.segments) return\n\n  // Only segments with an active parent\n  let groups = legend.segments.filter(s => s.parentIds ? s.parentIds.some(i => segments.includes(i)) : s)\n\n  // Add display properties\n  groups = groups.map(g => {\n    const isDetails = !g.type && g.heading && g.collapse && ['expanded', 'collapse'].includes(g.collapse)\n    return {\n      ...g,\n      isDetails,\n      isExpanded: isDetails && g?.collapse === 'expanded'\n    }\n  })\n\n  return (\n    <>\n      {groups.map((group, i) => (\n        <Fragment key={`gs${i}`}>\n          <SegmentGroup group={group} id={`s${i}`} />\n        </Fragment>\n      ))}\n    </>\n  )\n}\n","import React, { useRef } from 'react'\nimport { useApp } from '../store/use-app'\nimport { findTabStop } from '../lib/dom.js'\n\nexport default function More ({ id, label, isExpanded, setIsExpanded, isRemove }) {\n  const { activeRef } = useApp()\n  const btnRef = useRef(null)\n\n  const handleClick = () => {\n    setIsExpanded(!isExpanded)\n    if (!isRemove) return\n    const previousTabStop = findTabStop(document.activeElement, 'prev')\n    activeRef.current = previousTabStop\n  }\n\n  return (\n    <>\n      {!(isRemove && isExpanded)\n        ? (\n          <button\n            className='fm-c-btn-more'\n            aria-controls={id}\n            aria-label={label}\n            aria-expanded={isExpanded}\n            ref={btnRef}\n            onClick={handleClick}\n          >\n            <span className='fm-c-btn-more__chevron' />\n            {label}\n          </button>\n          )\n        : null}\n    </>\n  )\n}\n","const { DOMParser } = window\n\nexport const parseSVG = (icon, fill, text, isDarkBasemap = false, scale = 1) => {\n  const isSelected = icon.includes('selected')\n  // let styled = text.replace(/#0f0|#00ff00|#0F0|#00FF00/g, isSelected ? isDarkBasemap ? '#ffffff' : '#0b0c0c' : 'transparent')\n  // styled = styled.replace(/#00f|#0000ff|#00F|#0000FF/g, isDarkBasemap ? '#162232' : '#ffffff')\n  const parser = new DOMParser()\n  const dom = parser.parseFromString(text, 'text/html')\n  const svg = dom.querySelector('svg')\n  // Add xmlns attribute and class to svg\n  // svg.setAttribute('xmlns', 'http://www.w3.org/2000/svg')\n  svg.classList.add('fm-c-symbol')\n  svg.classList.toggle('fm-c-symbol--selected', isSelected)\n  svg.classList.toggle('fm-c-symbol--dark', isDarkBasemap)\n  // Set svg height and width\n  const viewBox = svg.getAttribute('viewBox')\n  const width = viewBox.split(' ')[2] * scale\n  const height = viewBox.split(' ')[3] * scale\n  svg.setAttribute('width', width)\n  svg.setAttribute('height', height)\n  // Conditionally add fill\n  if (fill) svg.setAttribute('fill', fill)\n  // Add classnames\n  const olFill = svg.querySelectorAll('[fill=\"#0b0c0c\" i], [style*=\"fill:#0b0c0c\" i]')\n  const olStroke = svg.querySelectorAll('[stroke=\"#0b0c0c\" i], [style*=\"stroke:#0b0c0c\" i]')\n  olFill.forEach(n => n.classList.add('fm-c-symbol__ol-fill'))\n  olStroke.forEach(n => n.classList.add('fm-c-symbol__ol-stroke'))\n  const bgFill = svg.querySelectorAll('[fill=\"#fff\" i], [fill=\"#ffffff\" i], [style*=\"fill:#fff\" i], [style*=\"fill:#ffffff\" i]')\n  const bgStroke = svg.querySelectorAll('[stroke*=\"#fff\" i], [stroke*=\"#ffffff\" i], [style*=\"stroke:#fff\" i], [style*=\"stroke:#ffffff\" i]')\n  bgFill.forEach(n => n.classList.add('fm-c-symbol__bg-fill'))\n  bgStroke.forEach(n => n.classList.add('fm-c-symbol__bg-stroke'))\n  const fgFill = svg.querySelectorAll(':not(.fm-c-symbol__ol-fill):not(.fm-c-symbol__bg-fill)[fill], :not(.fm-c-symbol__ol-fill):not(.fm-c-symbol__bg-fill)[style*=\"fill\"]')\n  const fgStroke = svg.querySelectorAll(':not(.fm-c-symbol__ol-stroke):not(.fm-c-symbol__bg-stroke)[stroke], :not(.fm-c-symbol__ol-stroke):not(.fm-c-symbol__bg-stroke)[style*=\"stroke\"]')\n  fgFill.forEach(n => n.classList.add('fm-c-symbol__fg-fill'))\n  fgStroke.forEach(n => n.classList.add('fm-c-symbol__fg-stroke'))\n  return dom.body.innerHTML\n}\n","import React, { useEffect, useState } from 'react'\nimport { useViewport } from '../store/use-viewport'\nimport { parseSVG } from '../lib/symbols'\n\nexport default function KeySymbol ({ item, display }) {\n  const { basemap } = useViewport()\n  const isDarkBasemap = ['dark', 'aerial'].includes(basemap)\n\n  const [svg, setSvg] = useState(null)\n\n  useEffect(() => {\n    if (!item?.icon) return\n    fetch(item.icon).then(response => response.text()).then(text => setSvg(\n      { __html: parseSVG(item.icon, fill, text, isDarkBasemap) }\n    ))\n  }, [item?.icon])\n\n  const fills = item?.fill?.replace(/\\s/g, '').split(',').map(f => f.includes(':') ? f : `default:${f}`)\n  const fill = fills?.length ? (fills.find(f => f.includes(basemap)) || fills[0]).split(':')[1] : null\n\n  return (\n    <>\n      {display === 'icon'\n        ? (\n          <div className={`fm-c-layers__image fm-c-layers__image--${display}`} dangerouslySetInnerHTML={svg} />\n          )\n        : null}\n      {display === 'fill'\n        ? (\n          <div className={`fm-c-layers__image fm-c-layers__image--${display}`}>\n            <svg width='40' height='40' viewBox='0 0 40 40' fill={fill}>\n              <path d='M8 8h24v24H8z' />\n            </svg>\n          </div>\n          )\n        : null}\n      {display === 'query-polygon'\n        ? (\n          <div className={`fm-c-layers__image fm-c-layers__image--${display}`}>\n            <svg width='40' height='40' viewBox='0 0 40 40' fill='none'>\n              <path d='M9 9h22v22H9z' />\n            </svg>\n          </div>\n          )\n        : null}\n      {display === 'ramp'\n        ? (\n          <div className={`fm-c-layers__image fm-c-layers__image--${display}`}>\n            <svg viewBox='0 0 5 5' preserveAspectRatio='none' fill={fill} stroke={fill} strokeWidth={1}>\n              <path d='M0 0h5v5H0z' />\n            </svg>\n          </div>\n          )\n        : null}\n    </>\n  )\n}\n","import React, { useState, Fragment } from 'react'\nimport { useQueryState } from '../hooks/use-query-state'\nimport { useApp } from '../store/use-app'\nimport { useViewport } from '../store/use-viewport'\nimport { events } from '../store/constants'\nimport eventBus from '../lib/eventbus.js'\nimport KeySymbol from './key-symbol.jsx'\n\nexport default function LayerGroup ({ id, group, hasSymbols, hasInputs }) {\n  const { parent, dispatch, mode, layers, segments } = useApp()\n  const { basemap, size } = useViewport()\n  const [, setQueryLyr] = useQueryState('lyr')\n  const [isExpanded, setIsExpanded] = useState(group?.collapse !== 'collapse')\n\n  const handleItemClick = e => {\n    const lyr = layers\n    const index = lyr.indexOf(e.currentTarget.value)\n    e.currentTarget.getAttribute('aria-checked') === 'false' ? lyr.push(e.currentTarget.value) : lyr.splice(index, 1)\n    dispatchAppChange(lyr)\n  }\n\n  const handleItemChange = e => {\n    const lyr = layers\n    if (checkedRadioId) {\n      lyr.splice(lyr.indexOf(checkedRadioId), 1)\n    }\n    lyr.push(e.currentTarget.value)\n    dispatchAppChange(lyr)\n  }\n\n  const dispatchAppChange = lyr => {\n    dispatch({ type: 'TOGGLE_LAYERS', layers: lyr })\n    eventBus.dispatch(parent, events.APP_CHANGE, { type: 'layer', mode, basemap, size, segments, layers: lyr })\n    // Update query param\n    setQueryLyr(lyr.join(','))\n  }\n\n  const handleDetailsClick = e => {\n    setIsExpanded(!isExpanded)\n  }\n\n  // Display properties\n  const layout = hasInputs ? group.layout : 'column'\n  const isDetails = hasInputs && layout !== 'column' && group.heading && ['expanded', 'collapse'].includes(group.collapse)\n  const numItems = group.items.length\n  const numCols = layout === 'column' && group.display === 'ramp' ? numItems : Math.min(numItems, 4)\n  const heading = group.heading || group.label\n  const checkedRadioId = group.items.find(item => layers?.includes(item.id))?.id\n  const style = { ...layout === 'column' ? { style: { gridTemplateColumns: numItems >= 4 ? `repeat(auto-fit, minmax(${Math.round(300 / numCols)}px, auto))` : 'repeat(3, 1fr)' } } : {} }\n  const groupSummary = group.items.reduce((result, { label, id }) => [...result, ...(\n    group?.type === 'radio' ? id === checkedRadioId : layers?.includes(id)) ? [label] : []], []\n  ).join(', ').replace(/, ([^,]*)$/, ', $1') || 'None selected'\n\n  const Heading = () => {\n    return (\n      heading\n        ? <h3 className='fm-c-layers__heading govuk-body-s' aria-hidden='true'>{heading}</h3>\n        : null\n    )\n  }\n\n  const ItemInner = ({ item, index, display, isChecked }) => {\n    if (hasInputs && group.type === 'radio') {\n      return (\n        <>\n          <input className='fm-c-layers__radio' defaultChecked={isChecked} id={item.id} name={`group-${id}`} type='radio' value={item.id} onChange={handleItemChange} />\n          <label className='fm-c-layers__label' htmlFor={item.id}>\n            {hasSymbols ? <KeySymbol display={display} item={item} /> : null}\n            <span className='fm-c-layers__text' dangerouslySetInnerHTML={{ __html: item.label }} />\n          </label>\n        </>\n      )\n    } else if (hasInputs && item.id) {\n      return (\n        <button className='fm-c-layers__button' role='switch' aria-checked={isChecked} value={item.id} onClick={handleItemClick}>\n          {hasSymbols ? <KeySymbol display={display} item={item} /> : null}\n          <span className='fm-c-layers__text' dangerouslySetInnerHTML={{ __html: item.label }} />\n        </button>\n      )\n    } else {\n      return (\n        <>\n          {hasSymbols ? <KeySymbol display={display} item={item} /> : null}\n          <span className={group.numLabels && index % group.numLabels !== 0 ? 'fm-u-visually-hidden' : 'fm-c-layers__text'} dangerouslySetInnerHTML={{ __html: item.label }} />\n        </>\n      )\n    }\n  }\n\n  return (\n    <div className={`fm-c-layers__group fm-c-layers__group--${layout || 'row'}${group.numLabels ? ' fm-c-layers__group--custom-labels' : ''}`} role='group' aria-label={heading}>\n      {isDetails\n        ? (\n          <button className='fm-c-details govuk-body-s' aria-expanded={isExpanded} aria-controls={`content-${id}`} onClick={handleDetailsClick}>\n            <span className='fm-c-details__label'>\n              <span className='fm-c-details__label-focus'>{heading}</span>\n            </span>\n            <span className='fm-c-details__summary'>\n              <span className='fm-c-details__summary-focus'>{groupSummary}</span>\n            </span>\n            <span className='fm-c-details__toggle'>\n              <span className='fm-c-details__toggle-focus'>\n                <span className='fm-c-details__chevron' />\n                {isExpanded ? 'Hide' : 'Show'}\n              </span>\n            </span>\n          </button>\n          )\n        : <Heading />}\n      <div\n        id={`content-${id}`}\n        className={`fm-c-layers__${layout || 'row'}s`}\n        {...style}\n      >\n        {group.items.map((item, i) => {\n          const display = group.display || (item.icon ? 'icon' : item.fill ? 'fill' : item.display)\n          const isChecked = group?.type === 'radio' ? item?.id === checkedRadioId : layers?.includes(item.id)\n          return (\n            <Fragment key={(item.id || item.label).toLowerCase()}>\n              {(hasSymbols || item.id)\n                ? (\n                  <div className={`fm-c-layers__item fm-c-layers__item--${display} govuk-body-s`}>\n                    <ItemInner item={item} index={i} display={display} isChecked={isChecked} />\n                  </div>\n                  )\n                : null}\n              {hasSymbols\n                ? item.items?.map((child, j) => {\n                  const display = item.display || (child.icon ? 'icon' : 'fill')\n                  return (\n                    <div key={`${item.label.toLowerCase()}-${j}`} className={`fm-c-layers__item fm-c-layers__item--${display} govuk-body-s`}>\n                      <ItemInner item={child} index={j} display={display} />\n                    </div>\n                  )\n                })\n                : null}\n            </Fragment>\n          )\n        })}\n      </div>\n    </div>\n  )\n}\n","import React, { useEffect, Fragment } from 'react'\nimport { useApp } from '../store/use-app'\nimport { useViewport } from '../store/use-viewport'\nimport { findTabStop } from '../lib/dom.js'\nimport { parseGroups } from '../lib/query.js'\nimport More from './more.jsx'\nimport LayerGroup from './layer-group.jsx'\n\nexport default function Layers ({ hasSymbols, hasInputs, isExpanded, setIsExpanded }) {\n  const { query, segments, options, activeRef, layers } = useApp()\n\n  if (!options.legend?.key) return\n\n  const { zoom } = useViewport()\n  const { id, legend, queryPolygon } = options\n  const { display, keyDisplay } = legend\n\n  useEffect(() => {\n    if (!isExpanded) return\n    const lastRef = activeRef.current\n    const nextTabStop = findTabStop(lastRef, 'next')\n    nextTabStop?.focus()\n  }, [isExpanded])\n\n  const moreLabel = keyDisplay === 'min' && isExpanded ? 'Fewer layers' : 'All layers'\n  const maxRow = display === 'inset' && keyDisplay === 'min' ? 0 : legend.key.length\n  const queryLabel = query ? queryPolygon.keyLabel : null\n  const groups = parseGroups(legend.key, segments, layers, zoom, hasInputs, queryLabel)\n  const isEmptyKey = !hasInputs && !groups.length\n\n  return (\n    <div id={`${id}-key`} className='fm-c-layers'>\n      {groups.map((g, i) => (\n        <Fragment key={`fl${i}`}>\n          {isExpanded || (!isExpanded && i <= maxRow)\n            ? <LayerGroup key={`lg${i}`} group={g} id={`l${i}`} display={display} hasSymbols={hasSymbols} hasInputs={hasInputs} />\n            : null}\n        </Fragment>\n      ))}\n      {maxRow < (groups.length - 1)\n        ? (\n          <div className='fm-c-layers__more fm-c-layers__more--centre'>\n            <More id={`${id}-key`} label={moreLabel} isExpanded={isExpanded} setIsExpanded={setIsExpanded} isRemove />\n          </div>\n          )\n        : null}\n      {isEmptyKey\n        ? <p className='govuk-body-s govuk-!-margin-bottom-0'>No features displayed</p>\n        : null}\n    </div>\n  )\n}\n","import React from 'react'\nimport { useApp } from '../store/use-app.js'\nimport { useViewport } from '../store/use-viewport.js'\nimport { events } from '../store/constants.js'\nimport eventBus from '../lib/eventbus.js'\n\nexport default function DrawStart () {\n  const { provider, parent, queryPolygon, mode, segments, layers, dispatch, query } = useApp()\n\n  if (!queryPolygon) return\n\n  const { size, basemap } = useViewport()\n\n  const handleClick = () => {\n    // Dynamic import of draw module\n    provider.draw?.start ? provider.draw.start() : provider.initDraw(queryPolygon, query)\n    dispatch({ type: 'SET_MODE', value: 'frame', query, isFrameVisible: !query })\n    eventBus.dispatch(parent, events.APP_CHANGE, { type: 'mode', mode: 'frame', basemap, size, segments, layers })\n  }\n\n  return (\n    <div className='fm-c-draw'>\n      {/* <h2 className='fm-c-draw__heading govuk-body-s'>{ draw.heading }</h2> */}\n      <button className='fm-c-btn-draw govuk-body-s' {...mode === 'frame' ? { 'aria-disabled': true } : {}} onClick={handleClick}>\n        {query ? queryPolygon.editLabel : queryPolygon.startLabel}\n      </button>\n    </div>\n  )\n}\n","import React, { useRef, useState, createRef, useEffect } from 'react'\nimport { useApp } from '../store/use-app'\nimport { useViewport } from '../store/use-viewport'\nimport { findTabStop } from '../lib/dom.js'\nimport More from './more.jsx'\n\nexport default function Styles () {\n  const { options, provider, activeRef } = useApp()\n  const { id } = options\n  const { basemaps, stylesImagePath, getImagePos, hasSize } = provider\n  const { basemap, size } = useViewport()\n  const viewportDispatch = useViewport().dispatch\n\n  const currentBasemap = basemap\n  const currentSize = size\n  const buttonsRef = useRef([])\n  const [isExpanded, setIsExpanded] = useState(basemaps.indexOf(currentBasemap) > 2 || size !== 'small')\n  buttonsRef.current = basemaps.map((_, i) => buttonsRef.current[i] ?? createRef())\n\n  const moreLabel = `${isExpanded ? 'Fewer' : 'More'} styles`\n\n  const handleBasemapClick = e => {\n    activeRef.current = null\n    const basemap = e.currentTarget.value\n    viewportDispatch({ type: 'SET_BASEMAP', basemap })\n  }\n\n  const handleSizeClick = e => {\n    activeRef.current = null\n    const size = e.currentTarget.value\n    viewportDispatch({ type: 'SET_SIZE', size })\n  }\n\n  // Set initial focus\n  useEffect(() => {\n    if (!isExpanded) return\n    const index = buttonsRef.current.length < 3 ? buttonsRef.current.length - 1 : 2\n    const el = buttonsRef.current[index].current\n    const nextTabStop = findTabStop(el, 'next')\n    nextTabStop.focus()\n  }, [isExpanded])\n\n  return (\n    <div id='map-styles' className='fm-c-layers fm-c-layers--style'>\n      <div className='fm-c-layers__group' role='group' aria-labelledby={`${id}-map-panel-label`}>\n        <div className='fm-c-layers__columns'>\n          {basemaps.filter((b, i) => isExpanded ? i >= 0 : i < 3).map((basemap, i) => (\n            <div key={i} className='fm-c-layers__item govuk-body-s'>\n              <button className='fm-c-layers__button' value={basemap} aria-pressed={currentBasemap === basemap} ref={buttonsRef.current[i]} onClick={handleBasemapClick}>\n                <div className='fm-c-layers__image'>\n                  <img src={stylesImagePath} draggable={false} width='120px' height='120px' alt='' style={{ objectPosition: getImagePos(basemap) }} />\n                </div>\n                {{\n                  default: 'Default',\n                  dark: 'Dark',\n                  aerial: 'Aerial',\n                  deuteranopia: 'Green-red enhanced',\n                  tritanopia: 'Blue-yellow enhanced',\n                  'high-contrast': 'High contrast'\n                }[basemap]}\n              </button>\n            </div>\n          ))}\n        </div>\n      </div>\n      {hasSize && isExpanded\n        ? (\n          <div className='fm-c-layers__group' role='group' aria-labelledby={`${id}-text-sizes`}>\n            <div id={`${id}-text-sizes`} className='fm-c-layers__header'>\n              <h3 className='fm-c-layers__heading govuk-body-s'>Text size</h3>\n            </div>\n            <div className='fm-c-layers__columns'>\n              {['small', 'large'].map((size, i) => (\n                <div key={i} className='fm-c-layers__item govuk-body-s'>\n                  <button className='fm-c-layers__button' value={size} aria-pressed={currentSize === size} onClick={handleSizeClick}>\n                    <div className='fm-c-layers__image'>\n                      <img src={stylesImagePath} draggable={false} width='120px' height='120px' alt='' style={{ objectPosition: getImagePos(size) }} />\n                    </div>\n                    {size[0].toUpperCase() + size.slice(1)}\n                  </button>\n                </div>\n              ))}\n            </div>\n          </div>\n          )\n        : null}\n      {basemaps.length > 3 || provider.hasSize\n        ? (\n          <div className='fm-c-layers__more fm-c-layers__more--centre'>\n            <More id={`${id}-styles`} label={moreLabel} isExpanded={isExpanded} setIsExpanded={setIsExpanded} isRemove />\n          </div>\n          )\n        : null}\n    </div>\n  )\n}\n","import React from 'react'\n\nexport default function Keyboard () {\n  return (\n    <dl className='fm-c-keyboard-list govuk-body-s'>\n      <div className='fm-u-visually-hidden'>\n        <dt>Get location information</dt>\n        <dd><kbd>Alt</kbd> + <kbd>I</kbd></dd>\n      </div>\n      <div className='fm-c-keyboard-list__item'>\n        <dt>Move in large steps</dt>\n        <dd><kbd>&larr;</kbd>, <kbd>&uarr;</kbd>, <kbd>&rarr;</kbd> or <kbd>&darr;</kbd></dd>\n      </div>\n      <div className='fm-c-keyboard-list__item'>\n        <dt>Move in small steps</dt>\n        <dd><kbd>Shift</kbd> + <kbd>&larr;</kbd>, <kbd>&uarr;</kbd>, <kbd>&rarr;</kbd> or <kbd>&darr;</kbd></dd>\n      </div>\n      <div className='fm-c-keyboard-list__item'>\n        <dt>Adjust zoom level</dt>\n        <dd><kbd>+</kbd> or <kbd>=</kbd> and <kbd>-</kbd> or <kbd>_</kbd></dd>\n      </div>\n      <div className='fm-c-keyboard-list__item'>\n        <dt>Select a feature</dt>\n        <dd><kbd>Page Up</kbd> and <kbd>Page Down</kbd></dd>\n      </div>\n      <div className='fm-c-keyboard-list__item'>\n        <dt>Get feature information</dt>\n        <dd><kbd>Enter</kbd></dd>\n      </div>\n    </dl>\n  )\n}\n","import React from 'react'\nimport { useApp } from '../store/use-app'\n\nexport default function LegendButton ({ legendBtnRef }) {\n  const { isEditMode, isMobile, dispatch, legend, activePanel } = useApp()\n\n  if (!legend) return\n\n  const handleClick = () => {\n    dispatch({ type: 'OPEN', data: 'LEGEND' })\n  }\n\n  return (\n    <button onClick={handleClick} aria-label={legend.title || 'Layers'} className='fm-c-btn fm-c-btn--legend govuk-body-s' ref={legendBtnRef} aria-expanded={false} {...activePanel === 'LEGEND' ? { style: { display: 'none' } } : {}}>\n      <svg aria-hidden='true' focusable='false' width='20' height='20' viewBox='0 0 20 20' fillRule='evenodd' fill='currentColor'>\n        <path d='M10 1l10 7-10 7L0 8l10-7zm0 2.441L3.488 8 10 12.559 16.512 8 10 3.441zm8.256 7.338L20 12l-10 7-10-7 1.744-1.221L10 16.559l8.256-5.78z' />\n      </svg>\n      <span className='fm-c-btn__label' aria-hidden {...isMobile && isEditMode ? { style: { display: 'none' } } : {}}>\n        {legend.title || 'Layers'}\n      </span>\n    </button>\n  )\n}\n","import React from 'react'\nimport { useApp } from '../store/use-app'\n\nexport default function KeyButton ({ keyBtnRef }) {\n  const { isEditMode, isMobile, dispatch, legend, activePanel } = useApp()\n\n  if (!legend) return\n\n  const handleClick = () => {\n    dispatch({ type: 'OPEN', data: 'KEY' })\n  }\n\n  return (\n    <button onClick={handleClick} aria-label='Key' className='fm-c-btn fm-c-btn--key govuk-body-s' ref={keyBtnRef} aria-expanded={false} {...activePanel === 'KEY' ? { style: { display: 'none' } } : {}}>\n      <svg aria-hidden='true' focusable='false' width='20' height='20' viewBox='0 0 20 20' fillRule='evenodd' fill='currentColor'>\n        <circle cx='3.5' cy='4' r='1.5' />\n        <circle cx='3.5' cy='10' r='1.5' />\n        <circle cx='3.5' cy='16' r='1.5' />\n        <path d='M7 4h11M7 10h11M7 16h11' fill='none' stroke='currentColor' strokeWidth='2' />\n      </svg>\n      <span className='fm-c-btn__label' aria-hidden {...isMobile && isEditMode ? { style: { display: 'none' } } : {}}>\n        Key\n      </span>\n    </button>\n  )\n}\n","import React from 'react'\nimport { useApp } from '../store/use-app'\nimport { useViewport } from '../store/use-viewport.js'\nimport { events } from '../store/constants'\nimport eventBus from '../lib/eventbus.js'\n\nexport default function DrawFinish () {\n  const { provider, parent, queryPolygon, mode, segments, layers, dispatch, viewportRef, query } = useApp()\n  const { size, basemap } = useViewport()\n\n  if (!mode) return\n\n  const handleClick = () => {\n    const feature = provider.draw.finish()\n    dispatch({ type: 'SET_MODE', value: 'default', query: feature, isFrameVisible: false })\n    eventBus.dispatch(parent, events.APP_CHANGE, { type: 'mode', mode: 'default', basemap, size, segments, layers })\n    viewportRef.current.focus()\n  }\n\n  return (\n    <button onClick={handleClick} className='fm-c-btn fm-c-btn--primary govuk-body-s'>\n      {query ? queryPolygon.updateLabel : queryPolygon.addLabel}\n    </button>\n  )\n}\n","import React from 'react'\nimport { useApp } from '../store/use-app'\n\nexport default function SearchButton ({ ariaLabelledby, searchBtnRef }) {\n  const { dispatch, search, activePanel } = useApp()\n\n  if (!search) return\n\n  const handleClick = () => {\n    dispatch({ type: 'OPEN', data: 'SEARCH' })\n  }\n\n  return (\n    <button onClick={handleClick} className='fm-c-btn fm-c-btn--search govuk-body-s' aria-labelledby={ariaLabelledby} aria-expanded={activePanel === 'SEARCH'} {...activePanel === 'SEARCH' ? { style: { display: 'none' } } : {}} ref={searchBtnRef}>\n      <svg aria-hidden='true' focusable='false' width='20' height='20' viewBox='0 0 20 20' fillRule='evenodd' fill='currentColor'>\n        <path d='M12.084 14.312c-1.117.711-2.444 1.123-3.866 1.123C4.235 15.435 1 12.201 1 8.218S4.235 1 8.218 1s7.217 3.235 7.217 7.218c0 1.422-.412 2.749-1.123 3.866L19 16.773 16.773 19l-4.689-4.688zM8.218 2.818c2.98 0 5.4 2.419 5.4 5.4s-2.42 5.4-5.4 5.4-5.4-2.42-5.4-5.4 2.419-5.4 5.4-5.4z' />\n      </svg>\n    </button>\n  )\n}\n","import React from 'react'\nimport { useApp } from '../store/use-app'\n\nexport default function StylesButton ({ ariaLabelledby, stylesBtnRef }) {\n  const { provider, dispatch } = useApp()\n  const { basemaps } = provider\n\n  // Mousedown used as target can move between mouseDown and mouseUp\n  const handlePointerDown = e => {\n    if (e.button !== 0) return\n    dispatch({ type: 'OPEN', data: 'STYLE' })\n  }\n\n  // Keydown used as target can move between keyDown and keyUp\n  const handleKeyDown = e => {\n    if (!['Enter', 'Space'].includes(e.key)) return\n    dispatch({ type: 'OPEN', data: 'STYLE' })\n  }\n\n  return (\n    <>\n      {basemaps?.length > 1\n        ? (\n          <button onPointerDown={handlePointerDown} onKeyDown={handleKeyDown} className='fm-c-btn fm-c-btn--style govuk-body-s' aria-labelledby={ariaLabelledby} ref={stylesBtnRef}>\n            <svg aria-hidden='true' focusable='false' width='20' height='20' viewBox='0 0 20 20' fillRule='evenodd' strokeLinejoin='round' fill='none' stroke='currentColor' strokeWidth='2'><path d='M2 18l5-2 6 2 5-2V2l-5 2-6-2-5 2v14z' /><path d='M7 2v14m6-12v14' strokeLinecap='round' /></svg>\n            {/* <img src={provider.stylesImagePath} draggable='false' width='68px' height='68px' alt='' style={{ objectPosition: '0px -240px' }} /> */}\n          </button>\n          )\n        : null}\n    </>\n  )\n}\n","import React, { useState, useRef, useEffect } from 'react'\nimport { useApp } from '../store/use-app'\n\nexport default function Tooltip ({ id, position, text, cssModifier, children }) {\n  const { isKeyboard } = useApp()\n  const [isVisible, setIsVisible] = useState(false)\n  const [hasFocusWithin, setHasFocusWithin] = useState(false)\n\n  const timeoutRef = useRef(null)\n  const labelRef = useRef(null)\n\n  const hideTooltip = () => {\n    if (timeoutRef.current) {\n      clearTimeout(timeoutRef.current)\n    }\n    setIsVisible(false)\n  }\n\n  const showTooltip = () => {\n    timeoutRef.current = setTimeout(() => setIsVisible(true), 500)\n  }\n\n  const handleKeyDown = e => {\n    setHasFocusWithin(false)\n  }\n\n  const handleKeyUp = e => {\n    setHasFocusWithin(true)\n  }\n\n  const handleGlobalKeyDown = e => {\n    const isActive = labelRef.current?.contains(document.activeElement)\n    if (['Escape', 'Esc'].includes(e.key) || isActive) {\n      hideTooltip()\n    }\n  }\n\n  useEffect(() => {\n    document.addEventListener('keydown', handleGlobalKeyDown)\n\n    return () => {\n      document.removeEventListener('keydown', handleGlobalKeyDown)\n    }\n  })\n\n  return (\n    <div\n      className={`fm-c-tooltip fm-c-tooltip--${position}${cssModifier ? ' fm-c-tooltip--' + cssModifier : ''}${isVisible ? ' fm-c-tooltip--visible' : ''}${hasFocusWithin ? ' fm-u-focus-within' : ''}`}\n      onMouseEnter={showTooltip}\n      onMouseLeave={hideTooltip}\n      onMouseDown={hideTooltip}\n      onFocus={isKeyboard ? showTooltip : null}\n      onBlur={hideTooltip}\n      onKeyDown={handleKeyDown}\n      onKeyUp={handleKeyUp}\n      ref={labelRef}\n    >\n      {children}\n      <div id={id} className='fm-c-tooltip__label' role='tooltip'>\n        <div className='fm-c-tooltip__label-inner govuk-body-s'>\n          {text}\n        </div>\n      </div>\n    </div>\n  )\n}\n","import React, { useEffect } from 'react'\nimport { useApp } from '../store/use-app'\nimport { useViewport } from '../store/use-viewport'\nimport Tooltip from './tooltip.jsx'\n\nexport default function Zoom () {\n  const { options } = useApp()\n  const { id, maxZoom, minZoom } = options\n  const { zoom, action } = useViewport()\n  const viewportDispatch = useViewport().dispatch\n\n  useEffect(() => {\n    if (!['ZOOM_IN', 'ZOOM_OUT'].includes(action)) return\n    viewportDispatch({ type: 'MOVEEND' })\n  }, [action])\n\n  return (\n    <div className='fm-c-zoom'>\n      <Tooltip id={`${id}-zoom-in-label`} position='left' text='Zoom in'>\n        <button onClick={() => { viewportDispatch({ type: 'ZOOM_IN' }) }} className='fm-c-btn fm-c-btn--zoom-in govuk-body-s' aria-disabled={zoom >= maxZoom} aria-labelledby={`${id}-zoom-in-label`} aria-controls={`${id}-viewport`}>\n          <svg aria-hidden='true' focusable='false' width='20' height='20' viewBox='0 0 20 20' style={{ fill: 'currentColor', fillRule: 'evenodd', clipRule: 'evenodd' }}><rect x='3' y='9' width='14' height='2' /><rect x='9' y='3' width='2' height='14' /></svg>\n        </button>\n      </Tooltip>\n      <Tooltip id={`${id}-zoom-out-label`} position='left' text='Zoom out'>\n        <button onClick={() => { viewportDispatch({ type: 'ZOOM_OUT' }) }} className='fm-c-btn fm-c-btn--zoom-out govuk-body-s' aria-disabled={zoom <= minZoom} aria-labelledby={`${id}-zoom-out-label`} aria-controls={`${id}-viewport`} data-fm-zoom-out-btn>\n          <svg aria-hidden='true' focusable='false' width='20' height='20' viewBox='0 0 20 20' style={{ fill: 'currentColor', fillRule: 'evenodd', clipRule: 'evenodd' }}><rect x='3' y='9' width='14' height='2' /></svg>\n        </button>\n      </Tooltip>\n    </div>\n  )\n}\n","import React, { useEffect, useState } from 'react'\nimport { useApp } from '../store/use-app'\nimport { useViewport } from '../store/use-viewport'\n\nexport default function Reset () {\n  const { id } = useApp().options\n  const { bbox, oCentre, rZoom, centre, zoom } = useViewport()\n  const viewportDispatch = useViewport().dispatch\n  const [isNewArea, setIsNewArea] = useState(false)\n\n  const handleOnClick = () => {\n    if (!isNewArea) return\n    viewportDispatch({ type: 'RESET' })\n  }\n\n  useEffect(() => {\n    const isSameCentre = JSON.stringify(oCentre) === JSON.stringify(centre)\n    const isSameZoom = rZoom === zoom\n    const isNewArea = oCentre && centre && rZoom && zoom && !(isSameCentre && isSameZoom)\n    setIsNewArea(isNewArea)\n  }, [bbox])\n\n  return (\n    <button onClick={handleOnClick} className='fm-c-btn fm-c-btn--reset govuk-body-s' aria-label='Reset map area' aria-disabled={!isNewArea} aria-controls={`${id}-viewport`}>\n      <svg aria-hidden='true' focusable='false' width='20' height='20' viewBox='0 0 20 20' fillRule='evenodd'>\n        <path d='M2.054 7.871L5.25 1.407l4 6.928-7.196-.464z' />\n        <path d='M7.25 4.871A6.46 6.46 0 0 1 10.5 4c3.587 0 6.5 2.913 6.5 6.5S14.087 17 10.5 17 4 14.087 4 10.5' fill='none' stroke='currentColor' strokeWidth='2' />\n      </svg>\n    </button>\n  )\n}\n","import React from 'react'\nimport { useApp } from '../store/use-app'\nimport { useViewport } from '../store/use-viewport'\n\nconst { sessionStorage } = window\n\nexport default function Location ({ ariaLabelledby }) {\n  const { provider, options } = useApp()\n  const { id } = options\n  const appDispatch = useApp().dispatch\n  const viewportDispatch = useViewport().dispatch\n\n  // Set initial geo location\n  const handleGeoLocationSuccess = (coord, place) => {\n    const hasSession = !!sessionStorage.getItem('geoloc')\n    sessionStorage.setItem('geoloc', JSON.stringify({ coord, place }))\n    if (hasSession) return\n    viewportDispatch({ type: 'GEOLOC', centre: coord, place })\n  }\n\n  const handleGeoLocationError = (err) => {\n    viewportDispatch({ type: 'CLEAR_STATUS' })\n    appDispatch({ type: 'ERROR', label: 'Can\\'t get location', message: err.message })\n  }\n\n  // Reset viewport\n  const handleOnClick = () => {\n    const geoloc = JSON.parse(sessionStorage.getItem('geoloc'))\n    if (geoloc) {\n      viewportDispatch({ type: 'GEOLOC', centre: geoloc.coord, place: geoloc.place })\n    } else {\n      provider.getGeoLocation(handleGeoLocationSuccess, handleGeoLocationError)\n      viewportDispatch({ type: 'UPDATE_STATUS', status: 'Getting location', isStatusVisuallyHidden: false })\n    }\n  }\n\n  return (\n    <button onClick={handleOnClick} className='fm-c-btn fm-c-btn--location' aria-labelledby={ariaLabelledby} aria-controls={`${id}-viewport`}>\n      <svg aria-hidden='true' focusable='false' width='20' height='20' viewBox='0 0 20 20' fillRule='evenodd'>\n        <g fill='none' stroke='currentColor' strokeWidth='2'>\n          <circle cx='10' cy='10' r='6' />\n          <path d='M10 4V1m0 18v-3m6-6h3M1 10h3' strokeLinecap='butt' />\n        </g>\n        <circle cx='10' cy='10' r='3' fill='currentColor' />\n      </svg>\n    </button>\n  )\n}\n","import React from 'react'\nimport { useApp } from '../store/use-app'\n\nexport default function Attribution () {\n  const { provider } = useApp()\n\n  if (!provider) return\n\n  const attribution = provider.attribution\n\n  return (\n    <>\n      {attribution?.logo && attribution?.label\n        ? <img className='fm-c-attribution' alt={attribution.label} src={attribution.logo} width='90' height='24' style={{ pointerEvents: 'auto', display: 'block' }} />\n        : <span className='fm-c-spacer' />}\n    </>\n  )\n}\n","import React from 'react'\nimport { useApp } from '../store/use-app'\n\nexport default function Error () {\n  const { message } = useApp().error\n\n  return (\n    <p>{message}</p>\n  )\n}\n","import React from 'react'\nimport { useApp } from '../store/use-app'\n\nexport default function ViewportLabel () {\n  const { options } = useApp()\n  const { id } = options\n\n  return (\n    <div id={`${id}-viewport-label`} className='fm-c-panel fm-c-panel--viewport-label govuk-body-s'>\n      <span className='fm-u-visually-hidden'>Interactive map. </span><kbd>Alt</kbd> + <kbd>K</kbd> <span className='fm-u-visually-hidden'>Show</span> keyboard controls<span className='fm-u-visually-hidden'>.</span>\n    </div>\n  )\n}\n","import React from 'react'\nimport { useApp } from '../store/use-app.js'\nimport { useViewport } from '../store/use-viewport.js'\nimport { events } from '../store/constants'\nimport eventBus from '../lib/eventbus.js'\n\nexport default function DrawCancel ({ cancelBtnRef }) {\n  const { provider, parent, segments, layers, dispatch, viewportRef } = useApp()\n  const { size, basemap } = useViewport()\n\n  const handleClick = () => {\n    provider.draw.cancel()\n    dispatch({ type: 'SET_MODE', value: 'default', isFrameVisible: false })\n    eventBus.dispatch(parent, events.APP_CHANGE, { type: 'mode', mode: 'default', basemap, size, segments, layers })\n    viewportRef.current.focus()\n  }\n\n  return (\n    <button onClick={handleClick} aria-label='Cancel' className='fm-c-btn fm-c-btn--secondary govuk-body-s' ref={cancelBtnRef}>\n      Cancel\n    </button>\n  )\n}\n","import React from 'react'\nimport { useApp } from '../store/use-app'\n\nexport default function DrawEdit () {\n  const { provider, mode, dispatch } = useApp()\n\n  if (!mode) return\n\n  const handleEditClick = () => {\n    provider.draw.edit()\n    dispatch({ type: 'SET_MODE', value: 'draw', isFrameVisible: false })\n  }\n\n  const handleBoxClick = () => {\n    provider.draw.reset()\n    dispatch({ type: 'SET_MODE', value: 'frame', isFrameVisible: true })\n  }\n\n  // const handleDoneClick = () => {\n  //     const feature = provider.draw.finishEdit()\n  //     dispatch({ type: 'SET_MODE', value: 'draw', isFrameVisible: !feature })\n  // }\n\n  // const handleResetClick = () => {\n  //     provider.draw.reset()\n  // }\n\n  return (\n    <div className='fm-o-viewport-controls'>\n      <button onClick={handleEditClick} className='fm-c-btn fm-c-btn--edit govuk-body-s' {...mode === 'draw' ? { style: { display: 'none' } } : {}}>\n        <svg aria-hidden='true' focusable='false' width='20' height='20' viewBox='0 0 20 20' fillRule='evenodd' fill='none' stroke='currentColor' strokeWidth='2'>\n          <path d='M16 6v7.996M14 16H6m-2-2.004V6m2-2h8' /><circle cx='4' cy='4' r='2' /><circle cx='4' cy='15.996' r='2' /><circle cx='16' cy='4' r='2' /><circle cx='16' cy='15.996' r='2' />\n        </svg>\n        Edit shape\n      </button>\n      <button onClick={handleBoxClick} className='fm-c-btn fm-c-btn--edit govuk-body-s' {...mode === 'frame' ? { style: { display: 'none' } } : {}}>\n        <svg aria-hidden='true' focusable='false' width='20' height='20' viewBox='0 0 20 20' fillRule='evenodd' fill='none' stroke='currentColor' strokeWidth='2'>\n          <rect x='2' y='2' width='16' height='16' />\n        </svg>\n        Use box\n      </button>\n    </div>\n  )\n}\n","import React from 'react'\nimport { useApp } from '../store/use-app'\n\nexport default function QueryButton () {\n  const { queryPolygon } = useApp()\n\n  return (\n    <button className='fm-c-btn fm-c-btn--primary govuk-body-s'>\n      {queryPolygon.submitLabel}\n    </button>\n  )\n}\n","import React, { useEffect, useRef } from 'react'\nimport { useOutsideInteract } from '../hooks/use-outside-interact'\nimport { toggleInert } from '../lib/dom'\nimport { useApp } from '../store/use-app'\n\nexport default function Help ({ instigatorRef, focusRef, heading, body }) {\n  const { isMobile, dispatch, options, activeRef, viewportRef, isDesktop } = useApp()\n  const { id, legend } = options\n\n  // Ref to element\n  const elementRef = useRef(null)\n  const isModal = isMobile || (legend.display !== 'inset' && !isDesktop)\n\n  // Hide keyboard on click outside\n  useOutsideInteract(elementRef, 'click', e => {\n    if (isDesktop || e.target !== viewportRef?.current?.querySelector('canvas')) return\n    handleClose()\n  })\n\n  // Events\n  const handleClose = () => {\n    dispatch({ type: 'CLOSE' })\n    activeRef.current = instigatorRef?.current\n  }\n\n  const handleKeyUp = e => {\n    if (['Escape', 'Esc'].includes(e.key)) {\n      e.preventDefault()\n      handleClose()\n    }\n  }\n\n  const handleBlur = e => {\n    if (!(isMobile && elementRef.current.contains(e.target) && !elementRef.current.contains(e.relatedTarget))) return\n    dispatch({ type: 'SET_IS_EXPANDED', value: false })\n  }\n\n  // Set intial focus\n  useEffect(() => {\n    activeRef.current = focusRef?.current || elementRef.current\n  }, [])\n\n  // Toggle inert elements\n  useEffect(() => {\n    toggleInert()\n  }, [isModal])\n\n  const panelId = `${id}-panel-help`\n  const hasWidth = legend.width && !(isMobile && legend.display === 'inset')\n\n  return (\n    <div\n      id={panelId}\n      className='fm-c-panel fm-c-panel--help'\n      aria-labelledby={`${panelId}-label`}\n      role={isModal ? 'dialog' : 'region'}\n      {...isModal\n        ? {\n            open: true,\n            'aria-modal': true\n          }\n        : {}}\n      ref={elementRef}\n      onBlur={handleBlur}\n      onKeyUp={handleKeyUp}\n      tabIndex='-1'\n      {...hasWidth\n        ? {\n            style: { width: legend.width }\n          }\n        : {}}\n    >\n      <div className='fm-c-panel__header'>\n        <h2 id={`${panelId}-label`} className='fm-c-panel__heading govuk-heading-m'>\n          {heading}\n        </h2>\n        {!isDesktop\n          ? (\n            <button onClick={handleClose} className='fm-c-btn fm-c-btn--close-panel govuk-body-s' aria-label='Close panel'>\n              <svg aria-hidden='true' focusable='false' width='20' height='20' viewBox='0 0 20 20'><path d='M10,8.6L15.6,3L17,4.4L11.4,10L17,15.6L15.6,17L10,11.4L4.4,17L3,15.6L8.6,10L3,4.4L4.4,3L10,8.6Z' style={{ fill: 'currentColor', stroke: 'currentColor', strokeWidth: 0.1 }} /></svg>\n            </button>\n            )\n          : null}\n      </div>\n      <div className='fm-c-panel__body'>\n        <div className='fm-c-panel__content' {...({ dangerouslySetInnerHTML: { __html: body } })} />\n      </div>\n    </div>\n  )\n}\n","import React from 'react'\nimport { useApp } from '../store/use-app'\n\nexport default function HelpButton ({ helpBtnRef }) {\n  const { dispatch, activePanel } = useApp()\n\n  const handleClick = () => {\n    dispatch({ type: 'OPEN', data: 'HELP' })\n  }\n\n  return (\n    <button onClick={handleClick} className='fm-c-btn fm-c-btn--help govuk-body-s' ref={helpBtnRef} aria-expanded={false} {...activePanel === 'HELP' ? { style: { display: 'none' } } : {}}>\n      <svg width='20' height='20' viewBox='0 0 20 20' fillRule='evenodd'>\n        <circle cx='10' cy='10' r='8.5' fill='none' stroke='currentColor' strokeWidth='1.5' /><path d='M10.935 11.673H8.708v-.223c0-1.997 2.445-2.651 2.085-3.597-.175-.46-1.57-.837-1.757.843l-2.273-.281c.407-4.359 7.331-3.069 6.405.161-.025.09-.143.502-.625.986-1.252 1.258-1.608 1.111-1.608 2.111zm-2.303.592h2.385v2.104H8.632z' />\n      </svg>\n      Help\n    </button>\n  )\n}\n","import React, { useEffect, useRef, useState } from 'react'\nimport { ViewportProvider } from '../store/viewport-provider.jsx'\nimport { useApp } from '../store/use-app'\nimport { defaults, events, settings } from '../store/constants'\nimport { updateTitle, toggleInert, constrainFocus } from '../lib/dom'\nimport eventBus from '../lib/eventbus'\nimport Viewport from './viewport.jsx'\nimport Exit from './exit.jsx'\nimport Search from './search.jsx'\nimport Panel from './panel.jsx'\nimport Segments from './segments.jsx'\nimport Layers from './layers.jsx'\nimport DrawStart from './draw-start.jsx'\nimport Styles from './styles.jsx'\nimport Keyboard from './keyboard.jsx'\nimport LegendButton from './legend-button.jsx'\nimport KeyButton from './key-button.jsx'\nimport DrawFinish from './draw-finish.jsx'\nimport SearchButton from './search-button.jsx'\nimport StylesButton from './styles-button.jsx'\nimport Zoom from './zoom.jsx'\nimport Reset from './reset.jsx'\nimport Location from './location.jsx'\nimport Attribution from './attribution.jsx'\nimport Error from './error.jsx'\nimport ViewportLabel from './viewport-label.jsx'\nimport DrawCancel from './draw-cancel.jsx'\nimport DrawEdit from './draw-edit.jsx'\nimport QueryButton from './query-button.jsx'\nimport Help from './help.jsx'\nimport HelpButton from './help-button.jsx'\nimport Tooltip from './tooltip.jsx'\n\nexport default function Container () {\n  // Derived from state and props\n  const { dispatch, provider, options, parent, info, search, queryPolygon, mode, activePanel, isPage, isMobile, isDesktop, activeRef, viewportRef, query, error } = useApp()\n  const { id } = options\n\n  // Refs to elements\n  const legendBtnRef = useRef(null)\n  const keyBtnRef = useRef(null)\n  const searchBtnRef = useRef(null)\n  const stylesBtnRef = useRef(null)\n  const helpBtnRef = useRef(null)\n  const cancelBtnRef = useRef(null)\n  const maskRef = useRef(null)\n\n  // Expanded panels\n  const [isKeyExpanded, setIsKeyExpanded] = useState()\n\n  // Template properties\n  const type = settings.container[options.type || defaults.CONTAINER_TYPE].CLASS\n  const device = isMobile ? 'mobile' : isDesktop ? 'desktop' : 'tablet'\n  const height = (isPage || options.target) ? '100%' : options.height || settings.container[options.type].HEIGHT\n  const legend = options.legend\n  const isLegendInset = legend?.display === 'inset'\n  const isLegendFixed = !isLegendInset && isDesktop\n  const isLegendModal = !isLegendFixed && (!isLegendInset || (isLegendInset && isKeyExpanded))\n  const hasLengedHeading = !(legend.display === 'inset' || (isLegendFixed && isPage))\n  const isQueryMode = ['frame', 'draw'].includes(mode)\n  const hasLegendButton = legend && !isQueryMode && !(isDesktop && !isLegendInset)\n  const hasKeyButton = legend && !isQueryMode && !legend.display\n  const isOffset = (isLegendInset && isPage) || !!search || (hasLegendButton && ['INFO', 'KEY'].includes(activePanel)) || (hasKeyButton && activePanel !== 'KEY')\n  const hasDrawButtons = isQueryMode && !(isDesktop && !isLegendInset)\n  const hasExitButton = !isQueryMode && isPage && !(isDesktop && !isLegendInset)\n  const hasSearchButton = !isQueryMode && search && !(isDesktop && search?.isExpanded)\n  const hasSearchPanel = !isQueryMode && (activePanel === 'SEARCH' || (isDesktop && search?.isExpanded))\n  const hasQueryButton = !isQueryMode && query && activePanel !== 'INFO' && !(isMobile && activePanel === 'KEY')\n\n  // Communication between Vanilla JS and React components\n  useEffect(() => {\n    eventBus.on(parent, events.SET_INFO, data => { dispatch({ type: 'SET_INFO', data }) })\n    eventBus.on(parent, events.SET_SELECTED, data => { dispatch({ type: 'SET_SELECTED', id: data }) })\n    eventBus.on(parent, events.SET_DRAW, data => { dispatch({ type: 'SET_DRAW', data }) })\n\n    // Ready for map\n    if (!(info || legend?.isVisible)) {\n      dispatch({ type: 'CONTAINER_READY' })\n    }\n  }, [])\n\n  // Toggle inert elements\n  useEffect(() => {\n    activeRef.current?.focus()\n    updateTitle()\n    toggleInert()\n  }, [isPage, activePanel])\n\n  return (\n    <ViewportProvider options={options}>\n      <div className={`fm-o-container fm-${device} ${type}${isQueryMode ? ' fm-draw' : ''}`} {...{ onKeyDown: constrainFocus }} style={{ height, width: '100%' }} {...(isPage ? { 'data-fm-page': options.pageTitle || 'Map view' } : {})} data-fm-container=''>\n        {isDesktop && !isLegendInset\n          ? (\n            <div className='fm-o-side'>\n              {!isQueryMode && isPage ? <Exit /> : null}\n              {!isQueryMode\n                ? (\n                  <Panel className='legend' label={legend.title} width={legend.width} isFixed={isLegendFixed} isHideHeading={!hasLengedHeading}>\n                    <DrawStart />\n                    <Segments />\n                    <Layers hasSymbols={!!legend.display} hasInputs isExpanded={isKeyExpanded} setIsExpanded={setIsKeyExpanded} />\n                  </Panel>\n                  )\n                : <Help focusRef={cancelBtnRef} heading={queryPolygon.helpLabel} body={queryPolygon.html} />}\n            </div>\n            )\n          : null}\n        <div className='fm-o-main'>\n          <Viewport />\n          <div className={`fm-o-inner${isLegendInset ? ' fm-o-inner--inset' : ''}${isOffset ? ' fm-o-inner--offset-top' : ''}`}>\n            <div className='fm-o-top'>\n              <div className='fm-o-top__column'>\n                {hasExitButton ? <Exit /> : null}\n                {!isMobile && hasSearchButton\n                  ? (\n                    <Tooltip id={`${id}-search-label`} position='below' text='Show search'>\n                      <SearchButton ariaLabelledby={`${id}-search-label`} searchBtnRef={searchBtnRef} />\n                    </Tooltip>\n                    )\n                  : null}\n                {!isMobile && hasSearchPanel ? <Search instigatorRef={searchBtnRef} /> : null}\n                {hasLegendButton ? <LegendButton legendBtnRef={legendBtnRef} /> : null}\n                {hasKeyButton ? <KeyButton keyBtnRef={keyBtnRef} /> : null}\n                {hasDrawButtons ? <HelpButton helpBtnRef={helpBtnRef} label={queryPolygon.helpLabel} /> : null}\n              </div>\n              <div className='fm-o-top__column'>\n                <ViewportLabel />\n                {isQueryMode ? <DrawEdit /> : null}\n              </div>\n              <div className='fm-o-top__column'>\n                {isMobile && hasSearchButton\n                  ? (\n                    <Tooltip id={`${id}-search-label`} position='left' text='Show search'>\n                      <SearchButton ariaLabelledby={`${id}-search-label`} searchBtnRef={searchBtnRef} />\n                    </Tooltip>\n                    )\n                  : null}\n                {isMobile && hasSearchPanel ? <Search instigatorRef={searchBtnRef} /> : null}\n              </div>\n            </div>\n            {activePanel === 'KEY' && !isMobile\n              ? (\n                <Panel isInset isNotObscure={false} className='key' label='Key' width={legend.keyWidth || legend.width} instigatorRef={keyBtnRef} isModal={isKeyExpanded} setIsModal={setIsKeyExpanded}>\n                  <Layers hasSymbols hasInputs={false} isExpanded={isKeyExpanded} setIsExpanded={setIsKeyExpanded} />\n                </Panel>\n                )\n              : null}\n            {info && activePanel === 'INFO' && !isMobile\n              ? <Panel className='info' isInset isNotObscure label={info.label} width={info.width} html={info.html} instigatorRef={viewportRef} isModal={false} />\n              : null}\n            {activePanel === 'LEGEND' && !(isMobile && isLegendInset) && !(isDesktop && !isLegendInset)\n              ? (\n                <Panel className='legend' isNotObscure={false} label={legend.title} width={legend.width} instigatorRef={legendBtnRef} isInset={isLegendInset} isModal={isLegendModal} setIsModal={setIsKeyExpanded} isHideHeading={!hasLengedHeading}>\n                  <DrawStart />\n                  <Segments />\n                  <Layers hasSymbols={!!legend.display} hasInputs isExpanded={isKeyExpanded} setIsExpanded={setIsKeyExpanded} />\n                </Panel>\n                )\n              : null}\n            {activePanel === 'HELP' && !(isMobile && isLegendInset) && !(isDesktop && !isLegendInset)\n              ? <Help instigatorRef={helpBtnRef} heading={queryPolygon.helpLabel} body={queryPolygon.html} />\n              : null}\n            <div className='fm-o-bottom'>\n              <div className='fm-o-footer'>\n                <Attribution />\n                {isQueryMode && !isMobile\n                  ? (\n                    <div className='fm-o-actions'>\n                      <DrawFinish />\n                      <DrawCancel cancelBtnRef={cancelBtnRef} />\n                    </div>\n                    )\n                  : null}\n                {hasQueryButton && !isMobile\n                  ? (\n                    <div className='fm-o-actions'>\n                      <QueryButton />\n                    </div>\n                    )\n                  : null}\n                <div className='fm-o-buttons' {...(activePanel === 'STYLE' ? { style: { display: 'none' } } : {})}>\n                  {options.hasReset ? <Reset /> : null}\n                  {options.hasGeoLocation\n                    ? (\n                      <Tooltip id={`${id}-location-label`} position='left' text='Use your location'>\n                        <Location ariaLabelledby={`${id}-location-label`} provider={provider} />\n                      </Tooltip>\n                      )\n                    : null}\n                  {!isMobile ? <Zoom /> : null}\n                  {provider.basemaps && Object.keys(provider?.basemaps).length\n                    ? (\n                      <Tooltip id={`${id}-style-label`} position='left' cssModifier='style' text='Choose map style'>\n                        <StylesButton ariaLabelledby={`${id}-style-label`} stylesBtnRef={stylesBtnRef} />\n                      </Tooltip>\n                      )\n                    : null}\n                </div>\n              </div>\n              {info && activePanel === 'INFO' && isMobile\n                ? <Panel isInset isNotObscure className='info' label={info.label} html={info.html} instigatorRef={viewportRef} isModal={false} />\n                : null}\n              {activePanel === 'KEY' && isMobile\n                ? (\n                  <Panel isInset isNotObscure className='key' label='Key' instigatorRef={keyBtnRef} isModal={isKeyExpanded} setIsModal={setIsKeyExpanded}>\n                    <Layers hasSymbols hasInputs={false} isExpanded={isKeyExpanded} setIsExpanded={setIsKeyExpanded} />\n                  </Panel>\n                  )\n                : null}\n              {activePanel === 'LEGEND' && isMobile && isLegendInset\n                ? (\n                  <Panel className='legend' isNotObscure label={legend.title} width={legend.width} instigatorRef={legendBtnRef} isInset={isLegendInset} isFixed={isLegendFixed} isModal={isLegendModal} setIsModal={setIsKeyExpanded} isHideHeading={!hasLengedHeading}>\n                    <DrawStart />\n                    <Segments />\n                    <Layers hasSymbols hasInputs isExpanded={isKeyExpanded} setIsExpanded={setIsKeyExpanded} />\n                  </Panel>\n                  )\n                : null}\n              {isQueryMode && isMobile\n                ? (\n                  <div className='fm-o-actions'>\n                    <DrawFinish />\n                    <DrawCancel cancelBtnRef={cancelBtnRef} />\n                  </div>\n                  )\n                : null}\n              {hasQueryButton && isMobile\n                ? (\n                  <div className='fm-o-actions'>\n                    <QueryButton />\n                  </div>\n                  )\n                : null}\n            </div>\n          </div>\n          {activePanel === 'STYLE'\n            ? (\n              <Panel isInset label='Map style' instigatorRef={stylesBtnRef} width='400px' isModal>\n                <Styles />\n              </Panel>\n              )\n            : null}\n          {['KEYBOARD', 'ERROR'].includes(activePanel)\n            ? (\n              <div className='fm-o-mask' ref={maskRef}>\n                {activePanel === 'KEYBOARD'\n                  ? (\n                    <Panel isInset width='500px' maxWidth='500px' label='Keyboard' instigatorRef={viewportRef} isOutsideInteract isModal>\n                      <Keyboard />\n                    </Panel>\n                    )\n                  : null}\n                {activePanel === 'ERROR'\n                  ? (\n                    <Panel isInset maxWidth='300px' label={error.label} instigatorRef={viewportRef} isOutsideInteract isModal>\n                      <Error />\n                    </Panel>\n                    )\n                  : null}\n              </div>\n              )\n            : null}\n        </div>\n      </div>\n    </ViewportProvider>\n  )\n}\n","import { defaults } from './constants'\n\nexport const getDetail = async (provider, point, isUserInitiated = false) => {\n  const { getNearest, reverseGeocodeToken } = provider\n  const viewport = await getViewport(provider)\n  const features = await getFeatures(provider, point)\n\n  let place\n  if (isUserInitiated && features.resultType === 'pixel') {\n    place = await getNearest(features.lngLat, reverseGeocodeToken)\n  }\n\n  return {\n    ...viewport,\n    resultType: features.resultType,\n    coord: features.coord,\n    features,\n    place\n  }\n}\n\nexport const getViewport = async (provider) => {\n  // Needs to be paddingBox or boundary extent not view\n  const { view } = provider\n  const { xmin, ymin, xmax, ymax } = view.extent\n  const bbox = [xmin, ymin, xmax, ymax]\n  const { x, y } = view.center\n  const centre = [x, y].map(n => Math.round(n))\n  const zoom = parseFloat(view.zoom.toFixed(defaults.PRECISION))\n  return { bbox, centre, zoom }\n}\n\nexport const getFeatures = async (provider, point) => {\n  const { view, pixelLayers } = provider\n\n  // Get all features at a given pixel\n  const pixel = { x: point[0], y: point[1] }\n  const hits = await view.hitTest(pixel)\n  const featuresAtPixel = hits.results.filter(r => pixelLayers.some(l => r.layer.id === l))\n  const items = featuresAtPixel.map(f => {\n    return {\n      ...f.graphic.attributes,\n      id: f.graphic.uid,\n      layer: f.layer.id\n    }\n  })\n\n  // Get map coord of query\n  let coord = view.toMap(pixel)\n  coord = [coord.x, coord.y].map(n => Math.round(n))\n\n  return {\n    resultType: 'pixel',\n    items,\n    featuresTotal: null,\n    featuresInViewport: [],\n    isFeaturesInMap: false,\n    isPixelFeaturesAtPixel: !!items.length,\n    isPixelFeaturesInMap: !!pixelLayers.length,\n    coord\n  }\n}\n","import { handleBaseTileLayerLoaded, handleBasemapChange, handleMoveStart, handleStationary } from './events'\nimport { getDetail } from './query'\nimport { debounce } from '../../lib/debounce'\nimport { getFocusPadding } from '../../lib/viewport.js'\nimport { defaults } from './constants'\nimport { targetMarkerGraphic } from './marker'\nimport config from './config.json'\n\nclass Provider extends EventTarget {\n  constructor ({ osTokenCallback, esriTokenCallback, defaultUrl, darkUrl, aerialUrl, reverseGeocode, images }) {\n    super()\n    this.srs = 27700\n    this.osTokenCallback = osTokenCallback\n    this.esriTokenCallback = esriTokenCallback\n    this.defaultUrl = defaultUrl\n    this.darkUrl = darkUrl\n    this.aerialUrl = aerialUrl\n    this.basemaps = ['default', 'dark', 'aerial'].filter(b => this[b + 'Url'])\n    this.images = images\n    this.stylesImagePath = `${images}/styles.jpg`\n    this.reverseGeocode = reverseGeocode\n    this.isUpdate = true\n    this.isUserInitiated = false\n    this.attribution = {\n      logo: `${images}/os-logo.png`,\n      label: 'Ordnance Survey logo'\n    }\n  }\n\n  init (options) {\n    if (window.globalThis) {\n      Promise.all([\n        import(/* webpackChunkName: \"esri-sdk\" */ '@arcgis/core/config.js'),\n        import(/* webpackChunkName: \"esri-sdk\" */ '@arcgis/core/Map.js'),\n        import(/* webpackChunkName: \"esri-sdk\" */ '@arcgis/core/views/MapView.js'),\n        import(/* webpackChunkName: \"esri-sdk\" */ '@arcgis/core/geometry/Extent.js'),\n        import(/* webpackChunkName: \"esri-sdk\" */ '@arcgis/core/geometry/Point.js'),\n        import(/* webpackChunkName: \"esri-sdk\" */ '@arcgis/core/layers/VectorTileLayer.js'),\n        import(/* webpackChunkName: \"esri-sdk\" */ '@arcgis/core/layers/FeatureLayer.js'),\n        import(/* webpackChunkName: \"esri-sdk\" */ '@arcgis/core/layers/GraphicsLayer.js'),\n        import(/* webpackChunkName: \"esri-sdk\" */ '@arcgis/core/layers/support/TileInfo.js'),\n        import(/* webpackChunkName: \"esri-sdk\", webpackExports: [\"watch\", \"when\"] */ '@arcgis/core/core/reactiveUtils.js')\n      ]).then(modules => this.addMap({ modules, ...options }))\n    }\n  }\n\n  remove () {\n    /* How to properly destroy the map and all related resources */\n    // this.view?.destroy()\n    // this.map = null\n    // this.view = null\n  }\n\n  async addMap ({ modules, target, paddingBox, frame, bbox, centre, zoom, minZoom, maxZoom, basemap, pixelLayers }) {\n    const esriConfig = modules[0].default\n    const Map = modules[1].default\n    const MapView = modules[2].default\n    const Extent = modules[3].default\n    const Point = modules[4].default\n    const VectorTileLayer = modules[5].default\n    const FeatureLayer = modules[6].default\n    const GraphicsLayer = modules[7].default\n    const TileInfo = modules[8].default\n    const reactiveWatch = modules[9].watch\n\n    esriConfig.apiKey = (await this.esriTokenCallback()).token\n\n    esriConfig.request.interceptors.push({\n      urls: config.OS_SERVICE_URL,\n      before: async params => {\n        // Conditionally refresh token\n        const token = (await this.osTokenCallback()).token\n\n        params.requestOptions.headers = {\n          Authorization: 'Bearer ' + token\n        }\n      }\n    })\n\n    basemap = basemap === 'dark' && !this.basemaps.includes('dark') ? 'dark' : basemap\n\n    const baseTileLayer = new VectorTileLayer({\n      url: basemap === 'aerial' ? this.defaultUrl : this[basemap + 'Url'],\n      visible: true\n    })\n\n    const graphicsLayer = new GraphicsLayer()\n\n    const map = new Map({\n      layers: [baseTileLayer, graphicsLayer]\n    })\n\n    const extent = bbox\n      ? new Extent({\n        xmin: bbox[0],\n        ymin: bbox[1],\n        xmax: bbox[2],\n        ymax: bbox[3]\n      })\n      : null\n\n    const view = new MapView({\n      spatialReference: 27700,\n      container: target,\n      map,\n      zoom: zoom || null,\n      center: centre\n        ? new Point({\n          x: centre[0],\n          y: centre[1],\n          spatialReference: 27700\n        })\n        : null,\n      extent,\n      constraints: {\n        snapToZoom: false,\n        minZoom,\n        maxZoom,\n        maxScale: 0,\n        lods: TileInfo.create({\n          spatialReference: { wkid: 27700 }\n        }).lods,\n        rotationEnabled: false\n      },\n      ui: {\n        components: []\n      },\n      padding: getFocusPadding(paddingBox, 1)\n    })\n\n    // Tidy up canvas\n    const canvasContainer = target.querySelector('.esri-view-surface')\n    canvasContainer.removeAttribute('role')\n    canvasContainer.tabIndex = -1\n\n    this.map = map\n    this.view = view\n    this.baseTileLayer = baseTileLayer\n    this.graphicsLayer = graphicsLayer\n    this.pixelLayers = pixelLayers\n    this.paddingBox = paddingBox\n    this.frame = frame\n    this.basemap = basemap\n    this.isDark = ['dark', 'aerial'].includes(basemap)\n    this.modules = { Map, MapView, Extent, Point, VectorTileLayer, GraphicsLayer, FeatureLayer }\n\n    // Map ready event (first load)\n    baseTileLayer.watch('loaded', () => handleBaseTileLayerLoaded(this))\n\n    // Movestart\n    reactiveWatch(() => [view.stationary], ([stationary]) => {\n      if (!stationary) {\n        handleMoveStart(this)\n      }\n    })\n\n    // All changes. Must debounce, min 300ms\n    const debounceStationary = debounce(() => {\n      /* Dont update when adding graphics */\n      if (!this.isUpdate) {\n        this.isUpdate = true\n        return\n      }\n      handleStationary(this)\n    }, 300)\n\n    reactiveWatch(() => [view.stationary, view.updating], ([stationary, updating]) => {\n      if (updating || !stationary) return\n      debounceStationary()\n    })\n\n    // Detect user initiated map movement\n    view.on('drag', e => {\n      if (e.action !== 'start') return\n      this.isUserInitiated = true\n    })\n    view.on('mouse-wheel', e => {\n      this.isUserInitiated = true\n    })\n  }\n\n  getImagePos (style) {\n    return {\n      default: '0 0',\n      dark: '0 -120px',\n      aerial: '0 -240px',\n      deuteranopia: '0 -360px',\n      tritanopia: '0 -480px',\n      'high-contrast': '0 -600px',\n      small: '0 -720px',\n      large: '0 -840px'\n    }[style]\n  }\n\n  getPixel (coord) {\n    const pixel = this.view.toScreen({ x: coord[0], y: coord[1] })\n    return [Math.round(pixel.x), Math.round(pixel.y)]\n  }\n\n  panBy (offset, isUserInitiated = true) {\n    const { x, y } = this.view.toScreen(this.view.center)\n    const newPixel = { x: x + offset[0], y: y + offset[1] }\n    const newCentre = this.view.toMap(newPixel)\n    this.isUserInitiated = isUserInitiated\n    this.view.goTo({ center: newCentre }).catch(err => console.log(err))\n  }\n\n  panTo (coord) {\n    this.view.goTo({ target: { x: coord[0], y: coord[1] } }).catch(err => console.log(err))\n  }\n\n  zoomIn () {\n    this.view.animation?.destroy()\n    this.isUserInitiated = true\n    this.view.goTo({ zoom: this.view.zoom + 1 }).catch(err => console.log(err))\n  }\n\n  zoomOut () {\n    this.view.animation?.destroy()\n    this.isUserInitiated = true\n    this.view.goTo({ zoom: this.view.zoom - 1 }).catch(err => console.log(err))\n  }\n\n  setBasemap (basemap) {\n    basemap = basemap === 'dark' && !this.basemaps.includes('dark') ? 'default' : basemap\n    this.basemap = basemap\n    this.isDark = ['dark', 'aerial'].includes(basemap)\n    this.baseTileLayer.loadStyle(this[basemap + 'Url']).then(() => {\n      handleBasemapChange(this)\n    })\n  }\n\n  setPadding (coord, isAnimate) {\n    if (!this.view) return\n    const { paddingBox } = this\n    const padding = getFocusPadding(paddingBox, 1)\n    this.view.padding = padding\n    if (!coord) return\n\n    import(/* webpackChunkName: \"esri-sdk\" */ '@arcgis/core/geometry/Point.js').then(module => {\n      this.isUserInitiated = false\n      const Point = module.default\n      this.view.goTo({\n        target: new Point({\n          x: coord[0],\n          y: coord[1],\n          spatialReference: 27700\n        })\n      }, {\n        animation: isAnimate\n      }).catch(err => console.log(err))\n    })\n  }\n\n  setSize (size) {\n    // console.log('setSize')\n  }\n\n  fitBbox (bbox) {\n    import(/* webpackChunkName: \"esri-sdk\" */ '@arcgis/core/geometry/Extent.js').then(module => {\n      const Extent = module.default\n      this.view.goTo(new Extent({\n        xmin: bbox[0],\n        ymin: bbox[1],\n        xmax: bbox[2],\n        ymax: bbox[3]\n      })).catch(err => console.log(err))\n    })\n  }\n\n  setCentre (coord, zoom) {\n    this.view.goTo({ center: coord, zoom }).catch(err => console.log(err))\n  }\n\n  initDraw (options, report) {\n    this.removeTargetMarker()\n    import(/* webpackChunkName: \"esri-sdk-draw\" */ './draw.js').then(module => {\n      const Draw = module.default\n      this.draw = new Draw(this, options, report)\n    })\n  }\n\n  setTargetMarker (coord, hasData, isVisible) {\n    this.removeTargetMarker()\n    import(/* webpackChunkName: 'esri-sdk' */ '@arcgis/core/Graphic.js').then(module => {\n      const Graphic = module.default\n      const { map, graphicsLayer, isDark } = this\n      if (!(map && coord && isVisible)) return\n      // *** Bug with graphics layer order\n      map.reorder(graphicsLayer, 99)\n      const graphic = new Graphic(targetMarkerGraphic(coord, isDark, hasData))\n      graphicsLayer.add(graphic)\n      this.isUpdate = false\n      this.targetMarker = graphic\n    })\n  }\n\n  removeTargetMarker () {\n    const { graphicsLayer, targetMarker } = this\n    if (!targetMarker) return\n    this.isUpdate = false\n    graphicsLayer.remove(targetMarker)\n    this.targetMarker = null\n  }\n\n  selectFeature (id) {\n    // console.log('select')\n  }\n\n  async queryFeature (id) {\n    // console.log('queryFeature')\n  }\n\n  async queryPoint (point) {\n    const detail = await getDetail(this, point)\n    const place = await this.getNearest(detail.coord)\n    this.dispatchEvent(new CustomEvent('mapquery', {\n      detail: {\n        resultType: detail.features.resultType,\n        ...detail,\n        place\n      }\n    }))\n  }\n\n  async getNearest (coord) {\n    const isOs = this.reverseGeocode !== 'esri-world-geocoder'\n    const tokenCallback = isOs ? this.osTokenCallback : this.esriTokenCallback\n\n    const { getNearest } = isOs\n      ? await import(/* webpackChunkName: \"esri-sdk\" */ '../os-open-names/nearest.js')\n      : await import(/* webpackChunkName: \"esri-sdk\" */ '../esri-world-geocoder/nearest.js')\n\n    const response = await getNearest(coord, tokenCallback)\n\n    return response\n  }\n\n  getGeoLocation (success, error) {\n    navigator.geolocation.getCurrentPosition(async (position) => {\n      let coord = [position.coords.longitude, position.coords.latitude]\n      coord = coord.map(n => parseFloat(n.toFixed(defaults.PRECISION)))\n      const place = this.getNearest ? await this.getNearest(coord, 4326) : null\n      success(coord, place)\n    }, (err) => {\n      console.log(err)\n      error(err)\n    }, {\n      enableHighAccuracy: false\n    })\n  }\n\n  showLocation (coord) {\n    console.log('showLocation')\n    // import(/* webpackChunkName: \"maplibre-legacy\", webpackExports: [\"Marker\"] */ 'maplibre-gl-legacy').then(module => {\n    //     this.locationMarker = addLocationMarker(module.default.Marker, coord, this.map)\n    // })\n  }\n}\n\nexport default Provider\n","import { getDetail } from './query'\nimport { reColourMarkers } from './marker'\n\nexport const handleBaseTileLayerLoaded = (provider) => {\n  const { map, view, modules } = provider\n  provider.isLoaded = true\n  provider.dispatchEvent(new CustomEvent('load', {\n    detail: {\n      map,\n      view,\n      modules\n    }\n  }))\n}\n\nexport const handleBasemapChange = async (provider) => {\n  const { size, basemap, draw } = provider\n  reColourMarkers(provider)\n  draw?.reColour()\n  provider.dispatchEvent(new CustomEvent('style', {\n    detail: {\n      type: 'basemap',\n      basemap,\n      size\n    }\n  }))\n}\n\nexport const handleStationary = async (provider) => {\n  const { paddingBox } = provider\n  const { offsetTop, offsetLeft, offsetWidth, offsetHeight } = paddingBox\n  const point = [offsetLeft + (offsetWidth / 2), offsetTop + (offsetHeight / 2)]\n  provider.isUserInitiated = false\n  const detail = await getDetail(provider, point)\n  provider.dispatchEvent(new CustomEvent('update', {\n    detail\n  }))\n}\n\nexport const handleMoveStart = (provider) => {\n  provider.dispatchEvent(new CustomEvent('movestart', {\n    detail: {\n      isUserInitiated: provider.isUserInitiated\n    }\n  }))\n}\n","export const targetMarkerGraphic = (coord, isDark, hasData) => {\n  return {\n    geometry: {\n      type: 'point',\n      x: coord[0],\n      y: coord[1],\n      spatialReference: 27700\n    },\n    symbol: {\n      type: 'simple-marker',\n      path: hasData\n        ? 'M34.5.5c18.765 0 34 15.235 34 34s-15.235 34-34 34-34-15.235-34-34 15.235-34 34-34zM34 2.504C16.736 2.769 2.769 16.736 2.504 34H31v1H2.504C2.769 52.264 16.736 66.231 34 66.496V38h1v28.496C52.264 66.231 66.231 52.264 66.496 35H38v-1h28.496C66.231 16.736 52.264 2.769 35 2.504V31h-1V2.504z'\n        : 'M66.496 35H38v-1h28.496l-.165-2.816 1.989-.205c.139 1.351.199 2.723.175 4.114l-.233 3.445-1.987-.236a32.1 32.1 0 0 0 .22-3.244l.001-.058zM35 2.504V31h-1V1.5h.914l.013-.997.166.002c1.334.023 2.649.123 3.941.296l-.265 1.982a32.38 32.38 0 0 0-3.711-.278c-.019 0-.039-.001-.058-.001zM2.504 35l.04 1.195-1.998.104-.041-2.392.073-1.725 1.996.135-.069 1.625-.001.058H31v1H2.504zm31.905 32.5H34V38h1v28.496c1.108-.016 2.204-.09 3.283-.217l.234 1.986c-1.348.159-2.72.239-4.111.235l.003-1zm33.638-38.563l-1.974.326a31.59 31.59 0 0 0-.863-3.779l1.919-.563c.385 1.308.692 2.649.918 4.016zm-1.558-5.975l-1.881.68c-.442-1.222-.956-2.41-1.537-3.558l1.784-.903c.618 1.22 1.164 2.483 1.634 3.781zm-2.619-5.591l-1.727 1.01a31.99 31.99 0 0 0-2.155-3.222l1.592-1.21c.83 1.091 1.595 2.234 2.29 3.422zm-3.586-5.024l-1.516 1.304a32.24 32.24 0 0 0-2.7-2.783l1.349-1.476c1.014.926 1.972 1.913 2.867 2.955zm-4.429-4.298l-1.258 1.555c-1.004-.812-2.057-1.564-3.156-2.252l1.061-1.695a34.24 34.24 0 0 1 3.353 2.392zm-5.132-3.431l-.956 1.756a31.63 31.63 0 0 0-3.511-1.642l.736-1.86c1.284.508 2.53 1.092 3.731 1.746zm-5.669-2.445l-.621 1.901a31.8 31.8 0 0 0-3.751-.976l.385-1.963c1.36.267 2.691.614 3.987 1.038zM32.868.538l.094 1.998c-1.306.062-2.592.202-3.854.417L28.773.981a34.05 34.05 0 0 1 4.095-.443zm-6.115.85l.455 1.948a31.73 31.73 0 0 0-3.713 1.11l-.689-1.878c1.282-.47 2.599-.865 3.947-1.18zm-5.859 1.949l.802 1.832c-1.189.52-2.341 1.111-3.45 1.767l-1.018-1.721a33.82 33.82 0 0 1 3.666-1.878zm-5.407 2.98l1.12 1.656a32.48 32.48 0 0 0-3.075 2.362l-1.311-1.51c1.036-.9 2.127-1.738 3.266-2.508zm-4.78 3.904l1.4 1.429a32.22 32.22 0 0 0-2.601 2.875l-1.562-1.25a34.48 34.48 0 0 1 2.763-3.054zm-4.001 4.7l1.634 1.154c-.744 1.053-1.426 2.154-2.04 3.296l-1.762-.948c.653-1.213 1.378-2.383 2.168-3.502zm-3.088 5.346l1.815.838c-.539 1.167-1.01 2.373-1.407 3.611l-1.905-.611a33.76 33.76 0 0 1 1.497-3.838zm-2.066 5.818l1.938.494a31.67 31.67 0 0 0-.727 3.807l-1.984-.255c.177-1.376.436-2.726.773-4.046zM.716 38.352l1.987-.225a31.82 31.82 0 0 0 .669 3.818l-1.946.464a33.71 33.71 0 0 1-.71-4.057zm1.25 6.046l1.913-.582c.379 1.244.832 2.456 1.353 3.632l-1.828.811c-.554-1.25-1.035-2.538-1.438-3.861zm2.33 5.718l1.776-.921c.597 1.151 1.262 2.262 1.989 3.327L6.41 53.651c-.773-1.132-1.479-2.312-2.114-3.535zm3.327 5.2l1.58-1.226c.794 1.022 1.648 1.996 2.557 2.915l-1.422 1.407c-.966-.976-1.872-2.01-2.715-3.096zm4.207 4.516l1.335-1.49a32.11 32.11 0 0 0 3.038 2.408l-1.145 1.64c-1.128-.788-2.206-1.643-3.228-2.558zm4.951 3.686l1.045-1.705a32.04 32.04 0 0 0 3.422 1.819l-.83 1.82a34.06 34.06 0 0 1-3.637-1.934zm5.537 2.731l.718-1.867c1.198.461 2.432.851 3.695 1.167l-.484 1.94c-1.343-.335-2.655-.75-3.929-1.24zm5.943 1.678l.365-1.966c1.258.233 2.541.393 3.847.475l-.125 1.996c-1.387-.087-2.751-.257-4.087-.505zm12.294.035l-.354-1.969c1.282-.231 2.539-.539 3.765-.918l.592 1.91c-1.303.404-2.639.731-4.003.977zm5.951-1.647l-.707-1.87a32 32 0 0 0 3.535-1.589l.93 1.771c-1.212.635-2.466 1.2-3.758 1.688zm5.552-2.701l-1.035-1.711c1.109-.671 2.174-1.407 3.19-2.203l1.234 1.575a34.26 34.26 0 0 1-3.389 2.339zm4.971-3.658l-1.326-1.497c.969-.858 1.885-1.773 2.743-2.741l1.496 1.327a34.05 34.05 0 0 1-2.913 2.911zm4.233-4.492l-1.573-1.235c.797-1.015 1.534-2.08 2.205-3.188l1.711 1.036c-.714 1.178-1.496 2.309-2.343 3.387zm3.356-5.181l-1.77-.931c.598-1.139 1.13-2.319 1.59-3.534l1.871.708c-.489 1.292-1.055 2.546-1.691 3.757zm2.361-5.706l-1.91-.592c.38-1.225.688-2.481.92-3.765l1.968.356c-.246 1.364-.574 2.7-.978 4.001z',\n      size: '68px',\n      color: isDark ? '#ffffff' : hasData ? '#0b0c0c' : '#505a5f',\n      outline: {\n        width: 0\n      }\n    }\n  }\n}\n\nexport const reColourMarkers = async (provider) => {\n  const { graphicsLayer, targetMarker, isDark } = provider\n  if (!targetMarker) return\n  const graphic = targetMarker.clone()\n  graphic.symbol.color = isDark ? '#ffffff' : '#0b0c0c'\n  graphicsLayer.remove(targetMarker)\n  graphicsLayer.add(graphic)\n  provider.targetMarker = graphic\n}\n","import React, { useState, useRef, useEffect } from 'react'\nimport { createPortal } from 'react-dom'\nimport { settings, events } from './js/store/constants.js'\nimport eventBus from './js/lib/eventbus.js'\nimport { AppProvider } from './js/store/app-provider.jsx'\nimport Container from './js/components/container.jsx'\nimport Provider from './js/provider/os-maplibre/provider.js'\n\nexport default function App (options) {\n  const mobileMQ = `(max-width: ${options.maxMobile || settings.breakpoints.MAX_MOBILE})`\n  const desktopMQ = `(min-width: ${options.minDesktop || settings.breakpoints.MIN_DESKTOP})`\n  const colorSchemeMQ = '(prefers-color-scheme: dark)'\n  const { type, parent, target, handleExit } = options\n\n  const [isMobile, setIsMobile] = useState(window?.matchMedia(mobileMQ).matches)\n  const [isDarkMode, setIsDarkMode] = useState(window?.matchMedia(colorSchemeMQ).matches)\n  const [isDesktop, setIsDesktop] = useState(window.matchMedia(desktopMQ).matches)\n  const [isKeyboard, setIsKeyboard] = useState(!!options.isKeyboard)\n\n  // Create a provider instance\n  const provider = useRef(new Provider(options.provider))\n  const viewportRef = useRef(null)\n  const paddingBoxRef = useRef(null)\n  const frameRef = useRef(null)\n  const obscurePanelRef = useRef(null)\n  const activeRef = useRef(null)\n\n  //\n  // Event handlers\n  //\n\n  const handleMobileMQ = e => setIsMobile(e.matches)\n  const handleDesktopMQ = e => setIsDesktop(e.matches)\n  const handleColorSchemeMQ = e => setIsDarkMode(e.matches)\n\n  //\n  // Side effects\n  //\n\n  useEffect(() => {\n    // Avoid flicker on refresh\n    document.body.classList.remove('fm-js-hidden')\n\n    // Set media queries\n    if (window.matchMedia(mobileMQ).addEventListener) {\n      window.matchMedia(mobileMQ).addEventListener('change', handleMobileMQ)\n      window.matchMedia(desktopMQ).addEventListener('change', handleDesktopMQ)\n      window.matchMedia(colorSchemeMQ).addEventListener('change', handleColorSchemeMQ)\n    } else {\n      window.matchMedia(mobileMQ).addListener(handleMobileMQ)\n      window.matchMedia(desktopMQ).addListener(handleDesktopMQ)\n      window.matchMedia(colorSchemeMQ).addListener(handleColorSchemeMQ)\n    }\n\n    // Keyboard events\n    eventBus.on(parent, events.SET_IS_KEYBOARD, data => setIsKeyboard(data))\n\n    return () => {\n      window.removeEventListener('change', handleMobileMQ)\n      window.removeEventListener('change', handleDesktopMQ)\n    }\n  }, [])\n\n  const isPage = (type === 'buttonFirst') || (type === 'hybrid' && isMobile)\n\n  return (\n    <AppProvider\n      options={options}\n      app={{\n        provider: provider.current,\n        isPage,\n        isMobile,\n        isDarkMode,\n        isDesktop,\n        isBack: window.history.state?.isBack,\n        isKeyboard,\n        parent,\n        handleExit,\n        viewportRef,\n        paddingBoxRef,\n        frameRef,\n        obscurePanelRef,\n        activeRef\n      }}\n    >\n      {target ? createPortal(<Container />, parent) : <Container />}\n    </AppProvider>\n  )\n}\n","'use strict'\nimport React from 'react'\nimport { createRoot } from 'react-dom/client'\nimport App from './app.jsx'\n\nexport default function Root (el, props) {\n  const root = createRoot(el)\n  root.render(<App {...props} />)\n  return root\n}\n"],"names":["defaults","PRECISION","POLYGON_QUERY_STROKE","POLYGON_QUERY_STROKE_DARK","n","l","u","i","o","r","f","e","c","s","a","h","p","v","y","Array","isArray","d","w","parentNode","removeChild","_","t","arguments","length","children","call","defaultProps","g","type","props","key","ref","__k","__","__b","__e","__d","__c","constructor","__v","__i","__u","vnode","m","current","k","b","this","context","x","C","base","M","push","P","__r","debounceRendering","sort","shift","__P","O","__n","namespaceURI","j","S","$","N","I","nextSibling","String","L","V","contains","insertBefore","nodeType","H","some","T","setProperty","test","A","style","cssText","replace","toLowerCase","slice","addEventListener","removeEventListener","removeAttribute","setAttribute","F","event","prototype","render","contextType","value","__E","q","sub","state","__h","_sb","__s","getDerivedStateFromProps","componentWillMount","componentDidMount","componentWillReceiveProps","shouldComponentUpdate","forEach","componentWillUpdate","componentDidUpdate","getChildContext","getSnapshotBeforeUpdate","indexOf","z","diffed","localName","document","createTextNode","createElementNS","is","data","childNodes","attributes","name","__html","innerHTML","unmount","componentWillUnmount","B","firstChild","D","E","G","Consumer","Provider","splice","getDerivedStateFromError","setState","componentDidCatch","forceUpdate","Promise","then","bind","resolve","setTimeout","__H","__N","filter","every","concat","useDebugValue","__m","requestAnimationFrame","clearTimeout","cancelAnimationFrame","isPureReactComponent","R","__f","Symbol","for","map","count","only","toArray","appendChild","__a","U","__R","__O","pop","createElement","fallback","delete","revealOrder","size","W","containerInfo","get","Map","reverse","set","Z","Y","textContent","isReactComponent","Object","defineProperty","configurable","writable","J","K","Q","cancelBubble","X","defaultPrevented","persist","isPropagationStopped","isDefaultPrevented","nativeEvent","nn","tn","enumerable","class","en","multiple","selected","defaultValue","className","$$typeof","rn","un","on","ReactCurrentDispatcher","readContext","useCallback","useContext","useDeferredValue","bn","useEffect","useId","useImperativeHandle","useInsertionEffect","gn","useLayoutEffect","useMemo","useReducer","useRef","useState","useSyncExternalStore","Cn","useTransition","Sn","fn","vn","_n","xn","Rn","startTransition","version","Children","hydrate","unmountComponentAtNode","createPortal","createContext","createFactory","cloneElement","apply","createRef","Fragment","isValidElement","isElement","isFragment","isMemo","displayName","startsWith","findDOMNode","Component","PureComponent","memo","forwardRef","flushSync","unstable_batchedUpdates","StrictMode","Suspense","SuspenseList","lazy","default","__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED","parseSegments","dataSegments","seg","_queryParams$get","queryParams","URLSearchParams","window","location","search","split","segments","_g$parentIds","_g$parentIds2","_g$items$find","_g$items$find2","_g$items$","hasParent","parentIds","hasActiveParent","includes","items","find","_seg","id","isSelected","parseLayers","dataLayers","_queryParams$get2","lyr","layers","has","Set","parseGroups","zoom","hasInputs","queryLabel","groups","minZoom","maxZoom","ramps","flatItems","_g$items$find3","checkedRadioId","item","_item$items","fill","icon","display","label","reducer","action","_state$legend","_objectSpread","isContainerReady","info","activePanel","hasViewportLabel","queryPolygon","targetMarker","featureId","hasOwn","activePanelHasFocus","hash","Date","now","error","message","isMobile","isDesktop","isFixed","legend","position","isKeyboard","mode","query","isFrameVisible","AppContext","AppProvider","options","app","dispatch","_getQueryParam","_targetMarkerQuery","featureIdParam","settings","params","hasQueryParam","getQueryParam","targetMarkerParam","targetMarkerQuery","coord","parseFloat","hasData","markerCoord","parseQuery","isVisible","pointerQuery","initialState","store","React","dmsSeparator","Dms","separator","char","parse","dms","isNaN","isFinite","Number","dmsParts","trim","NaN","deg","toDms","format","dp","undefined","Infinity","Math","abs","toFixed","floor","toLat","lat","wrap90","toLon","lon","wrap180","toBrng","brng","wrap360","fromLocale","str","locale","toLocaleString","thousands","decimal","toLocale","compassPoint","bearing","precision","RangeError","round","degrees","toRadians","PI","toDegrees","LatLonSpherical","TypeError","_lat","_lon","latitude","lng","longitude","metresToKm","metresToMiles","metresToNauticalMiles","args","toString","ll","coordinates","JSON","stringify","distanceTo","point","radius","sin","cos","atan2","sqrt","initialBearingTo","equals","finalBearingTo","midpointTo","intermediatePointTo","fraction","destinationPoint","distance","asin","intersection","p1","brng1","p2","brng2","EPSILON","acos","min","max","crossTrackDistanceTo","pathStart","pathEnd","alongTrackDistanceTo","sign","maxLatitude","crossingParallels","point1","point2","lon1","lon2","rhumbDistanceTo","log","tan","rhumbBearingTo","rhumbDestinationPoint","rhumbMidpointTo","f1","f2","f3","areaOf","polygon","closed","nVertices","prevBrng","initBrng","finalBrng","isPoleEnclosedBy","toGeoJSON","getFocusPadding","el","scale","parent","closest","getBoundingClientRect","box","top","left","right","width","bottom","height","getMapPixel","offsetTop","offsetLeft","offsetWidth","offsetHeight","getDistance","coord1","coord2","pow","LatLon","getUnits","metres","units","getArea","bbox","ew","ns","getDescription","place","centre","features","featuresTotal","isFeaturesInMap","isPixelFeaturesAtPixel","isPixelFeaturesInMap","text","parseZoom","setBasemap","isDarkMode","ls","localStorage","getItem","oColourScheme","oBasemap","removeItem","getSelectedIndex","total","getSelectedStatus","featuresInViewport","index","feature","getShortcutKey","featuresViewport","number","code","oPlace","oZoom","detail","isUserInitiated","description","original","oBbox","oCentre","rZoom","isPanZoom","isSame","isGeoLoc","isFeaturesChange","isUpdate","direction","getBoundsChange","isSameCentre","isSameZoom","change","getDirection","ns1","ns2","nsd","ew1","ew2","ewd","ewc","nsc","status","isMoving","isStatusVisuallyHidden","padding","timestamp","basemap","panel","viewport","isAnimate","pRect","vRect","oHeight","oWidth","isPortrait","ViewportContext","ViewportProvider","_window","cz","matchMedia","matches","BBOX","isPanZoomChange","useApp","history","useQueryState","navigate","url","replaceState","setQuery","existingQueries","queryString","pathname","decodeURIComponent","useViewport","debounce","callback","wait","timeoutId","Status","isVisuallyHidden","PaddingBox","provider","viewportRef","paddingBoxRef","obscurePanelRef","frameRef","setPadding","isActive","_extends","usePixelObscurred","isObscurred","setIsObscurred","pixel","getPixel","topEl","elementFromPoint","Target","isTargetCentre","hasTargetData","targetCoord","isTargetVisible","resultType","setTargetMarker","viewBox","fillRule","stroke","cx","cy","strokeWidth","Viewport","activeRef","queryFeature","queryPixel","appDispatch","viewportDispatch","setQueryCz","centreZoom","setQueryId","setQueryTarget","mapContainerRef","featureIdRef","startPixel","isDraggingRef","handleMapLoad","eventBus","events","APP_READY","handleMovestart","handleUpdate","handleMapQuery","selectedId","APP_QUERY","handleMapStyle","APP_CHANGE","debounceUpdatePlace","async","getNearest","debounceUpdateStatus","isFocusVisible","activeElement","isDarkBasemap","init","target","paddingBox","frame","featureLayers","pixelLayers","querySelector","remove","fitBbox","setCentre","showLocation","zoomIn","zoomOut","setItem","setSize","selectFeature","queryTarget","keys","join","role","onClick","layerX","layerY","queryPoint","onKeyDown","_features$featuresInV2","altKey","offsets","pan","toUpperCase","preventDefault","offset","shiftKey","panBy","_features$featuresInV","_featuresInViewport$s","_featuresInViewport$","selectedIndex","onKeyUp","onPointerDown","pageX","pageY","onPointerUp","diffX","diffY","drag","tabIndex","Exit","isBack","handleExit","Path","focusable","useOutsideInteract","handleInteractOutside","createMessage","suggestions","isExpanded","isFocusWithin","isFocusVisibleWithin","Autocomplete","updateViewport","selectedRef","debounceUpdateSuggest","suggest","updateStatus","_selectedRef$current","scrollIntoView","onMouseEnter","cache","getTime","onMouseDown","handleOnMouseDown","dangerouslySetInnerHTML","marked","Vector3d","plus","minus","times","dividedBy","dot","cross","negate","unit","norm","angleTo","rotateAround","axis","angle","rp","ellipsoids","WGS84","datums","ellipsoid","freeze","LatLonEllipsoidal","_height","datum","_datum","toCartesian","referenceFrame","eSq","Cartesian","epoch","dpHeight","super","toLatLon","e2","Airy1830","AiryModified","Bessel1841","Clarke1866","Clarke1880IGN","GRS80","Intl1924","WGS72","ED50","transform","ETRS89","Irl1975","NAD27","NAD83","NTF","OSGB36","Potsdam","TokyoJapan","LatLonEllipsoidal_Datum","convertDatum","toDatum","cartesian","Cartesian_Datum","deprecatedDatum","console","latLon","oldCartesian","newCartesian","applyTransform","x1","y1","z1","tx","ty","tz","rx","ry","rz","nationalGrid","trueOrigin","falseOrigin","easting","northing","scaleFactor","OsGridRef","E0","N0","F0","n2","n3","dE","dE2","dE3","dE4","dE5","LatLon_OsGridRef","gridref","match","Error","l1","charCodeAt","l2","e100km","n100km","padEnd","digits","useGrouping","minimumIntegerDigits","maximumFractionDigits","letterPair","fromCharCode","padStart","toOsGrid","osgbED","markString","string","patterns","reg","RegExp","parseResults","tokenCallback","config","encodeURI","results","token","response","fetch","headers","Authorization","json","header","totalresults","removeTenuousResults","words","GAZETTEER_ENTRY","NAME1","from","result","ID","values","removeDuplicates","COUNTRY","removeNonEngland","err","suggestion","COUNTY_UNITARY","DISTRICT_BOROUGH","POSTCODE_DISTRICT","LOCAL_TYPE","qualifier","MBR_XMIN","MBR_YMIN","MBR_XMAX","MBR_YMAX","GEOMETRY_X","GEOMETRY_Y","_json$suggestions","stripSuffix","magicKey","_json$candidates","candidates","Region","xmin","ymin","xmax","ymax","extent","PlaceName","Search","instigatorRef","_state$value","isAutocomplete","searchProvider","EsriProvider","OsProvider","formRef","clearBtnRef","inputRef","searchWidth","keyWidth","handleCollapse","_formRef$current","blur","focus","open","onSubmit","htmlFor","autoComplete","placeholder","spellCheck","enterKeyHint","handleClick","onChange","onFocus","onBlur","handleClear","Panel","isInset","isNotObscure","isHideHeading","isModal","setIsModal","isOutsideInteract","maxWidth","html","elementRef","bodyRef","hasTabindex","setHasTabindex","handleClose","panelId","hasCloseBtn","hasWidth","toggleInert","_bodyRef$current","_bodyRef$current2","_bodyRef$current3","scrollHeight","hasInteractions","_elementRef$current","_elementRef$current2","relatedTarget","constrainFocus","currentTarget","tabindex","SegmentGroup","group","setQuerySeg","heading","isHidden","isDetails","setIsExpanded","handleItemClickOrChange","isChecked","Heading","handleDetailsClick","defaultChecked","Segments","collapse","More","isRemove","btnRef","previousTabStop","findTabStop","DOMParser","parseSVG","dom","parseFromString","svg","classList","add","toggle","getAttribute","olFill","querySelectorAll","olStroke","bgFill","bgStroke","fgFill","fgStroke","body","KeySymbol","_item$fill","setSvg","fills","preserveAspectRatio","LayerGroup","hasSymbols","_group$items$find","setQueryLyr","handleItemClick","dispatchAppChange","handleItemChange","layout","numItems","numCols","gridTemplateColumns","groupSummary","reduce","ItemInner","numLabels","child","Layers","_options$legend","keyDisplay","lastRef","nextTabStop","moreLabel","maxRow","keyLabel","isEmptyKey","DrawStart","_provider$draw","draw","start","initDraw","editLabel","startLabel","Styles","basemaps","stylesImagePath","getImagePos","hasSize","currentBasemap","currentSize","buttonsRef","_buttonsRef$current$i","handleBasemapClick","handleSizeClick","src","draggable","alt","objectPosition","dark","aerial","deuteranopia","tritanopia","Keyboard","LegendButton","legendBtnRef","isEditMode","title","KeyButton","keyBtnRef","DrawFinish","finish","updateLabel","addLabel","SearchButton","ariaLabelledby","searchBtnRef","StylesButton","stylesBtnRef","button","strokeLinejoin","strokeLinecap","Tooltip","cssModifier","setIsVisible","hasFocusWithin","setHasFocusWithin","timeoutRef","labelRef","hideTooltip","showTooltip","handleGlobalKeyDown","_labelRef$current","onMouseLeave","Zoom","clipRule","Reset","isNewArea","setIsNewArea","handleOnClick","sessionStorage","Location","handleGeoLocationSuccess","hasSession","handleGeoLocationError","geoloc","getGeoLocation","Attribution","attribution","logo","pointerEvents","ViewportLabel","DrawCancel","cancelBtnRef","cancel","DrawEdit","handleEditClick","edit","handleBoxClick","reset","QueryButton","submitLabel","Help","focusRef","_viewportRef$current","HelpButton","helpBtnRef","Container","isPage","maskRef","isKeyExpanded","setIsKeyExpanded","container","CONTAINER_TYPE","CLASS","device","HEIGHT","isLegendInset","isLegendFixed","isLegendModal","hasLengedHeading","isQueryMode","hasLegendButton","hasKeyButton","isOffset","hasDrawButtons","hasExitButton","hasSearchButton","hasSearchPanel","hasQueryButton","SET_INFO","SET_SELECTED","SET_DRAW","_activeRef$current","updateTitle","pageTitle","helpLabel","hasReset","hasGeoLocation","getDetail","reverseGeocodeToken","getViewport","getFeatures","lngLat","view","center","featuresAtPixel","hitTest","layer","graphic","uid","toMap","EventTarget","osTokenCallback","esriTokenCallback","defaultUrl","darkUrl","aerialUrl","reverseGeocode","images","srs","globalThis","all","modules","addMap","esriConfig","MapView","Extent","Point","VectorTileLayer","FeatureLayer","GraphicsLayer","TileInfo","reactiveWatch","watch","apiKey","request","interceptors","urls","before","requestOptions","baseTileLayer","visible","graphicsLayer","spatialReference","constraints","snapToZoom","maxScale","lods","create","wkid","rotationEnabled","ui","components","canvasContainer","isDark","isLoaded","dispatchEvent","CustomEvent","handleBaseTileLayerLoaded","stationary","handleMoveStart","debounceStationary","handleStationary","updating","small","large","toScreen","newPixel","newCentre","goTo","catch","panTo","_this$view$animation","animation","destroy","_this$view$animation2","loadStyle","clone","symbol","color","reColourMarkers","reColour","handleBasemapChange","module","report","removeTargetMarker","Draw","Graphic","reorder","targetMarkerGraphic","geometry","path","outline","isOs","success","navigator","geolocation","getCurrentPosition","coords","enableHighAccuracy","App","_window2","_window$history$state","mobileMQ","maxMobile","breakpoints","MAX_MOBILE","desktopMQ","minDesktop","MIN_DESKTOP","colorSchemeMQ","setIsMobile","setIsDarkMode","setIsDesktop","setIsKeyboard","handleMobileMQ","handleDesktopMQ","handleColorSchemeMQ","addListener","SET_IS_KEYBOARD","Root","root"],"sourceRoot":""}